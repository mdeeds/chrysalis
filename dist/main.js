(()=>{var t={887:(t,e,n)=>{"use strict";n.r(e),n.d(e,{glMatrix:()=>i,mat2:()=>r,mat2d:()=>s,mat3:()=>a,mat4:()=>o,quat:()=>h,quat2:()=>p,vec2:()=>_,vec3:()=>u,vec4:()=>c});var i={};n.r(i),n.d(i,{ARRAY_TYPE:()=>d,EPSILON:()=>l,RANDOM:()=>f,equals:()=>y,setMatrixArrayType:()=>m,toRadian:()=>v});var r={};n.r(r),n.d(r,{LDU:()=>B,add:()=>N,adjoint:()=>E,clone:()=>w,copy:()=>x,create:()=>b,determinant:()=>P,equals:()=>U,exactEquals:()=>F,frob:()=>I,fromRotation:()=>D,fromScaling:()=>A,fromValues:()=>T,identity:()=>k,invert:()=>M,mul:()=>V,multiply:()=>O,multiplyScalar:()=>G,multiplyScalarAndAdd:()=>W,rotate:()=>R,scale:()=>j,set:()=>C,str:()=>L,sub:()=>K,subtract:()=>z,transpose:()=>S});var s={};n.r(s),n.d(s,{add:()=>ct,clone:()=>q,copy:()=>X,create:()=>$,determinant:()=>Z,equals:()=>dt,exactEquals:()=>lt,frob:()=>ut,fromRotation:()=>rt,fromScaling:()=>st,fromTranslation:()=>at,fromValues:()=>Y,identity:()=>H,invert:()=>J,mul:()=>ft,multiply:()=>tt,multiplyScalar:()=>pt,multiplyScalarAndAdd:()=>_t,rotate:()=>et,scale:()=>nt,set:()=>Q,str:()=>ot,sub:()=>mt,subtract:()=>ht,translate:()=>it});var a={};n.r(a),n.d(a,{add:()=>Ut,adjoint:()=>St,clone:()=>yt,copy:()=>bt,create:()=>gt,determinant:()=>Mt,equals:()=>$t,exactEquals:()=>Kt,frob:()=>Ft,fromMat2d:()=>Lt,fromMat4:()=>vt,fromQuat:()=>It,fromRotation:()=>Dt,fromScaling:()=>At,fromTranslation:()=>jt,fromValues:()=>wt,identity:()=>kt,invert:()=>Ct,mul:()=>qt,multiply:()=>Et,multiplyScalar:()=>Wt,multiplyScalarAndAdd:()=>Vt,normalFromMat4:()=>Bt,projection:()=>Nt,rotate:()=>Ot,scale:()=>Rt,set:()=>xt,str:()=>zt,sub:()=>Xt,subtract:()=>Gt,translate:()=>Pt,transpose:()=>Tt});var o={};n.r(o),n.d(o,{add:()=>Ae,adjoint:()=>ie,clone:()=>Yt,copy:()=>Qt,create:()=>Ht,determinant:()=>re,equals:()=>ze,exactEquals:()=>Ne,frob:()=>De,fromQuat:()=>Ce,fromQuat2:()=>ye,fromRotation:()=>de,fromRotationTranslation:()=>ve,fromRotationTranslationScale:()=>ke,fromRotationTranslationScaleOrigin:()=>Te,fromScaling:()=>le,fromTranslation:()=>_e,fromValues:()=>Jt,fromXRotation:()=>fe,fromYRotation:()=>me,fromZRotation:()=>ge,frustum:()=>Se,getRotation:()=>xe,getScaling:()=>we,getTranslation:()=>be,identity:()=>te,invert:()=>ne,lookAt:()=>Oe,mul:()=>Fe,multiply:()=>se,multiplyScalar:()=>Ie,multiplyScalarAndAdd:()=>Be,ortho:()=>Pe,perspective:()=>Me,perspectiveFromFieldOfView:()=>Ee,rotate:()=>ue,rotateX:()=>ce,rotateY:()=>he,rotateZ:()=>pe,scale:()=>oe,set:()=>Zt,str:()=>je,sub:()=>Ue,subtract:()=>Le,targetTo:()=>Re,translate:()=>ae,transpose:()=>ee});var u={};n.r(u),n.d(u,{add:()=>Xe,angle:()=>Tn,bezier:()=>mn,ceil:()=>Je,clone:()=>We,copy:()=>$e,create:()=>Ge,cross:()=>ln,dist:()=>Dn,distance:()=>an,div:()=>jn,divide:()=>Qe,dot:()=>_n,equals:()=>En,exactEquals:()=>Mn,floor:()=>Ze,forEach:()=>Bn,fromValues:()=>Ke,hermite:()=>fn,inverse:()=>hn,len:()=>Ln,length:()=>Ve,lerp:()=>dn,max:()=>en,min:()=>tn,mul:()=>Rn,multiply:()=>Ye,negate:()=>cn,normalize:()=>pn,random:()=>gn,rotateX:()=>wn,rotateY:()=>xn,rotateZ:()=>kn,round:()=>nn,scale:()=>rn,scaleAndAdd:()=>sn,set:()=>qe,sqrDist:()=>An,sqrLen:()=>In,squaredDistance:()=>on,squaredLength:()=>un,str:()=>Sn,sub:()=>On,subtract:()=>He,transformMat3:()=>yn,transformMat4:()=>vn,transformQuat:()=>bn,zero:()=>Cn});var c={};n.r(c),n.d(c,{add:()=>Wn,ceil:()=>qn,clone:()=>zn,copy:()=>Un,create:()=>Nn,cross:()=>ui,dist:()=>bi,distance:()=>ti,div:()=>yi,divide:()=>$n,dot:()=>oi,equals:()=>mi,exactEquals:()=>fi,floor:()=>Xn,forEach:()=>Ti,fromValues:()=>Fn,inverse:()=>si,len:()=>xi,length:()=>ni,lerp:()=>ci,max:()=>Yn,min:()=>Hn,mul:()=>vi,multiply:()=>Kn,negate:()=>ri,normalize:()=>ai,random:()=>hi,round:()=>Qn,scale:()=>Jn,scaleAndAdd:()=>Zn,set:()=>Gn,sqrDist:()=>wi,sqrLen:()=>ki,squaredDistance:()=>ei,squaredLength:()=>ii,str:()=>di,sub:()=>gi,subtract:()=>Vn,transformMat4:()=>pi,transformQuat:()=>_i,zero:()=>li});var h={};n.r(h),n.d(h,{add:()=>er,calculateW:()=>Ai,clone:()=>Qi,conjugate:()=>Ui,copy:()=>Zi,create:()=>Ci,dot:()=>rr,equals:()=>_r,exactEquals:()=>pr,exp:()=>Li,fromEuler:()=>Wi,fromMat3:()=>Gi,fromValues:()=>Ji,getAngle:()=>Pi,getAxisAngle:()=>Ei,identity:()=>Si,invert:()=>Fi,len:()=>or,length:()=>ar,lerp:()=>sr,ln:()=>Ii,mul:()=>nr,multiply:()=>Oi,normalize:()=>hr,pow:()=>Bi,random:()=>zi,rotateX:()=>Ri,rotateY:()=>ji,rotateZ:()=>Di,rotationTo:()=>lr,scale:()=>ir,set:()=>tr,setAxes:()=>fr,setAxisAngle:()=>Mi,slerp:()=>Ni,sqlerp:()=>dr,sqrLen:()=>cr,squaredLength:()=>ur,str:()=>Vi});var p={};n.r(p),n.d(p,{add:()=>zr,clone:()=>gr,conjugate:()=>$r,copy:()=>Tr,create:()=>mr,dot:()=>Wr,equals:()=>ts,exactEquals:()=>Zr,fromMat4:()=>kr,fromRotation:()=>xr,fromRotationTranslation:()=>br,fromRotationTranslationValues:()=>yr,fromTranslation:()=>wr,fromValues:()=>vr,getDual:()=>Er,getReal:()=>Mr,getTranslation:()=>Rr,identity:()=>Cr,invert:()=>Kr,len:()=>Xr,length:()=>qr,lerp:()=>Vr,mul:()=>Ur,multiply:()=>Fr,normalize:()=>Qr,rotateAroundAxis:()=>Nr,rotateByQuatAppend:()=>Ir,rotateByQuatPrepend:()=>Br,rotateX:()=>Dr,rotateY:()=>Ar,rotateZ:()=>Lr,scale:()=>Gr,set:()=>Sr,setDual:()=>Or,setReal:()=>Pr,sqrLen:()=>Yr,squaredLength:()=>Hr,str:()=>Jr,translate:()=>jr});var _={};n.r(_),n.d(_,{add:()=>as,angle:()=>Ds,ceil:()=>hs,clone:()=>ns,copy:()=>rs,create:()=>es,cross:()=>Cs,dist:()=>Gs,distance:()=>gs,div:()=>Us,divide:()=>cs,dot:()=>Ts,equals:()=>Bs,exactEquals:()=>Is,floor:()=>ps,forEach:()=>Ks,fromValues:()=>is,inverse:()=>xs,len:()=>Ns,length:()=>ys,lerp:()=>Ss,max:()=>ls,min:()=>_s,mul:()=>Fs,multiply:()=>us,negate:()=>ws,normalize:()=>ks,random:()=>Ms,rotate:()=>js,round:()=>ds,scale:()=>fs,scaleAndAdd:()=>ms,set:()=>ss,sqrDist:()=>Ws,sqrLen:()=>Vs,squaredDistance:()=>vs,squaredLength:()=>bs,str:()=>Ls,sub:()=>zs,subtract:()=>os,transformMat2:()=>Es,transformMat2d:()=>Ps,transformMat3:()=>Os,transformMat4:()=>Rs,zero:()=>As});var l=1e-6,d="undefined"!=typeof Float32Array?Float32Array:Array,f=Math.random;function m(t){d=t}var g=Math.PI/180;function v(t){return t*g}function y(t,e){return Math.abs(t-e)<=l*Math.max(1,Math.abs(t),Math.abs(e))}function b(){var t=new d(4);return d!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function w(t){var e=new d(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function x(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function k(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function T(t,e,n,i){var r=new d(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r}function C(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t}function S(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function M(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],a=n*s-r*i;return a?(a=1/a,t[0]=s*a,t[1]=-i*a,t[2]=-r*a,t[3]=n*a,t):null}function E(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t}function P(t){return t[0]*t[3]-t[2]*t[1]}function O(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=n[0],u=n[1],c=n[2],h=n[3];return t[0]=i*o+s*u,t[1]=r*o+a*u,t[2]=i*c+s*h,t[3]=r*c+a*h,t}function R(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=i*u+s*o,t[1]=r*u+a*o,t[2]=i*-o+s*u,t[3]=r*-o+a*u,t}function j(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=n[0],u=n[1];return t[0]=i*o,t[1]=r*o,t[2]=s*u,t[3]=a*u,t}function D(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t}function A(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function L(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function I(t){return Math.hypot(t[0],t[1],t[2],t[3])}function B(t,e,n,i){return t[2]=i[2]/i[0],n[0]=i[0],n[1]=i[1],n[3]=i[3]-t[2]*n[1],[t,e,n]}function N(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function z(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function F(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function U(t,e){var n=t[0],i=t[1],r=t[2],s=t[3],a=e[0],o=e[1],u=e[2],c=e[3];return Math.abs(n-a)<=l*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-o)<=l*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-u)<=l*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(s-c)<=l*Math.max(1,Math.abs(s),Math.abs(c))}function G(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function W(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var V=O,K=z;function $(){var t=new d(6);return d!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function q(t){var e=new d(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function X(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function H(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Y(t,e,n,i,r,s){var a=new d(6);return a[0]=t,a[1]=e,a[2]=n,a[3]=i,a[4]=r,a[5]=s,a}function Q(t,e,n,i,r,s,a){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=s,t[5]=a,t}function J(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],u=n*s-i*r;return u?(u=1/u,t[0]=s*u,t[1]=-i*u,t[2]=-r*u,t[3]=n*u,t[4]=(r*o-s*a)*u,t[5]=(i*a-n*o)*u,t):null}function Z(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=n[0],h=n[1],p=n[2],_=n[3],l=n[4],d=n[5];return t[0]=i*c+s*h,t[1]=r*c+a*h,t[2]=i*p+s*_,t[3]=r*p+a*_,t[4]=i*l+s*d+o,t[5]=r*l+a*d+u,t}function et(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=Math.sin(n),h=Math.cos(n);return t[0]=i*h+s*c,t[1]=r*h+a*c,t[2]=i*-c+s*h,t[3]=r*-c+a*h,t[4]=o,t[5]=u,t}function nt(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=n[0],h=n[1];return t[0]=i*c,t[1]=r*c,t[2]=s*h,t[3]=a*h,t[4]=o,t[5]=u,t}function it(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=n[0],h=n[1];return t[0]=i,t[1]=r,t[2]=s,t[3]=a,t[4]=i*c+s*h+o,t[5]=r*c+a*h+u,t}function rt(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t[4]=0,t[5]=0,t}function st(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function at(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function ot(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ut(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function ct(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t}function ht(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}function pt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t}function _t(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t}function lt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function dt(t,e){var n=t[0],i=t[1],r=t[2],s=t[3],a=t[4],o=t[5],u=e[0],c=e[1],h=e[2],p=e[3],_=e[4],d=e[5];return Math.abs(n-u)<=l*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(i-c)<=l*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(r-h)<=l*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(s-p)<=l*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(a-_)<=l*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(o-d)<=l*Math.max(1,Math.abs(o),Math.abs(d))}var ft=tt,mt=ht;function gt(){var t=new d(9);return d!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function vt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function yt(t){var e=new d(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function bt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function wt(t,e,n,i,r,s,a,o,u){var c=new d(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=i,c[4]=r,c[5]=s,c[6]=a,c[7]=o,c[8]=u,c}function xt(t,e,n,i,r,s,a,o,u,c){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=s,t[5]=a,t[6]=o,t[7]=u,t[8]=c,t}function kt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Tt(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Ct(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],u=e[6],c=e[7],h=e[8],p=h*a-o*c,_=-h*s+o*u,l=c*s-a*u,d=n*p+i*_+r*l;return d?(d=1/d,t[0]=p*d,t[1]=(-h*i+r*c)*d,t[2]=(o*i-r*a)*d,t[3]=_*d,t[4]=(h*n-r*u)*d,t[5]=(-o*n+r*s)*d,t[6]=l*d,t[7]=(-c*n+i*u)*d,t[8]=(a*n-i*s)*d,t):null}function St(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],u=e[6],c=e[7],h=e[8];return t[0]=a*h-o*c,t[1]=r*c-i*h,t[2]=i*o-r*a,t[3]=o*u-s*h,t[4]=n*h-r*u,t[5]=r*s-n*o,t[6]=s*c-a*u,t[7]=i*u-n*c,t[8]=n*a-i*s,t}function Mt(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],u=t[7],c=t[8];return e*(c*s-a*u)+n*(-c*r+a*o)+i*(u*r-s*o)}function Et(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=e[6],h=e[7],p=e[8],_=n[0],l=n[1],d=n[2],f=n[3],m=n[4],g=n[5],v=n[6],y=n[7],b=n[8];return t[0]=_*i+l*a+d*c,t[1]=_*r+l*o+d*h,t[2]=_*s+l*u+d*p,t[3]=f*i+m*a+g*c,t[4]=f*r+m*o+g*h,t[5]=f*s+m*u+g*p,t[6]=v*i+y*a+b*c,t[7]=v*r+y*o+b*h,t[8]=v*s+y*u+b*p,t}function Pt(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=e[6],h=e[7],p=e[8],_=n[0],l=n[1];return t[0]=i,t[1]=r,t[2]=s,t[3]=a,t[4]=o,t[5]=u,t[6]=_*i+l*a+c,t[7]=_*r+l*o+h,t[8]=_*s+l*u+p,t}function Ot(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=e[6],h=e[7],p=e[8],_=Math.sin(n),l=Math.cos(n);return t[0]=l*i+_*a,t[1]=l*r+_*o,t[2]=l*s+_*u,t[3]=l*a-_*i,t[4]=l*o-_*r,t[5]=l*u-_*s,t[6]=c,t[7]=h,t[8]=p,t}function Rt(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function jt(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Dt(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function At(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Lt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function It(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],a=n+n,o=i+i,u=r+r,c=n*a,h=i*a,p=i*o,_=r*a,l=r*o,d=r*u,f=s*a,m=s*o,g=s*u;return t[0]=1-p-d,t[3]=h-g,t[6]=_+m,t[1]=h+g,t[4]=1-c-d,t[7]=l-f,t[2]=_-m,t[5]=l+f,t[8]=1-c-p,t}function Bt(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],u=e[6],c=e[7],h=e[8],p=e[9],_=e[10],l=e[11],d=e[12],f=e[13],m=e[14],g=e[15],v=n*o-i*a,y=n*u-r*a,b=n*c-s*a,w=i*u-r*o,x=i*c-s*o,k=r*c-s*u,T=h*f-p*d,C=h*m-_*d,S=h*g-l*d,M=p*m-_*f,E=p*g-l*f,P=_*g-l*m,O=v*P-y*E+b*M+w*S-x*C+k*T;return O?(O=1/O,t[0]=(o*P-u*E+c*M)*O,t[1]=(u*S-a*P-c*C)*O,t[2]=(a*E-o*S+c*T)*O,t[3]=(r*E-i*P-s*M)*O,t[4]=(n*P-r*S+s*C)*O,t[5]=(i*S-n*E-s*T)*O,t[6]=(f*k-m*x+g*w)*O,t[7]=(m*b-d*k-g*y)*O,t[8]=(d*x-f*b+g*v)*O,t):null}function Nt(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function zt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Ft(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function Ut(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function Gt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function Wt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function Vt(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t}function Kt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function $t(t,e){var n=t[0],i=t[1],r=t[2],s=t[3],a=t[4],o=t[5],u=t[6],c=t[7],h=t[8],p=e[0],_=e[1],d=e[2],f=e[3],m=e[4],g=e[5],v=e[6],y=e[7],b=e[8];return Math.abs(n-p)<=l*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(i-_)<=l*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(r-d)<=l*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(s-f)<=l*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(a-m)<=l*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(o-g)<=l*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(u-v)<=l*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(c-y)<=l*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(h-b)<=l*Math.max(1,Math.abs(h),Math.abs(b))}var qt=Et,Xt=Gt;function Ht(){var t=new d(16);return d!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Yt(t){var e=new d(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Qt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Jt(t,e,n,i,r,s,a,o,u,c,h,p,_,l,f,m){var g=new d(16);return g[0]=t,g[1]=e,g[2]=n,g[3]=i,g[4]=r,g[5]=s,g[6]=a,g[7]=o,g[8]=u,g[9]=c,g[10]=h,g[11]=p,g[12]=_,g[13]=l,g[14]=f,g[15]=m,g}function Zt(t,e,n,i,r,s,a,o,u,c,h,p,_,l,d,f,m){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=s,t[5]=a,t[6]=o,t[7]=u,t[8]=c,t[9]=h,t[10]=p,t[11]=_,t[12]=l,t[13]=d,t[14]=f,t[15]=m,t}function te(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ee(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],s=e[6],a=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=s,t[11]=e[14],t[12]=r,t[13]=a,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ne(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],u=e[6],c=e[7],h=e[8],p=e[9],_=e[10],l=e[11],d=e[12],f=e[13],m=e[14],g=e[15],v=n*o-i*a,y=n*u-r*a,b=n*c-s*a,w=i*u-r*o,x=i*c-s*o,k=r*c-s*u,T=h*f-p*d,C=h*m-_*d,S=h*g-l*d,M=p*m-_*f,E=p*g-l*f,P=_*g-l*m,O=v*P-y*E+b*M+w*S-x*C+k*T;return O?(O=1/O,t[0]=(o*P-u*E+c*M)*O,t[1]=(r*E-i*P-s*M)*O,t[2]=(f*k-m*x+g*w)*O,t[3]=(_*x-p*k-l*w)*O,t[4]=(u*S-a*P-c*C)*O,t[5]=(n*P-r*S+s*C)*O,t[6]=(m*b-d*k-g*y)*O,t[7]=(h*k-_*b+l*y)*O,t[8]=(a*E-o*S+c*T)*O,t[9]=(i*S-n*E-s*T)*O,t[10]=(d*x-f*b+g*v)*O,t[11]=(p*b-h*x-l*v)*O,t[12]=(o*C-a*M-u*T)*O,t[13]=(n*M-i*C+r*T)*O,t[14]=(f*y-d*w-m*v)*O,t[15]=(h*w-p*y+_*v)*O,t):null}function ie(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],u=e[6],c=e[7],h=e[8],p=e[9],_=e[10],l=e[11],d=e[12],f=e[13],m=e[14],g=e[15];return t[0]=o*(_*g-l*m)-p*(u*g-c*m)+f*(u*l-c*_),t[1]=-(i*(_*g-l*m)-p*(r*g-s*m)+f*(r*l-s*_)),t[2]=i*(u*g-c*m)-o*(r*g-s*m)+f*(r*c-s*u),t[3]=-(i*(u*l-c*_)-o*(r*l-s*_)+p*(r*c-s*u)),t[4]=-(a*(_*g-l*m)-h*(u*g-c*m)+d*(u*l-c*_)),t[5]=n*(_*g-l*m)-h*(r*g-s*m)+d*(r*l-s*_),t[6]=-(n*(u*g-c*m)-a*(r*g-s*m)+d*(r*c-s*u)),t[7]=n*(u*l-c*_)-a*(r*l-s*_)+h*(r*c-s*u),t[8]=a*(p*g-l*f)-h*(o*g-c*f)+d*(o*l-c*p),t[9]=-(n*(p*g-l*f)-h*(i*g-s*f)+d*(i*l-s*p)),t[10]=n*(o*g-c*f)-a*(i*g-s*f)+d*(i*c-s*o),t[11]=-(n*(o*l-c*p)-a*(i*l-s*p)+h*(i*c-s*o)),t[12]=-(a*(p*m-_*f)-h*(o*m-u*f)+d*(o*_-u*p)),t[13]=n*(p*m-_*f)-h*(i*m-r*f)+d*(i*_-r*p),t[14]=-(n*(o*m-u*f)-a*(i*m-r*f)+d*(i*u-r*o)),t[15]=n*(o*_-u*p)-a*(i*_-r*p)+h*(i*u-r*o),t}function re(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],u=t[7],c=t[8],h=t[9],p=t[10],_=t[11],l=t[12],d=t[13],f=t[14],m=t[15];return(e*a-n*s)*(p*m-_*f)-(e*o-i*s)*(h*m-_*d)+(e*u-r*s)*(h*f-p*d)+(n*o-i*a)*(c*m-_*l)-(n*u-r*a)*(c*f-p*l)+(i*u-r*o)*(c*d-h*l)}function se(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=e[6],h=e[7],p=e[8],_=e[9],l=e[10],d=e[11],f=e[12],m=e[13],g=e[14],v=e[15],y=n[0],b=n[1],w=n[2],x=n[3];return t[0]=y*i+b*o+w*p+x*f,t[1]=y*r+b*u+w*_+x*m,t[2]=y*s+b*c+w*l+x*g,t[3]=y*a+b*h+w*d+x*v,y=n[4],b=n[5],w=n[6],x=n[7],t[4]=y*i+b*o+w*p+x*f,t[5]=y*r+b*u+w*_+x*m,t[6]=y*s+b*c+w*l+x*g,t[7]=y*a+b*h+w*d+x*v,y=n[8],b=n[9],w=n[10],x=n[11],t[8]=y*i+b*o+w*p+x*f,t[9]=y*r+b*u+w*_+x*m,t[10]=y*s+b*c+w*l+x*g,t[11]=y*a+b*h+w*d+x*v,y=n[12],b=n[13],w=n[14],x=n[15],t[12]=y*i+b*o+w*p+x*f,t[13]=y*r+b*u+w*_+x*m,t[14]=y*s+b*c+w*l+x*g,t[15]=y*a+b*h+w*d+x*v,t}function ae(t,e,n){var i,r,s,a,o,u,c,h,p,_,l,d,f=n[0],m=n[1],g=n[2];return e===t?(t[12]=e[0]*f+e[4]*m+e[8]*g+e[12],t[13]=e[1]*f+e[5]*m+e[9]*g+e[13],t[14]=e[2]*f+e[6]*m+e[10]*g+e[14],t[15]=e[3]*f+e[7]*m+e[11]*g+e[15]):(i=e[0],r=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=e[6],h=e[7],p=e[8],_=e[9],l=e[10],d=e[11],t[0]=i,t[1]=r,t[2]=s,t[3]=a,t[4]=o,t[5]=u,t[6]=c,t[7]=h,t[8]=p,t[9]=_,t[10]=l,t[11]=d,t[12]=i*f+o*m+p*g+e[12],t[13]=r*f+u*m+_*g+e[13],t[14]=s*f+c*m+l*g+e[14],t[15]=a*f+h*m+d*g+e[15]),t}function oe(t,e,n){var i=n[0],r=n[1],s=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ue(t,e,n,i){var r,s,a,o,u,c,h,p,_,d,f,m,g,v,y,b,w,x,k,T,C,S,M,E,P=i[0],O=i[1],R=i[2],j=Math.hypot(P,O,R);return j<l?null:(P*=j=1/j,O*=j,R*=j,r=Math.sin(n),a=1-(s=Math.cos(n)),o=e[0],u=e[1],c=e[2],h=e[3],p=e[4],_=e[5],d=e[6],f=e[7],m=e[8],g=e[9],v=e[10],y=e[11],b=P*P*a+s,w=O*P*a+R*r,x=R*P*a-O*r,k=P*O*a-R*r,T=O*O*a+s,C=R*O*a+P*r,S=P*R*a+O*r,M=O*R*a-P*r,E=R*R*a+s,t[0]=o*b+p*w+m*x,t[1]=u*b+_*w+g*x,t[2]=c*b+d*w+v*x,t[3]=h*b+f*w+y*x,t[4]=o*k+p*T+m*C,t[5]=u*k+_*T+g*C,t[6]=c*k+d*T+v*C,t[7]=h*k+f*T+y*C,t[8]=o*S+p*M+m*E,t[9]=u*S+_*M+g*E,t[10]=c*S+d*M+v*E,t[11]=h*S+f*M+y*E,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function ce(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[4],a=e[5],o=e[6],u=e[7],c=e[8],h=e[9],p=e[10],_=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*r+c*i,t[5]=a*r+h*i,t[6]=o*r+p*i,t[7]=u*r+_*i,t[8]=c*r-s*i,t[9]=h*r-a*i,t[10]=p*r-o*i,t[11]=_*r-u*i,t}function he(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],a=e[1],o=e[2],u=e[3],c=e[8],h=e[9],p=e[10],_=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r-c*i,t[1]=a*r-h*i,t[2]=o*r-p*i,t[3]=u*r-_*i,t[8]=s*i+c*r,t[9]=a*i+h*r,t[10]=o*i+p*r,t[11]=u*i+_*r,t}function pe(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],a=e[1],o=e[2],u=e[3],c=e[4],h=e[5],p=e[6],_=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r+c*i,t[1]=a*r+h*i,t[2]=o*r+p*i,t[3]=u*r+_*i,t[4]=c*r-s*i,t[5]=h*r-a*i,t[6]=p*r-o*i,t[7]=_*r-u*i,t}function _e(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function le(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function de(t,e,n){var i,r,s,a=n[0],o=n[1],u=n[2],c=Math.hypot(a,o,u);return c<l?null:(a*=c=1/c,o*=c,u*=c,i=Math.sin(e),s=1-(r=Math.cos(e)),t[0]=a*a*s+r,t[1]=o*a*s+u*i,t[2]=u*a*s-o*i,t[3]=0,t[4]=a*o*s-u*i,t[5]=o*o*s+r,t[6]=u*o*s+a*i,t[7]=0,t[8]=a*u*s+o*i,t[9]=o*u*s-a*i,t[10]=u*u*s+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function fe(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function me(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ge(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ve(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=i+i,u=r+r,c=s+s,h=i*o,p=i*u,_=i*c,l=r*u,d=r*c,f=s*c,m=a*o,g=a*u,v=a*c;return t[0]=1-(l+f),t[1]=p+v,t[2]=_-g,t[3]=0,t[4]=p-v,t[5]=1-(h+f),t[6]=d+m,t[7]=0,t[8]=_+g,t[9]=d-m,t[10]=1-(h+l),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ye(t,e){var n=new d(3),i=-e[0],r=-e[1],s=-e[2],a=e[3],o=e[4],u=e[5],c=e[6],h=e[7],p=i*i+r*r+s*s+a*a;return p>0?(n[0]=2*(o*a+h*i+u*s-c*r)/p,n[1]=2*(u*a+h*r+c*i-o*s)/p,n[2]=2*(c*a+h*s+o*r-u*i)/p):(n[0]=2*(o*a+h*i+u*s-c*r),n[1]=2*(u*a+h*r+c*i-o*s),n[2]=2*(c*a+h*s+o*r-u*i)),ve(t,e,n),t}function be(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function we(t,e){var n=e[0],i=e[1],r=e[2],s=e[4],a=e[5],o=e[6],u=e[8],c=e[9],h=e[10];return t[0]=Math.hypot(n,i,r),t[1]=Math.hypot(s,a,o),t[2]=Math.hypot(u,c,h),t}function xe(t,e){var n=new d(3);we(n,e);var i=1/n[0],r=1/n[1],s=1/n[2],a=e[0]*i,o=e[1]*r,u=e[2]*s,c=e[4]*i,h=e[5]*r,p=e[6]*s,_=e[8]*i,l=e[9]*r,f=e[10]*s,m=a+h+f,g=0;return m>0?(g=2*Math.sqrt(m+1),t[3]=.25*g,t[0]=(p-l)/g,t[1]=(_-u)/g,t[2]=(o-c)/g):a>h&&a>f?(g=2*Math.sqrt(1+a-h-f),t[3]=(p-l)/g,t[0]=.25*g,t[1]=(o+c)/g,t[2]=(_+u)/g):h>f?(g=2*Math.sqrt(1+h-a-f),t[3]=(_-u)/g,t[0]=(o+c)/g,t[1]=.25*g,t[2]=(p+l)/g):(g=2*Math.sqrt(1+f-a-h),t[3]=(o-c)/g,t[0]=(_+u)/g,t[1]=(p+l)/g,t[2]=.25*g),t}function ke(t,e,n,i){var r=e[0],s=e[1],a=e[2],o=e[3],u=r+r,c=s+s,h=a+a,p=r*u,_=r*c,l=r*h,d=s*c,f=s*h,m=a*h,g=o*u,v=o*c,y=o*h,b=i[0],w=i[1],x=i[2];return t[0]=(1-(d+m))*b,t[1]=(_+y)*b,t[2]=(l-v)*b,t[3]=0,t[4]=(_-y)*w,t[5]=(1-(p+m))*w,t[6]=(f+g)*w,t[7]=0,t[8]=(l+v)*x,t[9]=(f-g)*x,t[10]=(1-(p+d))*x,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Te(t,e,n,i,r){var s=e[0],a=e[1],o=e[2],u=e[3],c=s+s,h=a+a,p=o+o,_=s*c,l=s*h,d=s*p,f=a*h,m=a*p,g=o*p,v=u*c,y=u*h,b=u*p,w=i[0],x=i[1],k=i[2],T=r[0],C=r[1],S=r[2],M=(1-(f+g))*w,E=(l+b)*w,P=(d-y)*w,O=(l-b)*x,R=(1-(_+g))*x,j=(m+v)*x,D=(d+y)*k,A=(m-v)*k,L=(1-(_+f))*k;return t[0]=M,t[1]=E,t[2]=P,t[3]=0,t[4]=O,t[5]=R,t[6]=j,t[7]=0,t[8]=D,t[9]=A,t[10]=L,t[11]=0,t[12]=n[0]+T-(M*T+O*C+D*S),t[13]=n[1]+C-(E*T+R*C+A*S),t[14]=n[2]+S-(P*T+j*C+L*S),t[15]=1,t}function Ce(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],a=n+n,o=i+i,u=r+r,c=n*a,h=i*a,p=i*o,_=r*a,l=r*o,d=r*u,f=s*a,m=s*o,g=s*u;return t[0]=1-p-d,t[1]=h+g,t[2]=_-m,t[3]=0,t[4]=h-g,t[5]=1-c-d,t[6]=l+f,t[7]=0,t[8]=_+m,t[9]=l-f,t[10]=1-c-p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Se(t,e,n,i,r,s,a){var o=1/(n-e),u=1/(r-i),c=1/(s-a);return t[0]=2*s*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*u,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(r+i)*u,t[10]=(a+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*s*2*c,t[15]=0,t}function Me(t,e,n,i,r){var s,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(s=1/(i-r),t[10]=(r+i)*s,t[14]=2*r*i*s):(t[10]=-1,t[14]=-2*i),t}function Ee(t,e,n,i){var r=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+o),c=2/(r+s);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-o)*u*.5,t[9]=(r-s)*c*.5,t[10]=i/(n-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*n/(n-i),t[15]=0,t}function Pe(t,e,n,i,r,s,a){var o=1/(e-n),u=1/(i-r),c=1/(s-a);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*o,t[13]=(r+i)*u,t[14]=(a+s)*c,t[15]=1,t}function Oe(t,e,n,i){var r,s,a,o,u,c,h,p,_,d,f=e[0],m=e[1],g=e[2],v=i[0],y=i[1],b=i[2],w=n[0],x=n[1],k=n[2];return Math.abs(f-w)<l&&Math.abs(m-x)<l&&Math.abs(g-k)<l?te(t):(h=f-w,p=m-x,_=g-k,r=y*(_*=d=1/Math.hypot(h,p,_))-b*(p*=d),s=b*(h*=d)-v*_,a=v*p-y*h,(d=Math.hypot(r,s,a))?(r*=d=1/d,s*=d,a*=d):(r=0,s=0,a=0),o=p*a-_*s,u=_*r-h*a,c=h*s-p*r,(d=Math.hypot(o,u,c))?(o*=d=1/d,u*=d,c*=d):(o=0,u=0,c=0),t[0]=r,t[1]=o,t[2]=h,t[3]=0,t[4]=s,t[5]=u,t[6]=p,t[7]=0,t[8]=a,t[9]=c,t[10]=_,t[11]=0,t[12]=-(r*f+s*m+a*g),t[13]=-(o*f+u*m+c*g),t[14]=-(h*f+p*m+_*g),t[15]=1,t)}function Re(t,e,n,i){var r=e[0],s=e[1],a=e[2],o=i[0],u=i[1],c=i[2],h=r-n[0],p=s-n[1],_=a-n[2],l=h*h+p*p+_*_;l>0&&(h*=l=1/Math.sqrt(l),p*=l,_*=l);var d=u*_-c*p,f=c*h-o*_,m=o*p-u*h;return(l=d*d+f*f+m*m)>0&&(d*=l=1/Math.sqrt(l),f*=l,m*=l),t[0]=d,t[1]=f,t[2]=m,t[3]=0,t[4]=p*m-_*f,t[5]=_*d-h*m,t[6]=h*f-p*d,t[7]=0,t[8]=h,t[9]=p,t[10]=_,t[11]=0,t[12]=r,t[13]=s,t[14]=a,t[15]=1,t}function je(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function De(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Ae(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function Le(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function Ie(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Be(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t[9]=e[9]+n[9]*i,t[10]=e[10]+n[10]*i,t[11]=e[11]+n[11]*i,t[12]=e[12]+n[12]*i,t[13]=e[13]+n[13]*i,t[14]=e[14]+n[14]*i,t[15]=e[15]+n[15]*i,t}function Ne(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function ze(t,e){var n=t[0],i=t[1],r=t[2],s=t[3],a=t[4],o=t[5],u=t[6],c=t[7],h=t[8],p=t[9],_=t[10],d=t[11],f=t[12],m=t[13],g=t[14],v=t[15],y=e[0],b=e[1],w=e[2],x=e[3],k=e[4],T=e[5],C=e[6],S=e[7],M=e[8],E=e[9],P=e[10],O=e[11],R=e[12],j=e[13],D=e[14],A=e[15];return Math.abs(n-y)<=l*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(i-b)<=l*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(r-w)<=l*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(s-x)<=l*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(a-k)<=l*Math.max(1,Math.abs(a),Math.abs(k))&&Math.abs(o-T)<=l*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(u-C)<=l*Math.max(1,Math.abs(u),Math.abs(C))&&Math.abs(c-S)<=l*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(h-M)<=l*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(p-E)<=l*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(_-P)<=l*Math.max(1,Math.abs(_),Math.abs(P))&&Math.abs(d-O)<=l*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(f-R)<=l*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(m-j)<=l*Math.max(1,Math.abs(m),Math.abs(j))&&Math.abs(g-D)<=l*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(v-A)<=l*Math.max(1,Math.abs(v),Math.abs(A))}var Fe=se,Ue=Le;function Ge(){var t=new d(3);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function We(t){var e=new d(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ve(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function Ke(t,e,n){var i=new d(3);return i[0]=t,i[1]=e,i[2]=n,i}function $e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function qe(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t}function Xe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function He(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Ye(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Qe(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Je(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Ze(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function tn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function en(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function nn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function rn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function sn(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t}function an(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.hypot(n,i,r)}function on(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return n*n+i*i+r*r}function un(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function cn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function hn(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function pn(t,e){var n=e[0],i=e[1],r=e[2],s=n*n+i*i+r*r;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function _n(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ln(t,e,n){var i=e[0],r=e[1],s=e[2],a=n[0],o=n[1],u=n[2];return t[0]=r*u-s*o,t[1]=s*a-i*u,t[2]=i*o-r*a,t}function dn(t,e,n,i){var r=e[0],s=e[1],a=e[2];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=a+i*(n[2]-a),t}function fn(t,e,n,i,r,s){var a=s*s,o=a*(2*s-3)+1,u=a*(s-2)+s,c=a*(s-1),h=a*(3-2*s);return t[0]=e[0]*o+n[0]*u+i[0]*c+r[0]*h,t[1]=e[1]*o+n[1]*u+i[1]*c+r[1]*h,t[2]=e[2]*o+n[2]*u+i[2]*c+r[2]*h,t}function mn(t,e,n,i,r,s){var a=1-s,o=a*a,u=s*s,c=o*a,h=3*s*o,p=3*u*a,_=u*s;return t[0]=e[0]*c+n[0]*h+i[0]*p+r[0]*_,t[1]=e[1]*c+n[1]*h+i[1]*p+r[1]*_,t[2]=e[2]*c+n[2]*h+i[2]*p+r[2]*_,t}function gn(t,e){e=e||1;var n=2*f()*Math.PI,i=2*f()-1,r=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t[2]=i*e,t}function vn(t,e,n){var i=e[0],r=e[1],s=e[2],a=n[3]*i+n[7]*r+n[11]*s+n[15];return a=a||1,t[0]=(n[0]*i+n[4]*r+n[8]*s+n[12])/a,t[1]=(n[1]*i+n[5]*r+n[9]*s+n[13])/a,t[2]=(n[2]*i+n[6]*r+n[10]*s+n[14])/a,t}function yn(t,e,n){var i=e[0],r=e[1],s=e[2];return t[0]=i*n[0]+r*n[3]+s*n[6],t[1]=i*n[1]+r*n[4]+s*n[7],t[2]=i*n[2]+r*n[5]+s*n[8],t}function bn(t,e,n){var i=n[0],r=n[1],s=n[2],a=n[3],o=e[0],u=e[1],c=e[2],h=r*c-s*u,p=s*o-i*c,_=i*u-r*o,l=r*_-s*p,d=s*h-i*_,f=i*p-r*h,m=2*a;return h*=m,p*=m,_*=m,l*=2,d*=2,f*=2,t[0]=o+h+l,t[1]=u+p+d,t[2]=c+_+f,t}function wn(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function xn(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function kn(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Tn(t,e){var n=t[0],i=t[1],r=t[2],s=e[0],a=e[1],o=e[2],u=Math.sqrt(n*n+i*i+r*r)*Math.sqrt(s*s+a*a+o*o),c=u&&_n(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}function Cn(t){return t[0]=0,t[1]=0,t[2]=0,t}function Sn(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Mn(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function En(t,e){var n=t[0],i=t[1],r=t[2],s=e[0],a=e[1],o=e[2];return Math.abs(n-s)<=l*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-a)<=l*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(r-o)<=l*Math.max(1,Math.abs(r),Math.abs(o))}var Pn,On=He,Rn=Ye,jn=Qe,Dn=an,An=on,Ln=Ve,In=un,Bn=(Pn=Ge(),function(t,e,n,i,r,s){var a,o;for(e||(e=3),n||(n=0),o=i?Math.min(i*e+n,t.length):t.length,a=n;a<o;a+=e)Pn[0]=t[a],Pn[1]=t[a+1],Pn[2]=t[a+2],r(Pn,Pn,s),t[a]=Pn[0],t[a+1]=Pn[1],t[a+2]=Pn[2];return t});function Nn(){var t=new d(4);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function zn(t){var e=new d(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Fn(t,e,n,i){var r=new d(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r}function Un(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Gn(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t}function Wn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function Vn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function Kn(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function $n(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function qn(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Xn(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Hn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function Yn(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function Qn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Jn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Zn(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t}function ti(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],s=e[3]-t[3];return Math.hypot(n,i,r,s)}function ei(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],s=e[3]-t[3];return n*n+i*i+r*r+s*s}function ni(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.hypot(e,n,i,r)}function ii(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}function ri(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function si(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function ai(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],a=n*n+i*i+r*r+s*s;return a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=i*a,t[2]=r*a,t[3]=s*a,t}function oi(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function ui(t,e,n,i){var r=n[0]*i[1]-n[1]*i[0],s=n[0]*i[2]-n[2]*i[0],a=n[0]*i[3]-n[3]*i[0],o=n[1]*i[2]-n[2]*i[1],u=n[1]*i[3]-n[3]*i[1],c=n[2]*i[3]-n[3]*i[2],h=e[0],p=e[1],_=e[2],l=e[3];return t[0]=p*c-_*u+l*o,t[1]=-h*c+_*a-l*s,t[2]=h*u-p*a+l*r,t[3]=-h*o+p*s-_*r,t}function ci(t,e,n,i){var r=e[0],s=e[1],a=e[2],o=e[3];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=a+i*(n[2]-a),t[3]=o+i*(n[3]-o),t}function hi(t,e){var n,i,r,s,a,o;e=e||1;do{a=(n=2*f()-1)*n+(i=2*f()-1)*i}while(a>=1);do{o=(r=2*f()-1)*r+(s=2*f()-1)*s}while(o>=1);var u=Math.sqrt((1-a)/o);return t[0]=e*n,t[1]=e*i,t[2]=e*r*u,t[3]=e*s*u,t}function pi(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*s+n[12]*a,t[1]=n[1]*i+n[5]*r+n[9]*s+n[13]*a,t[2]=n[2]*i+n[6]*r+n[10]*s+n[14]*a,t[3]=n[3]*i+n[7]*r+n[11]*s+n[15]*a,t}function _i(t,e,n){var i=e[0],r=e[1],s=e[2],a=n[0],o=n[1],u=n[2],c=n[3],h=c*i+o*s-u*r,p=c*r+u*i-a*s,_=c*s+a*r-o*i,l=-a*i-o*r-u*s;return t[0]=h*c+l*-a+p*-u-_*-o,t[1]=p*c+l*-o+_*-a-h*-u,t[2]=_*c+l*-u+h*-o-p*-a,t[3]=e[3],t}function li(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function di(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function fi(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function mi(t,e){var n=t[0],i=t[1],r=t[2],s=t[3],a=e[0],o=e[1],u=e[2],c=e[3];return Math.abs(n-a)<=l*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-o)<=l*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-u)<=l*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(s-c)<=l*Math.max(1,Math.abs(s),Math.abs(c))}var gi=Vn,vi=Kn,yi=$n,bi=ti,wi=ei,xi=ni,ki=ii,Ti=function(){var t=Nn();return function(e,n,i,r,s,a){var o,u;for(n||(n=4),i||(i=0),u=r?Math.min(r*n+i,e.length):e.length,o=i;o<u;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],s(t,t,a),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}}();function Ci(){var t=new d(4);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Si(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Mi(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function Ei(t,e){var n=2*Math.acos(e[3]),i=Math.sin(n/2);return i>l?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),n}function Pi(t,e){var n=rr(t,e);return Math.acos(2*n*n-1)}function Oi(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=n[0],u=n[1],c=n[2],h=n[3];return t[0]=i*h+a*o+r*c-s*u,t[1]=r*h+a*u+s*o-i*c,t[2]=s*h+a*c+i*u-r*o,t[3]=a*h-i*o-r*u-s*c,t}function Ri(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],a=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=i*u+a*o,t[1]=r*u+s*o,t[2]=s*u-r*o,t[3]=a*u-i*o,t}function ji(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],a=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=i*u-s*o,t[1]=r*u+a*o,t[2]=s*u+i*o,t[3]=a*u-r*o,t}function Di(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],a=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=i*u+r*o,t[1]=r*u-i*o,t[2]=s*u+a*o,t[3]=a*u-s*o,t}function Ai(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t}function Li(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],a=Math.sqrt(n*n+i*i+r*r),o=Math.exp(s),u=a>0?o*Math.sin(a)/a:0;return t[0]=n*u,t[1]=i*u,t[2]=r*u,t[3]=o*Math.cos(a),t}function Ii(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],a=Math.sqrt(n*n+i*i+r*r),o=a>0?Math.atan2(a,s)/a:0;return t[0]=n*o,t[1]=i*o,t[2]=r*o,t[3]=.5*Math.log(n*n+i*i+r*r+s*s),t}function Bi(t,e,n){return Ii(t,e),ir(t,t,n),Li(t,t),t}function Ni(t,e,n,i){var r,s,a,o,u,c=e[0],h=e[1],p=e[2],_=e[3],d=n[0],f=n[1],m=n[2],g=n[3];return(s=c*d+h*f+p*m+_*g)<0&&(s=-s,d=-d,f=-f,m=-m,g=-g),1-s>l?(r=Math.acos(s),a=Math.sin(r),o=Math.sin((1-i)*r)/a,u=Math.sin(i*r)/a):(o=1-i,u=i),t[0]=o*c+u*d,t[1]=o*h+u*f,t[2]=o*p+u*m,t[3]=o*_+u*g,t}function zi(t){var e=f(),n=f(),i=f(),r=Math.sqrt(1-e),s=Math.sqrt(e);return t[0]=r*Math.sin(2*Math.PI*n),t[1]=r*Math.cos(2*Math.PI*n),t[2]=s*Math.sin(2*Math.PI*i),t[3]=s*Math.cos(2*Math.PI*i),t}function Fi(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],a=n*n+i*i+r*r+s*s,o=a?1/a:0;return t[0]=-n*o,t[1]=-i*o,t[2]=-r*o,t[3]=s*o,t}function Ui(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Gi(t,e){var n,i=e[0]+e[4]+e[8];if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,a=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*a+a]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*s+a]-e[3*a+s])*n,t[s]=(e[3*s+r]+e[3*r+s])*n,t[a]=(e[3*a+r]+e[3*r+a])*n}return t}function Wi(t,e,n,i){var r=.5*Math.PI/180;e*=r,n*=r,i*=r;var s=Math.sin(e),a=Math.cos(e),o=Math.sin(n),u=Math.cos(n),c=Math.sin(i),h=Math.cos(i);return t[0]=s*u*h-a*o*c,t[1]=a*o*h+s*u*c,t[2]=a*u*c-s*o*h,t[3]=a*u*h+s*o*c,t}function Vi(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Ki,$i,qi,Xi,Hi,Yi,Qi=zn,Ji=Fn,Zi=Un,tr=Gn,er=Wn,nr=Oi,ir=Jn,rr=oi,sr=ci,ar=ni,or=ar,ur=ii,cr=ur,hr=ai,pr=fi,_r=mi,lr=(Ki=Ge(),$i=Ke(1,0,0),qi=Ke(0,1,0),function(t,e,n){var i=_n(e,n);return i<-.999999?(ln(Ki,$i,e),Ln(Ki)<1e-6&&ln(Ki,qi,e),pn(Ki,Ki),Mi(t,Ki,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(ln(Ki,e,n),t[0]=Ki[0],t[1]=Ki[1],t[2]=Ki[2],t[3]=1+i,hr(t,t))}),dr=(Xi=Ci(),Hi=Ci(),function(t,e,n,i,r,s){return Ni(Xi,e,r,s),Ni(Hi,n,i,s),Ni(t,Xi,Hi,2*s*(1-s)),t}),fr=(Yi=gt(),function(t,e,n,i){return Yi[0]=n[0],Yi[3]=n[1],Yi[6]=n[2],Yi[1]=i[0],Yi[4]=i[1],Yi[7]=i[2],Yi[2]=-e[0],Yi[5]=-e[1],Yi[8]=-e[2],hr(t,Gi(t,Yi))});function mr(){var t=new d(8);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function gr(t){var e=new d(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function vr(t,e,n,i,r,s,a,o){var u=new d(8);return u[0]=t,u[1]=e,u[2]=n,u[3]=i,u[4]=r,u[5]=s,u[6]=a,u[7]=o,u}function yr(t,e,n,i,r,s,a){var o=new d(8);o[0]=t,o[1]=e,o[2]=n,o[3]=i;var u=.5*r,c=.5*s,h=.5*a;return o[4]=u*i+c*n-h*e,o[5]=c*i+h*t-u*n,o[6]=h*i+u*e-c*t,o[7]=-u*t-c*e-h*n,o}function br(t,e,n){var i=.5*n[0],r=.5*n[1],s=.5*n[2],a=e[0],o=e[1],u=e[2],c=e[3];return t[0]=a,t[1]=o,t[2]=u,t[3]=c,t[4]=i*c+r*u-s*o,t[5]=r*c+s*a-i*u,t[6]=s*c+i*o-r*a,t[7]=-i*a-r*o-s*u,t}function wr(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t}function xr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function kr(t,e){var n=Ci();xe(n,e);var i=new d(3);return be(i,e),br(t,n,i),t}function Tr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Cr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Sr(t,e,n,i,r,s,a,o,u){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=s,t[5]=a,t[6]=o,t[7]=u,t}var Mr=Zi;function Er(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var Pr=Zi;function Or(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function Rr(t,e){var n=e[4],i=e[5],r=e[6],s=e[7],a=-e[0],o=-e[1],u=-e[2],c=e[3];return t[0]=2*(n*c+s*a+i*u-r*o),t[1]=2*(i*c+s*o+r*a-n*u),t[2]=2*(r*c+s*u+n*o-i*a),t}function jr(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=.5*n[0],u=.5*n[1],c=.5*n[2],h=e[4],p=e[5],_=e[6],l=e[7];return t[0]=i,t[1]=r,t[2]=s,t[3]=a,t[4]=a*o+r*c-s*u+h,t[5]=a*u+s*o-i*c+p,t[6]=a*c+i*u-r*o+_,t[7]=-i*o-r*u-s*c+l,t}function Dr(t,e,n){var i=-e[0],r=-e[1],s=-e[2],a=e[3],o=e[4],u=e[5],c=e[6],h=e[7],p=o*a+h*i+u*s-c*r,_=u*a+h*r+c*i-o*s,l=c*a+h*s+o*r-u*i,d=h*a-o*i-u*r-c*s;return Ri(t,e,n),i=t[0],r=t[1],s=t[2],a=t[3],t[4]=p*a+d*i+_*s-l*r,t[5]=_*a+d*r+l*i-p*s,t[6]=l*a+d*s+p*r-_*i,t[7]=d*a-p*i-_*r-l*s,t}function Ar(t,e,n){var i=-e[0],r=-e[1],s=-e[2],a=e[3],o=e[4],u=e[5],c=e[6],h=e[7],p=o*a+h*i+u*s-c*r,_=u*a+h*r+c*i-o*s,l=c*a+h*s+o*r-u*i,d=h*a-o*i-u*r-c*s;return ji(t,e,n),i=t[0],r=t[1],s=t[2],a=t[3],t[4]=p*a+d*i+_*s-l*r,t[5]=_*a+d*r+l*i-p*s,t[6]=l*a+d*s+p*r-_*i,t[7]=d*a-p*i-_*r-l*s,t}function Lr(t,e,n){var i=-e[0],r=-e[1],s=-e[2],a=e[3],o=e[4],u=e[5],c=e[6],h=e[7],p=o*a+h*i+u*s-c*r,_=u*a+h*r+c*i-o*s,l=c*a+h*s+o*r-u*i,d=h*a-o*i-u*r-c*s;return Di(t,e,n),i=t[0],r=t[1],s=t[2],a=t[3],t[4]=p*a+d*i+_*s-l*r,t[5]=_*a+d*r+l*i-p*s,t[6]=l*a+d*s+p*r-_*i,t[7]=d*a-p*i-_*r-l*s,t}function Ir(t,e,n){var i=n[0],r=n[1],s=n[2],a=n[3],o=e[0],u=e[1],c=e[2],h=e[3];return t[0]=o*a+h*i+u*s-c*r,t[1]=u*a+h*r+c*i-o*s,t[2]=c*a+h*s+o*r-u*i,t[3]=h*a-o*i-u*r-c*s,o=e[4],u=e[5],c=e[6],h=e[7],t[4]=o*a+h*i+u*s-c*r,t[5]=u*a+h*r+c*i-o*s,t[6]=c*a+h*s+o*r-u*i,t[7]=h*a-o*i-u*r-c*s,t}function Br(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=n[0],u=n[1],c=n[2],h=n[3];return t[0]=i*h+a*o+r*c-s*u,t[1]=r*h+a*u+s*o-i*c,t[2]=s*h+a*c+i*u-r*o,t[3]=a*h-i*o-r*u-s*c,o=n[4],u=n[5],c=n[6],h=n[7],t[4]=i*h+a*o+r*c-s*u,t[5]=r*h+a*u+s*o-i*c,t[6]=s*h+a*c+i*u-r*o,t[7]=a*h-i*o-r*u-s*c,t}function Nr(t,e,n,i){if(Math.abs(i)<l)return Tr(t,e);var r=Math.hypot(n[0],n[1],n[2]);i*=.5;var s=Math.sin(i),a=s*n[0]/r,o=s*n[1]/r,u=s*n[2]/r,c=Math.cos(i),h=e[0],p=e[1],_=e[2],d=e[3];t[0]=h*c+d*a+p*u-_*o,t[1]=p*c+d*o+_*a-h*u,t[2]=_*c+d*u+h*o-p*a,t[3]=d*c-h*a-p*o-_*u;var f=e[4],m=e[5],g=e[6],v=e[7];return t[4]=f*c+v*a+m*u-g*o,t[5]=m*c+v*o+g*a-f*u,t[6]=g*c+v*u+f*o-m*a,t[7]=v*c-f*a-m*o-g*u,t}function zr(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t}function Fr(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=n[4],u=n[5],c=n[6],h=n[7],p=e[4],_=e[5],l=e[6],d=e[7],f=n[0],m=n[1],g=n[2],v=n[3];return t[0]=i*v+a*f+r*g-s*m,t[1]=r*v+a*m+s*f-i*g,t[2]=s*v+a*g+i*m-r*f,t[3]=a*v-i*f-r*m-s*g,t[4]=i*h+a*o+r*c-s*u+p*v+d*f+_*g-l*m,t[5]=r*h+a*u+s*o-i*c+_*v+d*m+l*f-p*g,t[6]=s*h+a*c+i*u-r*o+l*v+d*g+p*m-_*f,t[7]=a*h-i*o-r*u-s*c+d*v-p*f-_*m-l*g,t}var Ur=Fr;function Gr(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t}var Wr=rr;function Vr(t,e,n,i){var r=1-i;return Wr(e,n)<0&&(i=-i),t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i,t[3]=e[3]*r+n[3]*i,t[4]=e[4]*r+n[4]*i,t[5]=e[5]*r+n[5]*i,t[6]=e[6]*r+n[6]*i,t[7]=e[7]*r+n[7]*i,t}function Kr(t,e){var n=Hr(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t}function $r(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var qr=ar,Xr=qr,Hr=ur,Yr=Hr;function Qr(t,e){var n=Hr(e);if(n>0){n=Math.sqrt(n);var i=e[0]/n,r=e[1]/n,s=e[2]/n,a=e[3]/n,o=e[4],u=e[5],c=e[6],h=e[7],p=i*o+r*u+s*c+a*h;t[0]=i,t[1]=r,t[2]=s,t[3]=a,t[4]=(o-i*p)/n,t[5]=(u-r*p)/n,t[6]=(c-s*p)/n,t[7]=(h-a*p)/n}return t}function Jr(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function Zr(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function ts(t,e){var n=t[0],i=t[1],r=t[2],s=t[3],a=t[4],o=t[5],u=t[6],c=t[7],h=e[0],p=e[1],_=e[2],d=e[3],f=e[4],m=e[5],g=e[6],v=e[7];return Math.abs(n-h)<=l*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-p)<=l*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(r-_)<=l*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(s-d)<=l*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(a-f)<=l*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(o-m)<=l*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(u-g)<=l*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(c-v)<=l*Math.max(1,Math.abs(c),Math.abs(v))}function es(){var t=new d(2);return d!=Float32Array&&(t[0]=0,t[1]=0),t}function ns(t){var e=new d(2);return e[0]=t[0],e[1]=t[1],e}function is(t,e){var n=new d(2);return n[0]=t,n[1]=e,n}function rs(t,e){return t[0]=e[0],t[1]=e[1],t}function ss(t,e,n){return t[0]=e,t[1]=n,t}function as(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function os(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function us(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function cs(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function hs(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function ps(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function _s(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function ls(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function ds(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function fs(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function ms(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t}function gs(t,e){var n=e[0]-t[0],i=e[1]-t[1];return Math.hypot(n,i)}function vs(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}function ys(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function bs(t){var e=t[0],n=t[1];return e*e+n*n}function ws(t,e){return t[0]=-e[0],t[1]=-e[1],t}function xs(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function ks(t,e){var n=e[0],i=e[1],r=n*n+i*i;return r>0&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t}function Ts(t,e){return t[0]*e[0]+t[1]*e[1]}function Cs(t,e,n){var i=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=i,t}function Ss(t,e,n,i){var r=e[0],s=e[1];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t}function Ms(t,e){e=e||1;var n=2*f()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function Es(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t}function Ps(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t}function Os(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t}function Rs(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}function js(t,e,n,i){var r=e[0]-n[0],s=e[1]-n[1],a=Math.sin(i),o=Math.cos(i);return t[0]=r*o-s*a+n[0],t[1]=r*a+s*o+n[1],t}function Ds(t,e){var n=t[0],i=t[1],r=e[0],s=e[1],a=Math.sqrt(n*n+i*i)*Math.sqrt(r*r+s*s),o=a&&(n*r+i*s)/a;return Math.acos(Math.min(Math.max(o,-1),1))}function As(t){return t[0]=0,t[1]=0,t}function Ls(t){return"vec2("+t[0]+", "+t[1]+")"}function Is(t,e){return t[0]===e[0]&&t[1]===e[1]}function Bs(t,e){var n=t[0],i=t[1],r=e[0],s=e[1];return Math.abs(n-r)<=l*Math.max(1,Math.abs(n),Math.abs(r))&&Math.abs(i-s)<=l*Math.max(1,Math.abs(i),Math.abs(s))}var Ns=ys,zs=os,Fs=us,Us=cs,Gs=gs,Ws=vs,Vs=bs,Ks=function(){var t=es();return function(e,n,i,r,s,a){var o,u;for(n||(n=2),i||(i=0),u=r?Math.min(r*n+i,e.length):e.length,o=i;o<u;o+=n)t[0]=e[o],t[1]=e[o+1],s(t,t,a),e[o]=t[0],e[o+1]=t[1];return e}}()},204:(t,e,n)=>{"use strict";var i,r;i=[n(937),n(40),n(566)],void 0===(r=function(t,e,n){return function(t,e,n){var i=function(e,n){return t.js_beautify(e,n)};return i.js=t.js_beautify,i.css=e.css_beautify,i.html=n.html_beautify,i.js_beautify=t.js_beautify,i.css_beautify=e.css_beautify,i.html_beautify=n.html_beautify,i}(t,e,n)}.apply(e,i))||(t.exports=r)},40:(t,e)=>{var n,i;i=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=15)}([,,function(t,e,n){"use strict";function i(t){this.__parent=t,this.__character_count=0,this.__indent_count=-1,this.__alignment_count=0,this.__wrap_point_index=0,this.__wrap_point_character_count=0,this.__wrap_point_indent_count=-1,this.__wrap_point_alignment_count=0,this.__items=[]}function r(t,e){this.__cache=[""],this.__indent_size=t.indent_size,this.__indent_string=t.indent_char,t.indent_with_tabs||(this.__indent_string=new Array(t.indent_size+1).join(t.indent_char)),e=e||"",t.indent_level>0&&(e=new Array(t.indent_level+1).join(this.__indent_string)),this.__base_string=e,this.__base_string_length=e.length}function s(t,e){this.__indent_cache=new r(t,e),this.raw=!1,this._end_with_newline=t.end_with_newline,this.indent_size=t.indent_size,this.wrap_line_length=t.wrap_line_length,this.indent_empty_lines=t.indent_empty_lines,this.__lines=[],this.previous_line=null,this.current_line=null,this.next_line=new i(this),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1,this.__add_outputline()}i.prototype.clone_empty=function(){var t=new i(this.__parent);return t.set_indent(this.__indent_count,this.__alignment_count),t},i.prototype.item=function(t){return t<0?this.__items[this.__items.length+t]:this.__items[t]},i.prototype.has_match=function(t){for(var e=this.__items.length-1;e>=0;e--)if(this.__items[e].match(t))return!0;return!1},i.prototype.set_indent=function(t,e){this.is_empty()&&(this.__indent_count=t||0,this.__alignment_count=e||0,this.__character_count=this.__parent.get_indent_size(this.__indent_count,this.__alignment_count))},i.prototype._set_wrap_point=function(){this.__parent.wrap_line_length&&(this.__wrap_point_index=this.__items.length,this.__wrap_point_character_count=this.__character_count,this.__wrap_point_indent_count=this.__parent.next_line.__indent_count,this.__wrap_point_alignment_count=this.__parent.next_line.__alignment_count)},i.prototype._should_wrap=function(){return this.__wrap_point_index&&this.__character_count>this.__parent.wrap_line_length&&this.__wrap_point_character_count>this.__parent.next_line.__character_count},i.prototype._allow_wrap=function(){if(this._should_wrap()){this.__parent.add_new_line();var t=this.__parent.current_line;return t.set_indent(this.__wrap_point_indent_count,this.__wrap_point_alignment_count),t.__items=this.__items.slice(this.__wrap_point_index),this.__items=this.__items.slice(0,this.__wrap_point_index),t.__character_count+=this.__character_count-this.__wrap_point_character_count,this.__character_count=this.__wrap_point_character_count," "===t.__items[0]&&(t.__items.splice(0,1),t.__character_count-=1),!0}return!1},i.prototype.is_empty=function(){return 0===this.__items.length},i.prototype.last=function(){return this.is_empty()?null:this.__items[this.__items.length-1]},i.prototype.push=function(t){this.__items.push(t);var e=t.lastIndexOf("\n");-1!==e?this.__character_count=t.length-e:this.__character_count+=t.length},i.prototype.pop=function(){var t=null;return this.is_empty()||(t=this.__items.pop(),this.__character_count-=t.length),t},i.prototype._remove_indent=function(){this.__indent_count>0&&(this.__indent_count-=1,this.__character_count-=this.__parent.indent_size)},i.prototype._remove_wrap_indent=function(){this.__wrap_point_indent_count>0&&(this.__wrap_point_indent_count-=1)},i.prototype.trim=function(){for(;" "===this.last();)this.__items.pop(),this.__character_count-=1},i.prototype.toString=function(){var t="";return this.is_empty()?this.__parent.indent_empty_lines&&(t=this.__parent.get_indent_string(this.__indent_count)):(t=this.__parent.get_indent_string(this.__indent_count,this.__alignment_count),t+=this.__items.join("")),t},r.prototype.get_indent_size=function(t,e){var n=this.__base_string_length;return e=e||0,t<0&&(n=0),(n+=t*this.__indent_size)+e},r.prototype.get_indent_string=function(t,e){var n=this.__base_string;return e=e||0,t<0&&(t=0,n=""),e+=t*this.__indent_size,this.__ensure_cache(e),n+this.__cache[e]},r.prototype.__ensure_cache=function(t){for(;t>=this.__cache.length;)this.__add_column()},r.prototype.__add_column=function(){var t=this.__cache.length,e=0,n="";this.__indent_size&&t>=this.__indent_size&&(t-=(e=Math.floor(t/this.__indent_size))*this.__indent_size,n=new Array(e+1).join(this.__indent_string)),t&&(n+=new Array(t+1).join(" ")),this.__cache.push(n)},s.prototype.__add_outputline=function(){this.previous_line=this.current_line,this.current_line=this.next_line.clone_empty(),this.__lines.push(this.current_line)},s.prototype.get_line_number=function(){return this.__lines.length},s.prototype.get_indent_string=function(t,e){return this.__indent_cache.get_indent_string(t,e)},s.prototype.get_indent_size=function(t,e){return this.__indent_cache.get_indent_size(t,e)},s.prototype.is_empty=function(){return!this.previous_line&&this.current_line.is_empty()},s.prototype.add_new_line=function(t){return!(this.is_empty()||!t&&this.just_added_newline()||(this.raw||this.__add_outputline(),0))},s.prototype.get_code=function(t){this.trim(!0);var e=this.current_line.pop();e&&("\n"===e[e.length-1]&&(e=e.replace(/\n+$/g,"")),this.current_line.push(e)),this._end_with_newline&&this.__add_outputline();var n=this.__lines.join("\n");return"\n"!==t&&(n=n.replace(/[\n]/g,t)),n},s.prototype.set_wrap_point=function(){this.current_line._set_wrap_point()},s.prototype.set_indent=function(t,e){return t=t||0,e=e||0,this.next_line.set_indent(t,e),this.__lines.length>1?(this.current_line.set_indent(t,e),!0):(this.current_line.set_indent(),!1)},s.prototype.add_raw_token=function(t){for(var e=0;e<t.newlines;e++)this.__add_outputline();this.current_line.set_indent(-1),this.current_line.push(t.whitespace_before),this.current_line.push(t.text),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1},s.prototype.add_token=function(t){this.__add_space_before_token(),this.current_line.push(t),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=this.current_line._allow_wrap()},s.prototype.__add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&(this.non_breaking_space||this.set_wrap_point(),this.current_line.push(" "))},s.prototype.remove_indent=function(t){for(var e=this.__lines.length;t<e;)this.__lines[t]._remove_indent(),t++;this.current_line._remove_wrap_indent()},s.prototype.trim=function(t){for(t=void 0!==t&&t,this.current_line.trim();t&&this.__lines.length>1&&this.current_line.is_empty();)this.__lines.pop(),this.current_line=this.__lines[this.__lines.length-1],this.current_line.trim();this.previous_line=this.__lines.length>1?this.__lines[this.__lines.length-2]:null},s.prototype.just_added_newline=function(){return this.current_line.is_empty()},s.prototype.just_added_blankline=function(){return this.is_empty()||this.current_line.is_empty()&&this.previous_line.is_empty()},s.prototype.ensure_empty_line_above=function(t,e){for(var n=this.__lines.length-2;n>=0;){var r=this.__lines[n];if(r.is_empty())break;if(0!==r.item(0).indexOf(t)&&r.item(-1)!==e){this.__lines.splice(n+1,0,new i(this)),this.previous_line=this.__lines[this.__lines.length-2];break}n--}},t.exports.Output=s},,,,function(t,e,n){"use strict";function i(t,e){this.raw_options=r(t,e),this.disabled=this._get_boolean("disabled"),this.eol=this._get_characters("eol","auto"),this.end_with_newline=this._get_boolean("end_with_newline"),this.indent_size=this._get_number("indent_size",4),this.indent_char=this._get_characters("indent_char"," "),this.indent_level=this._get_number("indent_level"),this.preserve_newlines=this._get_boolean("preserve_newlines",!0),this.max_preserve_newlines=this._get_number("max_preserve_newlines",32786),this.preserve_newlines||(this.max_preserve_newlines=0),this.indent_with_tabs=this._get_boolean("indent_with_tabs","\t"===this.indent_char),this.indent_with_tabs&&(this.indent_char="\t",1===this.indent_size&&(this.indent_size=4)),this.wrap_line_length=this._get_number("wrap_line_length",this._get_number("max_char")),this.indent_empty_lines=this._get_boolean("indent_empty_lines"),this.templating=this._get_selection_list("templating",["auto","none","django","erb","handlebars","php","smarty"],["auto"])}function r(t,e){var n,i={};for(n in t=s(t))n!==e&&(i[n]=t[n]);if(e&&t[e])for(n in t[e])i[n]=t[e][n];return i}function s(t){var e,n={};for(e in t)n[e.replace(/-/g,"_")]=t[e];return n}i.prototype._get_array=function(t,e){var n=this.raw_options[t],i=e||[];return"object"==typeof n?null!==n&&"function"==typeof n.concat&&(i=n.concat()):"string"==typeof n&&(i=n.split(/[^a-zA-Z0-9_\/\-]+/)),i},i.prototype._get_boolean=function(t,e){var n=this.raw_options[t];return void 0===n?!!e:!!n},i.prototype._get_characters=function(t,e){var n=this.raw_options[t],i=e||"";return"string"==typeof n&&(i=n.replace(/\\r/,"\r").replace(/\\n/,"\n").replace(/\\t/,"\t")),i},i.prototype._get_number=function(t,e){var n=this.raw_options[t];e=parseInt(e,10),isNaN(e)&&(e=0);var i=parseInt(n,10);return isNaN(i)&&(i=e),i},i.prototype._get_selection=function(t,e,n){var i=this._get_selection_list(t,e,n);if(1!==i.length)throw new Error("Invalid Option Value: The option '"+t+"' can only be one of the following values:\n"+e+"\nYou passed in: '"+this.raw_options[t]+"'");return i[0]},i.prototype._get_selection_list=function(t,e,n){if(!e||0===e.length)throw new Error("Selection list cannot be empty.");if(n=n||[e[0]],!this._is_valid_selection(n,e))throw new Error("Invalid Default Value!");var i=this._get_array(t,n);if(!this._is_valid_selection(i,e))throw new Error("Invalid Option Value: The option '"+t+"' can contain only the following values:\n"+e+"\nYou passed in: '"+this.raw_options[t]+"'");return i},i.prototype._is_valid_selection=function(t,e){return t.length&&e.length&&!t.some((function(t){return-1===e.indexOf(t)}))},t.exports.Options=i,t.exports.normalizeOpts=s,t.exports.mergeOpts=r},,function(t,e,n){"use strict";var i=RegExp.prototype.hasOwnProperty("sticky");function r(t){this.__input=t||"",this.__input_length=this.__input.length,this.__position=0}r.prototype.restart=function(){this.__position=0},r.prototype.back=function(){this.__position>0&&(this.__position-=1)},r.prototype.hasNext=function(){return this.__position<this.__input_length},r.prototype.next=function(){var t=null;return this.hasNext()&&(t=this.__input.charAt(this.__position),this.__position+=1),t},r.prototype.peek=function(t){var e=null;return t=t||0,(t+=this.__position)>=0&&t<this.__input_length&&(e=this.__input.charAt(t)),e},r.prototype.__match=function(t,e){t.lastIndex=e;var n=t.exec(this.__input);return!n||i&&t.sticky||n.index!==e&&(n=null),n},r.prototype.test=function(t,e){return e=e||0,(e+=this.__position)>=0&&e<this.__input_length&&!!this.__match(t,e)},r.prototype.testChar=function(t,e){var n=this.peek(e);return t.lastIndex=0,null!==n&&t.test(n)},r.prototype.match=function(t){var e=this.__match(t,this.__position);return e?this.__position+=e[0].length:e=null,e},r.prototype.read=function(t,e,n){var i,r="";return t&&(i=this.match(t))&&(r+=i[0]),!e||!i&&t||(r+=this.readUntil(e,n)),r},r.prototype.readUntil=function(t,e){var n,i=this.__position;t.lastIndex=this.__position;var r=t.exec(this.__input);return r?(i=r.index,e&&(i+=r[0].length)):i=this.__input_length,n=this.__input.substring(this.__position,i),this.__position=i,n},r.prototype.readUntilAfter=function(t){return this.readUntil(t,!0)},r.prototype.get_regexp=function(t,e){var n=null,r="g";return e&&i&&(r="y"),"string"==typeof t&&""!==t?n=new RegExp(t,r):t&&(n=new RegExp(t.source,r)),n},r.prototype.get_literal_regexp=function(t){return RegExp(t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))},r.prototype.peekUntilAfter=function(t){var e=this.__position,n=this.readUntilAfter(t);return this.__position=e,n},r.prototype.lookBack=function(t){var e=this.__position-1;return e>=t.length&&this.__input.substring(e-t.length,e).toLowerCase()===t},t.exports.InputScanner=r},,,,,function(t,e,n){"use strict";function i(t,e){t="string"==typeof t?t:t.source,e="string"==typeof e?e:e.source,this.__directives_block_pattern=new RegExp(t+/ beautify( \w+[:]\w+)+ /.source+e,"g"),this.__directive_pattern=/ (\w+)[:](\w+)/g,this.__directives_end_ignore_pattern=new RegExp(t+/\sbeautify\signore:end\s/.source+e,"g")}i.prototype.get_directives=function(t){if(!t.match(this.__directives_block_pattern))return null;var e={};this.__directive_pattern.lastIndex=0;for(var n=this.__directive_pattern.exec(t);n;)e[n[1]]=n[2],n=this.__directive_pattern.exec(t);return e},i.prototype.readIgnored=function(t){return t.readUntilAfter(this.__directives_end_ignore_pattern)},t.exports.Directives=i},,function(t,e,n){"use strict";var i=n(16).Beautifier,r=n(17).Options;t.exports=function(t,e){return new i(t,e).beautify()},t.exports.defaultOptions=function(){return new r}},function(t,e,n){"use strict";var i=n(17).Options,r=n(2).Output,s=n(8).InputScanner,a=new(0,n(13).Directives)(/\/\*/,/\*\//),o=/\r\n|[\r\n]/,u=/\r\n|[\r\n]/g,c=/\s/,h=/(?:\s|\n)+/g,p=/\/\*(?:[\s\S]*?)((?:\*\/)|$)/g,_=/\/\/(?:[^\n\r\u2028\u2029]*)/g;function l(t,e){this._source_text=t||"",this._options=new i(e),this._ch=null,this._input=null,this.NESTED_AT_RULE={"@page":!0,"@font-face":!0,"@keyframes":!0,"@media":!0,"@supports":!0,"@document":!0},this.CONDITIONAL_GROUP_RULE={"@media":!0,"@supports":!0,"@document":!0}}l.prototype.eatString=function(t){var e="";for(this._ch=this._input.next();this._ch;){if(e+=this._ch,"\\"===this._ch)e+=this._input.next();else if(-1!==t.indexOf(this._ch)||"\n"===this._ch)break;this._ch=this._input.next()}return e},l.prototype.eatWhitespace=function(t){for(var e=c.test(this._input.peek()),n=0;c.test(this._input.peek());)this._ch=this._input.next(),t&&"\n"===this._ch&&(0===n||n<this._options.max_preserve_newlines)&&(n++,this._output.add_new_line(!0));return e},l.prototype.foundNestedPseudoClass=function(){for(var t=0,e=1,n=this._input.peek(e);n;){if("{"===n)return!0;if("("===n)t+=1;else if(")"===n){if(0===t)return!1;t-=1}else if(";"===n||"}"===n)return!1;e++,n=this._input.peek(e)}return!1},l.prototype.print_string=function(t){this._output.set_indent(this._indentLevel),this._output.non_breaking_space=!0,this._output.add_token(t)},l.prototype.preserveSingleSpace=function(t){t&&(this._output.space_before_token=!0)},l.prototype.indent=function(){this._indentLevel++},l.prototype.outdent=function(){this._indentLevel>0&&this._indentLevel--},l.prototype.beautify=function(){if(this._options.disabled)return this._source_text;var t=this._source_text,e=this._options.eol;"auto"===e&&(e="\n",t&&o.test(t||"")&&(e=t.match(o)[0]));var n=(t=t.replace(u,"\n")).match(/^[\t ]*/)[0];this._output=new r(this._options,n),this._input=new s(t),this._indentLevel=0,this._nestedLevel=0,this._ch=null;for(var i,l,d=0,f=!1,m=!1,g=!1,v=!1,y=!1,b=this._ch;i=""!==this._input.read(h),l=b,this._ch=this._input.next(),"\\"===this._ch&&this._input.hasNext()&&(this._ch+=this._input.next()),b=this._ch,this._ch;)if("/"===this._ch&&"*"===this._input.peek()){this._output.add_new_line(),this._input.back();var w=this._input.read(p),x=a.get_directives(w);x&&"start"===x.ignore&&(w+=a.readIgnored(this._input)),this.print_string(w),this.eatWhitespace(!0),this._output.add_new_line()}else if("/"===this._ch&&"/"===this._input.peek())this._output.space_before_token=!0,this._input.back(),this.print_string(this._input.read(_)),this.eatWhitespace(!0);else if("@"===this._ch)if(this.preserveSingleSpace(i),"{"===this._input.peek())this.print_string(this._ch+this.eatString("}"));else{this.print_string(this._ch);var k=this._input.peekUntilAfter(/[: ,;{}()[\]\/='"]/g);k.match(/[ :]$/)&&(k=this.eatString(": ").replace(/\s$/,""),this.print_string(k),this._output.space_before_token=!0),"extend"===(k=k.replace(/\s$/,""))?v=!0:"import"===k&&(y=!0),k in this.NESTED_AT_RULE?(this._nestedLevel+=1,k in this.CONDITIONAL_GROUP_RULE&&(g=!0)):f||0!==d||-1===k.indexOf(":")||(m=!0,this.indent())}else"#"===this._ch&&"{"===this._input.peek()?(this.preserveSingleSpace(i),this.print_string(this._ch+this.eatString("}"))):"{"===this._ch?(m&&(m=!1,this.outdent()),g?(g=!1,f=this._indentLevel>=this._nestedLevel):f=this._indentLevel>=this._nestedLevel-1,this._options.newline_between_rules&&f&&this._output.previous_line&&"{"!==this._output.previous_line.item(-1)&&this._output.ensure_empty_line_above("/",","),this._output.space_before_token=!0,"expand"===this._options.brace_style?(this._output.add_new_line(),this.print_string(this._ch),this.indent(),this._output.set_indent(this._indentLevel)):(this.indent(),this.print_string(this._ch)),this.eatWhitespace(!0),this._output.add_new_line()):"}"===this._ch?(this.outdent(),this._output.add_new_line(),"{"===l&&this._output.trim(!0),y=!1,v=!1,m&&(this.outdent(),m=!1),this.print_string(this._ch),f=!1,this._nestedLevel&&this._nestedLevel--,this.eatWhitespace(!0),this._output.add_new_line(),this._options.newline_between_rules&&!this._output.just_added_blankline()&&"}"!==this._input.peek()&&this._output.add_new_line(!0)):":"===this._ch?!f&&!g||this._input.lookBack("&")||this.foundNestedPseudoClass()||this._input.lookBack("(")||v||0!==d?(this._input.lookBack(" ")&&(this._output.space_before_token=!0),":"===this._input.peek()?(this._ch=this._input.next(),this.print_string("::")):this.print_string(":")):(this.print_string(":"),m||(m=!0,this._output.space_before_token=!0,this.eatWhitespace(!0),this.indent())):'"'===this._ch||"'"===this._ch?(this.preserveSingleSpace(i),this.print_string(this._ch+this.eatString(this._ch)),this.eatWhitespace(!0)):";"===this._ch?0===d?(m&&(this.outdent(),m=!1),v=!1,y=!1,this.print_string(this._ch),this.eatWhitespace(!0),"/"!==this._input.peek()&&this._output.add_new_line()):(this.print_string(this._ch),this.eatWhitespace(!0),this._output.space_before_token=!0):"("===this._ch?this._input.lookBack("url")?(this.print_string(this._ch),this.eatWhitespace(),d++,this.indent(),this._ch=this._input.next(),")"===this._ch||'"'===this._ch||"'"===this._ch?this._input.back():this._ch&&(this.print_string(this._ch+this.eatString(")")),d&&(d--,this.outdent()))):(this.preserveSingleSpace(i),this.print_string(this._ch),this.eatWhitespace(),d++,this.indent()):")"===this._ch?(d&&(d--,this.outdent()),this.print_string(this._ch)):","===this._ch?(this.print_string(this._ch),this.eatWhitespace(!0),!this._options.selector_separator_newline||m||0!==d||y?this._output.space_before_token=!0:this._output.add_new_line()):">"!==this._ch&&"+"!==this._ch&&"~"!==this._ch||m||0!==d?"]"===this._ch?this.print_string(this._ch):"["===this._ch?(this.preserveSingleSpace(i),this.print_string(this._ch)):"="===this._ch?(this.eatWhitespace(),this.print_string("="),c.test(this._ch)&&(this._ch="")):"!"!==this._ch||this._input.lookBack("\\")?(this.preserveSingleSpace(i),this.print_string(this._ch)):(this.print_string(" "),this.print_string(this._ch)):this._options.space_around_combinator?(this._output.space_before_token=!0,this.print_string(this._ch),this._output.space_before_token=!0):(this.print_string(this._ch),this.eatWhitespace(),this._ch&&c.test(this._ch)&&(this._ch=""));return this._output.get_code(e)},t.exports.Beautifier=l},function(t,e,n){"use strict";var i=n(6).Options;function r(t){i.call(this,t,"css"),this.selector_separator_newline=this._get_boolean("selector_separator_newline",!0),this.newline_between_rules=this._get_boolean("newline_between_rules",!0);var e=this._get_boolean("space_around_selector_separator");this.space_around_combinator=this._get_boolean("space_around_combinator")||e;var n=this._get_selection_list("brace_style",["collapse","expand","end-expand","none","preserve-inline"]);this.brace_style="collapse";for(var r=0;r<n.length;r++)"expand"!==n[r]?this.brace_style="collapse":this.brace_style=n[r]}r.prototype=new i,t.exports.Options=r}]),void 0===(n=function(){return{css_beautify:i}}.apply(e,[]))||(t.exports=n)},566:(t,e,n)=>{var i,r,s;s=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=18)}([,,function(t,e,n){"use strict";function i(t){this.__parent=t,this.__character_count=0,this.__indent_count=-1,this.__alignment_count=0,this.__wrap_point_index=0,this.__wrap_point_character_count=0,this.__wrap_point_indent_count=-1,this.__wrap_point_alignment_count=0,this.__items=[]}function r(t,e){this.__cache=[""],this.__indent_size=t.indent_size,this.__indent_string=t.indent_char,t.indent_with_tabs||(this.__indent_string=new Array(t.indent_size+1).join(t.indent_char)),e=e||"",t.indent_level>0&&(e=new Array(t.indent_level+1).join(this.__indent_string)),this.__base_string=e,this.__base_string_length=e.length}function s(t,e){this.__indent_cache=new r(t,e),this.raw=!1,this._end_with_newline=t.end_with_newline,this.indent_size=t.indent_size,this.wrap_line_length=t.wrap_line_length,this.indent_empty_lines=t.indent_empty_lines,this.__lines=[],this.previous_line=null,this.current_line=null,this.next_line=new i(this),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1,this.__add_outputline()}i.prototype.clone_empty=function(){var t=new i(this.__parent);return t.set_indent(this.__indent_count,this.__alignment_count),t},i.prototype.item=function(t){return t<0?this.__items[this.__items.length+t]:this.__items[t]},i.prototype.has_match=function(t){for(var e=this.__items.length-1;e>=0;e--)if(this.__items[e].match(t))return!0;return!1},i.prototype.set_indent=function(t,e){this.is_empty()&&(this.__indent_count=t||0,this.__alignment_count=e||0,this.__character_count=this.__parent.get_indent_size(this.__indent_count,this.__alignment_count))},i.prototype._set_wrap_point=function(){this.__parent.wrap_line_length&&(this.__wrap_point_index=this.__items.length,this.__wrap_point_character_count=this.__character_count,this.__wrap_point_indent_count=this.__parent.next_line.__indent_count,this.__wrap_point_alignment_count=this.__parent.next_line.__alignment_count)},i.prototype._should_wrap=function(){return this.__wrap_point_index&&this.__character_count>this.__parent.wrap_line_length&&this.__wrap_point_character_count>this.__parent.next_line.__character_count},i.prototype._allow_wrap=function(){if(this._should_wrap()){this.__parent.add_new_line();var t=this.__parent.current_line;return t.set_indent(this.__wrap_point_indent_count,this.__wrap_point_alignment_count),t.__items=this.__items.slice(this.__wrap_point_index),this.__items=this.__items.slice(0,this.__wrap_point_index),t.__character_count+=this.__character_count-this.__wrap_point_character_count,this.__character_count=this.__wrap_point_character_count," "===t.__items[0]&&(t.__items.splice(0,1),t.__character_count-=1),!0}return!1},i.prototype.is_empty=function(){return 0===this.__items.length},i.prototype.last=function(){return this.is_empty()?null:this.__items[this.__items.length-1]},i.prototype.push=function(t){this.__items.push(t);var e=t.lastIndexOf("\n");-1!==e?this.__character_count=t.length-e:this.__character_count+=t.length},i.prototype.pop=function(){var t=null;return this.is_empty()||(t=this.__items.pop(),this.__character_count-=t.length),t},i.prototype._remove_indent=function(){this.__indent_count>0&&(this.__indent_count-=1,this.__character_count-=this.__parent.indent_size)},i.prototype._remove_wrap_indent=function(){this.__wrap_point_indent_count>0&&(this.__wrap_point_indent_count-=1)},i.prototype.trim=function(){for(;" "===this.last();)this.__items.pop(),this.__character_count-=1},i.prototype.toString=function(){var t="";return this.is_empty()?this.__parent.indent_empty_lines&&(t=this.__parent.get_indent_string(this.__indent_count)):(t=this.__parent.get_indent_string(this.__indent_count,this.__alignment_count),t+=this.__items.join("")),t},r.prototype.get_indent_size=function(t,e){var n=this.__base_string_length;return e=e||0,t<0&&(n=0),(n+=t*this.__indent_size)+e},r.prototype.get_indent_string=function(t,e){var n=this.__base_string;return e=e||0,t<0&&(t=0,n=""),e+=t*this.__indent_size,this.__ensure_cache(e),n+this.__cache[e]},r.prototype.__ensure_cache=function(t){for(;t>=this.__cache.length;)this.__add_column()},r.prototype.__add_column=function(){var t=this.__cache.length,e=0,n="";this.__indent_size&&t>=this.__indent_size&&(t-=(e=Math.floor(t/this.__indent_size))*this.__indent_size,n=new Array(e+1).join(this.__indent_string)),t&&(n+=new Array(t+1).join(" ")),this.__cache.push(n)},s.prototype.__add_outputline=function(){this.previous_line=this.current_line,this.current_line=this.next_line.clone_empty(),this.__lines.push(this.current_line)},s.prototype.get_line_number=function(){return this.__lines.length},s.prototype.get_indent_string=function(t,e){return this.__indent_cache.get_indent_string(t,e)},s.prototype.get_indent_size=function(t,e){return this.__indent_cache.get_indent_size(t,e)},s.prototype.is_empty=function(){return!this.previous_line&&this.current_line.is_empty()},s.prototype.add_new_line=function(t){return!(this.is_empty()||!t&&this.just_added_newline()||(this.raw||this.__add_outputline(),0))},s.prototype.get_code=function(t){this.trim(!0);var e=this.current_line.pop();e&&("\n"===e[e.length-1]&&(e=e.replace(/\n+$/g,"")),this.current_line.push(e)),this._end_with_newline&&this.__add_outputline();var n=this.__lines.join("\n");return"\n"!==t&&(n=n.replace(/[\n]/g,t)),n},s.prototype.set_wrap_point=function(){this.current_line._set_wrap_point()},s.prototype.set_indent=function(t,e){return t=t||0,e=e||0,this.next_line.set_indent(t,e),this.__lines.length>1?(this.current_line.set_indent(t,e),!0):(this.current_line.set_indent(),!1)},s.prototype.add_raw_token=function(t){for(var e=0;e<t.newlines;e++)this.__add_outputline();this.current_line.set_indent(-1),this.current_line.push(t.whitespace_before),this.current_line.push(t.text),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1},s.prototype.add_token=function(t){this.__add_space_before_token(),this.current_line.push(t),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=this.current_line._allow_wrap()},s.prototype.__add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&(this.non_breaking_space||this.set_wrap_point(),this.current_line.push(" "))},s.prototype.remove_indent=function(t){for(var e=this.__lines.length;t<e;)this.__lines[t]._remove_indent(),t++;this.current_line._remove_wrap_indent()},s.prototype.trim=function(t){for(t=void 0!==t&&t,this.current_line.trim();t&&this.__lines.length>1&&this.current_line.is_empty();)this.__lines.pop(),this.current_line=this.__lines[this.__lines.length-1],this.current_line.trim();this.previous_line=this.__lines.length>1?this.__lines[this.__lines.length-2]:null},s.prototype.just_added_newline=function(){return this.current_line.is_empty()},s.prototype.just_added_blankline=function(){return this.is_empty()||this.current_line.is_empty()&&this.previous_line.is_empty()},s.prototype.ensure_empty_line_above=function(t,e){for(var n=this.__lines.length-2;n>=0;){var r=this.__lines[n];if(r.is_empty())break;if(0!==r.item(0).indexOf(t)&&r.item(-1)!==e){this.__lines.splice(n+1,0,new i(this)),this.previous_line=this.__lines[this.__lines.length-2];break}n--}},t.exports.Output=s},function(t,e,n){"use strict";t.exports.Token=function(t,e,n,i){this.type=t,this.text=e,this.comments_before=null,this.newlines=n||0,this.whitespace_before=i||"",this.parent=null,this.next=null,this.previous=null,this.opened=null,this.closed=null,this.directives=null}},,,function(t,e,n){"use strict";function i(t,e){this.raw_options=r(t,e),this.disabled=this._get_boolean("disabled"),this.eol=this._get_characters("eol","auto"),this.end_with_newline=this._get_boolean("end_with_newline"),this.indent_size=this._get_number("indent_size",4),this.indent_char=this._get_characters("indent_char"," "),this.indent_level=this._get_number("indent_level"),this.preserve_newlines=this._get_boolean("preserve_newlines",!0),this.max_preserve_newlines=this._get_number("max_preserve_newlines",32786),this.preserve_newlines||(this.max_preserve_newlines=0),this.indent_with_tabs=this._get_boolean("indent_with_tabs","\t"===this.indent_char),this.indent_with_tabs&&(this.indent_char="\t",1===this.indent_size&&(this.indent_size=4)),this.wrap_line_length=this._get_number("wrap_line_length",this._get_number("max_char")),this.indent_empty_lines=this._get_boolean("indent_empty_lines"),this.templating=this._get_selection_list("templating",["auto","none","django","erb","handlebars","php","smarty"],["auto"])}function r(t,e){var n,i={};for(n in t=s(t))n!==e&&(i[n]=t[n]);if(e&&t[e])for(n in t[e])i[n]=t[e][n];return i}function s(t){var e,n={};for(e in t)n[e.replace(/-/g,"_")]=t[e];return n}i.prototype._get_array=function(t,e){var n=this.raw_options[t],i=e||[];return"object"==typeof n?null!==n&&"function"==typeof n.concat&&(i=n.concat()):"string"==typeof n&&(i=n.split(/[^a-zA-Z0-9_\/\-]+/)),i},i.prototype._get_boolean=function(t,e){var n=this.raw_options[t];return void 0===n?!!e:!!n},i.prototype._get_characters=function(t,e){var n=this.raw_options[t],i=e||"";return"string"==typeof n&&(i=n.replace(/\\r/,"\r").replace(/\\n/,"\n").replace(/\\t/,"\t")),i},i.prototype._get_number=function(t,e){var n=this.raw_options[t];e=parseInt(e,10),isNaN(e)&&(e=0);var i=parseInt(n,10);return isNaN(i)&&(i=e),i},i.prototype._get_selection=function(t,e,n){var i=this._get_selection_list(t,e,n);if(1!==i.length)throw new Error("Invalid Option Value: The option '"+t+"' can only be one of the following values:\n"+e+"\nYou passed in: '"+this.raw_options[t]+"'");return i[0]},i.prototype._get_selection_list=function(t,e,n){if(!e||0===e.length)throw new Error("Selection list cannot be empty.");if(n=n||[e[0]],!this._is_valid_selection(n,e))throw new Error("Invalid Default Value!");var i=this._get_array(t,n);if(!this._is_valid_selection(i,e))throw new Error("Invalid Option Value: The option '"+t+"' can contain only the following values:\n"+e+"\nYou passed in: '"+this.raw_options[t]+"'");return i},i.prototype._is_valid_selection=function(t,e){return t.length&&e.length&&!t.some((function(t){return-1===e.indexOf(t)}))},t.exports.Options=i,t.exports.normalizeOpts=s,t.exports.mergeOpts=r},,function(t,e,n){"use strict";var i=RegExp.prototype.hasOwnProperty("sticky");function r(t){this.__input=t||"",this.__input_length=this.__input.length,this.__position=0}r.prototype.restart=function(){this.__position=0},r.prototype.back=function(){this.__position>0&&(this.__position-=1)},r.prototype.hasNext=function(){return this.__position<this.__input_length},r.prototype.next=function(){var t=null;return this.hasNext()&&(t=this.__input.charAt(this.__position),this.__position+=1),t},r.prototype.peek=function(t){var e=null;return t=t||0,(t+=this.__position)>=0&&t<this.__input_length&&(e=this.__input.charAt(t)),e},r.prototype.__match=function(t,e){t.lastIndex=e;var n=t.exec(this.__input);return!n||i&&t.sticky||n.index!==e&&(n=null),n},r.prototype.test=function(t,e){return e=e||0,(e+=this.__position)>=0&&e<this.__input_length&&!!this.__match(t,e)},r.prototype.testChar=function(t,e){var n=this.peek(e);return t.lastIndex=0,null!==n&&t.test(n)},r.prototype.match=function(t){var e=this.__match(t,this.__position);return e?this.__position+=e[0].length:e=null,e},r.prototype.read=function(t,e,n){var i,r="";return t&&(i=this.match(t))&&(r+=i[0]),!e||!i&&t||(r+=this.readUntil(e,n)),r},r.prototype.readUntil=function(t,e){var n,i=this.__position;t.lastIndex=this.__position;var r=t.exec(this.__input);return r?(i=r.index,e&&(i+=r[0].length)):i=this.__input_length,n=this.__input.substring(this.__position,i),this.__position=i,n},r.prototype.readUntilAfter=function(t){return this.readUntil(t,!0)},r.prototype.get_regexp=function(t,e){var n=null,r="g";return e&&i&&(r="y"),"string"==typeof t&&""!==t?n=new RegExp(t,r):t&&(n=new RegExp(t.source,r)),n},r.prototype.get_literal_regexp=function(t){return RegExp(t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))},r.prototype.peekUntilAfter=function(t){var e=this.__position,n=this.readUntilAfter(t);return this.__position=e,n},r.prototype.lookBack=function(t){var e=this.__position-1;return e>=t.length&&this.__input.substring(e-t.length,e).toLowerCase()===t},t.exports.InputScanner=r},function(t,e,n){"use strict";var i=n(8).InputScanner,r=n(3).Token,s=n(10).TokenStream,a=n(11).WhitespacePattern,o={START:"TK_START",RAW:"TK_RAW",EOF:"TK_EOF"},u=function(t,e){this._input=new i(t),this._options=e||{},this.__tokens=null,this._patterns={},this._patterns.whitespace=new a(this._input)};u.prototype.tokenize=function(){var t;this._input.restart(),this.__tokens=new s,this._reset();for(var e=new r(o.START,""),n=null,i=[],a=new s;e.type!==o.EOF;){for(t=this._get_next_token(e,n);this._is_comment(t);)a.add(t),t=this._get_next_token(e,n);a.isEmpty()||(t.comments_before=a,a=new s),t.parent=n,this._is_opening(t)?(i.push(n),n=t):n&&this._is_closing(t,n)&&(t.opened=n,n.closed=t,n=i.pop(),t.parent=n),t.previous=e,e.next=t,this.__tokens.add(t),e=t}return this.__tokens},u.prototype._is_first_token=function(){return this.__tokens.isEmpty()},u.prototype._reset=function(){},u.prototype._get_next_token=function(t,e){this._readWhitespace();var n=this._input.read(/.+/g);return n?this._create_token(o.RAW,n):this._create_token(o.EOF,"")},u.prototype._is_comment=function(t){return!1},u.prototype._is_opening=function(t){return!1},u.prototype._is_closing=function(t,e){return!1},u.prototype._create_token=function(t,e){return new r(t,e,this._patterns.whitespace.newline_count,this._patterns.whitespace.whitespace_before_token)},u.prototype._readWhitespace=function(){return this._patterns.whitespace.read()},t.exports.Tokenizer=u,t.exports.TOKEN=o},function(t,e,n){"use strict";function i(t){this.__tokens=[],this.__tokens_length=this.__tokens.length,this.__position=0,this.__parent_token=t}i.prototype.restart=function(){this.__position=0},i.prototype.isEmpty=function(){return 0===this.__tokens_length},i.prototype.hasNext=function(){return this.__position<this.__tokens_length},i.prototype.next=function(){var t=null;return this.hasNext()&&(t=this.__tokens[this.__position],this.__position+=1),t},i.prototype.peek=function(t){var e=null;return t=t||0,(t+=this.__position)>=0&&t<this.__tokens_length&&(e=this.__tokens[t]),e},i.prototype.add=function(t){this.__parent_token&&(t.parent=this.__parent_token),this.__tokens.push(t),this.__tokens_length+=1},t.exports.TokenStream=i},function(t,e,n){"use strict";var i=n(12).Pattern;function r(t,e){i.call(this,t,e),e?this._line_regexp=this._input.get_regexp(e._line_regexp):this.__set_whitespace_patterns("",""),this.newline_count=0,this.whitespace_before_token=""}r.prototype=new i,r.prototype.__set_whitespace_patterns=function(t,e){t+="\\t ",e+="\\n\\r",this._match_pattern=this._input.get_regexp("["+t+e+"]+",!0),this._newline_regexp=this._input.get_regexp("\\r\\n|["+e+"]")},r.prototype.read=function(){this.newline_count=0,this.whitespace_before_token="";var t=this._input.read(this._match_pattern);if(" "===t)this.whitespace_before_token=" ";else if(t){var e=this.__split(this._newline_regexp,t);this.newline_count=e.length-1,this.whitespace_before_token=e[this.newline_count]}return t},r.prototype.matching=function(t,e){var n=this._create();return n.__set_whitespace_patterns(t,e),n._update(),n},r.prototype._create=function(){return new r(this._input,this)},r.prototype.__split=function(t,e){t.lastIndex=0;for(var n=0,i=[],r=t.exec(e);r;)i.push(e.substring(n,r.index)),n=r.index+r[0].length,r=t.exec(e);return n<e.length?i.push(e.substring(n,e.length)):i.push(""),i},t.exports.WhitespacePattern=r},function(t,e,n){"use strict";function i(t,e){this._input=t,this._starting_pattern=null,this._match_pattern=null,this._until_pattern=null,this._until_after=!1,e&&(this._starting_pattern=this._input.get_regexp(e._starting_pattern,!0),this._match_pattern=this._input.get_regexp(e._match_pattern,!0),this._until_pattern=this._input.get_regexp(e._until_pattern),this._until_after=e._until_after)}i.prototype.read=function(){var t=this._input.read(this._starting_pattern);return this._starting_pattern&&!t||(t+=this._input.read(this._match_pattern,this._until_pattern,this._until_after)),t},i.prototype.read_match=function(){return this._input.match(this._match_pattern)},i.prototype.until_after=function(t){var e=this._create();return e._until_after=!0,e._until_pattern=this._input.get_regexp(t),e._update(),e},i.prototype.until=function(t){var e=this._create();return e._until_after=!1,e._until_pattern=this._input.get_regexp(t),e._update(),e},i.prototype.starting_with=function(t){var e=this._create();return e._starting_pattern=this._input.get_regexp(t,!0),e._update(),e},i.prototype.matching=function(t){var e=this._create();return e._match_pattern=this._input.get_regexp(t,!0),e._update(),e},i.prototype._create=function(){return new i(this._input,this)},i.prototype._update=function(){},t.exports.Pattern=i},function(t,e,n){"use strict";function i(t,e){t="string"==typeof t?t:t.source,e="string"==typeof e?e:e.source,this.__directives_block_pattern=new RegExp(t+/ beautify( \w+[:]\w+)+ /.source+e,"g"),this.__directive_pattern=/ (\w+)[:](\w+)/g,this.__directives_end_ignore_pattern=new RegExp(t+/\sbeautify\signore:end\s/.source+e,"g")}i.prototype.get_directives=function(t){if(!t.match(this.__directives_block_pattern))return null;var e={};this.__directive_pattern.lastIndex=0;for(var n=this.__directive_pattern.exec(t);n;)e[n[1]]=n[2],n=this.__directive_pattern.exec(t);return e},i.prototype.readIgnored=function(t){return t.readUntilAfter(this.__directives_end_ignore_pattern)},t.exports.Directives=i},function(t,e,n){"use strict";var i=n(12).Pattern,r={django:!1,erb:!1,handlebars:!1,php:!1,smarty:!1};function s(t,e){i.call(this,t,e),this.__template_pattern=null,this._disabled=Object.assign({},r),this._excluded=Object.assign({},r),e&&(this.__template_pattern=this._input.get_regexp(e.__template_pattern),this._excluded=Object.assign(this._excluded,e._excluded),this._disabled=Object.assign(this._disabled,e._disabled));var n=new i(t);this.__patterns={handlebars_comment:n.starting_with(/{{!--/).until_after(/--}}/),handlebars_unescaped:n.starting_with(/{{{/).until_after(/}}}/),handlebars:n.starting_with(/{{/).until_after(/}}/),php:n.starting_with(/<\?(?:[=]|php)/).until_after(/\?>/),erb:n.starting_with(/<%[^%]/).until_after(/[^%]%>/),django:n.starting_with(/{%/).until_after(/%}/),django_value:n.starting_with(/{{/).until_after(/}}/),django_comment:n.starting_with(/{#/).until_after(/#}/),smarty:n.starting_with(/{(?=[^}{\s\n])/).until_after(/[^\s\n]}/),smarty_comment:n.starting_with(/{\*/).until_after(/\*}/),smarty_literal:n.starting_with(/{literal}/).until_after(/{\/literal}/)}}s.prototype=new i,s.prototype._create=function(){return new s(this._input,this)},s.prototype._update=function(){this.__set_templated_pattern()},s.prototype.disable=function(t){var e=this._create();return e._disabled[t]=!0,e._update(),e},s.prototype.read_options=function(t){var e=this._create();for(var n in r)e._disabled[n]=-1===t.templating.indexOf(n);return e._update(),e},s.prototype.exclude=function(t){var e=this._create();return e._excluded[t]=!0,e._update(),e},s.prototype.read=function(){var t="";t=this._match_pattern?this._input.read(this._starting_pattern):this._input.read(this._starting_pattern,this.__template_pattern);for(var e=this._read_template();e;)this._match_pattern?e+=this._input.read(this._match_pattern):e+=this._input.readUntil(this.__template_pattern),t+=e,e=this._read_template();return this._until_after&&(t+=this._input.readUntilAfter(this._until_pattern)),t},s.prototype.__set_templated_pattern=function(){var t=[];this._disabled.php||t.push(this.__patterns.php._starting_pattern.source),this._disabled.handlebars||t.push(this.__patterns.handlebars._starting_pattern.source),this._disabled.erb||t.push(this.__patterns.erb._starting_pattern.source),this._disabled.django||(t.push(this.__patterns.django._starting_pattern.source),t.push(this.__patterns.django_value._starting_pattern.source),t.push(this.__patterns.django_comment._starting_pattern.source)),this._disabled.smarty||t.push(this.__patterns.smarty._starting_pattern.source),this._until_pattern&&t.push(this._until_pattern.source),this.__template_pattern=this._input.get_regexp("(?:"+t.join("|")+")")},s.prototype._read_template=function(){var t="",e=this._input.peek();if("<"===e){var n=this._input.peek(1);this._disabled.php||this._excluded.php||"?"!==n||(t=t||this.__patterns.php.read()),this._disabled.erb||this._excluded.erb||"%"!==n||(t=t||this.__patterns.erb.read())}else"{"===e&&(this._disabled.handlebars||this._excluded.handlebars||(t=(t=(t=t||this.__patterns.handlebars_comment.read())||this.__patterns.handlebars_unescaped.read())||this.__patterns.handlebars.read()),this._disabled.django||(this._excluded.django||this._excluded.handlebars||(t=t||this.__patterns.django_value.read()),this._excluded.django||(t=(t=t||this.__patterns.django_comment.read())||this.__patterns.django.read())),this._disabled.smarty||this._disabled.django&&this._disabled.handlebars&&(t=(t=(t=t||this.__patterns.smarty_comment.read())||this.__patterns.smarty_literal.read())||this.__patterns.smarty.read()));return t},t.exports.TemplatablePattern=s},,,,function(t,e,n){"use strict";var i=n(19).Beautifier,r=n(20).Options;t.exports=function(t,e,n,r){return new i(t,e,n,r).beautify()},t.exports.defaultOptions=function(){return new r}},function(t,e,n){"use strict";var i=n(20).Options,r=n(2).Output,s=n(21).Tokenizer,a=n(21).TOKEN,o=/\r\n|[\r\n]/,u=/\r\n|[\r\n]/g,c=function(t,e){this.indent_level=0,this.alignment_size=0,this.max_preserve_newlines=t.max_preserve_newlines,this.preserve_newlines=t.preserve_newlines,this._output=new r(t,e)};c.prototype.current_line_has_match=function(t){return this._output.current_line.has_match(t)},c.prototype.set_space_before_token=function(t,e){this._output.space_before_token=t,this._output.non_breaking_space=e},c.prototype.set_wrap_point=function(){this._output.set_indent(this.indent_level,this.alignment_size),this._output.set_wrap_point()},c.prototype.add_raw_token=function(t){this._output.add_raw_token(t)},c.prototype.print_preserved_newlines=function(t){var e=0;t.type!==a.TEXT&&t.previous.type!==a.TEXT&&(e=t.newlines?1:0),this.preserve_newlines&&(e=t.newlines<this.max_preserve_newlines+1?t.newlines:this.max_preserve_newlines+1);for(var n=0;n<e;n++)this.print_newline(n>0);return 0!==e},c.prototype.traverse_whitespace=function(t){return!(!t.whitespace_before&&!t.newlines||(this.print_preserved_newlines(t)||(this._output.space_before_token=!0),0))},c.prototype.previous_token_wrapped=function(){return this._output.previous_token_wrapped},c.prototype.print_newline=function(t){this._output.add_new_line(t)},c.prototype.print_token=function(t){t.text&&(this._output.set_indent(this.indent_level,this.alignment_size),this._output.add_token(t.text))},c.prototype.indent=function(){this.indent_level++},c.prototype.get_full_indent=function(t){return(t=this.indent_level+(t||0))<1?"":this._output.get_indent_string(t)};function h(t,e){return-1!==e.indexOf(t)}function p(t,e,n){this.parent=t||null,this.tag=e?e.tag_name:"",this.indent_level=n||0,this.parser_token=e||null}function _(t){this._printer=t,this._current_frame=null}function l(t,e,n,r){this._source_text=t||"",e=e||{},this._js_beautify=n,this._css_beautify=r,this._tag_stack=null;var s=new i(e,"html");this._options=s,this._is_wrap_attributes_force="force"===this._options.wrap_attributes.substr(0,"force".length),this._is_wrap_attributes_force_expand_multiline="force-expand-multiline"===this._options.wrap_attributes,this._is_wrap_attributes_force_aligned="force-aligned"===this._options.wrap_attributes,this._is_wrap_attributes_aligned_multiple="aligned-multiple"===this._options.wrap_attributes,this._is_wrap_attributes_preserve="preserve"===this._options.wrap_attributes.substr(0,"preserve".length),this._is_wrap_attributes_preserve_aligned="preserve-aligned"===this._options.wrap_attributes}_.prototype.get_parser_token=function(){return this._current_frame?this._current_frame.parser_token:null},_.prototype.record_tag=function(t){var e=new p(this._current_frame,t,this._printer.indent_level);this._current_frame=e},_.prototype._try_pop_frame=function(t){var e=null;return t&&(e=t.parser_token,this._printer.indent_level=t.indent_level,this._current_frame=t.parent),e},_.prototype._get_frame=function(t,e){for(var n=this._current_frame;n&&-1===t.indexOf(n.tag);){if(e&&-1!==e.indexOf(n.tag)){n=null;break}n=n.parent}return n},_.prototype.try_pop=function(t,e){var n=this._get_frame([t],e);return this._try_pop_frame(n)},_.prototype.indent_to_tag=function(t){var e=this._get_frame(t);e&&(this._printer.indent_level=e.indent_level)},l.prototype.beautify=function(){if(this._options.disabled)return this._source_text;var t=this._source_text,e=this._options.eol;"auto"===this._options.eol&&(e="\n",t&&o.test(t)&&(e=t.match(o)[0]));var n=(t=t.replace(u,"\n")).match(/^[\t ]*/)[0],i={text:"",type:""},r=new d,h=new c(this._options,n),p=new s(t,this._options).tokenize();this._tag_stack=new _(h);for(var l=null,f=p.next();f.type!==a.EOF;)f.type===a.TAG_OPEN||f.type===a.COMMENT?r=l=this._handle_tag_open(h,f,r,i):f.type===a.ATTRIBUTE||f.type===a.EQUALS||f.type===a.VALUE||f.type===a.TEXT&&!r.tag_complete?l=this._handle_inside_tag(h,f,r,p):f.type===a.TAG_CLOSE?l=this._handle_tag_close(h,f,r):f.type===a.TEXT?l=this._handle_text(h,f,r):h.add_raw_token(f),i=l,f=p.next();return h._output.get_code(e)},l.prototype._handle_tag_close=function(t,e,n){var i={text:e.text,type:e.type};return t.alignment_size=0,n.tag_complete=!0,t.set_space_before_token(e.newlines||""!==e.whitespace_before,!0),n.is_unformatted?t.add_raw_token(e):("<"===n.tag_start_char&&(t.set_space_before_token("/"===e.text[0],!0),this._is_wrap_attributes_force_expand_multiline&&n.has_wrapped_attrs&&t.print_newline(!1)),t.print_token(e)),!n.indent_content||n.is_unformatted||n.is_content_unformatted||(t.indent(),n.indent_content=!1),n.is_inline_element||n.is_unformatted||n.is_content_unformatted||t.set_wrap_point(),i},l.prototype._handle_inside_tag=function(t,e,n,i){var r=n.has_wrapped_attrs,s={text:e.text,type:e.type};if(t.set_space_before_token(e.newlines||""!==e.whitespace_before,!0),n.is_unformatted)t.add_raw_token(e);else if("{"===n.tag_start_char&&e.type===a.TEXT)t.print_preserved_newlines(e)?(e.newlines=0,t.add_raw_token(e)):t.print_token(e);else{if(e.type===a.ATTRIBUTE?(t.set_space_before_token(!0),n.attr_count+=1):(e.type===a.EQUALS||e.type===a.VALUE&&e.previous.type===a.EQUALS)&&t.set_space_before_token(!1),e.type===a.ATTRIBUTE&&"<"===n.tag_start_char&&((this._is_wrap_attributes_preserve||this._is_wrap_attributes_preserve_aligned)&&(t.traverse_whitespace(e),r=r||0!==e.newlines),this._is_wrap_attributes_force)){var o=n.attr_count>1;if(this._is_wrap_attributes_force_expand_multiline&&1===n.attr_count){var u,c=!0,h=0;do{if((u=i.peek(h)).type===a.ATTRIBUTE){c=!1;break}h+=1}while(h<4&&u.type!==a.EOF&&u.type!==a.TAG_CLOSE);o=!c}o&&(t.print_newline(!1),r=!0)}t.print_token(e),r=r||t.previous_token_wrapped(),n.has_wrapped_attrs=r}return s},l.prototype._handle_text=function(t,e,n){var i={text:e.text,type:"TK_CONTENT"};return n.custom_beautifier_name?this._print_custom_beatifier_text(t,e,n):n.is_unformatted||n.is_content_unformatted?t.add_raw_token(e):(t.traverse_whitespace(e),t.print_token(e)),i},l.prototype._print_custom_beatifier_text=function(t,e,n){var i=this;if(""!==e.text){var r,s=e.text,a=1,o="",u="";"javascript"===n.custom_beautifier_name&&"function"==typeof this._js_beautify?r=this._js_beautify:"css"===n.custom_beautifier_name&&"function"==typeof this._css_beautify?r=this._css_beautify:"html"===n.custom_beautifier_name&&(r=function(t,e){return new l(t,e,i._js_beautify,i._css_beautify).beautify()}),"keep"===this._options.indent_scripts?a=0:"separate"===this._options.indent_scripts&&(a=-t.indent_level);var c=t.get_full_indent(a);if(s=s.replace(/\n[ \t]*$/,""),"html"!==n.custom_beautifier_name&&"<"===s[0]&&s.match(/^(<!--|<!\[CDATA\[)/)){var h=/^(<!--[^\n]*|<!\[CDATA\[)(\n?)([ \t\n]*)([\s\S]*)(-->|]]>)$/.exec(s);if(!h)return void t.add_raw_token(e);o=c+h[1]+"\n",s=h[4],h[5]&&(u=c+h[5]),s=s.replace(/\n[ \t]*$/,""),(h[2]||-1!==h[3].indexOf("\n"))&&(h=h[3].match(/[ \t]+$/))&&(e.whitespace_before=h[0])}if(s)if(r){var p=function(){this.eol="\n"};p.prototype=this._options.raw_options,s=r(c+s,new p)}else{var _=e.whitespace_before;_&&(s=s.replace(new RegExp("\n("+_+")?","g"),"\n")),s=c+s.replace(/\n/g,"\n"+c)}o&&(s=s?o+s+"\n"+u:o+u),t.print_newline(!1),s&&(e.text=s,e.whitespace_before="",e.newlines=0,t.add_raw_token(e),t.print_newline(!0))}},l.prototype._handle_tag_open=function(t,e,n,i){var r=this._get_tag_open_token(e);return!n.is_unformatted&&!n.is_content_unformatted||n.is_empty_element||e.type!==a.TAG_OPEN||0!==e.text.indexOf("</")?(t.traverse_whitespace(e),this._set_tag_position(t,e,r,n,i),r.is_inline_element||t.set_wrap_point(),t.print_token(e)):(t.add_raw_token(e),r.start_tag_token=this._tag_stack.try_pop(r.tag_name)),(this._is_wrap_attributes_force_aligned||this._is_wrap_attributes_aligned_multiple||this._is_wrap_attributes_preserve_aligned)&&(r.alignment_size=e.text.length+1),r.tag_complete||r.is_unformatted||(t.alignment_size=r.alignment_size),r};var d=function(t,e){var n;this.parent=t||null,this.text="",this.type="TK_TAG_OPEN",this.tag_name="",this.is_inline_element=!1,this.is_unformatted=!1,this.is_content_unformatted=!1,this.is_empty_element=!1,this.is_start_tag=!1,this.is_end_tag=!1,this.indent_content=!1,this.multiline_content=!1,this.custom_beautifier_name=null,this.start_tag_token=null,this.attr_count=0,this.has_wrapped_attrs=!1,this.alignment_size=0,this.tag_complete=!1,this.tag_start_char="",this.tag_check="",e?(this.tag_start_char=e.text[0],this.text=e.text,"<"===this.tag_start_char?(n=e.text.match(/^<([^\s>]*)/),this.tag_check=n?n[1]:""):(n=e.text.match(/^{{(?:[\^]|#\*?)?([^\s}]+)/),this.tag_check=n?n[1]:"","{{#>"===e.text&&">"===this.tag_check&&null!==e.next&&(this.tag_check=e.next.text)),this.tag_check=this.tag_check.toLowerCase(),e.type===a.COMMENT&&(this.tag_complete=!0),this.is_start_tag="/"!==this.tag_check.charAt(0),this.tag_name=this.is_start_tag?this.tag_check:this.tag_check.substr(1),this.is_end_tag=!this.is_start_tag||e.closed&&"/>"===e.closed.text,this.is_end_tag=this.is_end_tag||"{"===this.tag_start_char&&(this.text.length<3||/[^#\^]/.test(this.text.charAt(2)))):this.tag_complete=!0};l.prototype._get_tag_open_token=function(t){var e=new d(this._tag_stack.get_parser_token(),t);return e.alignment_size=this._options.wrap_attributes_indent_size,e.is_end_tag=e.is_end_tag||h(e.tag_check,this._options.void_elements),e.is_empty_element=e.tag_complete||e.is_start_tag&&e.is_end_tag,e.is_unformatted=!e.tag_complete&&h(e.tag_check,this._options.unformatted),e.is_content_unformatted=!e.is_empty_element&&h(e.tag_check,this._options.content_unformatted),e.is_inline_element=h(e.tag_name,this._options.inline)||"{"===e.tag_start_char,e},l.prototype._set_tag_position=function(t,e,n,i,r){if(n.is_empty_element||(n.is_end_tag?n.start_tag_token=this._tag_stack.try_pop(n.tag_name):(this._do_optional_end_element(n)&&(n.is_inline_element||t.print_newline(!1)),this._tag_stack.record_tag(n),"script"!==n.tag_name&&"style"!==n.tag_name||n.is_unformatted||n.is_content_unformatted||(n.custom_beautifier_name=function(t,e){var n=null,i=null;return e.closed?("script"===t?n="text/javascript":"style"===t&&(n="text/css"),(n=function(t){for(var e=null,n=t.next;n.type!==a.EOF&&t.closed!==n;){if(n.type===a.ATTRIBUTE&&"type"===n.text){n.next&&n.next.type===a.EQUALS&&n.next.next&&n.next.next.type===a.VALUE&&(e=n.next.next.text);break}n=n.next}return e}(e)||n).search("text/css")>-1?i="css":n.search(/module|((text|application|dojo)\/(x-)?(javascript|ecmascript|jscript|livescript|(ld\+)?json|method|aspect))/)>-1?i="javascript":n.search(/(text|application|dojo)\/(x-)?(html)/)>-1?i="html":n.search(/test\/null/)>-1&&(i="null"),i):null}(n.tag_check,e)))),h(n.tag_check,this._options.extra_liners)&&(t.print_newline(!1),t._output.just_added_blankline()||t.print_newline(!0)),n.is_empty_element)"{"===n.tag_start_char&&"else"===n.tag_check&&(this._tag_stack.indent_to_tag(["if","unless","each"]),n.indent_content=!0,t.current_line_has_match(/{{#if/)||t.print_newline(!1)),"!--"===n.tag_name&&r.type===a.TAG_CLOSE&&i.is_end_tag&&-1===n.text.indexOf("\n")||(n.is_inline_element||n.is_unformatted||t.print_newline(!1),this._calcluate_parent_multiline(t,n));else if(n.is_end_tag){var s=!1;s=(s=n.start_tag_token&&n.start_tag_token.multiline_content)||!n.is_inline_element&&!(i.is_inline_element||i.is_unformatted)&&!(r.type===a.TAG_CLOSE&&n.start_tag_token===i)&&"TK_CONTENT"!==r.type,(n.is_content_unformatted||n.is_unformatted)&&(s=!1),s&&t.print_newline(!1)}else n.indent_content=!n.custom_beautifier_name,"<"===n.tag_start_char&&("html"===n.tag_name?n.indent_content=this._options.indent_inner_html:"head"===n.tag_name?n.indent_content=this._options.indent_head_inner_html:"body"===n.tag_name&&(n.indent_content=this._options.indent_body_inner_html)),n.is_inline_element||n.is_unformatted||"TK_CONTENT"===r.type&&!n.is_content_unformatted||t.print_newline(!1),this._calcluate_parent_multiline(t,n)},l.prototype._calcluate_parent_multiline=function(t,e){!e.parent||!t._output.just_added_newline()||(e.is_inline_element||e.is_unformatted)&&e.parent.is_inline_element||(e.parent.multiline_content=!0)};var f=["address","article","aside","blockquote","details","div","dl","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","main","nav","ol","p","pre","section","table","ul"],m=["a","audio","del","ins","map","noscript","video"];l.prototype._do_optional_end_element=function(t){var e=null;if(!t.is_empty_element&&t.is_start_tag&&t.parent){if("body"===t.tag_name)e=e||this._tag_stack.try_pop("head");else if("li"===t.tag_name)e=e||this._tag_stack.try_pop("li",["ol","ul"]);else if("dd"===t.tag_name||"dt"===t.tag_name)e=(e=e||this._tag_stack.try_pop("dt",["dl"]))||this._tag_stack.try_pop("dd",["dl"]);else if("p"===t.parent.tag_name&&-1!==f.indexOf(t.tag_name)){var n=t.parent.parent;n&&-1!==m.indexOf(n.tag_name)||(e=e||this._tag_stack.try_pop("p"))}else"rp"===t.tag_name||"rt"===t.tag_name?e=(e=e||this._tag_stack.try_pop("rt",["ruby","rtc"]))||this._tag_stack.try_pop("rp",["ruby","rtc"]):"optgroup"===t.tag_name?e=e||this._tag_stack.try_pop("optgroup",["select"]):"option"===t.tag_name?e=e||this._tag_stack.try_pop("option",["select","datalist","optgroup"]):"colgroup"===t.tag_name?e=e||this._tag_stack.try_pop("caption",["table"]):"thead"===t.tag_name?e=(e=e||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]):"tbody"===t.tag_name||"tfoot"===t.tag_name?e=(e=(e=(e=e||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]))||this._tag_stack.try_pop("thead",["table"]))||this._tag_stack.try_pop("tbody",["table"]):"tr"===t.tag_name?e=(e=(e=e||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]))||this._tag_stack.try_pop("tr",["table","thead","tbody","tfoot"]):"th"!==t.tag_name&&"td"!==t.tag_name||(e=(e=e||this._tag_stack.try_pop("td",["table","thead","tbody","tfoot","tr"]))||this._tag_stack.try_pop("th",["table","thead","tbody","tfoot","tr"]));return t.parent=this._tag_stack.get_parser_token(),e}},t.exports.Beautifier=l},function(t,e,n){"use strict";var i=n(6).Options;function r(t){i.call(this,t,"html"),1===this.templating.length&&"auto"===this.templating[0]&&(this.templating=["django","erb","handlebars","php"]),this.indent_inner_html=this._get_boolean("indent_inner_html"),this.indent_body_inner_html=this._get_boolean("indent_body_inner_html",!0),this.indent_head_inner_html=this._get_boolean("indent_head_inner_html",!0),this.indent_handlebars=this._get_boolean("indent_handlebars",!0),this.wrap_attributes=this._get_selection("wrap_attributes",["auto","force","force-aligned","force-expand-multiline","aligned-multiple","preserve","preserve-aligned"]),this.wrap_attributes_indent_size=this._get_number("wrap_attributes_indent_size",this.indent_size),this.extra_liners=this._get_array("extra_liners",["head","body","/html"]),this.inline=this._get_array("inline",["a","abbr","area","audio","b","bdi","bdo","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","meter","noscript","object","output","progress","q","ruby","s","samp","select","small","span","strong","sub","sup","svg","template","textarea","time","u","var","video","wbr","text","acronym","big","strike","tt"]),this.void_elements=this._get_array("void_elements",["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","!doctype","?xml","basefont","isindex"]),this.unformatted=this._get_array("unformatted",[]),this.content_unformatted=this._get_array("content_unformatted",["pre","textarea"]),this.unformatted_content_delimiter=this._get_characters("unformatted_content_delimiter"),this.indent_scripts=this._get_selection("indent_scripts",["normal","keep","separate"])}r.prototype=new i,t.exports.Options=r},function(t,e,n){"use strict";var i=n(9).Tokenizer,r=n(9).TOKEN,s=n(13).Directives,a=n(14).TemplatablePattern,o=n(12).Pattern,u={TAG_OPEN:"TK_TAG_OPEN",TAG_CLOSE:"TK_TAG_CLOSE",ATTRIBUTE:"TK_ATTRIBUTE",EQUALS:"TK_EQUALS",VALUE:"TK_VALUE",COMMENT:"TK_COMMENT",TEXT:"TK_TEXT",UNKNOWN:"TK_UNKNOWN",START:r.START,RAW:r.RAW,EOF:r.EOF},c=new s(/<\!--/,/-->/),h=function(t,e){i.call(this,t,e),this._current_tag_name="";var n=new a(this._input).read_options(this._options),r=new o(this._input);if(this.__patterns={word:n.until(/[\n\r\t <]/),single_quote:n.until_after(/'/),double_quote:n.until_after(/"/),attribute:n.until(/[\n\r\t =>]|\/>/),element_name:n.until(/[\n\r\t >\/]/),handlebars_comment:r.starting_with(/{{!--/).until_after(/--}}/),handlebars:r.starting_with(/{{/).until_after(/}}/),handlebars_open:r.until(/[\n\r\t }]/),handlebars_raw_close:r.until(/}}/),comment:r.starting_with(/<!--/).until_after(/-->/),cdata:r.starting_with(/<!\[CDATA\[/).until_after(/]]>/),conditional_comment:r.starting_with(/<!\[/).until_after(/]>/),processing:r.starting_with(/<\?/).until_after(/\?>/)},this._options.indent_handlebars&&(this.__patterns.word=this.__patterns.word.exclude("handlebars")),this._unformatted_content_delimiter=null,this._options.unformatted_content_delimiter){var s=this._input.get_literal_regexp(this._options.unformatted_content_delimiter);this.__patterns.unformatted_content_delimiter=r.matching(s).until_after(s)}};(h.prototype=new i)._is_comment=function(t){return!1},h.prototype._is_opening=function(t){return t.type===u.TAG_OPEN},h.prototype._is_closing=function(t,e){return t.type===u.TAG_CLOSE&&e&&((">"===t.text||"/>"===t.text)&&"<"===e.text[0]||"}}"===t.text&&"{"===e.text[0]&&"{"===e.text[1])},h.prototype._reset=function(){this._current_tag_name=""},h.prototype._get_next_token=function(t,e){var n=null;this._readWhitespace();var i=this._input.peek();return null===i?this._create_token(u.EOF,""):n=(n=(n=(n=(n=(n=(n=(n=(n=n||this._read_open_handlebars(i,e))||this._read_attribute(i,t,e))||this._read_close(i,e))||this._read_raw_content(i,t,e))||this._read_content_word(i))||this._read_comment_or_cdata(i))||this._read_processing(i))||this._read_open(i,e))||this._create_token(u.UNKNOWN,this._input.next())},h.prototype._read_comment_or_cdata=function(t){var e=null,n=null,i=null;return"<"===t&&("!"===this._input.peek(1)&&((n=this.__patterns.comment.read())?(i=c.get_directives(n))&&"start"===i.ignore&&(n+=c.readIgnored(this._input)):n=this.__patterns.cdata.read()),n&&((e=this._create_token(u.COMMENT,n)).directives=i)),e},h.prototype._read_processing=function(t){var e=null,n=null;if("<"===t){var i=this._input.peek(1);"!"!==i&&"?"!==i||(n=(n=this.__patterns.conditional_comment.read())||this.__patterns.processing.read()),n&&((e=this._create_token(u.COMMENT,n)).directives=null)}return e},h.prototype._read_open=function(t,e){var n=null,i=null;return e||"<"===t&&(n=this._input.next(),"/"===this._input.peek()&&(n+=this._input.next()),n+=this.__patterns.element_name.read(),i=this._create_token(u.TAG_OPEN,n)),i},h.prototype._read_open_handlebars=function(t,e){var n=null,i=null;return e||this._options.indent_handlebars&&"{"===t&&"{"===this._input.peek(1)&&("!"===this._input.peek(2)?(n=(n=this.__patterns.handlebars_comment.read())||this.__patterns.handlebars.read(),i=this._create_token(u.COMMENT,n)):(n=this.__patterns.handlebars_open.read(),i=this._create_token(u.TAG_OPEN,n))),i},h.prototype._read_close=function(t,e){var n=null,i=null;return e&&("<"===e.text[0]&&(">"===t||"/"===t&&">"===this._input.peek(1))?(n=this._input.next(),"/"===t&&(n+=this._input.next()),i=this._create_token(u.TAG_CLOSE,n)):"{"===e.text[0]&&"}"===t&&"}"===this._input.peek(1)&&(this._input.next(),this._input.next(),i=this._create_token(u.TAG_CLOSE,"}}"))),i},h.prototype._read_attribute=function(t,e,n){var i=null,r="";if(n&&"<"===n.text[0])if("="===t)i=this._create_token(u.EQUALS,this._input.next());else if('"'===t||"'"===t){var s=this._input.next();s+='"'===t?this.__patterns.double_quote.read():this.__patterns.single_quote.read(),i=this._create_token(u.VALUE,s)}else(r=this.__patterns.attribute.read())&&(i=e.type===u.EQUALS?this._create_token(u.VALUE,r):this._create_token(u.ATTRIBUTE,r));return i},h.prototype._is_content_unformatted=function(t){return-1===this._options.void_elements.indexOf(t)&&(-1!==this._options.content_unformatted.indexOf(t)||-1!==this._options.unformatted.indexOf(t))},h.prototype._read_raw_content=function(t,e,n){var i="";if(n&&"{"===n.text[0])i=this.__patterns.handlebars_raw_close.read();else if(e.type===u.TAG_CLOSE&&"<"===e.opened.text[0]&&"/"!==e.text[0]){var r=e.opened.text.substr(1).toLowerCase();if("script"===r||"style"===r){var s=this._read_comment_or_cdata(t);if(s)return s.type=u.TEXT,s;i=this._input.readUntil(new RegExp("</"+r+"[\\n\\r\\t ]*?>","ig"))}else this._is_content_unformatted(r)&&(i=this._input.readUntil(new RegExp("</"+r+"[\\n\\r\\t ]*?>","ig")))}return i?this._create_token(u.TEXT,i):null},h.prototype._read_content_word=function(t){var e="";if(this._options.unformatted_content_delimiter&&t===this._options.unformatted_content_delimiter[0]&&(e=this.__patterns.unformatted_content_delimiter.read()),e||(e=this.__patterns.word.read()),e)return this._create_token(u.TEXT,e)},t.exports.Tokenizer=h,t.exports.TOKEN=u}]),i=[n,n(937),n(40)],void 0===(r=function(t){var e=n(937),i=n(40);return{html_beautify:function(t,n){return s(t,n,e.js_beautify,i.css_beautify)}}}.apply(e,i))||(t.exports=r)},937:(t,e)=>{var n,i;i=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";var i=n(1).Beautifier,r=n(5).Options;t.exports=function(t,e){return new i(t,e).beautify()},t.exports.defaultOptions=function(){return new r}},function(t,e,n){"use strict";var i=n(2).Output,r=n(3).Token,s=n(4),a=n(5).Options,o=n(7).Tokenizer,u=n(7).line_starters,c=n(7).positionable_operators,h=n(7).TOKEN;function p(t,e){return-1!==e.indexOf(t)}function _(t,e){return t&&t.type===h.RESERVED&&t.text===e}function l(t,e){return t&&t.type===h.RESERVED&&p(t.text,e)}var d=["case","return","do","if","throw","else","await","break","continue","async"],f=function(t){for(var e={},n=0;n<t.length;n++)e[t[n].replace(/-/g,"_")]=t[n];return e}(["before-newline","after-newline","preserve-newline"]),m=[f.before_newline,f.preserve_newline],g="BlockStatement",v="Statement",y="ObjectLiteral",b="ArrayLiteral",w="ForInitializer",x="Conditional",k="Expression";function T(t,e){e.multiline_frame||e.mode===w||e.mode===x||t.remove_indent(e.start_line_index)}function C(t){return t===b}function S(t){return p(t,[k,w,x])}function M(t,e){e=e||{},this._source_text=t||"",this._output=null,this._tokens=null,this._last_last_text=null,this._flags=null,this._previous_flags=null,this._flag_store=null,this._options=new a(e)}M.prototype.create_flags=function(t,e){var n=0;return t&&(n=t.indentation_level,!this._output.just_added_newline()&&t.line_indent_level>n&&(n=t.line_indent_level)),{mode:e,parent:t,last_token:t?t.last_token:new r(h.START_BLOCK,""),last_word:t?t.last_word:"",declaration_statement:!1,declaration_assignment:!1,multiline_frame:!1,inline_frame:!1,if_block:!1,else_block:!1,do_block:!1,do_while:!1,import_block:!1,in_case_statement:!1,in_case:!1,case_body:!1,indentation_level:n,alignment:0,line_indent_level:t?t.line_indent_level:n,start_line_index:this._output.get_line_number(),ternary_depth:0}},M.prototype._reset=function(t){var e=t.match(/^[\t ]*/)[0];this._last_last_text="",this._output=new i(this._options,e),this._output.raw=this._options.test_output_raw,this._flag_store=[],this.set_mode(g);var n=new o(t,this._options);return this._tokens=n.tokenize(),t},M.prototype.beautify=function(){if(this._options.disabled)return this._source_text;var t=this._reset(this._source_text),e=this._options.eol;"auto"===this._options.eol&&(e="\n",t&&s.lineBreak.test(t||"")&&(e=t.match(s.lineBreak)[0]));for(var n=this._tokens.next();n;)this.handle_token(n),this._last_last_text=this._flags.last_token.text,this._flags.last_token=n,n=this._tokens.next();return this._output.get_code(e)},M.prototype.handle_token=function(t,e){t.type===h.START_EXPR?this.handle_start_expr(t):t.type===h.END_EXPR?this.handle_end_expr(t):t.type===h.START_BLOCK?this.handle_start_block(t):t.type===h.END_BLOCK?this.handle_end_block(t):t.type===h.WORD||t.type===h.RESERVED?this.handle_word(t):t.type===h.SEMICOLON?this.handle_semicolon(t):t.type===h.STRING?this.handle_string(t):t.type===h.EQUALS?this.handle_equals(t):t.type===h.OPERATOR?this.handle_operator(t):t.type===h.COMMA?this.handle_comma(t):t.type===h.BLOCK_COMMENT?this.handle_block_comment(t,e):t.type===h.COMMENT?this.handle_comment(t,e):t.type===h.DOT?this.handle_dot(t):t.type===h.EOF?this.handle_eof(t):(t.type,h.UNKNOWN,this.handle_unknown(t,e))},M.prototype.handle_whitespace_and_comments=function(t,e){var n=t.newlines,i=this._options.keep_array_indentation&&C(this._flags.mode);if(t.comments_before)for(var r=t.comments_before.next();r;)this.handle_whitespace_and_comments(r,e),this.handle_token(r,e),r=t.comments_before.next();if(i)for(var s=0;s<n;s+=1)this.print_newline(s>0,e);else if(this._options.max_preserve_newlines&&n>this._options.max_preserve_newlines&&(n=this._options.max_preserve_newlines),this._options.preserve_newlines&&n>1){this.print_newline(!1,e);for(var a=1;a<n;a+=1)this.print_newline(!0,e)}};var E=["async","break","continue","return","throw","yield"];M.prototype.allow_wrap_or_preserved_newline=function(t,e){if(e=void 0!==e&&e,!this._output.just_added_newline()){var n=this._options.preserve_newlines&&t.newlines||e;if(p(this._flags.last_token.text,c)||p(t.text,c)){var i=p(this._flags.last_token.text,c)&&p(this._options.operator_position,m)||p(t.text,c);n=n&&i}if(n)this.print_newline(!1,!0);else if(this._options.wrap_line_length){if(l(this._flags.last_token,E))return;this._output.set_wrap_point()}}},M.prototype.print_newline=function(t,e){if(!e&&";"!==this._flags.last_token.text&&","!==this._flags.last_token.text&&"="!==this._flags.last_token.text&&(this._flags.last_token.type!==h.OPERATOR||"--"===this._flags.last_token.text||"++"===this._flags.last_token.text))for(var n=this._tokens.peek();!(this._flags.mode!==v||this._flags.if_block&&_(n,"else")||this._flags.do_block);)this.restore_mode();this._output.add_new_line(t)&&(this._flags.multiline_frame=!0)},M.prototype.print_token_line_indentation=function(t){this._output.just_added_newline()&&(this._options.keep_array_indentation&&t.newlines&&("["===t.text||C(this._flags.mode))?(this._output.current_line.set_indent(-1),this._output.current_line.push(t.whitespace_before),this._output.space_before_token=!1):this._output.set_indent(this._flags.indentation_level,this._flags.alignment)&&(this._flags.line_indent_level=this._flags.indentation_level))},M.prototype.print_token=function(t){if(this._output.raw)this._output.add_raw_token(t);else{if(this._options.comma_first&&t.previous&&t.previous.type===h.COMMA&&this._output.just_added_newline()&&","===this._output.previous_line.last()){var e=this._output.previous_line.pop();this._output.previous_line.is_empty()&&(this._output.previous_line.push(e),this._output.trim(!0),this._output.current_line.pop(),this._output.trim()),this.print_token_line_indentation(t),this._output.add_token(","),this._output.space_before_token=!0}this.print_token_line_indentation(t),this._output.non_breaking_space=!0,this._output.add_token(t.text),this._output.previous_token_wrapped&&(this._flags.multiline_frame=!0)}},M.prototype.indent=function(){this._flags.indentation_level+=1,this._output.set_indent(this._flags.indentation_level,this._flags.alignment)},M.prototype.deindent=function(){this._flags.indentation_level>0&&(!this._flags.parent||this._flags.indentation_level>this._flags.parent.indentation_level)&&(this._flags.indentation_level-=1,this._output.set_indent(this._flags.indentation_level,this._flags.alignment))},M.prototype.set_mode=function(t){this._flags?(this._flag_store.push(this._flags),this._previous_flags=this._flags):this._previous_flags=this.create_flags(null,t),this._flags=this.create_flags(this._previous_flags,t),this._output.set_indent(this._flags.indentation_level,this._flags.alignment)},M.prototype.restore_mode=function(){this._flag_store.length>0&&(this._previous_flags=this._flags,this._flags=this._flag_store.pop(),this._previous_flags.mode===v&&T(this._output,this._previous_flags),this._output.set_indent(this._flags.indentation_level,this._flags.alignment))},M.prototype.start_of_object_property=function(){return this._flags.parent.mode===y&&this._flags.mode===v&&(":"===this._flags.last_token.text&&0===this._flags.ternary_depth||l(this._flags.last_token,["get","set"]))},M.prototype.start_of_statement=function(t){var e=!1;return!!(e=(e=(e=(e=(e=(e=(e=e||l(this._flags.last_token,["var","let","const"])&&t.type===h.WORD)||_(this._flags.last_token,"do"))||!(this._flags.parent.mode===y&&this._flags.mode===v)&&l(this._flags.last_token,E)&&!t.newlines)||_(this._flags.last_token,"else")&&!(_(t,"if")&&!t.comments_before))||this._flags.last_token.type===h.END_EXPR&&(this._previous_flags.mode===w||this._previous_flags.mode===x))||this._flags.last_token.type===h.WORD&&this._flags.mode===g&&!this._flags.in_case&&!("--"===t.text||"++"===t.text)&&"function"!==this._last_last_text&&t.type!==h.WORD&&t.type!==h.RESERVED)||this._flags.mode===y&&(":"===this._flags.last_token.text&&0===this._flags.ternary_depth||l(this._flags.last_token,["get","set"])))&&(this.set_mode(v),this.indent(),this.handle_whitespace_and_comments(t,!0),this.start_of_object_property()||this.allow_wrap_or_preserved_newline(t,l(t,["do","for","if","while"])),!0)},M.prototype.handle_start_expr=function(t){this.start_of_statement(t)||this.handle_whitespace_and_comments(t);var e=k;if("["===t.text){if(this._flags.last_token.type===h.WORD||")"===this._flags.last_token.text)return l(this._flags.last_token,u)&&(this._output.space_before_token=!0),this.print_token(t),this.set_mode(e),this.indent(),void(this._options.space_in_paren&&(this._output.space_before_token=!0));e=b,C(this._flags.mode)&&("["!==this._flags.last_token.text&&(","!==this._flags.last_token.text||"]"!==this._last_last_text&&"}"!==this._last_last_text)||this._options.keep_array_indentation||this.print_newline()),p(this._flags.last_token.type,[h.START_EXPR,h.END_EXPR,h.WORD,h.OPERATOR])||(this._output.space_before_token=!0)}else{if(this._flags.last_token.type===h.RESERVED)"for"===this._flags.last_token.text?(this._output.space_before_token=this._options.space_before_conditional,e=w):p(this._flags.last_token.text,["if","while"])?(this._output.space_before_token=this._options.space_before_conditional,e=x):p(this._flags.last_word,["await","async"])?this._output.space_before_token=!0:"import"===this._flags.last_token.text&&""===t.whitespace_before?this._output.space_before_token=!1:(p(this._flags.last_token.text,u)||"catch"===this._flags.last_token.text)&&(this._output.space_before_token=!0);else if(this._flags.last_token.type===h.EQUALS||this._flags.last_token.type===h.OPERATOR)this.start_of_object_property()||this.allow_wrap_or_preserved_newline(t);else if(this._flags.last_token.type===h.WORD){this._output.space_before_token=!1;var n=this._tokens.peek(-3);if(this._options.space_after_named_function&&n){var i=this._tokens.peek(-4);l(n,["async","function"])||"*"===n.text&&l(i,["async","function"])?this._output.space_before_token=!0:this._flags.mode===y&&("{"!==n.text&&","!==n.text&&("*"!==n.text||"{"!==i.text&&","!==i.text)||(this._output.space_before_token=!0))}}else this.allow_wrap_or_preserved_newline(t);(this._flags.last_token.type===h.RESERVED&&("function"===this._flags.last_word||"typeof"===this._flags.last_word)||"*"===this._flags.last_token.text&&(p(this._last_last_text,["function","yield"])||this._flags.mode===y&&p(this._last_last_text,["{",","])))&&(this._output.space_before_token=this._options.space_after_anon_function)}";"===this._flags.last_token.text||this._flags.last_token.type===h.START_BLOCK?this.print_newline():this._flags.last_token.type!==h.END_EXPR&&this._flags.last_token.type!==h.START_EXPR&&this._flags.last_token.type!==h.END_BLOCK&&"."!==this._flags.last_token.text&&this._flags.last_token.type!==h.COMMA||this.allow_wrap_or_preserved_newline(t,t.newlines),this.print_token(t),this.set_mode(e),this._options.space_in_paren&&(this._output.space_before_token=!0),this.indent()},M.prototype.handle_end_expr=function(t){for(;this._flags.mode===v;)this.restore_mode();this.handle_whitespace_and_comments(t),this._flags.multiline_frame&&this.allow_wrap_or_preserved_newline(t,"]"===t.text&&C(this._flags.mode)&&!this._options.keep_array_indentation),this._options.space_in_paren&&(this._flags.last_token.type!==h.START_EXPR||this._options.space_in_empty_paren?this._output.space_before_token=!0:(this._output.trim(),this._output.space_before_token=!1)),this.deindent(),this.print_token(t),this.restore_mode(),T(this._output,this._previous_flags),this._flags.do_while&&this._previous_flags.mode===x&&(this._previous_flags.mode=k,this._flags.do_block=!1,this._flags.do_while=!1)},M.prototype.handle_start_block=function(t){this.handle_whitespace_and_comments(t);var e=this._tokens.peek(),n=this._tokens.peek(1);"switch"===this._flags.last_word&&this._flags.last_token.type===h.END_EXPR?(this.set_mode(g),this._flags.in_case_statement=!0):this._flags.case_body?this.set_mode(g):n&&(p(n.text,[":",","])&&p(e.type,[h.STRING,h.WORD,h.RESERVED])||p(e.text,["get","set","..."])&&p(n.type,[h.WORD,h.RESERVED]))?p(this._last_last_text,["class","interface"])?this.set_mode(g):this.set_mode(y):this._flags.last_token.type===h.OPERATOR&&"=>"===this._flags.last_token.text?this.set_mode(g):p(this._flags.last_token.type,[h.EQUALS,h.START_EXPR,h.COMMA,h.OPERATOR])||l(this._flags.last_token,["return","throw","import","default"])?this.set_mode(y):this.set_mode(g);var i=!e.comments_before&&"}"===e.text,r=i&&"function"===this._flags.last_word&&this._flags.last_token.type===h.END_EXPR;if(this._options.brace_preserve_inline){var s=0,a=null;this._flags.inline_frame=!0;do{if(s+=1,(a=this._tokens.peek(s-1)).newlines){this._flags.inline_frame=!1;break}}while(a.type!==h.EOF&&(a.type!==h.END_BLOCK||a.opened!==t))}("expand"===this._options.brace_style||"none"===this._options.brace_style&&t.newlines)&&!this._flags.inline_frame?this._flags.last_token.type!==h.OPERATOR&&(r||this._flags.last_token.type===h.EQUALS||l(this._flags.last_token,d)&&"else"!==this._flags.last_token.text)?this._output.space_before_token=!0:this.print_newline(!1,!0):(!C(this._previous_flags.mode)||this._flags.last_token.type!==h.START_EXPR&&this._flags.last_token.type!==h.COMMA||((this._flags.last_token.type===h.COMMA||this._options.space_in_paren)&&(this._output.space_before_token=!0),(this._flags.last_token.type===h.COMMA||this._flags.last_token.type===h.START_EXPR&&this._flags.inline_frame)&&(this.allow_wrap_or_preserved_newline(t),this._previous_flags.multiline_frame=this._previous_flags.multiline_frame||this._flags.multiline_frame,this._flags.multiline_frame=!1)),this._flags.last_token.type!==h.OPERATOR&&this._flags.last_token.type!==h.START_EXPR&&(this._flags.last_token.type!==h.START_BLOCK||this._flags.inline_frame?this._output.space_before_token=!0:this.print_newline())),this.print_token(t),this.indent(),i||this._options.brace_preserve_inline&&this._flags.inline_frame||this.print_newline()},M.prototype.handle_end_block=function(t){for(this.handle_whitespace_and_comments(t);this._flags.mode===v;)this.restore_mode();var e=this._flags.last_token.type===h.START_BLOCK;this._flags.inline_frame&&!e?this._output.space_before_token=!0:"expand"===this._options.brace_style?e||this.print_newline():e||(C(this._flags.mode)&&this._options.keep_array_indentation?(this._options.keep_array_indentation=!1,this.print_newline(),this._options.keep_array_indentation=!0):this.print_newline()),this.restore_mode(),this.print_token(t)},M.prototype.handle_word=function(t){if(t.type===h.RESERVED&&(p(t.text,["set","get"])&&this._flags.mode!==y||"import"===t.text&&"("===this._tokens.peek().text||p(t.text,["as","from"])&&!this._flags.import_block||this._flags.mode===y&&":"===this._tokens.peek().text)&&(t.type=h.WORD),this.start_of_statement(t)?l(this._flags.last_token,["var","let","const"])&&t.type===h.WORD&&(this._flags.declaration_statement=!0):!t.newlines||S(this._flags.mode)||this._flags.last_token.type===h.OPERATOR&&"--"!==this._flags.last_token.text&&"++"!==this._flags.last_token.text||this._flags.last_token.type===h.EQUALS||!this._options.preserve_newlines&&l(this._flags.last_token,["var","let","const","set","get"])?this.handle_whitespace_and_comments(t):(this.handle_whitespace_and_comments(t),this.print_newline()),this._flags.do_block&&!this._flags.do_while){if(_(t,"while"))return this._output.space_before_token=!0,this.print_token(t),this._output.space_before_token=!0,void(this._flags.do_while=!0);this.print_newline(),this._flags.do_block=!1}if(this._flags.if_block)if(!this._flags.else_block&&_(t,"else"))this._flags.else_block=!0;else{for(;this._flags.mode===v;)this.restore_mode();this._flags.if_block=!1,this._flags.else_block=!1}if(this._flags.in_case_statement&&l(t,["case","default"]))return this.print_newline(),this._flags.last_token.type!==h.END_BLOCK&&(this._flags.case_body||this._options.jslint_happy)&&this.deindent(),this._flags.case_body=!1,this.print_token(t),void(this._flags.in_case=!0);if(this._flags.last_token.type!==h.COMMA&&this._flags.last_token.type!==h.START_EXPR&&this._flags.last_token.type!==h.EQUALS&&this._flags.last_token.type!==h.OPERATOR||this.start_of_object_property()||this.allow_wrap_or_preserved_newline(t),_(t,"function"))return(p(this._flags.last_token.text,["}",";"])||this._output.just_added_newline()&&!p(this._flags.last_token.text,["(","[","{",":","=",","])&&this._flags.last_token.type!==h.OPERATOR)&&(this._output.just_added_blankline()||t.comments_before||(this.print_newline(),this.print_newline(!0))),this._flags.last_token.type===h.RESERVED||this._flags.last_token.type===h.WORD?l(this._flags.last_token,["get","set","new","export"])||l(this._flags.last_token,E)||_(this._flags.last_token,"default")&&"export"===this._last_last_text||"declare"===this._flags.last_token.text?this._output.space_before_token=!0:this.print_newline():this._flags.last_token.type===h.OPERATOR||"="===this._flags.last_token.text?this._output.space_before_token=!0:(this._flags.multiline_frame||!S(this._flags.mode)&&!C(this._flags.mode))&&this.print_newline(),this.print_token(t),void(this._flags.last_word=t.text);var e="NONE";this._flags.last_token.type===h.END_BLOCK?this._previous_flags.inline_frame?e="SPACE":l(t,["else","catch","finally","from"])?"expand"===this._options.brace_style||"end-expand"===this._options.brace_style||"none"===this._options.brace_style&&t.newlines?e="NEWLINE":(e="SPACE",this._output.space_before_token=!0):e="NEWLINE":this._flags.last_token.type===h.SEMICOLON&&this._flags.mode===g?e="NEWLINE":this._flags.last_token.type===h.SEMICOLON&&S(this._flags.mode)?e="SPACE":this._flags.last_token.type===h.STRING?e="NEWLINE":this._flags.last_token.type===h.RESERVED||this._flags.last_token.type===h.WORD||"*"===this._flags.last_token.text&&(p(this._last_last_text,["function","yield"])||this._flags.mode===y&&p(this._last_last_text,["{",","]))?e="SPACE":this._flags.last_token.type===h.START_BLOCK?e=this._flags.inline_frame?"SPACE":"NEWLINE":this._flags.last_token.type===h.END_EXPR&&(this._output.space_before_token=!0,e="NEWLINE"),l(t,u)&&")"!==this._flags.last_token.text&&(e=this._flags.inline_frame||"else"===this._flags.last_token.text||"export"===this._flags.last_token.text?"SPACE":"NEWLINE"),l(t,["else","catch","finally"])?(this._flags.last_token.type!==h.END_BLOCK||this._previous_flags.mode!==g||"expand"===this._options.brace_style||"end-expand"===this._options.brace_style||"none"===this._options.brace_style&&t.newlines)&&!this._flags.inline_frame?this.print_newline():(this._output.trim(!0),"}"!==this._output.current_line.last()&&this.print_newline(),this._output.space_before_token=!0):"NEWLINE"===e?l(this._flags.last_token,d)||"declare"===this._flags.last_token.text&&l(t,["var","let","const"])?this._output.space_before_token=!0:this._flags.last_token.type!==h.END_EXPR?this._flags.last_token.type===h.START_EXPR&&l(t,["var","let","const"])||":"===this._flags.last_token.text||(_(t,"if")&&_(t.previous,"else")?this._output.space_before_token=!0:this.print_newline()):l(t,u)&&")"!==this._flags.last_token.text&&this.print_newline():this._flags.multiline_frame&&C(this._flags.mode)&&","===this._flags.last_token.text&&"}"===this._last_last_text?this.print_newline():"SPACE"===e&&(this._output.space_before_token=!0),!t.previous||t.previous.type!==h.WORD&&t.previous.type!==h.RESERVED||(this._output.space_before_token=!0),this.print_token(t),this._flags.last_word=t.text,t.type===h.RESERVED&&("do"===t.text?this._flags.do_block=!0:"if"===t.text?this._flags.if_block=!0:"import"===t.text?this._flags.import_block=!0:this._flags.import_block&&_(t,"from")&&(this._flags.import_block=!1))},M.prototype.handle_semicolon=function(t){this.start_of_statement(t)?this._output.space_before_token=!1:this.handle_whitespace_and_comments(t);for(var e=this._tokens.peek();!(this._flags.mode!==v||this._flags.if_block&&_(e,"else")||this._flags.do_block);)this.restore_mode();this._flags.import_block&&(this._flags.import_block=!1),this.print_token(t)},M.prototype.handle_string=function(t){(!t.text.startsWith("`")||0!==t.newlines||""!==t.whitespace_before||")"!==t.previous.text&&this._flags.last_token.type!==h.WORD)&&(this.start_of_statement(t)?this._output.space_before_token=!0:(this.handle_whitespace_and_comments(t),this._flags.last_token.type===h.RESERVED||this._flags.last_token.type===h.WORD||this._flags.inline_frame?this._output.space_before_token=!0:this._flags.last_token.type===h.COMMA||this._flags.last_token.type===h.START_EXPR||this._flags.last_token.type===h.EQUALS||this._flags.last_token.type===h.OPERATOR?this.start_of_object_property()||this.allow_wrap_or_preserved_newline(t):!t.text.startsWith("`")||this._flags.last_token.type!==h.END_EXPR||"]"!==t.previous.text&&")"!==t.previous.text||0!==t.newlines?this.print_newline():this._output.space_before_token=!0)),this.print_token(t)},M.prototype.handle_equals=function(t){this.start_of_statement(t)||this.handle_whitespace_and_comments(t),this._flags.declaration_statement&&(this._flags.declaration_assignment=!0),this._output.space_before_token=!0,this.print_token(t),this._output.space_before_token=!0},M.prototype.handle_comma=function(t){this.handle_whitespace_and_comments(t,!0),this.print_token(t),this._output.space_before_token=!0,this._flags.declaration_statement?(S(this._flags.parent.mode)&&(this._flags.declaration_assignment=!1),this._flags.declaration_assignment?(this._flags.declaration_assignment=!1,this.print_newline(!1,!0)):this._options.comma_first&&this.allow_wrap_or_preserved_newline(t)):this._flags.mode===y||this._flags.mode===v&&this._flags.parent.mode===y?(this._flags.mode===v&&this.restore_mode(),this._flags.inline_frame||this.print_newline()):this._options.comma_first&&this.allow_wrap_or_preserved_newline(t)},M.prototype.handle_operator=function(t){var e="*"===t.text&&(l(this._flags.last_token,["function","yield"])||p(this._flags.last_token.type,[h.START_BLOCK,h.COMMA,h.END_BLOCK,h.SEMICOLON])),n=p(t.text,["-","+"])&&(p(this._flags.last_token.type,[h.START_BLOCK,h.START_EXPR,h.EQUALS,h.OPERATOR])||p(this._flags.last_token.text,u)||","===this._flags.last_token.text);if(this.start_of_statement(t));else{var i=!e;this.handle_whitespace_and_comments(t,i)}if(l(this._flags.last_token,d))return this._output.space_before_token=!0,void this.print_token(t);if("*"!==t.text||this._flags.last_token.type!==h.DOT)if("::"!==t.text){if(this._flags.last_token.type===h.OPERATOR&&p(this._options.operator_position,m)&&this.allow_wrap_or_preserved_newline(t),":"===t.text&&this._flags.in_case)return this.print_token(t),this._flags.in_case=!1,this._flags.case_body=!0,void(this._tokens.peek().type!==h.START_BLOCK?(this.indent(),this.print_newline()):this._output.space_before_token=!0);var r=!0,s=!0,a=!1;if(":"===t.text?0===this._flags.ternary_depth?r=!1:(this._flags.ternary_depth-=1,a=!0):"?"===t.text&&(this._flags.ternary_depth+=1),!n&&!e&&this._options.preserve_newlines&&p(t.text,c)){var o=":"===t.text,_=o&&a,y=o&&!a;switch(this._options.operator_position){case f.before_newline:return this._output.space_before_token=!y,this.print_token(t),o&&!_||this.allow_wrap_or_preserved_newline(t),void(this._output.space_before_token=!0);case f.after_newline:return this._output.space_before_token=!0,!o||_?this._tokens.peek().newlines?this.print_newline(!1,!0):this.allow_wrap_or_preserved_newline(t):this._output.space_before_token=!1,this.print_token(t),void(this._output.space_before_token=!0);case f.preserve_newline:return y||this.allow_wrap_or_preserved_newline(t),r=!(this._output.just_added_newline()||y),this._output.space_before_token=r,this.print_token(t),void(this._output.space_before_token=!0)}}if(e){this.allow_wrap_or_preserved_newline(t),r=!1;var b=this._tokens.peek();s=b&&p(b.type,[h.WORD,h.RESERVED])}else"..."===t.text?(this.allow_wrap_or_preserved_newline(t),r=this._flags.last_token.type===h.START_BLOCK,s=!1):(p(t.text,["--","++","!","~"])||n)&&(this._flags.last_token.type!==h.COMMA&&this._flags.last_token.type!==h.START_EXPR||this.allow_wrap_or_preserved_newline(t),r=!1,s=!1,!t.newlines||"--"!==t.text&&"++"!==t.text||this.print_newline(!1,!0),";"===this._flags.last_token.text&&S(this._flags.mode)&&(r=!0),this._flags.last_token.type===h.RESERVED?r=!0:this._flags.last_token.type===h.END_EXPR?r=!("]"===this._flags.last_token.text&&("--"===t.text||"++"===t.text)):this._flags.last_token.type===h.OPERATOR&&(r=p(t.text,["--","-","++","+"])&&p(this._flags.last_token.text,["--","-","++","+"]),p(t.text,["+","-"])&&p(this._flags.last_token.text,["--","++"])&&(s=!0)),(this._flags.mode!==g||this._flags.inline_frame)&&this._flags.mode!==v||"{"!==this._flags.last_token.text&&";"!==this._flags.last_token.text||this.print_newline());this._output.space_before_token=this._output.space_before_token||r,this.print_token(t),this._output.space_before_token=s}else this.print_token(t);else this.print_token(t)},M.prototype.handle_block_comment=function(t,e){return this._output.raw?(this._output.add_raw_token(t),void(t.directives&&"end"===t.directives.preserve&&(this._output.raw=this._options.test_output_raw))):t.directives?(this.print_newline(!1,e),this.print_token(t),"start"===t.directives.preserve&&(this._output.raw=!0),void this.print_newline(!1,!0)):s.newline.test(t.text)||t.newlines?void this.print_block_commment(t,e):(this._output.space_before_token=!0,this.print_token(t),void(this._output.space_before_token=!0))},M.prototype.print_block_commment=function(t,e){var n,i=function(t){for(var e=[],n=(t=t.replace(s.allLineBreaks,"\n")).indexOf("\n");-1!==n;)e.push(t.substring(0,n)),n=(t=t.substring(n+1)).indexOf("\n");return t.length&&e.push(t),e}(t.text),r=!1,a=!1,o=t.whitespace_before,u=o.length;if(this.print_newline(!1,e),this.print_token_line_indentation(t),this._output.add_token(i[0]),this.print_newline(!1,e),i.length>1){for(r=function(t,e){for(var n=0;n<t.length;n++)if("*"!==t[n].trim().charAt(0))return!1;return!0}(i=i.slice(1)),a=function(t,e){for(var n,i=0,r=t.length;i<r;i++)if((n=t[i])&&0!==n.indexOf(e))return!1;return!0}(i,o),r&&(this._flags.alignment=1),n=0;n<i.length;n++)r?(this.print_token_line_indentation(t),this._output.add_token(i[n].replace(/^\s+/g,""))):a&&i[n]?(this.print_token_line_indentation(t),this._output.add_token(i[n].substring(u))):(this._output.current_line.set_indent(-1),this._output.add_token(i[n])),this.print_newline(!1,e);this._flags.alignment=0}},M.prototype.handle_comment=function(t,e){t.newlines?this.print_newline(!1,e):this._output.trim(!0),this._output.space_before_token=!0,this.print_token(t),this.print_newline(!1,e)},M.prototype.handle_dot=function(t){this.start_of_statement(t)||this.handle_whitespace_and_comments(t,!0),l(this._flags.last_token,d)?this._output.space_before_token=!1:this.allow_wrap_or_preserved_newline(t,")"===this._flags.last_token.text&&this._options.break_chained_methods),this._options.unindent_chained_methods&&this._output.just_added_newline()&&this.deindent(),this.print_token(t)},M.prototype.handle_unknown=function(t,e){this.print_token(t),"\n"===t.text[t.text.length-1]&&this.print_newline(!1,e)},M.prototype.handle_eof=function(t){for(;this._flags.mode===v;)this.restore_mode();this.handle_whitespace_and_comments(t)},t.exports.Beautifier=M},function(t,e,n){"use strict";function i(t){this.__parent=t,this.__character_count=0,this.__indent_count=-1,this.__alignment_count=0,this.__wrap_point_index=0,this.__wrap_point_character_count=0,this.__wrap_point_indent_count=-1,this.__wrap_point_alignment_count=0,this.__items=[]}function r(t,e){this.__cache=[""],this.__indent_size=t.indent_size,this.__indent_string=t.indent_char,t.indent_with_tabs||(this.__indent_string=new Array(t.indent_size+1).join(t.indent_char)),e=e||"",t.indent_level>0&&(e=new Array(t.indent_level+1).join(this.__indent_string)),this.__base_string=e,this.__base_string_length=e.length}function s(t,e){this.__indent_cache=new r(t,e),this.raw=!1,this._end_with_newline=t.end_with_newline,this.indent_size=t.indent_size,this.wrap_line_length=t.wrap_line_length,this.indent_empty_lines=t.indent_empty_lines,this.__lines=[],this.previous_line=null,this.current_line=null,this.next_line=new i(this),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1,this.__add_outputline()}i.prototype.clone_empty=function(){var t=new i(this.__parent);return t.set_indent(this.__indent_count,this.__alignment_count),t},i.prototype.item=function(t){return t<0?this.__items[this.__items.length+t]:this.__items[t]},i.prototype.has_match=function(t){for(var e=this.__items.length-1;e>=0;e--)if(this.__items[e].match(t))return!0;return!1},i.prototype.set_indent=function(t,e){this.is_empty()&&(this.__indent_count=t||0,this.__alignment_count=e||0,this.__character_count=this.__parent.get_indent_size(this.__indent_count,this.__alignment_count))},i.prototype._set_wrap_point=function(){this.__parent.wrap_line_length&&(this.__wrap_point_index=this.__items.length,this.__wrap_point_character_count=this.__character_count,this.__wrap_point_indent_count=this.__parent.next_line.__indent_count,this.__wrap_point_alignment_count=this.__parent.next_line.__alignment_count)},i.prototype._should_wrap=function(){return this.__wrap_point_index&&this.__character_count>this.__parent.wrap_line_length&&this.__wrap_point_character_count>this.__parent.next_line.__character_count},i.prototype._allow_wrap=function(){if(this._should_wrap()){this.__parent.add_new_line();var t=this.__parent.current_line;return t.set_indent(this.__wrap_point_indent_count,this.__wrap_point_alignment_count),t.__items=this.__items.slice(this.__wrap_point_index),this.__items=this.__items.slice(0,this.__wrap_point_index),t.__character_count+=this.__character_count-this.__wrap_point_character_count,this.__character_count=this.__wrap_point_character_count," "===t.__items[0]&&(t.__items.splice(0,1),t.__character_count-=1),!0}return!1},i.prototype.is_empty=function(){return 0===this.__items.length},i.prototype.last=function(){return this.is_empty()?null:this.__items[this.__items.length-1]},i.prototype.push=function(t){this.__items.push(t);var e=t.lastIndexOf("\n");-1!==e?this.__character_count=t.length-e:this.__character_count+=t.length},i.prototype.pop=function(){var t=null;return this.is_empty()||(t=this.__items.pop(),this.__character_count-=t.length),t},i.prototype._remove_indent=function(){this.__indent_count>0&&(this.__indent_count-=1,this.__character_count-=this.__parent.indent_size)},i.prototype._remove_wrap_indent=function(){this.__wrap_point_indent_count>0&&(this.__wrap_point_indent_count-=1)},i.prototype.trim=function(){for(;" "===this.last();)this.__items.pop(),this.__character_count-=1},i.prototype.toString=function(){var t="";return this.is_empty()?this.__parent.indent_empty_lines&&(t=this.__parent.get_indent_string(this.__indent_count)):(t=this.__parent.get_indent_string(this.__indent_count,this.__alignment_count),t+=this.__items.join("")),t},r.prototype.get_indent_size=function(t,e){var n=this.__base_string_length;return e=e||0,t<0&&(n=0),(n+=t*this.__indent_size)+e},r.prototype.get_indent_string=function(t,e){var n=this.__base_string;return e=e||0,t<0&&(t=0,n=""),e+=t*this.__indent_size,this.__ensure_cache(e),n+this.__cache[e]},r.prototype.__ensure_cache=function(t){for(;t>=this.__cache.length;)this.__add_column()},r.prototype.__add_column=function(){var t=this.__cache.length,e=0,n="";this.__indent_size&&t>=this.__indent_size&&(t-=(e=Math.floor(t/this.__indent_size))*this.__indent_size,n=new Array(e+1).join(this.__indent_string)),t&&(n+=new Array(t+1).join(" ")),this.__cache.push(n)},s.prototype.__add_outputline=function(){this.previous_line=this.current_line,this.current_line=this.next_line.clone_empty(),this.__lines.push(this.current_line)},s.prototype.get_line_number=function(){return this.__lines.length},s.prototype.get_indent_string=function(t,e){return this.__indent_cache.get_indent_string(t,e)},s.prototype.get_indent_size=function(t,e){return this.__indent_cache.get_indent_size(t,e)},s.prototype.is_empty=function(){return!this.previous_line&&this.current_line.is_empty()},s.prototype.add_new_line=function(t){return!(this.is_empty()||!t&&this.just_added_newline()||(this.raw||this.__add_outputline(),0))},s.prototype.get_code=function(t){this.trim(!0);var e=this.current_line.pop();e&&("\n"===e[e.length-1]&&(e=e.replace(/\n+$/g,"")),this.current_line.push(e)),this._end_with_newline&&this.__add_outputline();var n=this.__lines.join("\n");return"\n"!==t&&(n=n.replace(/[\n]/g,t)),n},s.prototype.set_wrap_point=function(){this.current_line._set_wrap_point()},s.prototype.set_indent=function(t,e){return t=t||0,e=e||0,this.next_line.set_indent(t,e),this.__lines.length>1?(this.current_line.set_indent(t,e),!0):(this.current_line.set_indent(),!1)},s.prototype.add_raw_token=function(t){for(var e=0;e<t.newlines;e++)this.__add_outputline();this.current_line.set_indent(-1),this.current_line.push(t.whitespace_before),this.current_line.push(t.text),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1},s.prototype.add_token=function(t){this.__add_space_before_token(),this.current_line.push(t),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=this.current_line._allow_wrap()},s.prototype.__add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&(this.non_breaking_space||this.set_wrap_point(),this.current_line.push(" "))},s.prototype.remove_indent=function(t){for(var e=this.__lines.length;t<e;)this.__lines[t]._remove_indent(),t++;this.current_line._remove_wrap_indent()},s.prototype.trim=function(t){for(t=void 0!==t&&t,this.current_line.trim();t&&this.__lines.length>1&&this.current_line.is_empty();)this.__lines.pop(),this.current_line=this.__lines[this.__lines.length-1],this.current_line.trim();this.previous_line=this.__lines.length>1?this.__lines[this.__lines.length-2]:null},s.prototype.just_added_newline=function(){return this.current_line.is_empty()},s.prototype.just_added_blankline=function(){return this.is_empty()||this.current_line.is_empty()&&this.previous_line.is_empty()},s.prototype.ensure_empty_line_above=function(t,e){for(var n=this.__lines.length-2;n>=0;){var r=this.__lines[n];if(r.is_empty())break;if(0!==r.item(0).indexOf(t)&&r.item(-1)!==e){this.__lines.splice(n+1,0,new i(this)),this.previous_line=this.__lines[this.__lines.length-2];break}n--}},t.exports.Output=s},function(t,e,n){"use strict";t.exports.Token=function(t,e,n,i){this.type=t,this.text=e,this.comments_before=null,this.newlines=n||0,this.whitespace_before=i||"",this.parent=null,this.next=null,this.previous=null,this.opened=null,this.closed=null,this.directives=null}},function(t,e,n){"use strict";var i="\\xaa\\xb5\\xba\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u02c1\\u02c6-\\u02d1\\u02e0-\\u02e4\\u02ec\\u02ee\\u0370-\\u0374\\u0376\\u0377\\u037a-\\u037d\\u0386\\u0388-\\u038a\\u038c\\u038e-\\u03a1\\u03a3-\\u03f5\\u03f7-\\u0481\\u048a-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05d0-\\u05ea\\u05f0-\\u05f2\\u0620-\\u064a\\u066e\\u066f\\u0671-\\u06d3\\u06d5\\u06e5\\u06e6\\u06ee\\u06ef\\u06fa-\\u06fc\\u06ff\\u0710\\u0712-\\u072f\\u074d-\\u07a5\\u07b1\\u07ca-\\u07ea\\u07f4\\u07f5\\u07fa\\u0800-\\u0815\\u081a\\u0824\\u0828\\u0840-\\u0858\\u08a0\\u08a2-\\u08ac\\u0904-\\u0939\\u093d\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097f\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bd\\u09ce\\u09dc\\u09dd\\u09df-\\u09e1\\u09f0\\u09f1\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a59-\\u0a5c\\u0a5e\\u0a72-\\u0a74\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abd\\u0ad0\\u0ae0\\u0ae1\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3d\\u0b5c\\u0b5d\\u0b5f-\\u0b61\\u0b71\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bd0\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c33\\u0c35-\\u0c39\\u0c3d\\u0c58\\u0c59\\u0c60\\u0c61\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbd\\u0cde\\u0ce0\\u0ce1\\u0cf1\\u0cf2\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d\\u0d4e\\u0d60\\u0d61\\u0d7a-\\u0d7f\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0e01-\\u0e30\\u0e32\\u0e33\\u0e40-\\u0e46\\u0e81\\u0e82\\u0e84\\u0e87\\u0e88\\u0e8a\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5\\u0ea7\\u0eaa\\u0eab\\u0ead-\\u0eb0\\u0eb2\\u0eb3\\u0ebd\\u0ec0-\\u0ec4\\u0ec6\\u0edc-\\u0edf\\u0f00\\u0f40-\\u0f47\\u0f49-\\u0f6c\\u0f88-\\u0f8c\\u1000-\\u102a\\u103f\\u1050-\\u1055\\u105a-\\u105d\\u1061\\u1065\\u1066\\u106e-\\u1070\\u1075-\\u1081\\u108e\\u10a0-\\u10c5\\u10c7\\u10cd\\u10d0-\\u10fa\\u10fc-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u1380-\\u138f\\u13a0-\\u13f4\\u1401-\\u166c\\u166f-\\u167f\\u1681-\\u169a\\u16a0-\\u16ea\\u16ee-\\u16f0\\u1700-\\u170c\\u170e-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176c\\u176e-\\u1770\\u1780-\\u17b3\\u17d7\\u17dc\\u1820-\\u1877\\u1880-\\u18a8\\u18aa\\u18b0-\\u18f5\\u1900-\\u191c\\u1950-\\u196d\\u1970-\\u1974\\u1980-\\u19ab\\u19c1-\\u19c7\\u1a00-\\u1a16\\u1a20-\\u1a54\\u1aa7\\u1b05-\\u1b33\\u1b45-\\u1b4b\\u1b83-\\u1ba0\\u1bae\\u1baf\\u1bba-\\u1be5\\u1c00-\\u1c23\\u1c4d-\\u1c4f\\u1c5a-\\u1c7d\\u1ce9-\\u1cec\\u1cee-\\u1cf1\\u1cf5\\u1cf6\\u1d00-\\u1dbf\\u1e00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59\\u1f5b\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fbc\\u1fbe\\u1fc2-\\u1fc4\\u1fc6-\\u1fcc\\u1fd0-\\u1fd3\\u1fd6-\\u1fdb\\u1fe0-\\u1fec\\u1ff2-\\u1ff4\\u1ff6-\\u1ffc\\u2071\\u207f\\u2090-\\u209c\\u2102\\u2107\\u210a-\\u2113\\u2115\\u2119-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u212d\\u212f-\\u2139\\u213c-\\u213f\\u2145-\\u2149\\u214e\\u2160-\\u2188\\u2c00-\\u2c2e\\u2c30-\\u2c5e\\u2c60-\\u2ce4\\u2ceb-\\u2cee\\u2cf2\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\u2d30-\\u2d67\\u2d6f\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\u2e2f\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303c\\u3041-\\u3096\\u309d-\\u309f\\u30a1-\\u30fa\\u30fc-\\u30ff\\u3105-\\u312d\\u3131-\\u318e\\u31a0-\\u31ba\\u31f0-\\u31ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\ua000-\\ua48c\\ua4d0-\\ua4fd\\ua500-\\ua60c\\ua610-\\ua61f\\ua62a\\ua62b\\ua640-\\ua66e\\ua67f-\\ua697\\ua6a0-\\ua6ef\\ua717-\\ua71f\\ua722-\\ua788\\ua78b-\\ua78e\\ua790-\\ua793\\ua7a0-\\ua7aa\\ua7f8-\\ua801\\ua803-\\ua805\\ua807-\\ua80a\\ua80c-\\ua822\\ua840-\\ua873\\ua882-\\ua8b3\\ua8f2-\\ua8f7\\ua8fb\\ua90a-\\ua925\\ua930-\\ua946\\ua960-\\ua97c\\ua984-\\ua9b2\\ua9cf\\uaa00-\\uaa28\\uaa40-\\uaa42\\uaa44-\\uaa4b\\uaa60-\\uaa76\\uaa7a\\uaa80-\\uaaaf\\uaab1\\uaab5\\uaab6\\uaab9-\\uaabd\\uaac0\\uaac2\\uaadb-\\uaadd\\uaae0-\\uaaea\\uaaf2-\\uaaf4\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e\\uabc0-\\uabe2\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uf900-\\ufa6d\\ufa70-\\ufad9\\ufb00-\\ufb06\\ufb13-\\ufb17\\ufb1d\\ufb1f-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc",r="(?:\\\\u[0-9a-fA-F]{4}|[\\x23\\x24\\x40\\x41-\\x5a\\x5f\\x61-\\x7a"+i+"])";e.identifier=new RegExp(r+"(?:\\\\u[0-9a-fA-F]{4}|[\\x24\\x30-\\x39\\x41-\\x5a\\x5f\\x61-\\x7a\\xaa\\xb5\\xba\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u02c1\\u02c6-\\u02d1\\u02e0-\\u02e4\\u02ec\\u02ee\\u0370-\\u0374\\u0376\\u0377\\u037a-\\u037d\\u0386\\u0388-\\u038a\\u038c\\u038e-\\u03a1\\u03a3-\\u03f5\\u03f7-\\u0481\\u048a-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05d0-\\u05ea\\u05f0-\\u05f2\\u0620-\\u064a\\u066e\\u066f\\u0671-\\u06d3\\u06d5\\u06e5\\u06e6\\u06ee\\u06ef\\u06fa-\\u06fc\\u06ff\\u0710\\u0712-\\u072f\\u074d-\\u07a5\\u07b1\\u07ca-\\u07ea\\u07f4\\u07f5\\u07fa\\u0800-\\u0815\\u081a\\u0824\\u0828\\u0840-\\u0858\\u08a0\\u08a2-\\u08ac\\u0904-\\u0939\\u093d\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097f\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bd\\u09ce\\u09dc\\u09dd\\u09df-\\u09e1\\u09f0\\u09f1\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a59-\\u0a5c\\u0a5e\\u0a72-\\u0a74\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abd\\u0ad0\\u0ae0\\u0ae1\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3d\\u0b5c\\u0b5d\\u0b5f-\\u0b61\\u0b71\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bd0\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c33\\u0c35-\\u0c39\\u0c3d\\u0c58\\u0c59\\u0c60\\u0c61\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbd\\u0cde\\u0ce0\\u0ce1\\u0cf1\\u0cf2\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d\\u0d4e\\u0d60\\u0d61\\u0d7a-\\u0d7f\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0e01-\\u0e30\\u0e32\\u0e33\\u0e40-\\u0e46\\u0e81\\u0e82\\u0e84\\u0e87\\u0e88\\u0e8a\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5\\u0ea7\\u0eaa\\u0eab\\u0ead-\\u0eb0\\u0eb2\\u0eb3\\u0ebd\\u0ec0-\\u0ec4\\u0ec6\\u0edc-\\u0edf\\u0f00\\u0f40-\\u0f47\\u0f49-\\u0f6c\\u0f88-\\u0f8c\\u1000-\\u102a\\u103f\\u1050-\\u1055\\u105a-\\u105d\\u1061\\u1065\\u1066\\u106e-\\u1070\\u1075-\\u1081\\u108e\\u10a0-\\u10c5\\u10c7\\u10cd\\u10d0-\\u10fa\\u10fc-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u1380-\\u138f\\u13a0-\\u13f4\\u1401-\\u166c\\u166f-\\u167f\\u1681-\\u169a\\u16a0-\\u16ea\\u16ee-\\u16f0\\u1700-\\u170c\\u170e-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176c\\u176e-\\u1770\\u1780-\\u17b3\\u17d7\\u17dc\\u1820-\\u1877\\u1880-\\u18a8\\u18aa\\u18b0-\\u18f5\\u1900-\\u191c\\u1950-\\u196d\\u1970-\\u1974\\u1980-\\u19ab\\u19c1-\\u19c7\\u1a00-\\u1a16\\u1a20-\\u1a54\\u1aa7\\u1b05-\\u1b33\\u1b45-\\u1b4b\\u1b83-\\u1ba0\\u1bae\\u1baf\\u1bba-\\u1be5\\u1c00-\\u1c23\\u1c4d-\\u1c4f\\u1c5a-\\u1c7d\\u1ce9-\\u1cec\\u1cee-\\u1cf1\\u1cf5\\u1cf6\\u1d00-\\u1dbf\\u1e00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59\\u1f5b\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fbc\\u1fbe\\u1fc2-\\u1fc4\\u1fc6-\\u1fcc\\u1fd0-\\u1fd3\\u1fd6-\\u1fdb\\u1fe0-\\u1fec\\u1ff2-\\u1ff4\\u1ff6-\\u1ffc\\u2071\\u207f\\u2090-\\u209c\\u2102\\u2107\\u210a-\\u2113\\u2115\\u2119-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u212d\\u212f-\\u2139\\u213c-\\u213f\\u2145-\\u2149\\u214e\\u2160-\\u2188\\u2c00-\\u2c2e\\u2c30-\\u2c5e\\u2c60-\\u2ce4\\u2ceb-\\u2cee\\u2cf2\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\u2d30-\\u2d67\\u2d6f\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\u2e2f\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303c\\u3041-\\u3096\\u309d-\\u309f\\u30a1-\\u30fa\\u30fc-\\u30ff\\u3105-\\u312d\\u3131-\\u318e\\u31a0-\\u31ba\\u31f0-\\u31ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\ua000-\\ua48c\\ua4d0-\\ua4fd\\ua500-\\ua60c\\ua610-\\ua61f\\ua62a\\ua62b\\ua640-\\ua66e\\ua67f-\\ua697\\ua6a0-\\ua6ef\\ua717-\\ua71f\\ua722-\\ua788\\ua78b-\\ua78e\\ua790-\\ua793\\ua7a0-\\ua7aa\\ua7f8-\\ua801\\ua803-\\ua805\\ua807-\\ua80a\\ua80c-\\ua822\\ua840-\\ua873\\ua882-\\ua8b3\\ua8f2-\\ua8f7\\ua8fb\\ua90a-\\ua925\\ua930-\\ua946\\ua960-\\ua97c\\ua984-\\ua9b2\\ua9cf\\uaa00-\\uaa28\\uaa40-\\uaa42\\uaa44-\\uaa4b\\uaa60-\\uaa76\\uaa7a\\uaa80-\\uaaaf\\uaab1\\uaab5\\uaab6\\uaab9-\\uaabd\\uaac0\\uaac2\\uaadb-\\uaadd\\uaae0-\\uaaea\\uaaf2-\\uaaf4\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e\\uabc0-\\uabe2\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uf900-\\ufa6d\\ufa70-\\ufad9\\ufb00-\\ufb06\\ufb13-\\ufb17\\ufb1d\\ufb1f-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc\\u0300-\\u036f\\u0483-\\u0487\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u0620-\\u0649\\u0672-\\u06d3\\u06e7-\\u06e8\\u06fb-\\u06fc\\u0730-\\u074a\\u0800-\\u0814\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0840-\\u0857\\u08e4-\\u08fe\\u0900-\\u0903\\u093a-\\u093c\\u093e-\\u094f\\u0951-\\u0957\\u0962-\\u0963\\u0966-\\u096f\\u0981-\\u0983\\u09bc\\u09be-\\u09c4\\u09c7\\u09c8\\u09d7\\u09df-\\u09e0\\u0a01-\\u0a03\\u0a3c\\u0a3e-\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a66-\\u0a71\\u0a75\\u0a81-\\u0a83\\u0abc\\u0abe-\\u0ac5\\u0ac7-\\u0ac9\\u0acb-\\u0acd\\u0ae2-\\u0ae3\\u0ae6-\\u0aef\\u0b01-\\u0b03\\u0b3c\\u0b3e-\\u0b44\\u0b47\\u0b48\\u0b4b-\\u0b4d\\u0b56\\u0b57\\u0b5f-\\u0b60\\u0b66-\\u0b6f\\u0b82\\u0bbe-\\u0bc2\\u0bc6-\\u0bc8\\u0bca-\\u0bcd\\u0bd7\\u0be6-\\u0bef\\u0c01-\\u0c03\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62-\\u0c63\\u0c66-\\u0c6f\\u0c82\\u0c83\\u0cbc\\u0cbe-\\u0cc4\\u0cc6-\\u0cc8\\u0cca-\\u0ccd\\u0cd5\\u0cd6\\u0ce2-\\u0ce3\\u0ce6-\\u0cef\\u0d02\\u0d03\\u0d46-\\u0d48\\u0d57\\u0d62-\\u0d63\\u0d66-\\u0d6f\\u0d82\\u0d83\\u0dca\\u0dcf-\\u0dd4\\u0dd6\\u0dd8-\\u0ddf\\u0df2\\u0df3\\u0e34-\\u0e3a\\u0e40-\\u0e45\\u0e50-\\u0e59\\u0eb4-\\u0eb9\\u0ec8-\\u0ecd\\u0ed0-\\u0ed9\\u0f18\\u0f19\\u0f20-\\u0f29\\u0f35\\u0f37\\u0f39\\u0f41-\\u0f47\\u0f71-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u1000-\\u1029\\u1040-\\u1049\\u1067-\\u106d\\u1071-\\u1074\\u1082-\\u108d\\u108f-\\u109d\\u135d-\\u135f\\u170e-\\u1710\\u1720-\\u1730\\u1740-\\u1750\\u1772\\u1773\\u1780-\\u17b2\\u17dd\\u17e0-\\u17e9\\u180b-\\u180d\\u1810-\\u1819\\u1920-\\u192b\\u1930-\\u193b\\u1951-\\u196d\\u19b0-\\u19c0\\u19c8-\\u19c9\\u19d0-\\u19d9\\u1a00-\\u1a15\\u1a20-\\u1a53\\u1a60-\\u1a7c\\u1a7f-\\u1a89\\u1a90-\\u1a99\\u1b46-\\u1b4b\\u1b50-\\u1b59\\u1b6b-\\u1b73\\u1bb0-\\u1bb9\\u1be6-\\u1bf3\\u1c00-\\u1c22\\u1c40-\\u1c49\\u1c5b-\\u1c7d\\u1cd0-\\u1cd2\\u1d00-\\u1dbe\\u1e01-\\u1f15\\u200c\\u200d\\u203f\\u2040\\u2054\\u20d0-\\u20dc\\u20e1\\u20e5-\\u20f0\\u2d81-\\u2d96\\u2de0-\\u2dff\\u3021-\\u3028\\u3099\\u309a\\ua640-\\ua66d\\ua674-\\ua67d\\ua69f\\ua6f0-\\ua6f1\\ua7f8-\\ua800\\ua806\\ua80b\\ua823-\\ua827\\ua880-\\ua881\\ua8b4-\\ua8c4\\ua8d0-\\ua8d9\\ua8f3-\\ua8f7\\ua900-\\ua909\\ua926-\\ua92d\\ua930-\\ua945\\ua980-\\ua983\\ua9b3-\\ua9c0\\uaa00-\\uaa27\\uaa40-\\uaa41\\uaa4c-\\uaa4d\\uaa50-\\uaa59\\uaa7b\\uaae0-\\uaae9\\uaaf2-\\uaaf3\\uabc0-\\uabe1\\uabec\\uabed\\uabf0-\\uabf9\\ufb20-\\ufb28\\ufe00-\\ufe0f\\ufe20-\\ufe26\\ufe33\\ufe34\\ufe4d-\\ufe4f\\uff10-\\uff19\\uff3f])*","g"),e.identifierStart=new RegExp(r),e.identifierMatch=new RegExp("(?:\\\\u[0-9a-fA-F]{4}|[\\x24\\x30-\\x39\\x41-\\x5a\\x5f\\x61-\\x7a"+i+"\\u0300-\\u036f\\u0483-\\u0487\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u0620-\\u0649\\u0672-\\u06d3\\u06e7-\\u06e8\\u06fb-\\u06fc\\u0730-\\u074a\\u0800-\\u0814\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0840-\\u0857\\u08e4-\\u08fe\\u0900-\\u0903\\u093a-\\u093c\\u093e-\\u094f\\u0951-\\u0957\\u0962-\\u0963\\u0966-\\u096f\\u0981-\\u0983\\u09bc\\u09be-\\u09c4\\u09c7\\u09c8\\u09d7\\u09df-\\u09e0\\u0a01-\\u0a03\\u0a3c\\u0a3e-\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a66-\\u0a71\\u0a75\\u0a81-\\u0a83\\u0abc\\u0abe-\\u0ac5\\u0ac7-\\u0ac9\\u0acb-\\u0acd\\u0ae2-\\u0ae3\\u0ae6-\\u0aef\\u0b01-\\u0b03\\u0b3c\\u0b3e-\\u0b44\\u0b47\\u0b48\\u0b4b-\\u0b4d\\u0b56\\u0b57\\u0b5f-\\u0b60\\u0b66-\\u0b6f\\u0b82\\u0bbe-\\u0bc2\\u0bc6-\\u0bc8\\u0bca-\\u0bcd\\u0bd7\\u0be6-\\u0bef\\u0c01-\\u0c03\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62-\\u0c63\\u0c66-\\u0c6f\\u0c82\\u0c83\\u0cbc\\u0cbe-\\u0cc4\\u0cc6-\\u0cc8\\u0cca-\\u0ccd\\u0cd5\\u0cd6\\u0ce2-\\u0ce3\\u0ce6-\\u0cef\\u0d02\\u0d03\\u0d46-\\u0d48\\u0d57\\u0d62-\\u0d63\\u0d66-\\u0d6f\\u0d82\\u0d83\\u0dca\\u0dcf-\\u0dd4\\u0dd6\\u0dd8-\\u0ddf\\u0df2\\u0df3\\u0e34-\\u0e3a\\u0e40-\\u0e45\\u0e50-\\u0e59\\u0eb4-\\u0eb9\\u0ec8-\\u0ecd\\u0ed0-\\u0ed9\\u0f18\\u0f19\\u0f20-\\u0f29\\u0f35\\u0f37\\u0f39\\u0f41-\\u0f47\\u0f71-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u1000-\\u1029\\u1040-\\u1049\\u1067-\\u106d\\u1071-\\u1074\\u1082-\\u108d\\u108f-\\u109d\\u135d-\\u135f\\u170e-\\u1710\\u1720-\\u1730\\u1740-\\u1750\\u1772\\u1773\\u1780-\\u17b2\\u17dd\\u17e0-\\u17e9\\u180b-\\u180d\\u1810-\\u1819\\u1920-\\u192b\\u1930-\\u193b\\u1951-\\u196d\\u19b0-\\u19c0\\u19c8-\\u19c9\\u19d0-\\u19d9\\u1a00-\\u1a15\\u1a20-\\u1a53\\u1a60-\\u1a7c\\u1a7f-\\u1a89\\u1a90-\\u1a99\\u1b46-\\u1b4b\\u1b50-\\u1b59\\u1b6b-\\u1b73\\u1bb0-\\u1bb9\\u1be6-\\u1bf3\\u1c00-\\u1c22\\u1c40-\\u1c49\\u1c5b-\\u1c7d\\u1cd0-\\u1cd2\\u1d00-\\u1dbe\\u1e01-\\u1f15\\u200c\\u200d\\u203f\\u2040\\u2054\\u20d0-\\u20dc\\u20e1\\u20e5-\\u20f0\\u2d81-\\u2d96\\u2de0-\\u2dff\\u3021-\\u3028\\u3099\\u309a\\ua640-\\ua66d\\ua674-\\ua67d\\ua69f\\ua6f0-\\ua6f1\\ua7f8-\\ua800\\ua806\\ua80b\\ua823-\\ua827\\ua880-\\ua881\\ua8b4-\\ua8c4\\ua8d0-\\ua8d9\\ua8f3-\\ua8f7\\ua900-\\ua909\\ua926-\\ua92d\\ua930-\\ua945\\ua980-\\ua983\\ua9b3-\\ua9c0\\uaa00-\\uaa27\\uaa40-\\uaa41\\uaa4c-\\uaa4d\\uaa50-\\uaa59\\uaa7b\\uaae0-\\uaae9\\uaaf2-\\uaaf3\\uabc0-\\uabe1\\uabec\\uabed\\uabf0-\\uabf9\\ufb20-\\ufb28\\ufe00-\\ufe0f\\ufe20-\\ufe26\\ufe33\\ufe34\\ufe4d-\\ufe4f\\uff10-\\uff19\\uff3f])+"),e.newline=/[\n\r\u2028\u2029]/,e.lineBreak=new RegExp("\r\n|"+e.newline.source),e.allLineBreaks=new RegExp(e.lineBreak.source,"g")},function(t,e,n){"use strict";var i=n(6).Options,r=["before-newline","after-newline","preserve-newline"];function s(t){i.call(this,t,"js");var e=this.raw_options.brace_style||null;"expand-strict"===e?this.raw_options.brace_style="expand":"collapse-preserve-inline"===e?this.raw_options.brace_style="collapse,preserve-inline":void 0!==this.raw_options.braces_on_own_line&&(this.raw_options.brace_style=this.raw_options.braces_on_own_line?"expand":"collapse");var n=this._get_selection_list("brace_style",["collapse","expand","end-expand","none","preserve-inline"]);this.brace_preserve_inline=!1,this.brace_style="collapse";for(var s=0;s<n.length;s++)"preserve-inline"===n[s]?this.brace_preserve_inline=!0:this.brace_style=n[s];this.unindent_chained_methods=this._get_boolean("unindent_chained_methods"),this.break_chained_methods=this._get_boolean("break_chained_methods"),this.space_in_paren=this._get_boolean("space_in_paren"),this.space_in_empty_paren=this._get_boolean("space_in_empty_paren"),this.jslint_happy=this._get_boolean("jslint_happy"),this.space_after_anon_function=this._get_boolean("space_after_anon_function"),this.space_after_named_function=this._get_boolean("space_after_named_function"),this.keep_array_indentation=this._get_boolean("keep_array_indentation"),this.space_before_conditional=this._get_boolean("space_before_conditional",!0),this.unescape_strings=this._get_boolean("unescape_strings"),this.e4x=this._get_boolean("e4x"),this.comma_first=this._get_boolean("comma_first"),this.operator_position=this._get_selection("operator_position",r),this.test_output_raw=this._get_boolean("test_output_raw"),this.jslint_happy&&(this.space_after_anon_function=!0)}s.prototype=new i,t.exports.Options=s},function(t,e,n){"use strict";function i(t,e){this.raw_options=r(t,e),this.disabled=this._get_boolean("disabled"),this.eol=this._get_characters("eol","auto"),this.end_with_newline=this._get_boolean("end_with_newline"),this.indent_size=this._get_number("indent_size",4),this.indent_char=this._get_characters("indent_char"," "),this.indent_level=this._get_number("indent_level"),this.preserve_newlines=this._get_boolean("preserve_newlines",!0),this.max_preserve_newlines=this._get_number("max_preserve_newlines",32786),this.preserve_newlines||(this.max_preserve_newlines=0),this.indent_with_tabs=this._get_boolean("indent_with_tabs","\t"===this.indent_char),this.indent_with_tabs&&(this.indent_char="\t",1===this.indent_size&&(this.indent_size=4)),this.wrap_line_length=this._get_number("wrap_line_length",this._get_number("max_char")),this.indent_empty_lines=this._get_boolean("indent_empty_lines"),this.templating=this._get_selection_list("templating",["auto","none","django","erb","handlebars","php","smarty"],["auto"])}function r(t,e){var n,i={};for(n in t=s(t))n!==e&&(i[n]=t[n]);if(e&&t[e])for(n in t[e])i[n]=t[e][n];return i}function s(t){var e,n={};for(e in t)n[e.replace(/-/g,"_")]=t[e];return n}i.prototype._get_array=function(t,e){var n=this.raw_options[t],i=e||[];return"object"==typeof n?null!==n&&"function"==typeof n.concat&&(i=n.concat()):"string"==typeof n&&(i=n.split(/[^a-zA-Z0-9_\/\-]+/)),i},i.prototype._get_boolean=function(t,e){var n=this.raw_options[t];return void 0===n?!!e:!!n},i.prototype._get_characters=function(t,e){var n=this.raw_options[t],i=e||"";return"string"==typeof n&&(i=n.replace(/\\r/,"\r").replace(/\\n/,"\n").replace(/\\t/,"\t")),i},i.prototype._get_number=function(t,e){var n=this.raw_options[t];e=parseInt(e,10),isNaN(e)&&(e=0);var i=parseInt(n,10);return isNaN(i)&&(i=e),i},i.prototype._get_selection=function(t,e,n){var i=this._get_selection_list(t,e,n);if(1!==i.length)throw new Error("Invalid Option Value: The option '"+t+"' can only be one of the following values:\n"+e+"\nYou passed in: '"+this.raw_options[t]+"'");return i[0]},i.prototype._get_selection_list=function(t,e,n){if(!e||0===e.length)throw new Error("Selection list cannot be empty.");if(n=n||[e[0]],!this._is_valid_selection(n,e))throw new Error("Invalid Default Value!");var i=this._get_array(t,n);if(!this._is_valid_selection(i,e))throw new Error("Invalid Option Value: The option '"+t+"' can contain only the following values:\n"+e+"\nYou passed in: '"+this.raw_options[t]+"'");return i},i.prototype._is_valid_selection=function(t,e){return t.length&&e.length&&!t.some((function(t){return-1===e.indexOf(t)}))},t.exports.Options=i,t.exports.normalizeOpts=s,t.exports.mergeOpts=r},function(t,e,n){"use strict";var i=n(8).InputScanner,r=n(9).Tokenizer,s=n(9).TOKEN,a=n(13).Directives,o=n(4),u=n(12).Pattern,c=n(14).TemplatablePattern;function h(t,e){return-1!==e.indexOf(t)}var p={START_EXPR:"TK_START_EXPR",END_EXPR:"TK_END_EXPR",START_BLOCK:"TK_START_BLOCK",END_BLOCK:"TK_END_BLOCK",WORD:"TK_WORD",RESERVED:"TK_RESERVED",SEMICOLON:"TK_SEMICOLON",STRING:"TK_STRING",EQUALS:"TK_EQUALS",OPERATOR:"TK_OPERATOR",COMMA:"TK_COMMA",BLOCK_COMMENT:"TK_BLOCK_COMMENT",COMMENT:"TK_COMMENT",DOT:"TK_DOT",UNKNOWN:"TK_UNKNOWN",START:s.START,RAW:s.RAW,EOF:s.EOF},_=new a(/\/\*/,/\*\//),l=/0[xX][0123456789abcdefABCDEF]*|0[oO][01234567]*|0[bB][01]*|\d+n|(?:\.\d+|\d+\.?\d*)(?:[eE][+-]?\d+)?/,d=/[0-9]/,f=/[^\d\.]/,m=">>> === !== << && >= ** != == <= >> || ?? |> < / - + > : & % ? ^ | *".split(" "),g=">>>= ... >>= <<= === >>> !== **= => ^= :: /= << <= == && -= >= >> != -- += ** || ?? ++ %= &= *= |= |> = ! ? > < : / ^ - + * & % ~ |";g=(g="\\?\\.(?!\\d) "+(g=g.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&"))).replace(/ /g,"|");var v,y=new RegExp(g),b="continue,try,throw,return,var,let,const,if,switch,case,default,for,while,break,function,import,export".split(","),w=b.concat(["do","in","of","else","get","set","new","catch","finally","typeof","yield","async","await","from","as"]),x=new RegExp("^(?:"+w.join("|")+")$"),k=function(t,e){r.call(this,t,e),this._patterns.whitespace=this._patterns.whitespace.matching(/\u00A0\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff/.source,/\u2028\u2029/.source);var n=new u(this._input),i=new c(this._input).read_options(this._options);this.__patterns={template:i,identifier:i.starting_with(o.identifier).matching(o.identifierMatch),number:n.matching(l),punct:n.matching(y),comment:n.starting_with(/\/\//).until(/[\n\r\u2028\u2029]/),block_comment:n.starting_with(/\/\*/).until_after(/\*\//),html_comment_start:n.matching(/<!--/),html_comment_end:n.matching(/-->/),include:n.starting_with(/#include/).until_after(o.lineBreak),shebang:n.starting_with(/#!/).until_after(o.lineBreak),xml:n.matching(/[\s\S]*?<(\/?)([-a-zA-Z:0-9_.]+|{[\s\S]+?}|!\[CDATA\[[\s\S]*?\]\]|)(\s+{[\s\S]+?}|\s+[-a-zA-Z:0-9_.]+|\s+[-a-zA-Z:0-9_.]+\s*=\s*('[^']*'|"[^"]*"|{[\s\S]+?}))*\s*(\/?)\s*>/),single_quote:i.until(/['\\\n\r\u2028\u2029]/),double_quote:i.until(/["\\\n\r\u2028\u2029]/),template_text:i.until(/[`\\$]/),template_expression:i.until(/[`}\\]/)}};(k.prototype=new r)._is_comment=function(t){return t.type===p.COMMENT||t.type===p.BLOCK_COMMENT||t.type===p.UNKNOWN},k.prototype._is_opening=function(t){return t.type===p.START_BLOCK||t.type===p.START_EXPR},k.prototype._is_closing=function(t,e){return(t.type===p.END_BLOCK||t.type===p.END_EXPR)&&e&&("]"===t.text&&"["===e.text||")"===t.text&&"("===e.text||"}"===t.text&&"{"===e.text)},k.prototype._reset=function(){v=!1},k.prototype._get_next_token=function(t,e){var n=null;this._readWhitespace();var i=this._input.peek();return null===i?this._create_token(p.EOF,""):n=(n=(n=(n=(n=(n=(n=(n=(n=n||this._read_non_javascript(i))||this._read_string(i))||this._read_word(t))||this._read_singles(i))||this._read_comment(i))||this._read_regexp(i,t))||this._read_xml(i,t))||this._read_punctuation())||this._create_token(p.UNKNOWN,this._input.next())},k.prototype._read_word=function(t){var e;return""!==(e=this.__patterns.identifier.read())?(e=e.replace(o.allLineBreaks,"\n"),t.type!==p.DOT&&(t.type!==p.RESERVED||"set"!==t.text&&"get"!==t.text)&&x.test(e)?"in"===e||"of"===e?this._create_token(p.OPERATOR,e):this._create_token(p.RESERVED,e):this._create_token(p.WORD,e)):""!==(e=this.__patterns.number.read())?this._create_token(p.WORD,e):void 0},k.prototype._read_singles=function(t){var e=null;return"("===t||"["===t?e=this._create_token(p.START_EXPR,t):")"===t||"]"===t?e=this._create_token(p.END_EXPR,t):"{"===t?e=this._create_token(p.START_BLOCK,t):"}"===t?e=this._create_token(p.END_BLOCK,t):";"===t?e=this._create_token(p.SEMICOLON,t):"."===t&&f.test(this._input.peek(1))?e=this._create_token(p.DOT,t):","===t&&(e=this._create_token(p.COMMA,t)),e&&this._input.next(),e},k.prototype._read_punctuation=function(){var t=this.__patterns.punct.read();if(""!==t)return"="===t?this._create_token(p.EQUALS,t):"?."===t?this._create_token(p.DOT,t):this._create_token(p.OPERATOR,t)},k.prototype._read_non_javascript=function(t){var e="";if("#"===t){if(this._is_first_token()&&(e=this.__patterns.shebang.read()))return this._create_token(p.UNKNOWN,e.trim()+"\n");if(e=this.__patterns.include.read())return this._create_token(p.UNKNOWN,e.trim()+"\n");t=this._input.next();var n="#";if(this._input.hasNext()&&this._input.testChar(d)){do{n+=t=this._input.next()}while(this._input.hasNext()&&"#"!==t&&"="!==t);return"#"===t||("["===this._input.peek()&&"]"===this._input.peek(1)?(n+="[]",this._input.next(),this._input.next()):"{"===this._input.peek()&&"}"===this._input.peek(1)&&(n+="{}",this._input.next(),this._input.next())),this._create_token(p.WORD,n)}this._input.back()}else if("<"===t&&this._is_first_token()){if(e=this.__patterns.html_comment_start.read()){for(;this._input.hasNext()&&!this._input.testChar(o.newline);)e+=this._input.next();return v=!0,this._create_token(p.COMMENT,e)}}else if(v&&"-"===t&&(e=this.__patterns.html_comment_end.read()))return v=!1,this._create_token(p.COMMENT,e);return null},k.prototype._read_comment=function(t){var e=null;if("/"===t){var n="";if("*"===this._input.peek(1)){n=this.__patterns.block_comment.read();var i=_.get_directives(n);i&&"start"===i.ignore&&(n+=_.readIgnored(this._input)),n=n.replace(o.allLineBreaks,"\n"),(e=this._create_token(p.BLOCK_COMMENT,n)).directives=i}else"/"===this._input.peek(1)&&(n=this.__patterns.comment.read(),e=this._create_token(p.COMMENT,n))}return e},k.prototype._read_string=function(t){if("`"===t||"'"===t||'"'===t){var e=this._input.next();return this.has_char_escapes=!1,e+="`"===t?this._read_string_recursive("`",!0,"${"):this._read_string_recursive(t),this.has_char_escapes&&this._options.unescape_strings&&(e=function(t){for(var e="",n=0,r=new i(t),s=null;r.hasNext();)if((s=r.match(/([\s]|[^\\]|\\\\)+/g))&&(e+=s[0]),"\\"===r.peek()){if(r.next(),"x"===r.peek())s=r.match(/x([0-9A-Fa-f]{2})/g);else{if("u"!==r.peek()){e+="\\",r.hasNext()&&(e+=r.next());continue}s=r.match(/u([0-9A-Fa-f]{4})/g)}if(!s)return t;if((n=parseInt(s[1],16))>126&&n<=255&&0===s[0].indexOf("x"))return t;if(n>=0&&n<32){e+="\\"+s[0];continue}e+=34===n||39===n||92===n?"\\"+String.fromCharCode(n):String.fromCharCode(n)}return e}(e)),this._input.peek()===t&&(e+=this._input.next()),e=e.replace(o.allLineBreaks,"\n"),this._create_token(p.STRING,e)}return null},k.prototype._allow_regexp_or_xml=function(t){return t.type===p.RESERVED&&h(t.text,["return","case","throw","else","do","typeof","yield"])||t.type===p.END_EXPR&&")"===t.text&&t.opened.previous.type===p.RESERVED&&h(t.opened.previous.text,["if","while","for"])||h(t.type,[p.COMMENT,p.START_EXPR,p.START_BLOCK,p.START,p.END_BLOCK,p.OPERATOR,p.EQUALS,p.EOF,p.SEMICOLON,p.COMMA])},k.prototype._read_regexp=function(t,e){if("/"===t&&this._allow_regexp_or_xml(e)){for(var n=this._input.next(),i=!1,r=!1;this._input.hasNext()&&(i||r||this._input.peek()!==t)&&!this._input.testChar(o.newline);)n+=this._input.peek(),i?i=!1:(i="\\"===this._input.peek(),"["===this._input.peek()?r=!0:"]"===this._input.peek()&&(r=!1)),this._input.next();return this._input.peek()===t&&(n+=this._input.next(),n+=this._input.read(o.identifier)),this._create_token(p.STRING,n)}return null},k.prototype._read_xml=function(t,e){if(this._options.e4x&&"<"===t&&this._allow_regexp_or_xml(e)){var n="",i=this.__patterns.xml.read_match();if(i){for(var r=i[2].replace(/^{\s+/,"{").replace(/\s+}$/,"}"),s=0===r.indexOf("{"),a=0;i;){var u=!!i[1],c=i[2];if(!(i[i.length-1]||"![CDATA["===c.slice(0,8))&&(c===r||s&&c.replace(/^{\s+/,"{").replace(/\s+}$/,"}"))&&(u?--a:++a),n+=i[0],a<=0)break;i=this.__patterns.xml.read_match()}return i||(n+=this._input.match(/[\s\S]*/g)[0]),n=n.replace(o.allLineBreaks,"\n"),this._create_token(p.STRING,n)}}return null},k.prototype._read_string_recursive=function(t,e,n){var i,r;"'"===t?r=this.__patterns.single_quote:'"'===t?r=this.__patterns.double_quote:"`"===t?r=this.__patterns.template_text:"}"===t&&(r=this.__patterns.template_expression);for(var s=r.read(),a="";this._input.hasNext();){if((a=this._input.next())===t||!e&&o.newline.test(a)){this._input.back();break}"\\"===a&&this._input.hasNext()?("x"===(i=this._input.peek())||"u"===i?this.has_char_escapes=!0:"\r"===i&&"\n"===this._input.peek(1)&&this._input.next(),a+=this._input.next()):n&&("${"===n&&"$"===a&&"{"===this._input.peek()&&(a+=this._input.next()),n===a&&(a+="`"===t?this._read_string_recursive("}",e,"`"):this._read_string_recursive("`",e,"${"),this._input.hasNext()&&(a+=this._input.next()))),s+=a+=r.read()}return s},t.exports.Tokenizer=k,t.exports.TOKEN=p,t.exports.positionable_operators=m.slice(),t.exports.line_starters=b.slice()},function(t,e,n){"use strict";var i=RegExp.prototype.hasOwnProperty("sticky");function r(t){this.__input=t||"",this.__input_length=this.__input.length,this.__position=0}r.prototype.restart=function(){this.__position=0},r.prototype.back=function(){this.__position>0&&(this.__position-=1)},r.prototype.hasNext=function(){return this.__position<this.__input_length},r.prototype.next=function(){var t=null;return this.hasNext()&&(t=this.__input.charAt(this.__position),this.__position+=1),t},r.prototype.peek=function(t){var e=null;return t=t||0,(t+=this.__position)>=0&&t<this.__input_length&&(e=this.__input.charAt(t)),e},r.prototype.__match=function(t,e){t.lastIndex=e;var n=t.exec(this.__input);return!n||i&&t.sticky||n.index!==e&&(n=null),n},r.prototype.test=function(t,e){return e=e||0,(e+=this.__position)>=0&&e<this.__input_length&&!!this.__match(t,e)},r.prototype.testChar=function(t,e){var n=this.peek(e);return t.lastIndex=0,null!==n&&t.test(n)},r.prototype.match=function(t){var e=this.__match(t,this.__position);return e?this.__position+=e[0].length:e=null,e},r.prototype.read=function(t,e,n){var i,r="";return t&&(i=this.match(t))&&(r+=i[0]),!e||!i&&t||(r+=this.readUntil(e,n)),r},r.prototype.readUntil=function(t,e){var n,i=this.__position;t.lastIndex=this.__position;var r=t.exec(this.__input);return r?(i=r.index,e&&(i+=r[0].length)):i=this.__input_length,n=this.__input.substring(this.__position,i),this.__position=i,n},r.prototype.readUntilAfter=function(t){return this.readUntil(t,!0)},r.prototype.get_regexp=function(t,e){var n=null,r="g";return e&&i&&(r="y"),"string"==typeof t&&""!==t?n=new RegExp(t,r):t&&(n=new RegExp(t.source,r)),n},r.prototype.get_literal_regexp=function(t){return RegExp(t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))},r.prototype.peekUntilAfter=function(t){var e=this.__position,n=this.readUntilAfter(t);return this.__position=e,n},r.prototype.lookBack=function(t){var e=this.__position-1;return e>=t.length&&this.__input.substring(e-t.length,e).toLowerCase()===t},t.exports.InputScanner=r},function(t,e,n){"use strict";var i=n(8).InputScanner,r=n(3).Token,s=n(10).TokenStream,a=n(11).WhitespacePattern,o={START:"TK_START",RAW:"TK_RAW",EOF:"TK_EOF"},u=function(t,e){this._input=new i(t),this._options=e||{},this.__tokens=null,this._patterns={},this._patterns.whitespace=new a(this._input)};u.prototype.tokenize=function(){var t;this._input.restart(),this.__tokens=new s,this._reset();for(var e=new r(o.START,""),n=null,i=[],a=new s;e.type!==o.EOF;){for(t=this._get_next_token(e,n);this._is_comment(t);)a.add(t),t=this._get_next_token(e,n);a.isEmpty()||(t.comments_before=a,a=new s),t.parent=n,this._is_opening(t)?(i.push(n),n=t):n&&this._is_closing(t,n)&&(t.opened=n,n.closed=t,n=i.pop(),t.parent=n),t.previous=e,e.next=t,this.__tokens.add(t),e=t}return this.__tokens},u.prototype._is_first_token=function(){return this.__tokens.isEmpty()},u.prototype._reset=function(){},u.prototype._get_next_token=function(t,e){this._readWhitespace();var n=this._input.read(/.+/g);return n?this._create_token(o.RAW,n):this._create_token(o.EOF,"")},u.prototype._is_comment=function(t){return!1},u.prototype._is_opening=function(t){return!1},u.prototype._is_closing=function(t,e){return!1},u.prototype._create_token=function(t,e){return new r(t,e,this._patterns.whitespace.newline_count,this._patterns.whitespace.whitespace_before_token)},u.prototype._readWhitespace=function(){return this._patterns.whitespace.read()},t.exports.Tokenizer=u,t.exports.TOKEN=o},function(t,e,n){"use strict";function i(t){this.__tokens=[],this.__tokens_length=this.__tokens.length,this.__position=0,this.__parent_token=t}i.prototype.restart=function(){this.__position=0},i.prototype.isEmpty=function(){return 0===this.__tokens_length},i.prototype.hasNext=function(){return this.__position<this.__tokens_length},i.prototype.next=function(){var t=null;return this.hasNext()&&(t=this.__tokens[this.__position],this.__position+=1),t},i.prototype.peek=function(t){var e=null;return t=t||0,(t+=this.__position)>=0&&t<this.__tokens_length&&(e=this.__tokens[t]),e},i.prototype.add=function(t){this.__parent_token&&(t.parent=this.__parent_token),this.__tokens.push(t),this.__tokens_length+=1},t.exports.TokenStream=i},function(t,e,n){"use strict";var i=n(12).Pattern;function r(t,e){i.call(this,t,e),e?this._line_regexp=this._input.get_regexp(e._line_regexp):this.__set_whitespace_patterns("",""),this.newline_count=0,this.whitespace_before_token=""}r.prototype=new i,r.prototype.__set_whitespace_patterns=function(t,e){t+="\\t ",e+="\\n\\r",this._match_pattern=this._input.get_regexp("["+t+e+"]+",!0),this._newline_regexp=this._input.get_regexp("\\r\\n|["+e+"]")},r.prototype.read=function(){this.newline_count=0,this.whitespace_before_token="";var t=this._input.read(this._match_pattern);if(" "===t)this.whitespace_before_token=" ";else if(t){var e=this.__split(this._newline_regexp,t);this.newline_count=e.length-1,this.whitespace_before_token=e[this.newline_count]}return t},r.prototype.matching=function(t,e){var n=this._create();return n.__set_whitespace_patterns(t,e),n._update(),n},r.prototype._create=function(){return new r(this._input,this)},r.prototype.__split=function(t,e){t.lastIndex=0;for(var n=0,i=[],r=t.exec(e);r;)i.push(e.substring(n,r.index)),n=r.index+r[0].length,r=t.exec(e);return n<e.length?i.push(e.substring(n,e.length)):i.push(""),i},t.exports.WhitespacePattern=r},function(t,e,n){"use strict";function i(t,e){this._input=t,this._starting_pattern=null,this._match_pattern=null,this._until_pattern=null,this._until_after=!1,e&&(this._starting_pattern=this._input.get_regexp(e._starting_pattern,!0),this._match_pattern=this._input.get_regexp(e._match_pattern,!0),this._until_pattern=this._input.get_regexp(e._until_pattern),this._until_after=e._until_after)}i.prototype.read=function(){var t=this._input.read(this._starting_pattern);return this._starting_pattern&&!t||(t+=this._input.read(this._match_pattern,this._until_pattern,this._until_after)),t},i.prototype.read_match=function(){return this._input.match(this._match_pattern)},i.prototype.until_after=function(t){var e=this._create();return e._until_after=!0,e._until_pattern=this._input.get_regexp(t),e._update(),e},i.prototype.until=function(t){var e=this._create();return e._until_after=!1,e._until_pattern=this._input.get_regexp(t),e._update(),e},i.prototype.starting_with=function(t){var e=this._create();return e._starting_pattern=this._input.get_regexp(t,!0),e._update(),e},i.prototype.matching=function(t){var e=this._create();return e._match_pattern=this._input.get_regexp(t,!0),e._update(),e},i.prototype._create=function(){return new i(this._input,this)},i.prototype._update=function(){},t.exports.Pattern=i},function(t,e,n){"use strict";function i(t,e){t="string"==typeof t?t:t.source,e="string"==typeof e?e:e.source,this.__directives_block_pattern=new RegExp(t+/ beautify( \w+[:]\w+)+ /.source+e,"g"),this.__directive_pattern=/ (\w+)[:](\w+)/g,this.__directives_end_ignore_pattern=new RegExp(t+/\sbeautify\signore:end\s/.source+e,"g")}i.prototype.get_directives=function(t){if(!t.match(this.__directives_block_pattern))return null;var e={};this.__directive_pattern.lastIndex=0;for(var n=this.__directive_pattern.exec(t);n;)e[n[1]]=n[2],n=this.__directive_pattern.exec(t);return e},i.prototype.readIgnored=function(t){return t.readUntilAfter(this.__directives_end_ignore_pattern)},t.exports.Directives=i},function(t,e,n){"use strict";var i=n(12).Pattern,r={django:!1,erb:!1,handlebars:!1,php:!1,smarty:!1};function s(t,e){i.call(this,t,e),this.__template_pattern=null,this._disabled=Object.assign({},r),this._excluded=Object.assign({},r),e&&(this.__template_pattern=this._input.get_regexp(e.__template_pattern),this._excluded=Object.assign(this._excluded,e._excluded),this._disabled=Object.assign(this._disabled,e._disabled));var n=new i(t);this.__patterns={handlebars_comment:n.starting_with(/{{!--/).until_after(/--}}/),handlebars_unescaped:n.starting_with(/{{{/).until_after(/}}}/),handlebars:n.starting_with(/{{/).until_after(/}}/),php:n.starting_with(/<\?(?:[=]|php)/).until_after(/\?>/),erb:n.starting_with(/<%[^%]/).until_after(/[^%]%>/),django:n.starting_with(/{%/).until_after(/%}/),django_value:n.starting_with(/{{/).until_after(/}}/),django_comment:n.starting_with(/{#/).until_after(/#}/),smarty:n.starting_with(/{(?=[^}{\s\n])/).until_after(/[^\s\n]}/),smarty_comment:n.starting_with(/{\*/).until_after(/\*}/),smarty_literal:n.starting_with(/{literal}/).until_after(/{\/literal}/)}}s.prototype=new i,s.prototype._create=function(){return new s(this._input,this)},s.prototype._update=function(){this.__set_templated_pattern()},s.prototype.disable=function(t){var e=this._create();return e._disabled[t]=!0,e._update(),e},s.prototype.read_options=function(t){var e=this._create();for(var n in r)e._disabled[n]=-1===t.templating.indexOf(n);return e._update(),e},s.prototype.exclude=function(t){var e=this._create();return e._excluded[t]=!0,e._update(),e},s.prototype.read=function(){var t="";t=this._match_pattern?this._input.read(this._starting_pattern):this._input.read(this._starting_pattern,this.__template_pattern);for(var e=this._read_template();e;)this._match_pattern?e+=this._input.read(this._match_pattern):e+=this._input.readUntil(this.__template_pattern),t+=e,e=this._read_template();return this._until_after&&(t+=this._input.readUntilAfter(this._until_pattern)),t},s.prototype.__set_templated_pattern=function(){var t=[];this._disabled.php||t.push(this.__patterns.php._starting_pattern.source),this._disabled.handlebars||t.push(this.__patterns.handlebars._starting_pattern.source),this._disabled.erb||t.push(this.__patterns.erb._starting_pattern.source),this._disabled.django||(t.push(this.__patterns.django._starting_pattern.source),t.push(this.__patterns.django_value._starting_pattern.source),t.push(this.__patterns.django_comment._starting_pattern.source)),this._disabled.smarty||t.push(this.__patterns.smarty._starting_pattern.source),this._until_pattern&&t.push(this._until_pattern.source),this.__template_pattern=this._input.get_regexp("(?:"+t.join("|")+")")},s.prototype._read_template=function(){var t="",e=this._input.peek();if("<"===e){var n=this._input.peek(1);this._disabled.php||this._excluded.php||"?"!==n||(t=t||this.__patterns.php.read()),this._disabled.erb||this._excluded.erb||"%"!==n||(t=t||this.__patterns.erb.read())}else"{"===e&&(this._disabled.handlebars||this._excluded.handlebars||(t=(t=(t=t||this.__patterns.handlebars_comment.read())||this.__patterns.handlebars_unescaped.read())||this.__patterns.handlebars.read()),this._disabled.django||(this._excluded.django||this._excluded.handlebars||(t=t||this.__patterns.django_value.read()),this._excluded.django||(t=(t=t||this.__patterns.django_comment.read())||this.__patterns.django.read())),this._disabled.smarty||this._disabled.django&&this._disabled.handlebars&&(t=(t=(t=t||this.__patterns.smarty_comment.read())||this.__patterns.smarty_literal.read())||this.__patterns.smarty.read()));return t},t.exports.TemplatablePattern=s}]),void 0===(n=function(){return{js_beautify:i}}.apply(e,[]))||(t.exports=n)},391:(t,e,n)=>{parcelRequire=function(e,i,r,s){var a,o="function"==typeof parcelRequire&&parcelRequire;function u(t,r){if(!i[t]){if(!e[t]){var s="function"==typeof parcelRequire&&parcelRequire;if(!r&&s)return s(t,!0);if(o)return o(t,!0);if("string"==typeof t)return n(784)(t);var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}h.resolve=function(n){return e[t][1][n]||n},h.cache={};var c=i[t]=new u.Module(t);e[t][0].call(c.exports,h,c,c.exports,this)}return i[t].exports;function h(t){return u(h.resolve(t))}}u.isParcelRequire=!0,u.Module=function(t){this.id=t,this.bundle=u,this.exports={}},u.modules=e,u.cache=i,u.parent=o,u.register=function(t,n){e[t]=[function(t,e){e.exports=n},{}]};for(var c=0;c<r.length;c++)try{u(r[c])}catch(e){a||(a=e)}if(r.length){var h=u(r[r.length-1]);t.exports=h}if(parcelRequire=u,a)throw a;return u}({EgBh:[function(t,e,n){var i={};i.useBlobBuilder=function(){try{return new Blob([]),!1}catch(t){return!0}}(),i.useArrayBufferView=!i.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(t){return!0}}(),e.exports.binaryFeatures=i;var r=e.exports.BlobBuilder;function s(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(r=e.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),s.prototype.append=function(t){"number"==typeof t?this._pieces.push(t):(this.flush(),this._parts.push(t))},s.prototype.flush=function(){if(this._pieces.length>0){var t=new Uint8Array(this._pieces);i.useArrayBufferView||(t=t.buffer),this._parts.push(t),this._pieces=[]}},s.prototype.getBuffer=function(){if(this.flush(),i.useBlobBuilder){for(var t=new r,e=0,n=this._parts.length;e<n;e++)t.append(this._parts[e]);return t.getBlob()}return new Blob(this._parts)},e.exports.BufferBuilder=s},{}],kdPp:[function(t,e,n){var i=t("./bufferbuilder").BufferBuilder,r=t("./bufferbuilder").binaryFeatures,s={unpack:function(t){return new a(t).unpack()},pack:function(t){var e=new o;return e.pack(t),e.getBuffer()}};function a(t){this.index=0,this.dataBuffer=t,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function o(){this.bufferBuilder=new i}function u(t){var e=t.charCodeAt(0);return e<=2047?"00":e<=65535?"000":e<=2097151?"0000":e<=67108863?"00000":"000000"}e.exports=s,a.prototype.unpack=function(){var t,e=this.unpack_uint8();if(e<128)return e;if((224^e)<32)return(224^e)-32;if((t=160^e)<=15)return this.unpack_raw(t);if((t=176^e)<=15)return this.unpack_string(t);if((t=144^e)<=15)return this.unpack_array(t);if((t=128^e)<=15)return this.unpack_map(t);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:case 213:case 214:case 215:return;case 216:return t=this.unpack_uint16(),this.unpack_string(t);case 217:return t=this.unpack_uint32(),this.unpack_string(t);case 218:return t=this.unpack_uint16(),this.unpack_raw(t);case 219:return t=this.unpack_uint32(),this.unpack_raw(t);case 220:return t=this.unpack_uint16(),this.unpack_array(t);case 221:return t=this.unpack_uint32(),this.unpack_array(t);case 222:return t=this.unpack_uint16(),this.unpack_map(t);case 223:return t=this.unpack_uint32(),this.unpack_map(t)}},a.prototype.unpack_uint8=function(){var t=255&this.dataView[this.index];return this.index++,t},a.prototype.unpack_uint16=function(){var t=this.read(2),e=256*(255&t[0])+(255&t[1]);return this.index+=2,e},a.prototype.unpack_uint32=function(){var t=this.read(4),e=256*(256*(256*t[0]+t[1])+t[2])+t[3];return this.index+=4,e},a.prototype.unpack_uint64=function(){var t=this.read(8),e=256*(256*(256*(256*(256*(256*(256*t[0]+t[1])+t[2])+t[3])+t[4])+t[5])+t[6])+t[7];return this.index+=8,e},a.prototype.unpack_int8=function(){var t=this.unpack_uint8();return t<128?t:t-256},a.prototype.unpack_int16=function(){var t=this.unpack_uint16();return t<32768?t:t-65536},a.prototype.unpack_int32=function(){var t=this.unpack_uint32();return t<Math.pow(2,31)?t:t-Math.pow(2,32)},a.prototype.unpack_int64=function(){var t=this.unpack_uint64();return t<Math.pow(2,63)?t:t-Math.pow(2,64)},a.prototype.unpack_raw=function(t){if(this.length<this.index+t)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+t+" "+this.length);var e=this.dataBuffer.slice(this.index,this.index+t);return this.index+=t,e},a.prototype.unpack_string=function(t){for(var e,n,i=this.read(t),r=0,s="";r<t;)(e=i[r])<128?(s+=String.fromCharCode(e),r++):(192^e)<32?(n=(192^e)<<6|63&i[r+1],s+=String.fromCharCode(n),r+=2):(n=(15&e)<<12|(63&i[r+1])<<6|63&i[r+2],s+=String.fromCharCode(n),r+=3);return this.index+=t,s},a.prototype.unpack_array=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=this.unpack();return e},a.prototype.unpack_map=function(t){for(var e={},n=0;n<t;n++){var i=this.unpack(),r=this.unpack();e[i]=r}return e},a.prototype.unpack_float=function(){var t=this.unpack_uint32(),e=(t>>23&255)-127;return(0==t>>31?1:-1)*(8388607&t|8388608)*Math.pow(2,e-23)},a.prototype.unpack_double=function(){var t=this.unpack_uint32(),e=this.unpack_uint32(),n=(t>>20&2047)-1023;return(0==t>>31?1:-1)*((1048575&t|1048576)*Math.pow(2,n-20)+e*Math.pow(2,n-52))},a.prototype.read=function(t){var e=this.index;if(e+t<=this.length)return this.dataView.subarray(e,e+t);throw new Error("BinaryPackFailure: read index out of range")},o.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},o.prototype.pack=function(t){var e=typeof t;if("string"===e)this.pack_string(t);else if("number"===e)Math.floor(t)===t?this.pack_integer(t):this.pack_double(t);else if("boolean"===e)!0===t?this.bufferBuilder.append(195):!1===t&&this.bufferBuilder.append(194);else if("undefined"===e)this.bufferBuilder.append(192);else{if("object"!==e)throw new Error('Type "'+e+'" not yet supported');if(null===t)this.bufferBuilder.append(192);else{var n=t.constructor;if(n==Array)this.pack_array(t);else if(n==Blob||n==File||t instanceof Blob||t instanceof File)this.pack_bin(t);else if(n==ArrayBuffer)r.useArrayBufferView?this.pack_bin(new Uint8Array(t)):this.pack_bin(t);else if("BYTES_PER_ELEMENT"in t)r.useArrayBufferView?this.pack_bin(new Uint8Array(t.buffer)):this.pack_bin(t.buffer);else if(n==Object||n.toString().startsWith("class"))this.pack_object(t);else if(n==Date)this.pack_string(t.toString());else{if("function"!=typeof t.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(t.toBinaryPack())}}}this.bufferBuilder.flush()},o.prototype.pack_bin=function(t){var e=t.length||t.byteLength||t.size;if(e<=15)this.pack_uint8(160+e);else if(e<=65535)this.bufferBuilder.append(218),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(e)}this.bufferBuilder.append(t)},o.prototype.pack_string=function(t){var e=function(t){return t.length>600?new Blob([t]).size:t.replace(/[^\u0000-\u007F]/g,u).length}(t);if(e<=15)this.pack_uint8(176+e);else if(e<=65535)this.bufferBuilder.append(216),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(e)}this.bufferBuilder.append(t)},o.prototype.pack_array=function(t){var e=t.length;if(e<=15)this.pack_uint8(144+e);else if(e<=65535)this.bufferBuilder.append(220),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(e)}for(var n=0;n<e;n++)this.pack(t[n])},o.prototype.pack_integer=function(t){if(t>=-32&&t<=127)this.bufferBuilder.append(255&t);else if(t>=0&&t<=255)this.bufferBuilder.append(204),this.pack_uint8(t);else if(t>=-128&&t<=127)this.bufferBuilder.append(208),this.pack_int8(t);else if(t>=0&&t<=65535)this.bufferBuilder.append(205),this.pack_uint16(t);else if(t>=-32768&&t<=32767)this.bufferBuilder.append(209),this.pack_int16(t);else if(t>=0&&t<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(t);else if(t>=-2147483648&&t<=2147483647)this.bufferBuilder.append(210),this.pack_int32(t);else if(t>=-0x8000000000000000&&t<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(t);else{if(!(t>=0&&t<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(t)}},o.prototype.pack_double=function(t){var e=0;t<0&&(e=1,t=-t);var n=Math.floor(Math.log(t)/Math.LN2),i=t/Math.pow(2,n)-1,r=Math.floor(i*Math.pow(2,52)),s=Math.pow(2,32),a=e<<31|n+1023<<20|r/s&1048575,o=r%s;this.bufferBuilder.append(203),this.pack_int32(a),this.pack_int32(o)},o.prototype.pack_object=function(t){var e=Object.keys(t).length;if(e<=15)this.pack_uint8(128+e);else if(e<=65535)this.bufferBuilder.append(222),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(e)}for(var n in t)t.hasOwnProperty(n)&&(this.pack(n),this.pack(t[n]))},o.prototype.pack_uint8=function(t){this.bufferBuilder.append(t)},o.prototype.pack_uint16=function(t){this.bufferBuilder.append(t>>8),this.bufferBuilder.append(255&t)},o.prototype.pack_uint32=function(t){var e=4294967295&t;this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},o.prototype.pack_uint64=function(t){var e=t/Math.pow(2,32),n=t%Math.pow(2,32);this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},o.prototype.pack_int8=function(t){this.bufferBuilder.append(255&t)},o.prototype.pack_int16=function(t){this.bufferBuilder.append((65280&t)>>8),this.bufferBuilder.append(255&t)},o.prototype.pack_int32=function(t){this.bufferBuilder.append(t>>>24&255),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},o.prototype.pack_int64=function(t){var e=Math.floor(t/Math.pow(2,32)),n=t%Math.pow(2,32);this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}},{"./bufferbuilder":"EgBh"}],iSxC:[function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.extractVersion=a,n.wrapPeerConnectionEvent=function(t,e,n){if(t.RTCPeerConnection){var i=t.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(t,i){if(t!==e)return r.apply(this,arguments);var s=function(t){var e=n(t);e&&i(e)};return this._eventMap=this._eventMap||{},this._eventMap[i]=s,r.apply(this,[t,s])};var s=i.removeEventListener;i.removeEventListener=function(t,n){if(t!==e||!this._eventMap||!this._eventMap[n])return s.apply(this,arguments);var i=this._eventMap[n];return delete this._eventMap[n],s.apply(this,[t,i])},Object.defineProperty(i,"on"+e,{get:function(){return this["_on"+e]},set:function(t){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),t&&this.addEventListener(e,this["_on"+e]=t)},enumerable:!0,configurable:!0})}},n.disableLog=function(t){return"boolean"!=typeof t?new Error("Argument type: "+i(t)+". Please use a boolean."):(r=t,t?"adapter.js logging disabled":"adapter.js logging enabled")},n.disableWarnings=function(t){return"boolean"!=typeof t?new Error("Argument type: "+i(t)+". Please use a boolean."):(s=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))},n.log=function(){if("object"===("undefined"==typeof window?"undefined":i(window))){if(r)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},n.deprecated=function(t,e){s&&console.warn(t+" is deprecated, please use "+e+" instead.")},n.detectBrowser=function(t){var{navigator:e}=t,n={browser:null,version:null};if(void 0===t||!t.navigator)return n.browser="Not a browser.",n;if(e.mozGetUserMedia)n.browser="firefox",n.version=a(e.userAgent,/Firefox\/(\d+)\./,1);else if(e.webkitGetUserMedia||!1===t.isSecureContext&&t.webkitRTCPeerConnection&&!t.RTCIceGatherer)n.browser="chrome",n.version=a(e.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(e.mediaDevices&&e.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=a(e.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!t.RTCPeerConnection||!e.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=a(e.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype}return n},n.compactObject=function t(e){return o(e)?Object.keys(e).reduce((function(n,i){var r=o(e[i]),s=r?t(e[i]):e[i],a=r&&!Object.keys(s).length;return void 0===s||a?n:Object.assign(n,function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},i,s))}),{}):e},n.walkStats=u,n.filterStats=function(t,e,n){var i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(null===e)return r;var s=[];return t.forEach((function(t){"track"===t.type&&t.trackIdentifier===e.id&&s.push(t)})),s.forEach((function(e){t.forEach((function(n){n.type===i&&n.trackId===e.id&&u(t,n,r)}))})),r};var r=!0,s=!0;function a(t,e,n){var i=t.match(e);return i&&i.length>=n&&parseInt(i[n],10)}function o(t){return"[object Object]"===Object.prototype.toString.call(t)}function u(t,e,n){e&&!n.has(e.id)&&(n.set(e.id,e),Object.keys(e).forEach((function(i){i.endsWith("Id")?u(t,t.get(e[i]),n):i.endsWith("Ids")&&e[i].forEach((function(e){u(t,t.get(e),n)}))})))}},{}],s6SN:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(t){var e=t&&t.navigator;if(e.mediaDevices){var n=i.detectBrowser(t),r=function(t){if("object"!==s(t)||t.mandatory||t.optional)return t;var e={};return Object.keys(t).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i="object"===s(t[n])?t[n]:{ideal:t[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);var r=function(t,e){return t?t+e.charAt(0).toUpperCase()+e.slice(1):"deviceId"===e?"sourceId":e};if(void 0!==i.ideal){e.optional=e.optional||[];var a={};"number"==typeof i.ideal?(a[r("min",n)]=i.ideal,e.optional.push(a),(a={})[r("max",n)]=i.ideal,e.optional.push(a)):(a[r("",n)]=i.ideal,e.optional.push(a))}void 0!==i.exact&&"number"!=typeof i.exact?(e.mandatory=e.mandatory||{},e.mandatory[r("",n)]=i.exact):["min","max"].forEach((function(t){void 0!==i[t]&&(e.mandatory=e.mandatory||{},e.mandatory[r(t,n)]=i[t])}))}})),t.advanced&&(e.optional=(e.optional||[]).concat(t.advanced)),e},o=function(t,i){if(n.version>=61)return i(t);if((t=JSON.parse(JSON.stringify(t)))&&"object"===s(t.audio)){var o=function(t,e,n){e in t&&!(n in t)&&(t[n]=t[e],delete t[e])};o((t=JSON.parse(JSON.stringify(t))).audio,"autoGainControl","googAutoGainControl"),o(t.audio,"noiseSuppression","googNoiseSuppression"),t.audio=r(t.audio)}if(t&&"object"===s(t.video)){var u=t.video.facingMode;u=u&&("object"===s(u)?u:{ideal:u});var c,h=n.version<66;if(u&&("user"===u.exact||"environment"===u.exact||"user"===u.ideal||"environment"===u.ideal)&&(!e.mediaDevices.getSupportedConstraints||!e.mediaDevices.getSupportedConstraints().facingMode||h)&&(delete t.video.facingMode,"environment"===u.exact||"environment"===u.ideal?c=["back","rear"]:"user"!==u.exact&&"user"!==u.ideal||(c=["front"]),c))return e.mediaDevices.enumerateDevices().then((function(e){var n=(e=e.filter((function(t){return"videoinput"===t.kind}))).find((function(t){return c.some((function(e){return t.label.toLowerCase().includes(e)}))}));return!n&&e.length&&c.includes("back")&&(n=e[e.length-1]),n&&(t.video.deviceId=u.exact?{exact:n.deviceId}:{ideal:n.deviceId}),t.video=r(t.video),a("chrome: "+JSON.stringify(t)),i(t)}));t.video=r(t.video)}return a("chrome: "+JSON.stringify(t)),i(t)},u=function(t){return n.version>=64?t:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[t.name]||t.name,message:t.message,constraint:t.constraint||t.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(e.getUserMedia=function(t,n,i){o(t,(function(t){e.webkitGetUserMedia(t,n,(function(t){i&&i(u(t))}))}))}.bind(e),e.mediaDevices.getUserMedia){var c=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(t){return o(t,(function(t){return c(t).then((function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((function(t){t.stop()})),new DOMException("","NotFoundError");return e}),(function(t){return Promise.reject(u(t))}))}))}}}};var i=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var a=i?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}return n.default=t,e&&e.set(t,n),n}(t("../utils.js"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a=i.log},{"../utils.js":"iSxC"}],VHa8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&("function"==typeof e?t.navigator.mediaDevices.getDisplayMedia=function(n){return e(n).then((function(e){var i=n.video&&n.video.width,r=n.video&&n.video.height,s=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:s||3}},i&&(n.video.mandatory.maxWidth=i),r&&(n.video.mandatory.maxHeight=r),t.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],uI5X:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimMediaStream=function(t){t.MediaStream=t.MediaStream||t.webkitMediaStream},n.shimOnTrack=function(t){if("object"!==u(t)||!t.RTCPeerConnection||"ontrack"in t.RTCPeerConnection.prototype)i.wrapPeerConnectionEvent(t,"track",(function(t){return t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t}));else{Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});var e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(e){e.stream.addEventListener("addtrack",(function(i){var r;r=t.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(t){return t.track&&t.track.id===i.track.id})):{track:i.track};var s=new Event("track");s.track=i.track,s.receiver=r,s.transceiver={receiver:r},s.streams=[e.stream],n.dispatchEvent(s)})),e.stream.getTracks().forEach((function(i){var r;r=t.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(t){return t.track&&t.track.id===i.id})):{track:i};var s=new Event("track");s.track=i,s.receiver=r,s.transceiver={receiver:r},s.streams=[e.stream],n.dispatchEvent(s)}))},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}},n.shimGetSendersWithDtmf=function(t){if("object"===u(t)&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){var e=function(t,e){return{track:e,get dtmf(){return void 0===this._dtmf&&("audio"===e.kind?this._dtmf=t.createDTMFSender(e):this._dtmf=null),this._dtmf},_pc:t}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(t,i){var r=n.apply(this,arguments);return r||(r=e(this,t),this._senders.push(r)),r};var i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(t){i.apply(this,arguments);var e=this._senders.indexOf(t);-1!==e&&this._senders.splice(e,1)}}var r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(t){var n=this;this._senders=this._senders||[],r.apply(this,[t]),t.getTracks().forEach((function(t){n._senders.push(e(n,t))}))};var s=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(t){var e=this;this._senders=this._senders||[],s.apply(this,[t]),t.getTracks().forEach((function(t){var n=e._senders.find((function(e){return e.track===t}));n&&e._senders.splice(e._senders.indexOf(n),1)}))}}else if("object"===u(t)&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){var a=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=a.apply(this,[]);return e.forEach((function(e){return e._pc=t})),e},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},n.shimGetStats=function(t){if(t.RTCPeerConnection){var e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){var t=this,[n,i,r]=arguments;if(arguments.length>0&&"function"==typeof n)return e.apply(this,arguments);if(0===e.length&&(0===arguments.length||"function"!=typeof n))return e.apply(this,[]);var s=function(t){var e={};return t.result().forEach((function(t){var n={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach((function(e){n[e]=t.stat(e)})),e[n.id]=n})),e},a=function(t){return new Map(Object.keys(t).map((function(e){return[e,t[e]]})))};return arguments.length>=2?e.apply(this,[function(t){i(a(s(t)))},n]):new Promise((function(n,i){e.apply(t,[function(t){n(a(s(t)))},i])})).then(i,r)}}},n.shimSenderReceiverGetStats=function(t){if("object"===u(t)&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver){if(!("getStats"in t.RTCRtpSender.prototype)){var e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){var t=this,n=e.apply(this,[]);return n.forEach((function(e){return e._pc=t})),n});var n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){var t=n.apply(this,arguments);return t._pc=this,t}),t.RTCRtpSender.prototype.getStats=function(){var t=this;return this._pc.getStats().then((function(e){return i.filterStats(e,t.track,!0)}))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){var r=t.RTCPeerConnection.prototype.getReceivers;r&&(t.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=r.apply(this,[]);return e.forEach((function(e){return e._pc=t})),e}),i.wrapPeerConnectionEvent(t,"track",(function(t){return t.receiver._pc=t.srcElement,t})),t.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this._pc.getStats().then((function(e){return i.filterStats(e,t.track,!1)}))}}if("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype){var s=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){var e,n,i,r=arguments[0];return this.getSenders().forEach((function(t){t.track===r&&(e?i=!0:e=t)})),this.getReceivers().forEach((function(t){return t.track===r&&(n?i=!0:n=t),t.track===r})),i||e&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):e?e.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return s.apply(this,arguments)}}}},n.shimAddTrackRemoveTrackWithNative=c,n.shimAddTrackRemoveTrack=function(t){if(t.RTCPeerConnection){var e=i.detectBrowser(t);if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return c(t);var n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this,e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((function(e){return t._reverseStreams[e.id]}))};var r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(e){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},e.getTracks().forEach((function(t){if(n.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[e.id]){var i=new t.MediaStream(e.getTracks());this._streams[e.id]=i,this._reverseStreams[i.id]=e,e=i}r.apply(this,[e])};var s=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(t){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[t.id]||t]),delete this._reverseStreams[this._streams[t.id]?this._streams[t.id].id:t.id],delete this._streams[t.id]},t.RTCPeerConnection.prototype.addTrack=function(e,n){var i=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find((function(t){return t===e})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var s=this._streams[n.id];if(s)s.addTrack(e),Promise.resolve().then((function(){i.dispatchEvent(new Event("negotiationneeded"))}));else{var a=new t.MediaStream([e]);this._streams[n.id]=a,this._reverseStreams[a.id]=n,this.addStream(a)}return this.getSenders().find((function(t){return t.track===e}))},["createOffer","createAnswer"].forEach((function(e){var n=t.RTCPeerConnection.prototype[e],i=o({},e,(function(){var t=this,e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[function(n){var i=h(t,n);e[0].apply(null,[i])},function(t){e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((function(e){return h(t,e)}))}));t.RTCPeerConnection.prototype[e]=i[e]}));var a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(t=this,n=(e=arguments[0]).sdp,Object.keys(t._reverseStreams||[]).forEach((function(e){var i=t._reverseStreams[e],r=t._streams[i.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:e.type,sdp:n})),a.apply(this,arguments)):a.apply(this,arguments);var t,e,n};var u=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get:function(){var t=u.get.apply(this);return""===t.type?t:h(this,t)}}),t.RTCPeerConnection.prototype.removeTrack=function(t){var e,n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(t._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(i){n._streams[i].getTracks().find((function(e){return t.track===e}))&&(e=n._streams[i])})),e&&(1===e.getTracks().length?this.removeStream(this._reverseStreams[e.id]):e.removeTrack(t.track),this.dispatchEvent(new Event("negotiationneeded")))}}function h(t,e){var n=e.sdp;return Object.keys(t._reverseStreams||[]).forEach((function(e){var i=t._reverseStreams[e],r=t._streams[i.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:e.type,sdp:n})}},n.shimPeerConnection=function(t){var e=i.detectBrowser(t);if(!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection){e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(e){var n=t.RTCPeerConnection.prototype[e],i=o({},e,(function(){return arguments[0]=new("addIceCandidate"===e?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));t.RTCPeerConnection.prototype[e]=i[e]}));var n=t.RTCPeerConnection.prototype.addIceCandidate;t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},n.fixNegotiationNeeded=function(t){i.wrapPeerConnectionEvent(t,"negotiationneeded",(function(t){if("stable"===t.target.signalingState)return t}))},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}});var i=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var s=i?Object.getOwnPropertyDescriptor(t,r):null;s&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=t[r]}return n.default=t,e&&e.set(t,n),n}(t("../utils.js")),r=t("./getusermedia"),s=t("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(e){return t._shimmedLocalStreams[e][0]}))};var e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(t,n){if(!n)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var i=e.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};var n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(t){var e=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},t.getTracks().forEach((function(t){if(e.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError")}));var i=this.getSenders();n.apply(this,arguments);var r=this.getSenders().filter((function(t){return-1===i.indexOf(t)}));this._shimmedLocalStreams[t.id]=[t].concat(r)};var i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(t){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[t.id],i.apply(this,arguments)};var r=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(t){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},t&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var i=e._shimmedLocalStreams[n].indexOf(t);-1!==i&&e._shimmedLocalStreams[n].splice(i,1),1===e._shimmedLocalStreams[n].length&&delete e._shimmedLocalStreams[n]})),r.apply(this,arguments)}}},{"../utils.js":"iSxC","./getusermedia":"s6SN","./getdisplaymedia":"VHa8"}],NZ1C:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(t,e){var n=!1;return(t=JSON.parse(JSON.stringify(t))).filter((function(t){if(t&&(t.urls||t.url)){var e=t.urls||t.url;t.url&&!t.urls&&i.deprecated("RTCIceServer.url","RTCIceServer.urls");var r="string"==typeof e;return r&&(e=[e]),e=e.filter((function(t){if(0===t.indexOf("stun:"))return!1;var e=t.startsWith("turn")&&!t.startsWith("turn:[")&&t.includes("transport=udp");return e&&!n?(n=!0,!0):e&&!n})),delete t.url,t.urls=r?e[0]:e,!!e.length}}))};var i=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var a=i?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}return n.default=t,e&&e.set(t,n),n}(t("../utils"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}},{"../utils":"iSxC"}],YHvh:[function(t,e,n){"use strict";var i={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};i.localCName=i.generateIdentifier(),i.splitLines=function(t){return t.trim().split("\n").map((function(t){return t.trim()}))},i.splitSections=function(t){return t.split("\nm=").map((function(t,e){return(e>0?"m="+t:t).trim()+"\r\n"}))},i.getDescription=function(t){var e=i.splitSections(t);return e&&e[0]},i.getMediaSections=function(t){var e=i.splitSections(t);return e.shift(),e},i.matchPrefix=function(t,e){return i.splitLines(t).filter((function(t){return 0===t.indexOf(e)}))},i.parseCandidate=function(t){for(var e,n={foundation:(e=0===t.indexOf("a=candidate:")?t.substring(12).split(" "):t.substring(10).split(" "))[0],component:parseInt(e[1],10),protocol:e[2].toLowerCase(),priority:parseInt(e[3],10),ip:e[4],address:e[4],port:parseInt(e[5],10),type:e[7]},i=8;i<e.length;i+=2)switch(e[i]){case"raddr":n.relatedAddress=e[i+1];break;case"rport":n.relatedPort=parseInt(e[i+1],10);break;case"tcptype":n.tcpType=e[i+1];break;case"ufrag":n.ufrag=e[i+1],n.usernameFragment=e[i+1];break;default:n[e[i]]=e[i+1]}return n},i.writeCandidate=function(t){var e=[];e.push(t.foundation),e.push(t.component),e.push(t.protocol.toUpperCase()),e.push(t.priority),e.push(t.address||t.ip),e.push(t.port);var n=t.type;return e.push("typ"),e.push(n),"host"!==n&&t.relatedAddress&&t.relatedPort&&(e.push("raddr"),e.push(t.relatedAddress),e.push("rport"),e.push(t.relatedPort)),t.tcpType&&"tcp"===t.protocol.toLowerCase()&&(e.push("tcptype"),e.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(e.push("ufrag"),e.push(t.usernameFragment||t.ufrag)),"candidate:"+e.join(" ")},i.parseIceOptions=function(t){return t.substr(14).split(" ")},i.parseRtpMap=function(t){var e=t.substr(9).split(" "),n={payloadType:parseInt(e.shift(),10)};return e=e[0].split("/"),n.name=e[0],n.clockRate=parseInt(e[1],10),n.channels=3===e.length?parseInt(e[2],10):1,n.numChannels=n.channels,n},i.writeRtpMap=function(t){var e=t.payloadType;void 0!==t.preferredPayloadType&&(e=t.preferredPayloadType);var n=t.channels||t.numChannels||1;return"a=rtpmap:"+e+" "+t.name+"/"+t.clockRate+(1!==n?"/"+n:"")+"\r\n"},i.parseExtmap=function(t){var e=t.substr(9).split(" ");return{id:parseInt(e[0],10),direction:e[0].indexOf("/")>0?e[0].split("/")[1]:"sendrecv",uri:e[1]}},i.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&"sendrecv"!==t.direction?"/"+t.direction:"")+" "+t.uri+"\r\n"},i.parseFmtp=function(t){for(var e,n={},i=t.substr(t.indexOf(" ")+1).split(";"),r=0;r<i.length;r++)n[(e=i[r].trim().split("="))[0].trim()]=e[1];return n},i.writeFmtp=function(t){var e="",n=t.payloadType;if(void 0!==t.preferredPayloadType&&(n=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){var i=[];Object.keys(t.parameters).forEach((function(e){t.parameters[e]?i.push(e+"="+t.parameters[e]):i.push(e)})),e+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return e},i.parseRtcpFb=function(t){var e=t.substr(t.indexOf(" ")+1).split(" ");return{type:e.shift(),parameter:e.join(" ")}},i.writeRtcpFb=function(t){var e="",n=t.payloadType;return void 0!==t.preferredPayloadType&&(n=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach((function(t){e+="a=rtcp-fb:"+n+" "+t.type+(t.parameter&&t.parameter.length?" "+t.parameter:"")+"\r\n"})),e},i.parseSsrcMedia=function(t){var e=t.indexOf(" "),n={ssrc:parseInt(t.substr(7,e-7),10)},i=t.indexOf(":",e);return i>-1?(n.attribute=t.substr(e+1,i-e-1),n.value=t.substr(i+1)):n.attribute=t.substr(e+1),n},i.parseSsrcGroup=function(t){var e=t.substr(13).split(" ");return{semantics:e.shift(),ssrcs:e.map((function(t){return parseInt(t,10)}))}},i.getMid=function(t){var e=i.matchPrefix(t,"a=mid:")[0];if(e)return e.substr(6)},i.parseFingerprint=function(t){var e=t.substr(14).split(" ");return{algorithm:e[0].toLowerCase(),value:e[1]}},i.getDtlsParameters=function(t,e){return{role:"auto",fingerprints:i.matchPrefix(t+e,"a=fingerprint:").map(i.parseFingerprint)}},i.writeDtlsParameters=function(t,e){var n="a=setup:"+e+"\r\n";return t.fingerprints.forEach((function(t){n+="a=fingerprint:"+t.algorithm+" "+t.value+"\r\n"})),n},i.getIceParameters=function(t,e){var n=i.splitLines(t);return{usernameFragment:(n=n.concat(i.splitLines(e))).filter((function(t){return 0===t.indexOf("a=ice-ufrag:")}))[0].substr(12),password:n.filter((function(t){return 0===t.indexOf("a=ice-pwd:")}))[0].substr(10)}},i.writeIceParameters=function(t){return"a=ice-ufrag:"+t.usernameFragment+"\r\na=ice-pwd:"+t.password+"\r\n"},i.parseRtpParameters=function(t){for(var e={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=i.splitLines(t)[0].split(" "),r=3;r<n.length;r++){var s=n[r],a=i.matchPrefix(t,"a=rtpmap:"+s+" ")[0];if(a){var o=i.parseRtpMap(a),u=i.matchPrefix(t,"a=fmtp:"+s+" ");switch(o.parameters=u.length?i.parseFmtp(u[0]):{},o.rtcpFeedback=i.matchPrefix(t,"a=rtcp-fb:"+s+" ").map(i.parseRtcpFb),e.codecs.push(o),o.name.toUpperCase()){case"RED":case"ULPFEC":e.fecMechanisms.push(o.name.toUpperCase())}}}return i.matchPrefix(t,"a=extmap:").forEach((function(t){e.headerExtensions.push(i.parseExtmap(t))})),e},i.writeRtpDescription=function(t,e){var n="";n+="m="+t+" ",n+=e.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=e.codecs.map((function(t){return void 0!==t.preferredPayloadType?t.preferredPayloadType:t.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",e.codecs.forEach((function(t){n+=i.writeRtpMap(t),n+=i.writeFmtp(t),n+=i.writeRtcpFb(t)}));var r=0;return e.codecs.forEach((function(t){t.maxptime>r&&(r=t.maxptime)})),r>0&&(n+="a=maxptime:"+r+"\r\n"),n+="a=rtcp-mux\r\n",e.headerExtensions&&e.headerExtensions.forEach((function(t){n+=i.writeExtmap(t)})),n},i.parseRtpEncodingParameters=function(t){var e,n=[],r=i.parseRtpParameters(t),s=-1!==r.fecMechanisms.indexOf("RED"),a=-1!==r.fecMechanisms.indexOf("ULPFEC"),o=i.matchPrefix(t,"a=ssrc:").map((function(t){return i.parseSsrcMedia(t)})).filter((function(t){return"cname"===t.attribute})),u=o.length>0&&o[0].ssrc,c=i.matchPrefix(t,"a=ssrc-group:FID").map((function(t){return t.substr(17).split(" ").map((function(t){return parseInt(t,10)}))}));c.length>0&&c[0].length>1&&c[0][0]===u&&(e=c[0][1]),r.codecs.forEach((function(t){if("RTX"===t.name.toUpperCase()&&t.parameters.apt){var i={ssrc:u,codecPayloadType:parseInt(t.parameters.apt,10)};u&&e&&(i.rtx={ssrc:e}),n.push(i),s&&((i=JSON.parse(JSON.stringify(i))).fec={ssrc:u,mechanism:a?"red+ulpfec":"red"},n.push(i))}})),0===n.length&&u&&n.push({ssrc:u});var h=i.matchPrefix(t,"b=");return h.length&&(h=0===h[0].indexOf("b=TIAS:")?parseInt(h[0].substr(7),10):0===h[0].indexOf("b=AS:")?1e3*parseInt(h[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(t){t.maxBitrate=h}))),n},i.parseRtcpParameters=function(t){var e={},n=i.matchPrefix(t,"a=ssrc:").map((function(t){return i.parseSsrcMedia(t)})).filter((function(t){return"cname"===t.attribute}))[0];n&&(e.cname=n.value,e.ssrc=n.ssrc);var r=i.matchPrefix(t,"a=rtcp-rsize");e.reducedSize=r.length>0,e.compound=0===r.length;var s=i.matchPrefix(t,"a=rtcp-mux");return e.mux=s.length>0,e},i.parseMsid=function(t){var e,n=i.matchPrefix(t,"a=msid:");if(1===n.length)return{stream:(e=n[0].substr(7).split(" "))[0],track:e[1]};var r=i.matchPrefix(t,"a=ssrc:").map((function(t){return i.parseSsrcMedia(t)})).filter((function(t){return"msid"===t.attribute}));return r.length>0?{stream:(e=r[0].value.split(" "))[0],track:e[1]}:void 0},i.parseSctpDescription=function(t){var e,n=i.parseMLine(t),r=i.matchPrefix(t,"a=max-message-size:");r.length>0&&(e=parseInt(r[0].substr(19),10)),isNaN(e)&&(e=65536);var s=i.matchPrefix(t,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substr(12),10),protocol:n.fmt,maxMessageSize:e};if(i.matchPrefix(t,"a=sctpmap:").length>0){var a=i.matchPrefix(t,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:e}}},i.writeSctpDescription=function(t,e){var n=[];return n="DTLS/SCTP"!==t.protocol?["m="+t.kind+" 9 "+t.protocol+" "+e.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+e.port+"\r\n"]:["m="+t.kind+" 9 "+t.protocol+" "+e.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+e.port+" "+e.protocol+" 65535\r\n"],void 0!==e.maxMessageSize&&n.push("a=max-message-size:"+e.maxMessageSize+"\r\n"),n.join("")},i.generateSessionId=function(){return Math.random().toString().substr(2,21)},i.writeSessionBoilerplate=function(t,e,n){var r=void 0!==e?e:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(t||i.generateSessionId())+" "+r+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},i.writeMediaSection=function(t,e,n,r){var s=i.writeRtpDescription(t.kind,e);if(s+=i.writeIceParameters(t.iceGatherer.getLocalParameters()),s+=i.writeDtlsParameters(t.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),s+="a=mid:"+t.mid+"\r\n",t.direction?s+="a="+t.direction+"\r\n":t.rtpSender&&t.rtpReceiver?s+="a=sendrecv\r\n":t.rtpSender?s+="a=sendonly\r\n":t.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",t.rtpSender){var a="msid:"+r.id+" "+t.rtpSender.track.id+"\r\n";s+="a="+a,s+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" "+a,t.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" "+a,s+="a=ssrc-group:FID "+t.sendEncodingParameters[0].ssrc+" "+t.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",t.rtpSender&&t.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),s},i.getDirection=function(t,e){for(var n=i.splitLines(t),r=0;r<n.length;r++)switch(n[r]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[r].substr(2)}return e?i.getDirection(e):"sendrecv"},i.getKind=function(t){return i.splitLines(t)[0].split(" ")[0].substr(2)},i.isRejected=function(t){return"0"===t.split(" ",2)[1]},i.parseMLine=function(t){var e=i.splitLines(t)[0].substr(2).split(" ");return{kind:e[0],port:parseInt(e[1],10),protocol:e[2],fmt:e.slice(3).join(" ")}},i.parseOLine=function(t){var e=i.matchPrefix(t,"o=")[0].substr(2).split(" ");return{username:e[0],sessionId:e[1],sessionVersion:parseInt(e[2],10),netType:e[3],addressType:e[4],address:e[5]}},i.isValidSDP=function(t){if("string"!=typeof t||0===t.length)return!1;for(var e=i.splitLines(t),n=0;n<e.length;n++)if(e[n].length<2||"="!==e[n].charAt(1))return!1;return!0},"object"==typeof e&&(e.exports=i)},{}],NJ2u:[function(t,e,n){"use strict";var i=t("sdp");function r(t,e,n,r,s){var a=i.writeRtpDescription(t.kind,e);if(a+=i.writeIceParameters(t.iceGatherer.getLocalParameters()),a+=i.writeDtlsParameters(t.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":s||"active"),a+="a=mid:"+t.mid+"\r\n",t.rtpSender&&t.rtpReceiver?a+="a=sendrecv\r\n":t.rtpSender?a+="a=sendonly\r\n":t.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",t.rtpSender){var o=t.rtpSender._initialTrackId||t.rtpSender.track.id;t.rtpSender._initialTrackId=o;var u="msid:"+(r?r.id:"-")+" "+o+"\r\n";a+="a="+u,a+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" "+u,t.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" "+u,a+="a=ssrc-group:FID "+t.sendEncodingParameters[0].ssrc+" "+t.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",t.rtpSender&&t.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),a}function s(t,e){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},i=function(t,e){t=parseInt(t,10);for(var n=0;n<e.length;n++)if(e[n].payloadType===t||e[n].preferredPayloadType===t)return e[n]},r=function(t,e,n,r){var s=i(t.parameters.apt,n),a=i(e.parameters.apt,r);return s&&a&&s.name.toLowerCase()===a.name.toLowerCase()};return t.codecs.forEach((function(i){for(var s=0;s<e.codecs.length;s++){var a=e.codecs[s];if(i.name.toLowerCase()===a.name.toLowerCase()&&i.clockRate===a.clockRate){if("rtx"===i.name.toLowerCase()&&i.parameters&&a.parameters.apt&&!r(i,a,t.codecs,e.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(i.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(t){for(var e=0;e<i.rtcpFeedback.length;e++)if(i.rtcpFeedback[e].type===t.type&&i.rtcpFeedback[e].parameter===t.parameter)return!0;return!1}));break}}})),t.headerExtensions.forEach((function(t){for(var i=0;i<e.headerExtensions.length;i++){var r=e.headerExtensions[i];if(t.uri===r.uri){n.headerExtensions.push(r);break}}})),n}function a(t,e,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[e][t].indexOf(n)}function o(t,e){var n=t.getRemoteCandidates().find((function(t){return e.foundation===t.foundation&&e.ip===t.ip&&e.port===t.port&&e.priority===t.priority&&e.protocol===t.protocol&&e.type===t.type}));return n||t.addRemoteCandidate(e),!n}function u(t,e){var n=new Error(e);return n.name=t,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[t],n}e.exports=function(t,e){function n(e,n){n.addTrack(e),n.dispatchEvent(new t.MediaStreamTrackEvent("addtrack",{track:e}))}function c(e,n,i,r){var s=new Event("track");s.track=n,s.receiver=i,s.transceiver={receiver:i},s.streams=r,t.setTimeout((function(){e._dispatchEvent("track",s)}))}var h=function(n){var r=this,s=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(t){r[t]=s[t].bind(s)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw u("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(t,e){var n=!1;return(t=JSON.parse(JSON.stringify(t))).filter((function(t){if(t&&(t.urls||t.url)){var i=t.urls||t.url;t.url&&!t.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var r="string"==typeof i;return r&&(i=[i]),i=i.filter((function(t){return 0!==t.indexOf("turn:")||-1===t.indexOf("transport=udp")||-1!==t.indexOf("turn:[")||n?0===t.indexOf("stun:")&&e>=14393&&-1===t.indexOf("?transport=udp"):(n=!0,!0)})),delete t.url,t.urls=r?i[0]:i,!!i.length}}))}(n.iceServers||[],e),this._iceGatherers=[],n.iceCandidatePoolSize)for(var a=n.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new t.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=i.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(h.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(h.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),h.prototype.onicecandidate=null,h.prototype.onaddstream=null,h.prototype.ontrack=null,h.prototype.onremovestream=null,h.prototype.onsignalingstatechange=null,h.prototype.oniceconnectionstatechange=null,h.prototype.onconnectionstatechange=null,h.prototype.onicegatheringstatechange=null,h.prototype.onnegotiationneeded=null,h.prototype.ondatachannel=null,h.prototype._dispatchEvent=function(t,e){this._isClosed||(this.dispatchEvent(e),"function"==typeof this["on"+t]&&this["on"+t](e))},h.prototype._emitGatheringStateChange=function(){var t=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",t)},h.prototype.getConfiguration=function(){return this._config},h.prototype.getLocalStreams=function(){return this.localStreams},h.prototype.getRemoteStreams=function(){return this.remoteStreams},h.prototype._createTransceiver=function(t,e){var n=this.transceivers.length>0,i={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:t,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)i.iceTransport=this.transceivers[0].iceTransport,i.dtlsTransport=this.transceivers[0].dtlsTransport;else{var r=this._createIceAndDtlsTransports();i.iceTransport=r.iceTransport,i.dtlsTransport=r.dtlsTransport}return e||this.transceivers.push(i),i},h.prototype.addTrack=function(e,n){if(this._isClosed)throw u("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var i;if(this.transceivers.find((function(t){return t.track===e})))throw u("InvalidAccessError","Track already exists.");for(var r=0;r<this.transceivers.length;r++)this.transceivers[r].track||this.transceivers[r].kind!==e.kind||(i=this.transceivers[r]);return i||(i=this._createTransceiver(e.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),i.track=e,i.stream=n,i.rtpSender=new t.RTCRtpSender(e,i.dtlsTransport),i.rtpSender},h.prototype.addStream=function(t){var n=this;if(e>=15025)t.getTracks().forEach((function(e){n.addTrack(e,t)}));else{var i=t.clone();t.getTracks().forEach((function(t,e){var n=i.getTracks()[e];t.addEventListener("enabled",(function(t){n.enabled=t.enabled}))})),i.getTracks().forEach((function(t){n.addTrack(t,i)}))}},h.prototype.removeTrack=function(e){if(this._isClosed)throw u("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(e instanceof t.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(t){return t.rtpSender===e}));if(!n)throw u("InvalidAccessError","Sender was not created by this connection.");var i=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(t){return t.stream})).indexOf(i)&&this.localStreams.indexOf(i)>-1&&this.localStreams.splice(this.localStreams.indexOf(i),1),this._maybeFireNegotiationNeeded()},h.prototype.removeStream=function(t){var e=this;t.getTracks().forEach((function(t){var n=e.getSenders().find((function(e){return e.track===t}));n&&e.removeTrack(n)}))},h.prototype.getSenders=function(){return this.transceivers.filter((function(t){return!!t.rtpSender})).map((function(t){return t.rtpSender}))},h.prototype.getReceivers=function(){return this.transceivers.filter((function(t){return!!t.rtpReceiver})).map((function(t){return t.rtpReceiver}))},h.prototype._createIceGatherer=function(e,n){var i=this;if(n&&e>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var r=new t.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(r,"state",{value:"new",writable:!0}),this.transceivers[e].bufferedCandidateEvents=[],this.transceivers[e].bufferCandidates=function(t){var n=!t.candidate||0===Object.keys(t.candidate).length;r.state=n?"completed":"gathering",null!==i.transceivers[e].bufferedCandidateEvents&&i.transceivers[e].bufferedCandidateEvents.push(t)},r.addEventListener("localcandidate",this.transceivers[e].bufferCandidates),r},h.prototype._gather=function(e,n){var r=this,s=this.transceivers[n].iceGatherer;if(!s.onlocalcandidate){var a=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,s.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),s.onlocalcandidate=function(t){if(!(r.usingBundle&&n>0)){var a=new Event("icecandidate");a.candidate={sdpMid:e,sdpMLineIndex:n};var o=t.candidate,u=!o||0===Object.keys(o).length;if(u)"new"!==s.state&&"gathering"!==s.state||(s.state="completed");else{"new"===s.state&&(s.state="gathering"),o.component=1,o.ufrag=s.getLocalParameters().usernameFragment;var c=i.writeCandidate(o);a.candidate=Object.assign(a.candidate,i.parseCandidate(c)),a.candidate.candidate=c,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var h=i.getMediaSections(r._localDescription.sdp);h[a.candidate.sdpMLineIndex]+=u?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",r._localDescription.sdp=i.getDescription(r._localDescription.sdp)+h.join("");var p=r.transceivers.every((function(t){return t.iceGatherer&&"completed"===t.iceGatherer.state}));"gathering"!==r.iceGatheringState&&(r.iceGatheringState="gathering",r._emitGatheringStateChange()),u||r._dispatchEvent("icecandidate",a),p&&(r._dispatchEvent("icecandidate",new Event("icecandidate")),r.iceGatheringState="complete",r._emitGatheringStateChange())}},t.setTimeout((function(){a.forEach((function(t){s.onlocalcandidate(t)}))}),0)}},h.prototype._createIceAndDtlsTransports=function(){var e=this,n=new t.RTCIceTransport(null);n.onicestatechange=function(){e._updateIceConnectionState(),e._updateConnectionState()};var i=new t.RTCDtlsTransport(n);return i.ondtlsstatechange=function(){e._updateConnectionState()},i.onerror=function(){Object.defineProperty(i,"state",{value:"failed",writable:!0}),e._updateConnectionState()},{iceTransport:n,dtlsTransport:i}},h.prototype._disposeIceAndDtlsTransports=function(t){var e=this.transceivers[t].iceGatherer;e&&(delete e.onlocalcandidate,delete this.transceivers[t].iceGatherer);var n=this.transceivers[t].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[t].iceTransport);var i=this.transceivers[t].dtlsTransport;i&&(delete i.ondtlsstatechange,delete i.onerror,delete this.transceivers[t].dtlsTransport)},h.prototype._transceive=function(t,n,r){var a=s(t.localCapabilities,t.remoteCapabilities);n&&t.rtpSender&&(a.encodings=t.sendEncodingParameters,a.rtcp={cname:i.localCName,compound:t.rtcpParameters.compound},t.recvEncodingParameters.length&&(a.rtcp.ssrc=t.recvEncodingParameters[0].ssrc),t.rtpSender.send(a)),r&&t.rtpReceiver&&a.codecs.length>0&&("video"===t.kind&&t.recvEncodingParameters&&e<15019&&t.recvEncodingParameters.forEach((function(t){delete t.rtx})),t.recvEncodingParameters.length?a.encodings=t.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:t.rtcpParameters.compound},t.rtcpParameters.cname&&(a.rtcp.cname=t.rtcpParameters.cname),t.sendEncodingParameters.length&&(a.rtcp.ssrc=t.sendEncodingParameters[0].ssrc),t.rtpReceiver.receive(a))},h.prototype.setLocalDescription=function(t){var e,n,r=this;if(-1===["offer","answer"].indexOf(t.type))return Promise.reject(u("TypeError",'Unsupported type "'+t.type+'"'));if(!a("setLocalDescription",t.type,r.signalingState)||r._isClosed)return Promise.reject(u("InvalidStateError","Can not set local "+t.type+" in state "+r.signalingState));if("offer"===t.type)e=i.splitSections(t.sdp),n=e.shift(),e.forEach((function(t,e){var n=i.parseRtpParameters(t);r.transceivers[e].localCapabilities=n})),r.transceivers.forEach((function(t,e){r._gather(t.mid,e)}));else if("answer"===t.type){e=i.splitSections(r._remoteDescription.sdp),n=e.shift();var o=i.matchPrefix(n,"a=ice-lite").length>0;e.forEach((function(t,e){var a=r.transceivers[e],u=a.iceGatherer,c=a.iceTransport,h=a.dtlsTransport,p=a.localCapabilities,_=a.remoteCapabilities;if(!(i.isRejected(t)&&0===i.matchPrefix(t,"a=bundle-only").length||a.rejected)){var l=i.getIceParameters(t,n),d=i.getDtlsParameters(t,n);o&&(d.role="server"),r.usingBundle&&0!==e||(r._gather(a.mid,e),"new"===c.state&&c.start(u,l,o?"controlling":"controlled"),"new"===h.state&&h.start(d));var f=s(p,_);r._transceive(a,f.codecs.length>0,!1)}}))}return r._localDescription={type:t.type,sdp:t.sdp},"offer"===t.type?r._updateSignalingState("have-local-offer"):r._updateSignalingState("stable"),Promise.resolve()},h.prototype.setRemoteDescription=function(r){var h=this;if(-1===["offer","answer"].indexOf(r.type))return Promise.reject(u("TypeError",'Unsupported type "'+r.type+'"'));if(!a("setRemoteDescription",r.type,h.signalingState)||h._isClosed)return Promise.reject(u("InvalidStateError","Can not set remote "+r.type+" in state "+h.signalingState));var p={};h.remoteStreams.forEach((function(t){p[t.id]=t}));var _=[],l=i.splitSections(r.sdp),d=l.shift(),f=i.matchPrefix(d,"a=ice-lite").length>0,m=i.matchPrefix(d,"a=group:BUNDLE ").length>0;h.usingBundle=m;var g=i.matchPrefix(d,"a=ice-options:")[0];return h.canTrickleIceCandidates=!!g&&g.substr(14).split(" ").indexOf("trickle")>=0,l.forEach((function(a,u){var c=i.splitLines(a),l=i.getKind(a),g=i.isRejected(a)&&0===i.matchPrefix(a,"a=bundle-only").length,v=c[0].substr(2).split(" ")[2],y=i.getDirection(a,d),b=i.parseMsid(a),w=i.getMid(a)||i.generateIdentifier();if(g||"application"===l&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))h.transceivers[u]={mid:w,kind:l,protocol:v,rejected:!0};else{var x,k,T,C,S,M,E,P,O;!g&&h.transceivers[u]&&h.transceivers[u].rejected&&(h.transceivers[u]=h._createTransceiver(l,!0));var R,j,D=i.parseRtpParameters(a);g||(R=i.getIceParameters(a,d),(j=i.getDtlsParameters(a,d)).role="client"),E=i.parseRtpEncodingParameters(a);var A=i.parseRtcpParameters(a),L=i.matchPrefix(a,"a=end-of-candidates",d).length>0,I=i.matchPrefix(a,"a=candidate:").map((function(t){return i.parseCandidate(t)})).filter((function(t){return 1===t.component}));if(("offer"===r.type||"answer"===r.type)&&!g&&m&&u>0&&h.transceivers[u]&&(h._disposeIceAndDtlsTransports(u),h.transceivers[u].iceGatherer=h.transceivers[0].iceGatherer,h.transceivers[u].iceTransport=h.transceivers[0].iceTransport,h.transceivers[u].dtlsTransport=h.transceivers[0].dtlsTransport,h.transceivers[u].rtpSender&&h.transceivers[u].rtpSender.setTransport(h.transceivers[0].dtlsTransport),h.transceivers[u].rtpReceiver&&h.transceivers[u].rtpReceiver.setTransport(h.transceivers[0].dtlsTransport)),"offer"!==r.type||g)"answer"!==r.type||g||(k=(x=h.transceivers[u]).iceGatherer,T=x.iceTransport,C=x.dtlsTransport,S=x.rtpReceiver,M=x.sendEncodingParameters,P=x.localCapabilities,h.transceivers[u].recvEncodingParameters=E,h.transceivers[u].remoteCapabilities=D,h.transceivers[u].rtcpParameters=A,I.length&&"new"===T.state&&(!f&&!L||m&&0!==u?I.forEach((function(t){o(x.iceTransport,t)})):T.setRemoteCandidates(I)),m&&0!==u||("new"===T.state&&T.start(k,R,"controlling"),"new"===C.state&&C.start(j)),!s(x.localCapabilities,x.remoteCapabilities).codecs.filter((function(t){return"rtx"===t.name.toLowerCase()})).length&&x.sendEncodingParameters[0].rtx&&delete x.sendEncodingParameters[0].rtx,h._transceive(x,"sendrecv"===y||"recvonly"===y,"sendrecv"===y||"sendonly"===y),!S||"sendrecv"!==y&&"sendonly"!==y?delete x.rtpReceiver:(O=S.track,b?(p[b.stream]||(p[b.stream]=new t.MediaStream),n(O,p[b.stream]),_.push([O,S,p[b.stream]])):(p.default||(p.default=new t.MediaStream),n(O,p.default),_.push([O,S,p.default]))));else{(x=h.transceivers[u]||h._createTransceiver(l)).mid=w,x.iceGatherer||(x.iceGatherer=h._createIceGatherer(u,m)),I.length&&"new"===x.iceTransport.state&&(!L||m&&0!==u?I.forEach((function(t){o(x.iceTransport,t)})):x.iceTransport.setRemoteCandidates(I)),P=t.RTCRtpReceiver.getCapabilities(l),e<15019&&(P.codecs=P.codecs.filter((function(t){return"rtx"!==t.name}))),M=x.sendEncodingParameters||[{ssrc:1001*(2*u+2)}];var B,N=!1;"sendrecv"===y||"sendonly"===y?(N=!x.rtpReceiver,S=x.rtpReceiver||new t.RTCRtpReceiver(x.dtlsTransport,l),N&&(O=S.track,b&&"-"===b.stream||(b?(p[b.stream]||(p[b.stream]=new t.MediaStream,Object.defineProperty(p[b.stream],"id",{get:function(){return b.stream}})),Object.defineProperty(O,"id",{get:function(){return b.track}}),B=p[b.stream]):(p.default||(p.default=new t.MediaStream),B=p.default)),B&&(n(O,B),x.associatedRemoteMediaStreams.push(B)),_.push([O,S,B]))):x.rtpReceiver&&x.rtpReceiver.track&&(x.associatedRemoteMediaStreams.forEach((function(e){var n,i,r=e.getTracks().find((function(t){return t.id===x.rtpReceiver.track.id}));r&&(n=r,(i=e).removeTrack(n),i.dispatchEvent(new t.MediaStreamTrackEvent("removetrack",{track:n})))})),x.associatedRemoteMediaStreams=[]),x.localCapabilities=P,x.remoteCapabilities=D,x.rtpReceiver=S,x.rtcpParameters=A,x.sendEncodingParameters=M,x.recvEncodingParameters=E,h._transceive(h.transceivers[u],!1,N)}}})),void 0===h._dtlsRole&&(h._dtlsRole="offer"===r.type?"active":"passive"),h._remoteDescription={type:r.type,sdp:r.sdp},"offer"===r.type?h._updateSignalingState("have-remote-offer"):h._updateSignalingState("stable"),Object.keys(p).forEach((function(e){var n=p[e];if(n.getTracks().length){if(-1===h.remoteStreams.indexOf(n)){h.remoteStreams.push(n);var i=new Event("addstream");i.stream=n,t.setTimeout((function(){h._dispatchEvent("addstream",i)}))}_.forEach((function(t){var e=t[0],i=t[1];n.id===t[2].id&&c(h,e,i,[n])}))}})),_.forEach((function(t){t[2]||c(h,t[0],t[1],[])})),t.setTimeout((function(){h&&h.transceivers&&h.transceivers.forEach((function(t){t.iceTransport&&"new"===t.iceTransport.state&&t.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),t.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},h.prototype.close=function(){this.transceivers.forEach((function(t){t.iceTransport&&t.iceTransport.stop(),t.dtlsTransport&&t.dtlsTransport.stop(),t.rtpSender&&t.rtpSender.stop(),t.rtpReceiver&&t.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},h.prototype._updateSignalingState=function(t){this.signalingState=t;var e=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",e)},h.prototype._maybeFireNegotiationNeeded=function(){var e=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,t.setTimeout((function(){if(e.needNegotiation){e.needNegotiation=!1;var t=new Event("negotiationneeded");e._dispatchEvent("negotiationneeded",t)}}),0))},h.prototype._updateIceConnectionState=function(){var t,e={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(t){t.iceTransport&&!t.rejected&&e[t.iceTransport.state]++})),t="new",e.failed>0?t="failed":e.checking>0?t="checking":e.disconnected>0?t="disconnected":e.new>0?t="new":e.connected>0?t="connected":e.completed>0&&(t="completed"),t!==this.iceConnectionState){this.iceConnectionState=t;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},h.prototype._updateConnectionState=function(){var t,e={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(t){t.iceTransport&&t.dtlsTransport&&!t.rejected&&(e[t.iceTransport.state]++,e[t.dtlsTransport.state]++)})),e.connected+=e.completed,t="new",e.failed>0?t="failed":e.connecting>0?t="connecting":e.disconnected>0?t="disconnected":e.new>0?t="new":e.connected>0&&(t="connected"),t!==this.connectionState){this.connectionState=t;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},h.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(u("InvalidStateError","Can not call createOffer after close"));var s=n.transceivers.filter((function(t){return"audio"===t.kind})).length,a=n.transceivers.filter((function(t){return"video"===t.kind})).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==o.offerToReceiveAudio&&(s=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(a=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(n.transceivers.forEach((function(t){"audio"===t.kind?--s<0&&(t.wantReceive=!1):"video"===t.kind&&--a<0&&(t.wantReceive=!1)}));s>0||a>0;)s>0&&(n._createTransceiver("audio"),s--),a>0&&(n._createTransceiver("video"),a--);var c=i.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(r,s){var a=r.track,o=r.kind,u=r.mid||i.generateIdentifier();r.mid=u,r.iceGatherer||(r.iceGatherer=n._createIceGatherer(s,n.usingBundle));var c=t.RTCRtpSender.getCapabilities(o);e<15019&&(c.codecs=c.codecs.filter((function(t){return"rtx"!==t.name}))),c.codecs.forEach((function(t){"H264"===t.name&&void 0===t.parameters["level-asymmetry-allowed"]&&(t.parameters["level-asymmetry-allowed"]="1"),r.remoteCapabilities&&r.remoteCapabilities.codecs&&r.remoteCapabilities.codecs.forEach((function(e){t.name.toLowerCase()===e.name.toLowerCase()&&t.clockRate===e.clockRate&&(t.preferredPayloadType=e.payloadType)}))})),c.headerExtensions.forEach((function(t){(r.remoteCapabilities&&r.remoteCapabilities.headerExtensions||[]).forEach((function(e){t.uri===e.uri&&(t.id=e.id)}))}));var h=r.sendEncodingParameters||[{ssrc:1001*(2*s+1)}];a&&e>=15019&&"video"===o&&!h[0].rtx&&(h[0].rtx={ssrc:h[0].ssrc+1}),r.wantReceive&&(r.rtpReceiver=new t.RTCRtpReceiver(r.dtlsTransport,o)),r.localCapabilities=c,r.sendEncodingParameters=h})),"max-compat"!==n._config.bundlePolicy&&(c+="a=group:BUNDLE "+n.transceivers.map((function(t){return t.mid})).join(" ")+"\r\n"),c+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(t,e){c+=r(t,t.localCapabilities,"offer",t.stream,n._dtlsRole),c+="a=rtcp-rsize\r\n",!t.iceGatherer||"new"===n.iceGatheringState||0!==e&&n.usingBundle||(t.iceGatherer.getLocalCandidates().forEach((function(t){t.component=1,c+="a="+i.writeCandidate(t)+"\r\n"})),"completed"===t.iceGatherer.state&&(c+="a=end-of-candidates\r\n"))}));var h=new t.RTCSessionDescription({type:"offer",sdp:c});return Promise.resolve(h)},h.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(u("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(u("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var a=i.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(a+="a=group:BUNDLE "+n.transceivers.map((function(t){return t.mid})).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var o=i.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(t,i){if(!(i+1>o)){if(t.rejected)return"application"===t.kind?"DTLS/SCTP"===t.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+t.protocol+" webrtc-datachannel\r\n":"audio"===t.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===t.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+t.mid+"\r\n");var u;t.stream&&("audio"===t.kind?u=t.stream.getAudioTracks()[0]:"video"===t.kind&&(u=t.stream.getVideoTracks()[0]),u&&e>=15019&&"video"===t.kind&&!t.sendEncodingParameters[0].rtx&&(t.sendEncodingParameters[0].rtx={ssrc:t.sendEncodingParameters[0].ssrc+1}));var c=s(t.localCapabilities,t.remoteCapabilities);!c.codecs.filter((function(t){return"rtx"===t.name.toLowerCase()})).length&&t.sendEncodingParameters[0].rtx&&delete t.sendEncodingParameters[0].rtx,a+=r(t,c,"answer",t.stream,n._dtlsRole),t.rtcpParameters&&t.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}}));var c=new t.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(c)},h.prototype.addIceCandidate=function(t){var e,n=this;return t&&void 0===t.sdpMLineIndex&&!t.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(r,s){if(!n._remoteDescription)return s(u("InvalidStateError","Can not add ICE candidate without a remote description"));if(t&&""!==t.candidate){var a=t.sdpMLineIndex;if(t.sdpMid)for(var c=0;c<n.transceivers.length;c++)if(n.transceivers[c].mid===t.sdpMid){a=c;break}var h=n.transceivers[a];if(!h)return s(u("OperationError","Can not add ICE candidate"));if(h.rejected)return r();var p=Object.keys(t.candidate).length>0?i.parseCandidate(t.candidate):{};if("tcp"===p.protocol&&(0===p.port||9===p.port))return r();if(p.component&&1!==p.component)return r();if((0===a||a>0&&h.iceTransport!==n.transceivers[0].iceTransport)&&!o(h.iceTransport,p))return s(u("OperationError","Can not add ICE candidate"));var _=t.candidate.trim();0===_.indexOf("a=")&&(_=_.substr(2)),(e=i.getMediaSections(n._remoteDescription.sdp))[a]+="a="+(p.type?_:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=i.getDescription(n._remoteDescription.sdp)+e.join("")}else for(var l=0;l<n.transceivers.length&&(n.transceivers[l].rejected||(n.transceivers[l].iceTransport.addRemoteCandidate({}),(e=i.getMediaSections(n._remoteDescription.sdp))[l]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=i.getDescription(n._remoteDescription.sdp)+e.join(""),!n.usingBundle));l++);r()}))},h.prototype.getStats=function(e){if(e&&e instanceof t.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(t){t.rtpSender&&t.rtpSender.track===e?n=t.rtpSender:t.rtpReceiver&&t.rtpReceiver.track===e&&(n=t.rtpReceiver)})),!n)throw u("InvalidAccessError","Invalid selector.");return n.getStats()}var i=[];return this.transceivers.forEach((function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(e){t[e]&&i.push(t[e].getStats())}))})),Promise.all(i).then((function(t){var e=new Map;return t.forEach((function(t){t.forEach((function(t){e.set(t.id,t)}))})),e}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(e){var n=t[e];if(n&&n.prototype&&n.prototype.getStats){var i=n.prototype.getStats;n.prototype.getStats=function(){return i.apply(this).then((function(t){var e=new Map;return Object.keys(t).forEach((function(n){t[n].type=function(t){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type}(t[n]),e.set(n,t[n])})),e}))}}}));var p=["createOffer","createAnswer"];return p.forEach((function(t){var e=h.prototype[t];h.prototype[t]=function(){var t=arguments;return"function"==typeof t[0]||"function"==typeof t[1]?e.apply(this,[arguments[2]]).then((function(e){"function"==typeof t[0]&&t[0].apply(null,[e])}),(function(e){"function"==typeof t[1]&&t[1].apply(null,[e])})):e.apply(this,arguments)}})),(p=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(t){var e=h.prototype[t];h.prototype[t]=function(){var t=arguments;return"function"==typeof t[1]||"function"==typeof t[2]?e.apply(this,arguments).then((function(){"function"==typeof t[1]&&t[1].apply(null)}),(function(e){"function"==typeof t[2]&&t[2].apply(null,[e])})):e.apply(this,arguments)}})),["getStats"].forEach((function(t){var e=h.prototype[t];h.prototype[t]=function(){var t=arguments;return"function"==typeof t[1]?e.apply(this,arguments).then((function(){"function"==typeof t[1]&&t[1].apply(null)})):e.apply(this,arguments)}})),h}},{sdp:"YHvh"}],YdKx:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(t){var e=t&&t.navigator,n=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(t){return n(t).catch((function(t){return Promise.reject(function(t){return{name:{PermissionDeniedError:"NotAllowedError"}[t.name]||t.name,message:t.message,constraint:t.constraint,toString:function(){return this.name}}}(t))}))}}},{}],P3bV:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(t){"getDisplayMedia"in t.navigator&&t.navigator.mediaDevices&&(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||(t.navigator.mediaDevices.getDisplayMedia=t.navigator.getDisplayMedia.bind(t.navigator)))}},{}],XRic:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimPeerConnection=function(t){var e=i.detectBrowser(t);if(t.RTCIceGatherer&&(t.RTCIceCandidate||(t.RTCIceCandidate=function(t){return t}),t.RTCSessionDescription||(t.RTCSessionDescription=function(t){return t}),e.version<15025)){var n=Object.getOwnPropertyDescriptor(t.MediaStreamTrack.prototype,"enabled");Object.defineProperty(t.MediaStreamTrack.prototype,"enabled",{set:function(t){n.set.call(this,t);var e=new Event("enabled");e.enabled=t,this.dispatchEvent(e)}})}!t.RTCRtpSender||"dtmf"in t.RTCRtpSender.prototype||Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new t.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),t.RTCDtmfSender&&!t.RTCDTMFSender&&(t.RTCDTMFSender=t.RTCDtmfSender);var a=(0,s.default)(t,e.version);t.RTCPeerConnection=function(t){return t&&t.iceServers&&(t.iceServers=(0,r.filterIceServers)(t.iceServers,e.version),i.log("ICE servers after filtering:",t.iceServers)),new a(t)},t.RTCPeerConnection.prototype=a.prototype},n.shimReplaceTrack=function(t){!t.RTCRtpSender||"replaceTrack"in t.RTCRtpSender.prototype||(t.RTCRtpSender.prototype.replaceTrack=t.RTCRtpSender.prototype.setTrack)},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return a.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}});var i=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var s=i?Object.getOwnPropertyDescriptor(t,r):null;s&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=t[r]}return n.default=t,e&&e.set(t,n),n}(t("../utils")),r=t("./filtericeservers"),s=function(t){return t&&t.__esModule?t:{default:t}}(t("rtcpeerconnection-shim")),a=t("./getusermedia"),o=t("./getdisplaymedia");function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}},{"../utils":"iSxC","./filtericeservers":"NZ1C","rtcpeerconnection-shim":"NJ2u","./getusermedia":"YdKx","./getdisplaymedia":"P3bV"}],GzSv:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(t){var e=i.detectBrowser(t),n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(t,e,r){i.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(t).then(e,r)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var a=function(t,e,n){e in t&&!(n in t)&&(t[n]=t[e],delete t[e])},o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(t){return"object"===s(t)&&"object"===s(t.audio)&&(t=JSON.parse(JSON.stringify(t)),a(t.audio,"autoGainControl","mozAutoGainControl"),a(t.audio,"noiseSuppression","mozNoiseSuppression")),o(t)},r&&r.prototype.getSettings){var u=r.prototype.getSettings;r.prototype.getSettings=function(){var t=u.apply(this,arguments);return a(t,"mozAutoGainControl","autoGainControl"),a(t,"mozNoiseSuppression","noiseSuppression"),t}}if(r&&r.prototype.applyConstraints){var c=r.prototype.applyConstraints;r.prototype.applyConstraints=function(t){return"audio"===this.kind&&"object"===s(t)&&(t=JSON.parse(JSON.stringify(t)),a(t,"autoGainControl","mozAutoGainControl"),a(t,"noiseSuppression","mozNoiseSuppression")),c.apply(this,[t])}}}};var i=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var a=i?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}return n.default=t,e&&e.set(t,n),n}(t("../utils"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}},{"../utils":"iSxC"}],UuGU:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return!0===n.video?n.video={mediaSource:e}:n.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(n)})}},{}],Fzdr:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimOnTrack=function(t){"object"===o(t)&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(t){var e=i.detectBrowser(t);if("object"===o(t)&&(t.RTCPeerConnection||t.mozRTCPeerConnection)){if(!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(e){var n=t.RTCPeerConnection.prototype[e],i=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},e,(function(){return arguments[0]=new("addIceCandidate"===e?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));t.RTCPeerConnection.prototype[e]=i[e]})),e.version<68){var n=t.RTCPeerConnection.prototype.addIceCandidate;t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){var[t,n,i]=arguments;return s.apply(this,[t||null]).then((function(t){if(e.version<53&&!n)try{t.forEach((function(t){t.type=r[t.type]||t.type}))}catch(e){if("TypeError"!==e.name)throw e;t.forEach((function(e,n){t.set(n,Object.assign({},e,{type:r[e.type]||e.type}))}))}return t})).then(n,i)}}},n.shimSenderGetStats=function(t){if("object"===o(t)&&t.RTCPeerConnection&&t.RTCRtpSender&&(!t.RTCRtpSender||!("getStats"in t.RTCRtpSender.prototype))){var e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){var t=this,n=e.apply(this,[]);return n.forEach((function(e){return e._pc=t})),n});var n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){var t=n.apply(this,arguments);return t._pc=this,t}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},n.shimReceiverGetStats=function(t){if("object"===o(t)&&t.RTCPeerConnection&&t.RTCRtpSender&&(!t.RTCRtpSender||!("getStats"in t.RTCRtpReceiver.prototype))){var e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){var t=this,n=e.apply(this,[]);return n.forEach((function(e){return e._pc=t})),n}),i.wrapPeerConnectionEvent(t,"track",(function(t){return t.receiver._pc=t.srcElement,t})),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},n.shimRemoveStream=function(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(t){var e=this;i.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&t.getTracks().includes(n.track)&&e.removeTrack(n)}))})},n.shimRTCDataChannel=function(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)},n.shimAddTransceiver=function(t){if("object"===o(t)&&t.RTCPeerConnection){var e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var t=arguments[1],n=t&&"sendEncodings"in t;n&&t.sendEncodings.forEach((function(t){if("rid"in t&&!/^[a-z0-9]{0,16}$/i.test(t.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in t&&!(parseFloat(t.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in t&&!(parseFloat(t.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var i=e.apply(this,arguments);if(n){var{sender:r}=i,s=r.getParameters();"encodings"in s||(s.encodings=t.sendEncodings,this.setParametersPromises.push(r.setParameters(s).catch((function(){}))))}return i})}},n.shimCreateOffer=function(t){if("object"===o(t)&&t.RTCPeerConnection){var e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){var t=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return e.apply(n,t)})).finally((function(){n.setParametersPromises=[]})):e.apply(this,arguments)}}},n.shimCreateAnswer=function(t){if("object"===o(t)&&t.RTCPeerConnection){var e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){var t=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return e.apply(n,t)})).finally((function(){n.setParametersPromises=[]})):e.apply(this,arguments)}}},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}});var i=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var s=i?Object.getOwnPropertyDescriptor(t,r):null;s&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=t[r]}return n.default=t,e&&e.set(t,n),n}(t("../utils")),r=t("./getusermedia"),s=t("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}},{"../utils":"iSxC","./getusermedia":"GzSv","./getdisplaymedia":"UuGU"}],t1lL:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimLocalStreamsAPI=function(t){if("object"===s(t)&&t.RTCPeerConnection){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){var e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(t){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach((function(i){return e.call(n,i,t)})),t.getVideoTracks().forEach((function(i){return e.call(n,i,t)}))},t.RTCPeerConnection.prototype.addTrack=function(t){var n=arguments[1];return n&&(this._localStreams?this._localStreams.includes(n)||this._localStreams.push(n):this._localStreams=[n]),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(t){var e=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(t);if(-1!==n){this._localStreams.splice(n,1);var i=t.getTracks();this.getSenders().forEach((function(t){i.includes(t.track)&&e.removeTrack(t)}))}})}},n.shimRemoteStreamsAPI=function(t){if("object"===s(t)&&t.RTCPeerConnection&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(t){var e=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!e._remoteStreams.includes(t)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))})}});var e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){var t=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!(t._remoteStreams.indexOf(e)>=0)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}}))}),e.apply(t,arguments)}}},n.shimCallbacksAPI=function(t){if("object"===s(t)&&t.RTCPeerConnection){var e=t.RTCPeerConnection.prototype,n=e.createOffer,i=e.createAnswer,r=e.setLocalDescription,a=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(t,e){var i=arguments.length>=2?arguments[2]:arguments[0],r=n.apply(this,[i]);return e?(r.then(t,e),Promise.resolve()):r},e.createAnswer=function(t,e){var n=arguments.length>=2?arguments[2]:arguments[0],r=i.apply(this,[n]);return e?(r.then(t,e),Promise.resolve()):r};var u=function(t,e,n){var i=r.apply(this,[t]);return n?(i.then(e,n),Promise.resolve()):i};e.setLocalDescription=u,u=function(t,e,n){var i=a.apply(this,[t]);return n?(i.then(e,n),Promise.resolve()):i},e.setRemoteDescription=u,u=function(t,e,n){var i=o.apply(this,[t]);return n?(i.then(e,n),Promise.resolve()):i},e.addIceCandidate=u}},n.shimGetUserMedia=function(t){var e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){var n=e.mediaDevices,i=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=function(t){return i(a(t))}}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=function(t,n,i){e.mediaDevices.getUserMedia(t).then(n,i)}.bind(e))},n.shimConstraints=a,n.shimRTCIceServerUrls=function(t){var e=t.RTCPeerConnection;t.RTCPeerConnection=function(t,n){if(t&&t.iceServers){for(var r=[],s=0;s<t.iceServers.length;s++){var a=t.iceServers[s];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(i.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,r.push(a)):r.push(t.iceServers[s])}t.iceServers=r}return new e(t,n)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in t.RTCPeerConnection&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:function(){return e.generateCertificate}})},n.shimTrackEventTransceiver=function(t){"object"===s(t)&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function(t){var e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(t){if(t){void 0!==t.offerToReceiveAudio&&(t.offerToReceiveAudio=!!t.offerToReceiveAudio);var n=this.getTransceivers().find((function(t){return"audio"===t.receiver.track.kind}));!1===t.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==t.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==t.offerToReceiveVideo&&(t.offerToReceiveVideo=!!t.offerToReceiveVideo);var i=this.getTransceivers().find((function(t){return"video"===t.receiver.track.kind}));!1===t.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==t.offerToReceiveVideo||i||this.addTransceiver("video")}return e.apply(this,arguments)}};var i=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var a=i?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}return n.default=t,e&&e.set(t,n),n}(t("../utils"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){return t&&void 0!==t.video?Object.assign({},t,{video:i.compactObject(t.video)}):t}},{"../utils":"iSxC"}],GOQK:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimRTCIceCandidate=function(t){if(t.RTCIceCandidate&&(!t.RTCIceCandidate||!("foundation"in t.RTCIceCandidate.prototype))){var e=t.RTCIceCandidate;t.RTCIceCandidate=function(t){if("object"===a(t)&&t.candidate&&0===t.candidate.indexOf("a=")&&((t=JSON.parse(JSON.stringify(t))).candidate=t.candidate.substr(2)),t.candidate&&t.candidate.length){var n=new e(t),r=i.default.parseCandidate(t.candidate),s=Object.assign(n,r);return s.toJSON=function(){return{candidate:s.candidate,sdpMid:s.sdpMid,sdpMLineIndex:s.sdpMLineIndex,usernameFragment:s.usernameFragment}},s}return new e(t)},t.RTCIceCandidate.prototype=e.prototype,r.wrapPeerConnectionEvent(t,"icecandidate",(function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new t.RTCIceCandidate(e.candidate),writable:"false"}),e}))}},n.shimMaxMessageSize=function(t){if(t.RTCPeerConnection){var e=r.detectBrowser(t);"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===e.browser&&e.version>=76){var{sdpSemantics:t}=this.getConfiguration();"plan-b"===t&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(t){if(!t||!t.sdp)return!1;var e=i.default.splitSections(t.sdp);return e.shift(),e.some((function(t){var e=i.default.parseMLine(t);return e&&"application"===e.kind&&-1!==e.protocol.indexOf("SCTP")}))}(arguments[0])){var r,s=function(t){var e=t.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===e||e.length<2)return-1;var n=parseInt(e[1],10);return n!=n?-1:n}(arguments[0]),a=(c=s,h=65536,"firefox"===e.browser&&(h=e.version<57?-1===c?16384:2147483637:e.version<60?57===e.version?65535:65536:2147483637),h),o=function(t,n){var r=65536;"firefox"===e.browser&&57===e.version&&(r=65535);var s=i.default.matchPrefix(t.sdp,"a=max-message-size:");return s.length>0?r=parseInt(s[0].substr(19),10):"firefox"===e.browser&&-1!==n&&(r=2147483637),r}(arguments[0],s);r=0===a&&0===o?Number.POSITIVE_INFINITY:0===a||0===o?Math.max(a,o):Math.min(a,o);var u={};Object.defineProperty(u,"maxMessageSize",{get:function(){return r}}),this._sctp=u}var c,h;return n.apply(this,arguments)}}},n.shimSendThrowTypeError=function(t){if(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype){var e=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){var t=e.apply(this,arguments);return n(t,this),t},r.wrapPeerConnectionEvent(t,"datachannel",(function(t){return n(t.channel,t.target),t}))}function n(t,e){var n=t.send;t.send=function(){var i=arguments[0],r=i.length||i.size||i.byteLength;if("open"===t.readyState&&e.sctp&&r>e.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+e.sctp.maxMessageSize+" bytes)");return n.apply(t,arguments)}}},n.shimConnectionState=function(t){if(t.RTCPeerConnection&&!("connectionState"in t.RTCPeerConnection.prototype)){var e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(t){var n=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(t){var e=t.target;if(e._lastConnectionState!==e.connectionState){e._lastConnectionState=e.connectionState;var n=new Event("connectionstatechange",t);e.dispatchEvent(n)}return t},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}},n.removeAllowExtmapMixed=function(t){if(t.RTCPeerConnection){var e=r.detectBrowser(t);if(!("chrome"===e.browser&&e.version>=71)){var n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(t){return t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")&&(t.sdp=t.sdp.split("\n").filter((function(t){return"a=extmap-allow-mixed"!==t.trim()})).join("\n")),n.apply(this,arguments)}}}};var i=function(t){return t&&t.__esModule?t:{default:t}}(t("sdp")),r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var a=i?Object.getOwnPropertyDescriptor(t,r):null;a&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=t[r]}return n.default=t,e&&e.set(t,n),n}(t("./utils"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}},{sdp:"YHvh","./utils":"iSxC"}],KtlG:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var{window:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},n=i.log,c=i.detectBrowser(t),h={browserDetails:c,commonShim:u,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings};switch(c.browser){case"chrome":if(!r||!r.shimPeerConnection||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),h;n("adapter.js shimming chrome."),h.browserShim=r,r.shimGetUserMedia(t),r.shimMediaStream(t),r.shimPeerConnection(t),r.shimOnTrack(t),r.shimAddTrackRemoveTrack(t),r.shimGetSendersWithDtmf(t),r.shimGetStats(t),r.shimSenderReceiverGetStats(t),r.fixNegotiationNeeded(t),u.shimRTCIceCandidate(t),u.shimConnectionState(t),u.shimMaxMessageSize(t),u.shimSendThrowTypeError(t),u.removeAllowExtmapMixed(t);break;case"firefox":if(!a||!a.shimPeerConnection||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),h;n("adapter.js shimming firefox."),h.browserShim=a,a.shimGetUserMedia(t),a.shimPeerConnection(t),a.shimOnTrack(t),a.shimRemoveStream(t),a.shimSenderGetStats(t),a.shimReceiverGetStats(t),a.shimRTCDataChannel(t),a.shimAddTransceiver(t),a.shimCreateOffer(t),a.shimCreateAnswer(t),u.shimRTCIceCandidate(t),u.shimConnectionState(t),u.shimMaxMessageSize(t),u.shimSendThrowTypeError(t);break;case"edge":if(!s||!s.shimPeerConnection||!e.shimEdge)return n("MS edge shim is not included in this adapter release."),h;n("adapter.js shimming edge."),h.browserShim=s,s.shimGetUserMedia(t),s.shimGetDisplayMedia(t),s.shimPeerConnection(t),s.shimReplaceTrack(t),u.shimMaxMessageSize(t),u.shimSendThrowTypeError(t);break;case"safari":if(!o||!e.shimSafari)return n("Safari shim is not included in this adapter release."),h;n("adapter.js shimming safari."),h.browserShim=o,o.shimRTCIceServerUrls(t),o.shimCreateOfferLegacy(t),o.shimCallbacksAPI(t),o.shimLocalStreamsAPI(t),o.shimRemoteStreamsAPI(t),o.shimTrackEventTransceiver(t),o.shimGetUserMedia(t),u.shimRTCIceCandidate(t),u.shimMaxMessageSize(t),u.shimSendThrowTypeError(t),u.removeAllowExtmapMixed(t);break;default:n("Unsupported browser!")}return h};var i=h(t("./utils")),r=h(t("./chrome/chrome_shim")),s=h(t("./edge/edge_shim")),a=h(t("./firefox/firefox_shim")),o=h(t("./safari/safari_shim")),u=h(t("./common_shim"));function c(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return c=function(){return t},t}function h(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=c();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var s=i?Object.getOwnPropertyDescriptor(t,r):null;s&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=t[r]}return n.default=t,e&&e.set(t,n),n}},{"./utils":"iSxC","./chrome/chrome_shim":"uI5X","./edge/edge_shim":"XRic","./firefox/firefox_shim":"Fzdr","./safari/safari_shim":"t1lL","./common_shim":"GOQK"}],tI1X:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=(0,t("./adapter_factory.js").adapterFactory)({window});n.default=i},{"./adapter_factory.js":"KtlG"}],sXtV:[function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var r=i(t("webrtc-adapter"));n.webRTCAdapter=r.default},{"webrtc-adapter":"tI1X"}],I31f:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./adapter");n.Supports=new(function(){function t(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return t.prototype.isWebRTCSupported=function(){return"undefined"!=typeof RTCPeerConnection},t.prototype.isBrowserSupported=function(){var t=this.getBrowser(),e=this.getVersion();return!!this.supportedBrowsers.includes(t)&&("chrome"===t?e>=this.minChromeVersion:"firefox"===t?e>=this.minFirefoxVersion:"safari"===t&&!this.isIOS&&e>=this.minSafariVersion)},t.prototype.getBrowser=function(){return i.webRTCAdapter.browserDetails.browser},t.prototype.getVersion=function(){return i.webRTCAdapter.browserDetails.version||0},t.prototype.isUnifiedPlanSupported=function(){var t,e=this.getBrowser(),n=i.webRTCAdapter.browserDetails.version||0;if("chrome"===e&&n<72)return!1;if("firefox"===e&&n>=59)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var r=!1;try{(t=new RTCPeerConnection).addTransceiver("audio"),r=!0}catch(t){}finally{t&&t.close()}return r},t.prototype.toString=function(){return"Supports: \n    browser:"+this.getBrowser()+" \n    version:"+this.getVersion()+" \n    isIOS:"+this.isIOS+" \n    isWebRTCSupported:"+this.isWebRTCSupported()+" \n    isBrowserSupported:"+this.isBrowserSupported()+" \n    isUnifiedPlanSupported:"+this.isUnifiedPlanSupported()},t}())},{"./adapter":"sXtV"}],BHXf:[function(t,e,n){"use strict";var i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(n,"__esModule",{value:!0});var r=i(t("peerjs-js-binarypack")),s=t("./supports"),a={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0.peerjs.com:3478",username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};n.util=new(function(){function t(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=a,this.browser=s.Supports.getBrowser(),this.browserVersion=s.Supports.getVersion(),this.supports=function(){var t,e={browser:s.Supports.isBrowserSupported(),webRTC:s.Supports.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!e.webRTC)return e;try{t=new RTCPeerConnection(a),e.audioVideo=!0;var n=void 0;try{n=t.createDataChannel("_PEERJSTEST",{ordered:!0}),e.data=!0,e.reliable=!!n.ordered;try{n.binaryType="blob",e.binaryBlob=!s.Supports.isIOS}catch(t){}}catch(t){}finally{n&&n.close()}}catch(t){}finally{t&&t.close()}return e}(),this.pack=r.pack,this.unpack=r.unpack,this._dataCount=1}return t.prototype.noop=function(){},t.prototype.validateId=function(t){return!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(t)},t.prototype.chunk=function(t){for(var e=[],i=t.size,r=Math.ceil(i/n.util.chunkedMTU),s=0,a=0;a<i;){var o=Math.min(i,a+n.util.chunkedMTU),u=t.slice(a,o),c={__peerData:this._dataCount,n:s,data:u,total:r};e.push(c),a=o,s++}return this._dataCount++,e},t.prototype.blobToArrayBuffer=function(t,e){var n=new FileReader;return n.onload=function(t){t.target&&e(t.target.result)},n.readAsArrayBuffer(t),n},t.prototype.binaryStringToArrayBuffer=function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=255&t.charCodeAt(n);return e.buffer},t.prototype.randomToken=function(){return Math.random().toString(36).substr(2)},t.prototype.isSecure=function(){return"https:"===location.protocol},t}())},{"peerjs-js-binarypack":"kdPp","./supports":"I31f"}],JJlS:[function(t,e,n){"use strict";var i=Object.prototype.hasOwnProperty,r="~";function s(){}function a(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(t,e,n,i,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var o=new a(n,i||t,s),u=r?r+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],o]:t._events[u].push(o):(t._events[u]=o,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new s:delete t._events[e]}function c(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(r=!1)),c.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)i.call(t,e)&&n.push(r?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},c.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,a=new Array(s);i<s;i++)a[i]=n[i].fn;return a},c.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},c.prototype.emit=function(t,e,n,i,s,a){var o=r?r+t:t;if(!this._events[o])return!1;var u,c,h=this._events[o],p=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),p){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,n),!0;case 4:return h.fn.call(h.context,e,n,i),!0;case 5:return h.fn.call(h.context,e,n,i,s),!0;case 6:return h.fn.call(h.context,e,n,i,s,a),!0}for(c=1,u=new Array(p-1);c<p;c++)u[c-1]=arguments[c];h.fn.apply(h.context,u)}else{var _,l=h.length;for(c=0;c<l;c++)switch(h[c].once&&this.removeListener(t,h[c].fn,void 0,!0),p){case 1:h[c].fn.call(h[c].context);break;case 2:h[c].fn.call(h[c].context,e);break;case 3:h[c].fn.call(h[c].context,e,n);break;case 4:h[c].fn.call(h[c].context,e,n,i);break;default:if(!u)for(_=1,u=new Array(p-1);_<p;_++)u[_-1]=arguments[_];h[c].fn.apply(h[c].context,u)}}return!0},c.prototype.on=function(t,e,n){return o(this,t,e,n,!1)},c.prototype.once=function(t,e,n){return o(this,t,e,n,!0)},c.prototype.removeListener=function(t,e,n,i){var s=r?r+t:t;if(!this._events[s])return this;if(!e)return u(this,s),this;var a=this._events[s];if(a.fn)a.fn!==e||i&&!a.once||n&&a.context!==n||u(this,s);else{for(var o=0,c=[],h=a.length;o<h;o++)(a[o].fn!==e||i&&!a[o].once||n&&a[o].context!==n)&&c.push(a[o]);c.length?this._events[s]=1===c.length?c[0]:c:u(this,s)}return this},c.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&u(this,e)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,void 0!==e&&(e.exports=c)},{}],WOs9:[function(t,e,n){"use strict";var i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,s=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a},r=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};Object.defineProperty(n,"__esModule",{value:!0});var s,a="PeerJS: ";!function(t){t[t.Disabled=0]="Disabled",t[t.Errors=1]="Errors",t[t.Warnings=2]="Warnings",t[t.All=3]="All"}(s=n.LogLevel||(n.LogLevel={}));var o=function(){function t(){this._logLevel=s.Disabled}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){this._logLevel=t},enumerable:!0,configurable:!0}),t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logLevel>=s.All&&this._print.apply(this,r([s.All],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logLevel>=s.Warnings&&this._print.apply(this,r([s.Warnings],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logLevel>=s.Errors&&this._print.apply(this,r([s.Errors],t))},t.prototype.setLogFunction=function(t){this._print=t},t.prototype._print=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=r([a],e);for(var o in i)i[o]instanceof Error&&(i[o]="("+i[o].name+") "+i[o].message);t>=s.All?console.log.apply(console,r(i)):t>=s.Warnings?console.warn.apply(console,r(["WARNING"],i)):t>=s.Errors&&console.error.apply(console,r(["ERROR"],i))},t}();n.default=new o},{}],ZRYf:[function(t,e,n){"use strict";var i;Object.defineProperty(n,"__esModule",{value:!0}),(i=n.ConnectionEventType||(n.ConnectionEventType={})).Open="open",i.Stream="stream",i.Data="data",i.Close="close",i.Error="error",i.IceStateChanged="iceStateChanged",function(t){t.Data="data",t.Media="media"}(n.ConnectionType||(n.ConnectionType={})),function(t){t.Open="open",t.Close="close",t.Connection="connection",t.Call="call",t.Disconnected="disconnected",t.Error="error"}(n.PeerEventType||(n.PeerEventType={})),function(t){t.BrowserIncompatible="browser-incompatible",t.Disconnected="disconnected",t.InvalidID="invalid-id",t.InvalidKey="invalid-key",t.Network="network",t.PeerUnavailable="peer-unavailable",t.SslUnavailable="ssl-unavailable",t.ServerError="server-error",t.SocketError="socket-error",t.SocketClosed="socket-closed",t.UnavailableID="unavailable-id",t.WebRTC="webrtc"}(n.PeerErrorType||(n.PeerErrorType={})),function(t){t.Binary="binary",t.BinaryUTF8="binary-utf8",t.JSON="json"}(n.SerializationType||(n.SerializationType={})),function(t){t.Message="message",t.Disconnected="disconnected",t.Error="error",t.Close="close"}(n.SocketEventType||(n.SocketEventType={})),function(t){t.Heartbeat="HEARTBEAT",t.Candidate="CANDIDATE",t.Offer="OFFER",t.Answer="ANSWER",t.Open="OPEN",t.Error="ERROR",t.IdTaken="ID-TAKEN",t.InvalidKey="INVALID-KEY",t.Leave="LEAVE",t.Expire="EXPIRE"}(n.ServerMessageType||(n.ServerMessageType={}))},{}],wJlv:[function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,s=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a},s=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var u=t("eventemitter3"),c=o(t("./logger")),h=t("./enums"),p=function(t){function e(e,n,i,r,s,a){void 0===a&&(a=5e3);var o=t.call(this)||this;o.pingInterval=a,o._disconnected=!0,o._messagesQueue=[];var u=e?"wss://":"ws://";return o._baseUrl=u+n+":"+i+r+"peerjs?key="+s,o}return i(e,t),e.prototype.start=function(t,e){var n=this;this._id=t;var i=this._baseUrl+"&id="+t+"&token="+e;!this._socket&&this._disconnected&&(this._socket=new WebSocket(i),this._disconnected=!1,this._socket.onmessage=function(t){var e;try{e=JSON.parse(t.data),c.default.log("Server message received:",e)}catch(e){return void c.default.log("Invalid server message",t.data)}n.emit(h.SocketEventType.Message,e)},this._socket.onclose=function(t){n._disconnected||(c.default.log("Socket closed.",t),n._cleanup(),n._disconnected=!0,n.emit(h.SocketEventType.Disconnected))},this._socket.onopen=function(){n._disconnected||(n._sendQueuedMessages(),c.default.log("Socket open"),n._scheduleHeartbeat())})},e.prototype._scheduleHeartbeat=function(){var t=this;this._wsPingTimer=setTimeout((function(){t._sendHeartbeat()}),this.pingInterval)},e.prototype._sendHeartbeat=function(){if(this._wsOpen()){var t=JSON.stringify({type:h.ServerMessageType.Heartbeat});this._socket.send(t),this._scheduleHeartbeat()}else c.default.log("Cannot send heartbeat, because socket closed")},e.prototype._wsOpen=function(){return!!this._socket&&1===this._socket.readyState},e.prototype._sendQueuedMessages=function(){var t,e,n=s(this._messagesQueue);this._messagesQueue=[];try{for(var i=a(n),r=i.next();!r.done;r=i.next()){var o=r.value;this.send(o)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.prototype.send=function(t){if(!this._disconnected)if(this._id)if(t.type){if(this._wsOpen()){var e=JSON.stringify(t);this._socket.send(e)}}else this.emit(h.SocketEventType.Error,"Invalid message");else this._messagesQueue.push(t)},e.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},e.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},e}(u.EventEmitter);n.Socket=p},{eventemitter3:"JJlS","./logger":"WOs9","./enums":"ZRYf"}],HCdX:[function(t,e,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{u(i.next(t))}catch(t){s(t)}}function o(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}u((i=i.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,i,r,s,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var o=t("./util"),u=a(t("./logger")),c=t("./enums"),h=function(){function t(t){this.connection=t}return t.prototype.startConnection=function(t){var e=this._startPeerConnection();if(this.connection.peerConnection=e,this.connection.type===c.ConnectionType.Media&&t._stream&&this._addTracksToConnection(t._stream,e),t.originator){if(this.connection.type===c.ConnectionType.Data){var n=this.connection,i={ordered:!!t.reliable},r=e.createDataChannel(n.label,i);n.initialize(r)}this._makeOffer()}else this.handleSDP("OFFER",t.sdp)},t.prototype._startPeerConnection=function(){u.default.log("Creating RTCPeerConnection.");var t=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(t),t},t.prototype._setupListeners=function(t){var e=this,n=this.connection.peer,i=this.connection.connectionId,r=this.connection.type,s=this.connection.provider;u.default.log("Listening for ICE candidates."),t.onicecandidate=function(t){t.candidate&&t.candidate.candidate&&(u.default.log("Received ICE candidates for "+n+":",t.candidate),s.socket.send({type:c.ServerMessageType.Candidate,payload:{candidate:t.candidate,type:r,connectionId:i},dst:n}))},t.oniceconnectionstatechange=function(){switch(t.iceConnectionState){case"failed":u.default.log("iceConnectionState is failed, closing connections to "+n),e.connection.emit(c.ConnectionEventType.Error,new Error("Negotiation of connection to "+n+" failed.")),e.connection.close();break;case"closed":u.default.log("iceConnectionState is closed, closing connections to "+n),e.connection.emit(c.ConnectionEventType.Error,new Error("Connection to "+n+" closed.")),e.connection.close();break;case"disconnected":u.default.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":t.onicecandidate=o.util.noop}e.connection.emit(c.ConnectionEventType.IceStateChanged,t.iceConnectionState)},u.default.log("Listening for data channel"),t.ondatachannel=function(t){u.default.log("Received data channel");var e=t.channel;s.getConnection(n,i).initialize(e)},u.default.log("Listening for remote stream"),t.ontrack=function(t){u.default.log("Received remote stream");var r=t.streams[0],a=s.getConnection(n,i);if(a.type===c.ConnectionType.Media){var o=a;e._addStreamToMediaConnection(r,o)}}},t.prototype.cleanup=function(){u.default.log("Cleaning up PeerConnection to "+this.connection.peer);var t=this.connection.peerConnection;if(t){this.connection.peerConnection=null,t.onicecandidate=t.oniceconnectionstatechange=t.ondatachannel=t.ontrack=function(){};var e="closed"!==t.signalingState,n=!1;if(this.connection.type===c.ConnectionType.Data){var i=this.connection.dataChannel;i&&(n=!!i.readyState&&"closed"!==i.readyState)}(e||n)&&t.close()}},t.prototype._makeOffer=function(){return r(this,void 0,Promise,(function(){var t,e,n,r,a,h,p;return s(this,(function(s){switch(s.label){case 0:t=this.connection.peerConnection,e=this.connection.provider,s.label=1;case 1:return s.trys.push([1,7,,8]),[4,t.createOffer(this.connection.options.constraints)];case 2:n=s.sent(),u.default.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),s.label=3;case 3:return s.trys.push([3,5,,6]),[4,t.setLocalDescription(n)];case 4:return s.sent(),u.default.log("Set localDescription:",n,"for:"+this.connection.peer),r={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:o.util.browser},this.connection.type===c.ConnectionType.Data&&(a=this.connection,r=i(i({},r),{label:a.label,reliable:a.reliable,serialization:a.serialization})),e.socket.send({type:c.ServerMessageType.Offer,payload:r,dst:this.connection.peer}),[3,6];case 5:return"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=(h=s.sent())&&(e.emitError(c.PeerErrorType.WebRTC,h),u.default.log("Failed to setLocalDescription, ",h)),[3,6];case 6:return[3,8];case 7:return p=s.sent(),e.emitError(c.PeerErrorType.WebRTC,p),u.default.log("Failed to createOffer, ",p),[3,8];case 8:return[2]}}))}))},t.prototype._makeAnswer=function(){return r(this,void 0,Promise,(function(){var t,e,n,i,r;return s(this,(function(s){switch(s.label){case 0:t=this.connection.peerConnection,e=this.connection.provider,s.label=1;case 1:return s.trys.push([1,7,,8]),[4,t.createAnswer()];case 2:n=s.sent(),u.default.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),s.label=3;case 3:return s.trys.push([3,5,,6]),[4,t.setLocalDescription(n)];case 4:return s.sent(),u.default.log("Set localDescription:",n,"for:"+this.connection.peer),e.socket.send({type:c.ServerMessageType.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,browser:o.util.browser},dst:this.connection.peer}),[3,6];case 5:return i=s.sent(),e.emitError(c.PeerErrorType.WebRTC,i),u.default.log("Failed to setLocalDescription, ",i),[3,6];case 6:return[3,8];case 7:return r=s.sent(),e.emitError(c.PeerErrorType.WebRTC,r),u.default.log("Failed to create answer, ",r),[3,8];case 8:return[2]}}))}))},t.prototype.handleSDP=function(t,e){return r(this,void 0,Promise,(function(){var n,i,r,a;return s(this,(function(s){switch(s.label){case 0:e=new RTCSessionDescription(e),n=this.connection.peerConnection,i=this.connection.provider,u.default.log("Setting remote description",e),r=this,s.label=1;case 1:return s.trys.push([1,5,,6]),[4,n.setRemoteDescription(e)];case 2:return s.sent(),u.default.log("Set remoteDescription:"+t+" for:"+this.connection.peer),"OFFER"!==t?[3,4]:[4,r._makeAnswer()];case 3:s.sent(),s.label=4;case 4:return[3,6];case 5:return a=s.sent(),i.emitError(c.PeerErrorType.WebRTC,a),u.default.log("Failed to setRemoteDescription, ",a),[3,6];case 6:return[2]}}))}))},t.prototype.handleCandidate=function(t){return r(this,void 0,Promise,(function(){var e,n,i,r,a,o;return s(this,(function(s){switch(s.label){case 0:u.default.log("handleCandidate:",t),e=t.candidate,n=t.sdpMLineIndex,i=t.sdpMid,r=this.connection.peerConnection,a=this.connection.provider,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.addIceCandidate(new RTCIceCandidate({sdpMid:i,sdpMLineIndex:n,candidate:e}))];case 2:return s.sent(),u.default.log("Added ICE candidate for:"+this.connection.peer),[3,4];case 3:return o=s.sent(),a.emitError(c.PeerErrorType.WebRTC,o),u.default.log("Failed to handleCandidate, ",o),[3,4];case 4:return[2]}}))}))},t.prototype._addTracksToConnection=function(t,e){if(u.default.log("add tracks from stream "+t.id+" to peer connection"),!e.addTrack)return u.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");t.getTracks().forEach((function(n){e.addTrack(n,t)}))},t.prototype._addStreamToMediaConnection=function(t,e){u.default.log("add stream "+t.id+" to media connection "+e.connectionId),e.addStream(t)},t}();n.Negotiator=h},{"./util":"BHXf","./logger":"WOs9","./enums":"ZRYf"}],tQFK:[function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var r=function(t){function e(e,n,i){var r=t.call(this)||this;return r.peer=e,r.provider=n,r.options=i,r._open=!1,r.metadata=i.metadata,r}return i(e,t),Object.defineProperty(e.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),e}(t("eventemitter3").EventEmitter);n.BaseConnection=r},{eventemitter3:"JJlS"}],dbHP:[function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var o=t("./util"),u=a(t("./logger")),c=t("./negotiator"),h=t("./enums"),p=function(t){function e(n,i,r){var s=t.call(this,n,i,r)||this;return s._localStream=s.options._stream,s.connectionId=s.options.connectionId||e.ID_PREFIX+o.util.randomToken(),s._negotiator=new c.Negotiator(s),s._localStream&&s._negotiator.startConnection({_stream:s._localStream,originator:!0}),s}return i(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return h.ConnectionType.Media},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localStream",{get:function(){return this._localStream},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!0,configurable:!0}),e.prototype.addStream=function(e){u.default.log("Receiving stream",e),this._remoteStream=e,t.prototype.emit.call(this,h.ConnectionEventType.Stream,e)},e.prototype.handleMessage=function(t){var e=t.type,n=t.payload;switch(t.type){case h.ServerMessageType.Answer:this._negotiator.handleSDP(e,n.sdp),this._open=!0;break;case h.ServerMessageType.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:u.default.warn("Unrecognized message type:"+e+" from peer:"+this.peer)}},e.prototype.answer=function(t,e){var n,i;if(void 0===e&&(e={}),this._localStream)u.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this._localStream=t,e&&e.sdpTransform&&(this.options.sdpTransform=e.sdpTransform),this._negotiator.startConnection(r(r({},this.options._payload),{_stream:t}));var a=this.provider._getMessages(this.connectionId);try{for(var o=s(a),c=o.next();!c.done;c=o.next()){var h=c.value;this.handleMessage(h)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}this._open=!0}},e.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,t.prototype.emit.call(this,h.ConnectionEventType.Close))},e.ID_PREFIX="mc_",e}(t("./baseconnection").BaseConnection);n.MediaConnection=p},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK"}],GGp6:[function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("eventemitter3"),a=r(t("./logger")),o=function(t){function e(){var e=t.call(this)||this;return e.fileReader=new FileReader,e._queue=[],e._processing=!1,e.fileReader.onload=function(t){e._processing=!1,t.target&&e.emit("done",t.target.result),e.doNextTask()},e.fileReader.onerror=function(t){a.default.error("EncodingQueue error:",t),e._processing=!1,e.destroy(),e.emit("error",t)},e}return i(e,t),Object.defineProperty(e.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"processing",{get:function(){return this._processing},enumerable:!0,configurable:!0}),e.prototype.enque=function(t){this.queue.push(t),this.processing||this.doNextTask()},e.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},e.prototype.doNextTask=function(){0!==this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},e}(s.EventEmitter);n.EncodingQueue=o},{eventemitter3:"JJlS","./logger":"WOs9"}],GBTQ:[function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var a=t("./util"),o=s(t("./logger")),u=t("./negotiator"),c=t("./enums"),h=t("./baseconnection"),p=t("./encodingQueue"),_=function(t){function e(n,i,r){var s=t.call(this,n,i,r)||this;return s.stringify=JSON.stringify,s.parse=JSON.parse,s._buffer=[],s._bufferSize=0,s._buffering=!1,s._chunkedData={},s._encodingQueue=new p.EncodingQueue,s.connectionId=s.options.connectionId||e.ID_PREFIX+a.util.randomToken(),s.label=s.options.label||s.connectionId,s.serialization=s.options.serialization||c.SerializationType.Binary,s.reliable=!!s.options.reliable,s._encodingQueue.on("done",(function(t){s._bufferedSend(t)})),s._encodingQueue.on("error",(function(){o.default.error("DC#"+s.connectionId+": Error occured in encoding from blob to arraybuffer, close DC"),s.close()})),s._negotiator=new u.Negotiator(s),s._negotiator.startConnection(s.options._payload||{originator:!0}),s}return i(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return c.ConnectionType.Data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!0,configurable:!0}),e.prototype.initialize=function(t){this._dc=t,this._configureDataChannel()},e.prototype._configureDataChannel=function(){var t=this;a.util.supports.binaryBlob&&!a.util.supports.reliable||(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){o.default.log("DC#"+t.connectionId+" dc connection success"),t._open=!0,t.emit(c.ConnectionEventType.Open)},this.dataChannel.onmessage=function(e){o.default.log("DC#"+t.connectionId+" dc onmessage:",e.data),t._handleDataMessage(e)},this.dataChannel.onclose=function(){o.default.log("DC#"+t.connectionId+" dc closed for:",t.peer),t.close()}},e.prototype._handleDataMessage=function(e){var n=this,i=e.data,r=i.constructor,s=i;if(this.serialization===c.SerializationType.Binary||this.serialization===c.SerializationType.BinaryUTF8){if(r===Blob)return void a.util.blobToArrayBuffer(i,(function(t){var e=a.util.unpack(t);n.emit(c.ConnectionEventType.Data,e)}));if(r===ArrayBuffer)s=a.util.unpack(i);else if(r===String){var o=a.util.binaryStringToArrayBuffer(i);s=a.util.unpack(o)}}else this.serialization===c.SerializationType.JSON&&(s=this.parse(i));s.__peerData?this._handleChunk(s):t.prototype.emit.call(this,c.ConnectionEventType.Data,s)},e.prototype._handleChunk=function(t){var e=t.__peerData,n=this._chunkedData[e]||{data:[],count:0,total:t.total};if(n.data[t.n]=t.data,n.count++,this._chunkedData[e]=n,n.total===n.count){delete this._chunkedData[e];var i=new Blob(n.data);this._handleDataMessage({data:i})}},e.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,t.prototype.emit.call(this,c.ConnectionEventType.Close))},e.prototype.send=function(e,n){if(this.open)if(this.serialization===c.SerializationType.JSON)this._bufferedSend(this.stringify(e));else if(this.serialization===c.SerializationType.Binary||this.serialization===c.SerializationType.BinaryUTF8){var i=a.util.pack(e);if(!n&&i.size>a.util.chunkedMTU)return void this._sendChunks(i);a.util.supports.binaryBlob?this._bufferedSend(i):this._encodingQueue.enque(i)}else this._bufferedSend(e);else t.prototype.emit.call(this,c.ConnectionEventType.Error,new Error("Connection is not open. You should listen for the `open` event before sending messages."))},e.prototype._bufferedSend=function(t){!this._buffering&&this._trySend(t)||(this._buffer.push(t),this._bufferSize=this._buffer.length)},e.prototype._trySend=function(t){var n=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>e.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout((function(){n._buffering=!1,n._tryBuffer()}),50),!1;try{this.dataChannel.send(t)}catch(t){return o.default.error("DC#:"+this.connectionId+" Error when sending:",t),this._buffering=!0,this.close(),!1}return!0},e.prototype._tryBuffer=function(){if(this.open&&0!==this._buffer.length){var t=this._buffer[0];this._trySend(t)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}},e.prototype._sendChunks=function(t){var e,n,i=a.util.chunk(t);o.default.log("DC#"+this.connectionId+" Try to send "+i.length+" chunks...");try{for(var s=r(i),u=s.next();!u.done;u=s.next()){var c=u.value;this.send(c,!0)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}},e.prototype.handleMessage=function(t){var e=t.payload;switch(t.type){case c.ServerMessageType.Answer:this._negotiator.handleSDP(t.type,e.sdp);break;case c.ServerMessageType.Candidate:this._negotiator.handleCandidate(e.candidate);break;default:o.default.warn("Unrecognized message type:",t.type,"from peer:",this.peer)}},e.ID_PREFIX="dc_",e.MAX_BUFFERED_AMOUNT=8388608,e}(h.BaseConnection);n.DataConnection=_},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK","./encodingQueue":"GGp6"}],in7L:[function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{u(i.next(t))}catch(t){s(t)}}function o(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}u((i=i.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var n,i,r,s,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var a=t("./util"),o=s(t("./logger")),u=function(){function t(t){this._options=t}return t.prototype._buildUrl=function(t){return(this._options.secure?"https://":"http://")+this._options.host+":"+this._options.port+this._options.path+this._options.key+"/"+t+"?ts="+(new Date).getTime()+Math.random()},t.prototype.retrieveId=function(){return i(this,void 0,Promise,(function(){var t,e,n,i;return r(this,(function(r){switch(r.label){case 0:t=this._buildUrl("id"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,fetch(t)];case 2:if(200!==(e=r.sent()).status)throw new Error("Error. Status:"+e.status);return[2,e.text()];case 3:throw n=r.sent(),o.default.error("Error retrieving ID",n),i="","/"===this._options.path&&this._options.host!==a.util.CLOUD_HOST&&(i=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+i);case 4:return[2]}}))}))},t.prototype.listAllPeers=function(){return i(this,void 0,Promise,(function(){var t,e,n,i;return r(this,(function(r){switch(r.label){case 0:t=this._buildUrl("peers"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,fetch(t)];case 2:if(200!==(e=r.sent()).status){if(401===e.status)throw n=this._options.host===a.util.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+n);throw new Error("Error. Status:"+e.status)}return[2,e.json()];case 3:throw i=r.sent(),o.default.error("Error retrieving list peers",i),new Error("Could not get list peers from the server."+i);case 4:return[2]}}))}))},t}();n.API=u},{"./util":"BHXf","./logger":"WOs9"}],Hxpd:[function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,s=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var u=t("eventemitter3"),c=t("./util"),h=o(t("./logger")),p=t("./socket"),_=t("./mediaconnection"),l=t("./dataconnection"),d=t("./enums"),f=t("./api"),m=function(t){function e(n,i){var s,a=t.call(this)||this;return a._id=null,a._lastServerId=null,a._destroyed=!1,a._disconnected=!1,a._open=!1,a._connections=new Map,a._lostMessages=new Map,n&&n.constructor==Object?i=n:n&&(s=n.toString()),i=r({debug:0,host:c.util.CLOUD_HOST,port:c.util.CLOUD_PORT,path:"/",key:e.DEFAULT_KEY,token:c.util.randomToken(),config:c.util.defaultConfig},i),a._options=i,"/"===a._options.host&&(a._options.host=window.location.hostname),a._options.path&&("/"!==a._options.path[0]&&(a._options.path="/"+a._options.path),"/"!==a._options.path[a._options.path.length-1]&&(a._options.path+="/")),void 0===a._options.secure&&a._options.host!==c.util.CLOUD_HOST?a._options.secure=c.util.isSecure():a._options.host==c.util.CLOUD_HOST&&(a._options.secure=!0),a._options.logFunction&&h.default.setLogFunction(a._options.logFunction),h.default.logLevel=a._options.debug||0,a._api=new f.API(i),a._socket=a._createServerConnection(),c.util.supports.audioVideo||c.util.supports.data?s&&!c.util.validateId(s)?(a._delayedAbort(d.PeerErrorType.InvalidID,'ID "'+s+'" is invalid'),a):(s?a._initialize(s):a._api.retrieveId().then((function(t){return a._initialize(t)})).catch((function(t){return a._abort(d.PeerErrorType.ServerError,t)})),a):(a._delayedAbort(d.PeerErrorType.BrowserIncompatible,"The current browser does not support WebRTC"),a)}return i(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"socket",{get:function(){return this._socket},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connections",{get:function(){var t,e,n=Object.create(null);try{for(var i=s(this._connections),r=i.next();!r.done;r=i.next()){var o=a(r.value,2),u=o[0],c=o[1];n[u]=c}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!0,configurable:!0}),e.prototype._createServerConnection=function(){var t=this,e=new p.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(d.SocketEventType.Message,(function(e){t._handleMessage(e)})),e.on(d.SocketEventType.Error,(function(e){t._abort(d.PeerErrorType.SocketError,e)})),e.on(d.SocketEventType.Disconnected,(function(){t.disconnected||(t.emitError(d.PeerErrorType.Network,"Lost connection to server."),t.disconnect())})),e.on(d.SocketEventType.Close,(function(){t.disconnected||t._abort(d.PeerErrorType.SocketClosed,"Underlying socket is already closed.")})),e},e.prototype._initialize=function(t){this._id=t,this.socket.start(t,this._options.token)},e.prototype._handleMessage=function(t){var e,n,i=t.type,r=t.payload,a=t.src;switch(i){case d.ServerMessageType.Open:this._lastServerId=this.id,this._open=!0,this.emit(d.PeerEventType.Open,this.id);break;case d.ServerMessageType.Error:this._abort(d.PeerErrorType.ServerError,r.msg);break;case d.ServerMessageType.IdTaken:this._abort(d.PeerErrorType.UnavailableID,'ID "'+this.id+'" is taken');break;case d.ServerMessageType.InvalidKey:this._abort(d.PeerErrorType.InvalidKey,'API KEY "'+this._options.key+'" is invalid');break;case d.ServerMessageType.Leave:h.default.log("Received leave message from "+a),this._cleanupPeer(a),this._connections.delete(a);break;case d.ServerMessageType.Expire:this.emitError(d.PeerErrorType.PeerUnavailable,"Could not connect to peer "+a);break;case d.ServerMessageType.Offer:var o=r.connectionId;if((m=this.getConnection(a,o))&&(m.close(),h.default.warn("Offer received for existing Connection ID:"+o)),r.type===d.ConnectionType.Media)m=new _.MediaConnection(a,this,{connectionId:o,_payload:r,metadata:r.metadata}),this._addConnection(a,m),this.emit(d.PeerEventType.Call,m);else{if(r.type!==d.ConnectionType.Data)return void h.default.warn("Received malformed connection type:"+r.type);m=new l.DataConnection(a,this,{connectionId:o,_payload:r,metadata:r.metadata,label:r.label,serialization:r.serialization,reliable:r.reliable}),this._addConnection(a,m),this.emit(d.PeerEventType.Connection,m)}var u=this._getMessages(o);try{for(var c=s(u),p=c.next();!p.done;p=c.next()){var f=p.value;m.handleMessage(f)}}catch(t){e={error:t}}finally{try{p&&!p.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}break;default:if(!r)return void h.default.warn("You received a malformed message from "+a+" of type "+i);var m;o=r.connectionId,(m=this.getConnection(a,o))&&m.peerConnection?m.handleMessage(t):o?this._storeMessage(o,t):h.default.warn("You received an unrecognized message:",t)}},e.prototype._storeMessage=function(t,e){this._lostMessages.has(t)||this._lostMessages.set(t,[]),this._lostMessages.get(t).push(e)},e.prototype._getMessages=function(t){var e=this._lostMessages.get(t);return e?(this._lostMessages.delete(t),e):[]},e.prototype.connect=function(t,e){if(void 0===e&&(e={}),this.disconnected)return h.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(d.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");var n=new l.DataConnection(t,this,e);return this._addConnection(t,n),n},e.prototype.call=function(t,e,n){if(void 0===n&&(n={}),this.disconnected)return h.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(d.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");if(e){n._stream=e;var i=new _.MediaConnection(t,this,n);return this._addConnection(t,i),i}h.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},e.prototype._addConnection=function(t,e){h.default.log("add connection "+e.type+":"+e.connectionId+" to peerId:"+t),this._connections.has(t)||this._connections.set(t,[]),this._connections.get(t).push(e)},e.prototype._removeConnection=function(t){var e=this._connections.get(t.peer);if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}this._lostMessages.delete(t.connectionId)},e.prototype.getConnection=function(t,e){var n,i,r=this._connections.get(t);if(!r)return null;try{for(var a=s(r),o=a.next();!o.done;o=a.next()){var u=o.value;if(u.connectionId===e)return u}}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return null},e.prototype._delayedAbort=function(t,e){var n=this;setTimeout((function(){n._abort(t,e)}),0)},e.prototype._abort=function(t,e){h.default.error("Aborting!"),this.emitError(t,e),this._lastServerId?this.disconnect():this.destroy()},e.prototype.emitError=function(t,e){var n;h.default.error("Error:",e),(n="string"==typeof e?new Error(e):e).type=t,this.emit(d.PeerEventType.Error,n)},e.prototype.destroy=function(){this.destroyed||(h.default.log("Destroy peer with ID:"+this.id),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit(d.PeerEventType.Close))},e.prototype._cleanup=function(){var t,e;try{for(var n=s(this._connections.keys()),i=n.next();!i.done;i=n.next()){var r=i.value;this._cleanupPeer(r),this._connections.delete(r)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.socket.removeAllListeners()},e.prototype._cleanupPeer=function(t){var e,n,i=this._connections.get(t);if(i)try{for(var r=s(i),a=r.next();!a.done;a=r.next())a.value.close()}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},e.prototype.disconnect=function(){if(!this.disconnected){var t=this.id;h.default.log("Disconnect peer with ID:"+t),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=t,this._id=null,this.emit(d.PeerEventType.Disconnected,t)}},e.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)h.default.log("Attempting reconnection to server with ID "+this._lastServerId),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");h.default.error("In a hurry? We're still trying to make the initial connection!")}},e.prototype.listAllPeers=function(t){var e=this;void 0===t&&(t=function(t){}),this._api.listAllPeers().then((function(e){return t(e)})).catch((function(t){return e._abort(d.PeerErrorType.ServerError,t)}))},e.DEFAULT_KEY="peerjs",e}(u.EventEmitter);n.Peer=m},{eventemitter3:"JJlS","./util":"BHXf","./logger":"WOs9","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ","./enums":"ZRYf","./api":"in7L"}],iTK6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./util"),r=t("./peer");n.peerjs={Peer:r.Peer,util:i.util},n.default=r.Peer,window.peerjs=n.peerjs,window.Peer=r.Peer},{"./util":"BHXf","./peer":"Hxpd"}]},{},["iTK6"])},784:t=>{function e(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=()=>[],e.resolve=e,e.id=784,t.exports=e},962:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.BasicBot=void 0;const a=s(n(887)),o=n(4);class u extends o.Cube{constructor(t,e){super(t,"img/Basic Bot.png",e),this.lightness=.3,this.radius=1.1}getObjectTransform(){const t=super.getObjectTransform();return a.mat4.translate(t,t,[0,2,0]),t}}e.BasicBot=u},667:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Beacon=void 0;const a=s(n(887)),o=n(974),u=n(762);class c extends u.Shape{constructor(t,e){super(t,"img/Beacon.png",e),this.radius=.4,this.state.gemLevel=12;const n=[],i=[],r=[];o.Geometry.addCubeData(n,r,i,.4,.6,.4),o.Geometry.translate(n,0,1.8,0),o.Geometry.addTubeData(n,r,i,.2),this.createBuffers(t,n,r,i),this.isOn=!0,this.lastToggle=window.performance.now(),this.lastSuccessfulToggle=window.performance.now()}toggle(){const t=window.performance.now();t-this.lastToggle<500&&t-this.lastSuccessfulToggle<2e3?this.lastToggle=t:(this.lastSuccessfulToggle=t,this.lastToggle=t,this.isOn?this.turnOff():this.turnOn())}turnOn(){this.isOn||(this.isOn=!0,super.setTextureImage("img/Beacon.png"))}turnOff(){this.isOn&&(this.isOn=!1,super.setTextureImage("img/BeaconOff.png"))}getIsOn(){return this.isOn}getObjectTransform(){const t=super.getObjectTransform();return a.mat4.translate(t,t,[0,2,0]),t}}e.Beacon=c},719:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Bubble=void 0;const a=s(n(887)),o=n(974),u=n(762);class c extends u.Shape{constructor(t,e,n){const i=document.createElement("canvas");i.width=512,i.height=256;const r=i.getContext("2d");r.fillStyle="white",r.clearRect(0,0,512,256),r.beginPath(),r.fillRect(0,0,512,256),r.beginPath(),r.fillStyle="green",r.font="128px 'Courier New', Courier, monospace",r.fillText(e,0,128,512),super(t,i,n),this.canvas=i;const s=[],a=[],u=[];o.Geometry.addRectangleData(s,a,u,1.5,.75),this.createBuffers(t,s,u,a)}getObjectTransform(){const t=super.getObjectTransform();return a.mat4.translate(t,t,[0,3.5,0]),t}makeMessageSVG(t){const e=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","text");n.innerHTML=t,n.setAttribute("x","50"),n.setAttribute("y","50"),n.setAttribute("font-size","30"),e.appendChild(n);const i=(new XMLSerializer).serializeToString(e),r=`data:image/svg+xml;base64,${btoa(i)}`,s=document.createElement("img");return s.src=r,s}}e.Bubble=c},823:function(t,e){"use strict";var n=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{u(i.next(t))}catch(t){s(t)}}function o(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}u((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Cog=void 0,e.Cog=class{constructor(t,e){this.thing=t,this.computer=e}update(t){return n(this,void 0,void 0,(function*(){return yield this.computer.getDelta(t)}))}upload(t,e){this.thing.upload(t,e),this.computer.upload(t,e)}}},723:function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{u(i.next(t))}catch(t){s(t)}}function o(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}u((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Computer=void 0;const r=n(151);e.Computer=class{constructor(t,e,n){this.library=n,this.startWorker(t,e)}startWorker(t,e){let n="";for(const t of e.split(/[ ,\n\r]+/))n+=this.library.getCode(t),n+="\n";const i="data:text/javascript;base64,"+btoa(`\n    var perspective;\n    var delta;\n    ${n}\n    onmessage = function(eventMessage) {\n      perspective = eventMessage.data;\n      delta = { turn: 0.0 };\n      ${t}\n      postMessage(delta); \n    }\n    `);this.worker=new Worker(i),this.working=!1,this.worker.onerror=t=>{r.Log.error(`line ${t.lineno-2}: ${t.message}`),this.worker.terminate()},this.clearResponseHandler()}getDelta(t){return i(this,void 0,void 0,(function*(){return this.working?new Promise(((t,e)=>{e("Worker is busy.")})):(this.worker.postMessage(t),new Promise(((t,e)=>{this.worker.onmessage=e=>{t(e.data)}})))}))}clearResponseHandler(){this.worker.onmessage=t=>{r.Log.error("No one is listening.")}}upload(t,e){this.worker.terminate(),this.startWorker(t,e)}}},4:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Cube=void 0;const i=n(974),r=n(762);class s extends r.Shape{constructor(t,e,n){super(t,e,n),this.loadTexture(t,e);const r=[],s=[],a=[];i.Geometry.addCubeData(r,s,a,1,1,1),this.createBuffers(t,r,s,a)}}e.Cube=s},154:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Flower=void 0;const a=s(n(887)),o=n(974),u=n(762);class c extends u.Shape{constructor(t,e){super(t,"img/Flower.png",e),this.lightness=0,this.radius=.2;const n=[],i=[],r=[];o.Geometry.addCylinderData(n,r,i,.2),this.createBuffers(t,n,r,i)}getObjectTransform(){const t=super.getObjectTransform();return a.mat4.translate(t,t,[0,.7*this.state.data.position,0]),t}}e.Flower=c},958:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Gem=void 0;const a=n(762),o=s(n(887)),u=n(974);class c extends a.Shape{constructor(t,e){super(t,"img/Gem-2.png",e);let n=[],i=[],r=[];u.Geometry.addGemData(n,i,r),this.createBuffers(t,n,r,i)}getObjectTransform(){const t=super.getObjectTransform(),e=3*(window.performance.now()/1e3-this.startTimeSeconds);return o.mat4.translate(t,t,[0,1.5,0]),o.mat4.rotate(t,t,e,[0,1,0]),o.mat4.scale(t,t,[.8,.8,.8]),t}}e.Gem=c},349:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GemBox=void 0,e.GemBox=class{constructor(){this.container=document.createElement("div"),this.container.classList.add("gembox"),this.gemSet=new Set,this.resetGems(),document.getElementsByTagName("body")[0].appendChild(this.container)}resetGems(){this.container.innerHTML="";for(let t=0;t<8;++t){const e=45*t;this.addGem(e,this.gemSet.has(t))}}addGem(t,e){const n=document.createElement("img");n.classList.add("gem"),n.style.setProperty("filter",`hue-rotate(${t}deg)`),n.src=e?"img/YesGem.png":"img/NoGem.png",this.container.appendChild(n),n.width=32}collect(t){const e=t.state.data.gemId;this.gemSet.has(e)||(this.gemSet.add(e),this.resetGems())}getGemLevel(){return this.gemSet.size}}},974:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Geometry=void 0;class n{static translate(t,e,n,i){for(let r=0;r<t.length;r+=3)t[r]+=e,t[r+1]+=n,t[r+2]+=i}static addTubeData(t,e,n,i){const r=2*Math.PI/16,s=.75/16;for(let a=0;a<16;++a){let o=a*r-Math.PI/2;const u=Math.cos(o)*i,c=Math.sin(o)*i,h=Math.cos(o+r)*i,p=Math.sin(o+r)*i;t.push(u,1,c),t.push(h,1,p),t.push(u,-1,c),t.push(h,1,p),t.push(u,-1,c),t.push(h,-1,p);let _=.25+a*s;e.push(_,0),e.push(_+s,0),e.push(_,.5),e.push(_+s,0),e.push(_,.5),e.push(_+s,.5),n.push(u,0,c),n.push(h,0,p),n.push(u,0,c),n.push(h,0,p),n.push(u,0,c),n.push(h,0,p)}}static addDiscData(t,e,n,i){const r=2*Math.PI/16;for(let s=0;s<16;++s){let a=s*r-Math.PI/2;const o=Math.cos(a)*i,u=Math.sin(a)*i,c=Math.cos(a+r)*i,h=Math.sin(a+r)*i;t.push(0,1,0),t.push(o,1,u),t.push(c,1,h);const p=.125+.125*Math.cos(a),_=.25+.25*Math.sin(a),l=.125+.125*Math.cos(a+r),d=.25+.25*Math.sin(a+r);e.push(.125,.25),e.push(p,_),e.push(l,d),n.push(0,1,0),n.push(0,1,0),n.push(0,1,0)}}static addCylinderData(t,e,i,r){n.addTubeData(t,e,i,r),n.addDiscData(t,e,i,r)}static addCubeData(t,e,n,i,r,s){t.push(-i,r,-s),t.push(i,r,-s),t.push(i,r,s),t.push(-i,r,-s),t.push(i,r,s),t.push(-i,r,s),t.push(-i,r,s),t.push(i,r,s),t.push(i,-r,s),t.push(-i,r,s),t.push(i,-r,s),t.push(-i,-r,s),t.push(i,r,s),t.push(i,r,-s),t.push(i,-r,-s),t.push(i,r,s),t.push(i,-r,-s),t.push(i,-r,s),t.push(i,r,-s),t.push(-i,r,-s),t.push(-i,-r,-s),t.push(i,r,-s),t.push(-i,-r,-s),t.push(i,-r,-s),t.push(-i,r,-s),t.push(-i,r,s),t.push(-i,-r,s),t.push(-i,r,-s),t.push(-i,-r,s),t.push(-i,-r,-s),e.push(0,0,.25,0,.25,.5,0,0,.25,.5,0,.5,0,.5,.25,.5,.25,1,0,.5,.25,1,0,1,.25,.5,.5,.5,.5,1,.25,.5,.5,1,.25,1,.5,.5,.75,.5,.75,1,.5,.5,.75,1,.5,1,.75,.5,1,.5,1,1,.75,.5,1,1,.75,1),n.push(0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0)}static addGemData(t,e,n){const i=.8,r=2*Math.PI/4;for(let s=0;s<4;++s){let a=s*r,o=0,u=.7,c=0,h=Math.cos(a),p=0,_=Math.sin(a),l=Math.cos(a+r),d=0,f=Math.sin(a+r);t.push(o*i,u,c*i),e.push((h+l)/4,0,(_+f)/4),n.push(.25,.5),t.push(l*i,d,f*i),e.push(l,d,f),n.push(.25+.25*l,.5+.5*f),t.push(h*i,p,_*i),e.push(h,p,_),n.push(.25+.25*h,.5+.5*_),u=-u,t.push(o*i,u,c*i),e.push((h+l)/4,0,(_+f)/4),n.push(.75,.5),t.push(l*i,d,f*i),e.push(l,d,f),n.push(.75+.25*l,.5+.5*f),t.push(h*i,p,_*i),e.push(h,p,_),n.push(.75+.25*h,.5+.5*_)}}static addRectangleData(t,e,n,i,r){t.push(-i,r,0),t.push(i,r,0),t.push(-i,-r,0),t.push(i,r,0),t.push(-i,-r,0),t.push(i,-r,0),n.push(0,0),n.push(1,0),n.push(0,1),n.push(1,0),n.push(0,1),n.push(1,1),e.push(-i,r,1),e.push(i,r,1),e.push(-i,-r,1),e.push(i,r,1),e.push(-i,-r,1),e.push(i,-r,1)}}e.Geometry=n},296:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Gopher=void 0;const a=s(n(887)),o=n(974),u=n(762);class c extends u.Shape{constructor(t,e){super(t,"img/Gopher.png",e),this.radius=.5;const n=[],i=[],r=[];o.Geometry.addCubeData(n,r,i,.5,.8,.5),o.Geometry.translate(n,0,0,0),this.createBuffers(t,n,r,i)}getObjectTransform(){const t=super.getObjectTransform();return a.mat4.translate(t,t,[0,1.6,0]),a.mat4.rotate(t,t,Math.PI/4,[0,-1,0]),t}}e.Gopher=c},451:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.GopherHole=void 0;const a=n(974),o=n(762),u=s(n(887));class c extends o.Shape{constructor(t,e){super(t,"img/GopherHole.png",e);const n=[],i=[],r=[];a.Geometry.addCylinderData(n,i,r,1.3),a.Geometry.translate(n,0,.3,0),this.createBuffers(t,n,i,r)}getObjectTransform(){const t=super.getObjectTransform();return u.mat4.rotate(t,t,Math.PI/4,[0,-1,0]),t}}e.GopherHole=c},701:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ground=void 0;const i=n(4);class r extends i.Cube{constructor(t,e,n){super(t,e,n)}}e.Ground=r},861:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Hazard=void 0;const a=s(n(887)),o=n(701);class u extends o.Ground{constructor(t,e){super(t,"img/Hazard.png",e),this.nextChangeTime=this.startTimeSeconds+3*Math.random(),Math.random()<.5?this.orientation=0:this.orientation=Math.PI/2}getObjectTransform(){const t=super.getObjectTransform(),e=window.performance.now()/1e3;return e>this.nextChangeTime&&(0===this.orientation?this.orientation=Math.PI/2:this.orientation=0,this.nextChangeTime=e+3*Math.random()),a.mat4.rotate(t,t,this.orientation,[0,1,0]),t}}e.Hazard=u},247:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HeartbeatGroup=void 0;const i=n(151),r=n(955);class s{constructor(t,e,n){this.peerId=t,this.username=e,this.statusElement=document.createElement("div"),this.statusElement.innerText=` ${e}`,this.statusElement.classList.add("pulse"),n.appendChild(this.statusElement),this.healthy=!0,this.update()}update(){this.lastPingTime=window.performance.now(),this.statusElement.innerText=` ${this.username}`,this.healthy=!0,this.statusElement.classList.remove("pulse"),setTimeout((()=>{this.statusElement.classList.add("pulse")}),10),this.deathTimer&&clearTimeout(this.deathTimer),this.deathTimer=setTimeout((()=>this.die()),1e4)}die(){this.statusElement.innerText=` ${this.username}`,this.healthy=!1}isHealthy(){return this.healthy}}e.HeartbeatGroup=class{constructor(t,e=null){this.username=t,this.connection=new r.PeerConnection(null),this.healthMap=new Map,this.status=document.createElement("div"),this.status.innerText="Status",this.status.classList.add("status"),this.connection.waitReady().then((()=>{if(i.Log.info("Ready ready."),this.healthMap.set(this.connection.id(),new s(this.connection.id(),t,this.status)),e){const t=this.makeThump();i.Log.info(`Sending initial (${t}) to: ${e}`),this.connection.send(e,t)}i.Log.info("initiating beat sequence."),this.beat()})),e?(this.leaderId=e,this.healthMap.set(e,null),this.leader=!1):this.leader=!0,document.getElementsByTagName("body")[0].appendChild(this.status),this.connection.addCallback("thump: ",(t=>{const e=t.split(",");for(let t=0;t<e.length;++t){const n=e[t];let r,a;[a,r]=n.split("="),a!==this.getConnection().id()&&(this.healthMap.has(a)&&null!==this.healthMap.get(a)?0===t&&this.healthMap.get(a).update():(i.Log.info(`Meeting: ${a}`),this.healthMap.set(a,new s(a,r,this.status))))}}))}isLeader(){return this.leader}getConnection(){return this.connection}getUsername(){return this.username}broadcast(t){for(const[e,n]of this.healthMap.entries())(null==n||n.isHealthy())&&e!==this.connection.id()&&this.connection.send(e,t)}sendToLeader(t){return this.leaderId||i.Log.error("Leaders shouldn't talk to themselves."),this.connection.sendAndPromiseResponse(this.leaderId,t)}makeThump(){if(null===this.connection.id())return;const t=[`${this.connection.id()}=${this.username}`];this.healthMap.get(this.connection.id()).update();for(const[e,n]of this.healthMap)null!==n&&e!=this.connection.id()&&t.push(`${e}=${n.username}`);return`thump: ${t.join(",")}`}beat(){const t=this.makeThump();this.broadcast(t),setTimeout((()=>this.beat()),600)}}},138:(t,e,n)=>{"use strict";const i=n(151),r=n(930),s=document.createElement("div");document.getElementsByTagName("body")[0].appendChild(s),i.Log.setTargetElement(s),i.Log.info("Initiating start sequence.");const a=new URL(document.URL),o=a.searchParams.get("login");if(o)new r.Meet("vialis",o,a.searchParams.get("join"));else{i.Log.info("Unrecognized user."),i.Log.info(""),i.Log.info("Enter your username");const t=document.getElementsByTagName("body")[0],e=document.createElement("span");e.innerText="login: ",t.appendChild(e);const n=document.createElement("span");n.classList.add("login"),n.contentEditable="true",n.spellcheck=!1,n.innerText="",n.tabIndex=1,t.appendChild(n);const r=document.createElement("a");t.appendChild(r);const s=()=>{const t=n.innerText.trim();if(t.match(/[A-Za-z][A-Za-z0-9]+/)){const e=new URL(a.href);e.searchParams.append("login",t),r.href=e.href,r.innerText="Let's go!"}else r.href="",r.innerText="";setTimeout(s,100)};s()}},767:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Intention=void 0,e.Intention=class{constructor(t,e,n){this.effectiveTime=t,this.delta=e,this.cog=n}}},603:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LibTablet=void 0;const i=n(151),r=n(811);class s extends r.Tablet{constructor(t,e,n){n.data?n.data.type="lib":n.data={type:"lib"},super(t,n),this.library=e,this.upload(n.code,n.libraryList)}upload(t,e){i.Log.info(`Updating library: ${e}`),super.upload(t,e),this.library.setCode(e,t)}}e.LibTablet=s},799:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Library=void 0;const i=n(151);e.Library=class{constructor(){this.books=new Map}mergeFromObject(t){for(const e of Object.keys(t))this.books.set(e,t[e])}toObject(){const t={};for(const e of this.books.keys())t[e]=this.books.get(e);return t}getCode(t){return""===t?"":this.books.has(t)?this.books.get(t):(i.Log.error(`Could not load "${t}"`),`/* No such library: ${t} */`)}setCode(t,e){i.Log.info(`Updating library ${t} with ${e.length} bytes`),this.books.set(t,e)}size(){return this.books.size}libraryNames(){return this.books.keys()}}},151:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Log=void 0;class n{static setTargetElement(t){n.target=t,t.classList.add("log")}static addToLog(t){n.messages.push(t),n.target.appendChild(t),n.messages.length>10&&(n.target.removeChild(n.messages[0]),n.messages.splice(0,1))}static info(t){if(t===this.lastMessage)return;const e=(window.performance.now()-n.startTime)/1e3;console.log(`${e.toFixed(3)}: ${t}`),this.lastMessage=t;const i=document.createElement("div");i.innerText=t,n.addToLog(i)}static error(t){if(t===this.lastMessage)return;console.error(t),this.lastMessage=t;const e=document.createElement("div");e.classList.add("error"),e.innerText=t,n.addToLog(e)}}e.Log=n,n.messages=[],n.lastMessage="",n.startTime=window.performance.now()},470:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MasterControl=void 0;const i=n(962),r=n(667),s=n(719),a=n(823),o=n(723),u=n(154),c=n(958),h=n(349),p=n(296),_=n(451),l=n(701),d=n(861),f=n(767),m=n(151),g=n(819),v=n(709),y=n(507),b=n(90),w=n(762),x=n(811),k=n(170),T=n(435),C=n(750);class S{constructor(t,e,n,i){this.previousTimestamps=[],this.frameRateDiv=null,this.utilizationDiv=null,this.gl=t,this.state=e,this.keyFocusElement=n,this.username=i,this.cogs=new Map,this.frameNumber=0,this.pendingEvents=[],this.keysDown=new Set,n.addEventListener("keydown",(t=>{this.keysDown.add(t.code)})),n.addEventListener("keyup",(t=>{this.keysDown.delete(t.code)})),n.addEventListener("focusout",(t=>{this.keysDown.clear()})),this.terminal=new k.Terminal(n),this.gemBox=new h.GemBox;for(const t of this.state.getEverything().allEntries())if(t.state.code&&t instanceof w.Shape&&!(t instanceof x.Tablet)){const e=new o.Computer(t.state.code,t.state.libraryList,this.state.library),n=new a.Cog(t,e);t.state.id>0&&!this.cogs.has(t.state.id)?this.cogs.set(t.state.id,n):m.Log.error(`Invalid thing: ${t.state.id}`)}if(this.state.players.has(this.username)){m.Log.info(`Materializing ${this.username}.`);const t=this.state.players.get(this.username),e=t.id;let n=null;this.state.thingIndex.has(e)?n=this.state.thingIndex.get(e):(n=new y.Player(this.gl,t),this.state.thingIndex.set(e,n)),m.Log.info("Building computer for player.");const i=new o.Computer(t.code,t.libraryList,this.state.library),r=new a.Cog(n,i);this.state.insert(n.state.xyz[0],n.state.xyz[2],n),this.cogs.has(n.state.id)&&m.Log.error(`Duplicate: ${n.state.id}`),this.cogs.set(n.state.id,r),this.terminal.setCog(r),this.keyFocusElement.focus()}else m.Log.error(`${this.username} is not here.`);setTimeout((()=>{this.eventLoop()}),0)}setGround(t,e,n){for(const i of n)if(i instanceof l.Ground&&!t(i)){this.state.remove(i);const t=e(i.state);this.state.insert(t.state.xyz[0],t.state.xyz[2],t);break}}setItem(t,e,n){for(const e of n)if(t(e))return;const i=e();this.state.insert(i.state.xyz[0],i.state.xyz[2],i)}static removeThing(t,e){const n=t.indexOf(e);n<0||(t[n]=t[t.length-1],t.pop())}handleAdminAction(t,e){let n,h;[n,h]=t.state.inFrontXZ(2);const f=[];if(this.state.getEverything().appendFromRange(new b.BoundingBox(n,h,1),f),S.removeThing(f,t),0!=f.length){if("setTile"===e&&this.setGround((t=>t instanceof C.Tile),(t=>new C.Tile(this.gl,t)),f),"setOcean"===e&&this.setGround((t=>t instanceof g.Ocean),(t=>new g.Ocean(this.gl,t)),f),"setHazard"===e&&this.setGround((t=>t instanceof d.Hazard),(t=>new d.Hazard(this.gl,t)),f),"setBeacon"===e&&this.setItem((t=>t instanceof r.Beacon),(()=>{const t=new T.ThingState([n,0,h]);return new r.Beacon(this.gl,t)}),f),"setFlower"===e&&this.setItem((t=>t instanceof u.Flower),(()=>{const t=new T.ThingState([n,0,h]);return t.data={position:1},new u.Flower(this.gl,t)}),f),"setApi"===e&&this.setItem((t=>t instanceof x.Tablet),(()=>{const t=new T.ThingState([n,0,h]);return t.data={type:"api"},new x.Tablet(this.gl,t)}),f),"setNote"===e&&this.setItem((t=>t instanceof x.Tablet),(()=>{const t=new T.ThingState([n,0,h]);return t.data={type:"note"},new x.Tablet(this.gl,t)}),f),"setLib"===e&&this.setItem((t=>t instanceof x.Tablet),(()=>{const t=new T.ThingState([n,0,h]);return t.data={type:"lib"},new x.Tablet(this.gl,t)}),f),"setGem"===e&&this.setItem((t=>t instanceof c.Gem),(()=>{const t=new T.ThingState([n,0,h]);return t.data={position:1},new c.Gem(this.gl,t)}),f),"setGopher"===e&&(this.setItem((t=>t instanceof p.Gopher),(()=>{const t=new T.ThingState([n,0,h]);return new p.Gopher(this.gl,t)}),f),this.setItem((t=>t instanceof _.GopherHole),(()=>{const t=new T.ThingState([n,0,h]);return new _.GopherHole(this.gl,t)}),f),this.setItem((t=>t instanceof s.Bubble),(()=>{const t=new T.ThingState([n,0,h]);return new s.Bubble(this.gl,"Hi!  I'm Gigi.",t)}),f)),"setRobot"===e){let t=!1;for(const e of f)if(e instanceof i.BasicBot){t=!0;break}if(!t){const t=new T.ThingState([n,0,h]);this.cogs.has(t.id)&&m.Log.error(`Duplicate!? ${t.id}`);const e=new i.BasicBot(this.gl,t);this.state.insert(e.state.xyz[0],e.state.xyz[2],e),e.state.code="delta = {turn: 1.0, drive: 0.05}",e.state.libraryList="";const r=new o.Computer(e.state.code,e.state.libraryList,this.state.library),s=new a.Cog(e,r);this.cogs.set(e.state.id,s)}}if("clear"===e)for(const t of f)t instanceof l.Ground||this.state.remove(t)}else m.Log.info("Missed.")}updateMiddleObject(t,e,n,i){if(null===t)return e;const r=t.state.xyz[0]-n,s=t.state.xyz[2]-i,a=r*r+s*s,o=e.state.xyz[0]-n,u=e.state.xyz[2]-i;return o*o+u*u<a?e:t}actOnThing(t,e){if(t instanceof w.Shape&&e instanceof w.Shape&&t.lift(e))if(this.cogs.has(e.state.id)){const t=this.cogs.get(e.state.id);this.terminal.setCog(t)}else this.terminal.setThing(e)}raiseRobot(t,e){}handleAction(t){if(t instanceof w.Shape&&t.isLifting()){const e=t.liftedThing();return void(t.drop()&&this.cogs.has(t.state.id)&&(this.terminal.setCog(this.cogs.get(t.state.id),!1),this.state.move(e.state.xyz[0],e.state.xyz[2],e)))}let e,n;[e,n]=t.state.inFrontXZ(2);const i=[];this.state.getEverything().appendFromRange(new b.BoundingBox(e,n,2),i),S.removeThing(i,t);let r=null,s=null;for(const e of i)e instanceof C.Tile&&(r=e),e instanceof l.Ground||(s=this.updateMiddleObject(s,e,t.state.xyz[0],t.state.xyz[2]));null==s?null!=r&&t instanceof y.Player&&this.raiseRobot(t,r):this.actOnThing(t,s)}distance2(t,e){const n=t[0]-e[0],i=t[2]-e[2];return n*n+i*i}distance(t,e){return Math.sqrt(this.distance2(t,e))}closerOfTwo(t,e,n){return null===e?n:null===n||this.distance2(t,e)<this.distance2(t,n)?e:n}angleTo(t,e,n){return(Math.atan2(-(n[0]-t[0]),n[2]-t[2])-e+3*Math.PI)%(2*Math.PI)-Math.PI}getCogPerspective(t){const e=new v.Perspective;e.keysDown=this.keysDown,e.currentHeading=t.thing.state.heading,t.thing instanceof w.Shape&&(e.isLifted=t.thing.isLifted(),e.isLifting=t.thing.isLifting()),t.thing.state.data&&(e.data=t.thing.state.data);const n=[],i=t.thing.state.xyz;if(i){this.state.getEverything().appendFromRange(new b.BoundingBox(i[0],i[2],20),n);let s=null,a=null,o=null,u=null,c=0;for(const e of n)if(e instanceof y.Player)s=this.closerOfTwo(i,s,e.state.xyz);else if(e instanceof r.Beacon)e.getIsOn()&&(++c,a=this.closerOfTwo(i,a,e.state.xyz));else if(e instanceof g.Ocean){const n=this.angleTo(t.thing.state.xyz,t.thing.state.heading,e.state.xyz);n>-Math.PI/12&&n<Math.PI/4&&(u=this.closerOfTwo(i,u,e.state.xyz)),n>-Math.PI/4&&n<Math.PI/12&&(o=this.closerOfTwo(i,o,e.state.xyz))}e.countBeacons=c,a&&(e.closestBeacon=[a[0]-i[0],a[2]-i[2]]),s&&(e.closestPlayer=[s[0]-i[0],s[2]-i[2]]),o&&(e.closestWallLeft=this.distance(i,o)),u&&(e.closestWallRight=this.distance(i,u))}return e}collideThing(t,e){if(0===t.lightness)return;if(t instanceof w.Shape&&t.isLifted())return void t.trackWithLifter();t.state.data||(t.state.data={}),t.state.data.bumped=!1;const n=[];this.state.getEverything().appendFromRange(new b.BoundingBox(t.state.xyz[0],t.state.xyz[2],2.1),n),S.removeThing(n,t);for(const s of n){if(s instanceof c.Gem){t.state.id==this.state.userId&&(this.gemBox.collect(s),t.state.gemLevel=this.gemBox.getGemLevel());continue}if(s instanceof C.Tile)continue;if(t instanceof i.BasicBot&&s instanceof d.Hazard)continue;if(s instanceof w.Shape&&s.isLifted())continue;const n=t.state.xyz[0]-s.state.xyz[0],a=t.state.xyz[2]-s.state.xyz[2];if(0===n&&0===a)continue;const o=n*n+a*a,u=(t.radius+s.radius)*(t.radius+s.radius);if(o<u){const i=t.lightness/(t.lightness+s.lightness),c=Math.sqrt(o),h=i*(Math.sqrt(u)-c),p=n/c*h,_=a/c*h;if(t.state.data.bumped=!0,s instanceof r.Beacon&&s.toggle(),0!==p||0!==_){e.has(t)||e.set(t,new Float32Array(3));const n=e.get(t);n[0]=n[0]+p,n[2]=n[2]+_}}}}eventLoop(){if(null===this.frameRateDiv){const t=document.createElement("div");t.id="epsDiv",this.frameRateDiv=document.createElement("div"),this.utilizationDiv=document.createElement("div"),t.appendChild(this.frameRateDiv),t.appendChild(this.utilizationDiv),document.getElementsByTagName("body")[0].appendChild(t)}const t=window.performance.now();if(this.previousTimestamps.push(t),this.previousTimestamps.length>10){this.previousTimestamps.pop();const e=1e4/(t-this.previousTimestamps[0]);this.previousTimestamps.shift(),this.frameRateDiv.innerText=`${e.toFixed(1)} eps`}const e=this.frameNumber+5;for(const t of this.cogs.values()){const n=this.getCogPerspective(t);t.computer.getDelta(n).then((n=>{n.state&&n.state.log&&(m.Log.info(n.state.log),n.state.log=null);const i=new f.Intention(e,n,t);this.pendingEvents.push(i)}))}const n=[],i=new Map;for(const t of this.pendingEvents)t.effectiveTime<=this.frameNumber?(null!=t.delta.state&&null!=t.delta.state.adminAction&&(this.handleAdminAction(t.cog.thing,t.delta.state.adminAction),t.delta.state.adminAction=null),null!=t.delta.state&&null!=t.delta.state.action&&this.handleAction(t.cog.thing),this.state.applyThing(t.cog.thing,t.delta),i.has(t.cog.thing)||i.set(t.cog.thing,new Float32Array(3))):n.push(t);this.pendingEvents=n;const r=[];this.state.getEverything().appendFromRange(this.state.getEverything().getBoundary(),r);for(const t of r)this.collideThing(t,i);for(const t of i.keys()){const e=t.state,n=i.get(t);0!=n[0]&&0!=n[2]&&(e.xyz[0]+=n[0],e.xyz[2]+=n[2],this.state.move(e.xyz[0],e.xyz[2],t))}this.frameNumber++,setTimeout((()=>{this.eventLoop()}),t+1e3/60-window.performance.now())}}e.MasterControl=S},930:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Meet=void 0;const i=n(247),r=n(151),s=n(28),a=n(800),o=n(365),u=n(863);e.Meet=class{constructor(t,e,n){this.username=e,this.worldName=t,this.heartbeatGroup=new i.HeartbeatGroup(e,n);const s=document.getElementsByTagName("body")[0],a=document.createElement("div");a.id="localGameDiv",a.innerText="Local",s.appendChild(a);const u=document.createElement("div");if(!n){const t=document.createElement("div"),e=document.createElement("span");t.appendChild(e),e.id="startSpan",e.innerText="Start!",s.appendChild(t),e.addEventListener("click",(()=>{t.remove(),u.remove(),this.startAsServer()}))}if(n){const t=new URL(document.URL);t.searchParams.delete("login"),u.innerText=t.toString(),this.heartbeatGroup.getConnection().waitReady().then((t=>{r.Log.info("Ready to play."),this.heartbeatGroup.getConnection().addCallback("Start: ",(t=>{this.startAsClient(t)}))}))}else u.innerText="Loading...",this.heartbeatGroup.getConnection().waitReady().then((t=>{const e=new URL(document.URL);e.searchParams.delete("login"),e.searchParams.append("join",t.id()),u.innerText=e.toString()}));this.canvas=this.makeCanvas(),this.gl=this.canvas.getContext("webgl"),this.worldClient=new o.WorldClient(this.gl,t,this.heartbeatGroup),s.appendChild(u)}makeCanvas(){const t=document.createElement("canvas");return t.id="glCanvas",t.width=2048,t.height=1536,t}startAsClient(t){r.Log.info("Starting game as client.");const e=new a.State(this.gl,this.worldName,this.username,(t=>{this.heartbeatGroup.broadcast(t)}));this.worldClient.setState(e),e.buildFromString(t),new s.Render(e,this.canvas).main(this.heartbeatGroup)}startAsServer(){u.WorldServer.getState(this.gl,this.worldName,this.username,(t=>{this.heartbeatGroup.broadcast(t)})).then((t=>{this.worldClient.setState(t),r.Log.info("Starting game as server."),this.heartbeatGroup.broadcast(`Start: ${t.serialize()}`),new s.Render(t,this.canvas).main(this.heartbeatGroup),r.Log.info("Systems are active.")}))}}},819:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Ocean=void 0;const a=s(n(887)),o=n(701);class u extends o.Ground{constructor(t,e){super(t,"img/Ocean-1.png",e),this.rate=(3+2*Math.random())/6}getObjectTransform(){const t=super.getObjectTransform(),e=window.performance.now()/1e3-this.startTimeSeconds;let n=.2*Math.sin(e/this.rate)-.1;return a.mat4.translate(t,t,[0,n,0]),t}}e.Ocean=u},955:function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{u(i.next(t))}catch(t){s(t)}}function o(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}u((i=i.apply(t,e||[])).next())}))},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.PeerConnection=void 0;const s=r(n(391)),a=n(151);class o{constructor(t,e){this.resolve=t,this.reject=e,this.timeout=setTimeout((()=>{e("Deadline exceeded.")}),5e3)}}e.PeerConnection=class{constructor(t){this.peer=new s.default(t),this.peers=new Map,this.responses=new Map,this.callbacks=new Map,this.ready=!1,this.readyCallbacks=[],this.peer.on("open",(t=>{a.Log.info(`I am ${this.peer.id}`),this.ready=!0,a.Log.info(`Callback count: ${this.readyCallbacks.length}`);for(const t of this.readyCallbacks)t(this)})),this.peer.on("connection",(t=>{t.on("data",(e=>{const n=e.match(/<(\d+)<(.*)/);if(null!==n){const t=parseInt(n[1]);if(this.responses.has(t)){const e=this.responses.get(t);clearTimeout(e.timeout),this.responses.delete(t),e.resolve(n[2])}else a.Log.error(`${this.peer.id} did not ask for ${t}`);return}const i=e.match(/>(\d+)>(.*)/);let r="";if(null!==i){const t=parseInt(i[1]);e=i[2],r=`<${t}<`}if(this.callbacks.has(e)){const n=this.callbacks.get(e)();n instanceof Promise?n.then((e=>{this.send(t.peer,r+e)})):this.send(t.peer,r+n)}else for(const n of this.callbacks.keys())if(e.startsWith(n)){const i=e.substr(n.length),s=this.callbacks.get(n)(i);s&&this.send(t.peer,r+s)}}))}))}waitReady(){return i(this,void 0,void 0,(function*(){return new Promise(((t,e)=>{this.ready?t(this):(a.Log.info(`${this.peer.id}: Not ready.`),this.readyCallbacks.push(t))}))}))}id(){return this.peer.id}addCallback(t,e){a.Log.info(`${this.peer.id}: Listening for ${t}`),this.callbacks.set(t,e)}send(t,e){if(t===this.id())return void a.Log.error(`Self message: ${e}`);let n=!1;if(this.peers.has(t)){const i=this.peers.get(t);i.open?(i.send(e),n=!0):a.Log.info(`Connection is not open to: ${t}`)}if(!n){const n=this.peer.connect(t);this.peers.set(t,n),n.on("open",(()=>{a.Log.info(`New connection open to: ${t}`),n.send(e)}))}}sendAndPromiseResponse(t,e){return i(this,void 0,void 0,(function*(){const n=Math.trunc(window.performance.now());return this.waitReady().then((()=>{this.send(t,`>${n.toFixed(0)}>${e}`)})),new Promise(((t,e)=>{const i=new o(t,e);this.responses.set(n,i)}))}))}}},709:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Perspective=void 0,e.Perspective=class{constructor(){this.data={}}}},507:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Player=void 0;const a=s(n(887)),o=n(974),u=n(762);class c extends u.Shape{constructor(t,e){let n="img/Empty Player.png";e.imageSource&&(n=e.imageSource),super(t,n,e),this.lightness=1,this.radius=.6;const i=[],r=[],s=[];o.Geometry.addCubeData(i,s,r,.65,.65,.65),o.Geometry.translate(i,0,1.3,0),o.Geometry.addTubeData(i,s,r,.6),this.createBuffers(t,i,s,r)}getObjectTransform(){const t=super.getObjectTransform();return a.mat4.translate(t,t,[0,2,0]),t}}e.Player=c},699:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ProgramInfo=void 0,e.ProgramInfo=class{constructor(){}}},663:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QuadTree=void 0;const i=n(151),r=n(90);class s{constructor(t,e,n){this.x=t,this.y=e,this.value=n}}class a{constructor(t,e=!1){this.boundary=t,this.children=null,this.entries=[],e?this.root=null:(this.root=this,this.entryLocation=new Map)}getBoundary(){return this.boundary}insert(t,e,n){const i=new s(t,e,n);return this.entryLocation.set(n,i),this.insertEntry(i)}remove(t){const e=this.entryLocation.get(t);e?this.removeEntry(e):i.Log.error("Failed to find entry.")}move(t,e,n){const r=this.entryLocation.get(n);r?this.moveEntry(t,e,r):i.Log.error("Failed to find entry.")}allEntries(){const t=[];return this.appendFromRange(this.boundary,t),t}appendFromRange(t,e){if(t.intersects(this.boundary))if(null===this.children)for(let n of this.entries)t.containsPoint(n.x,n.y)&&e.push(n.value);else for(let n of this.children)n.appendFromRange(t,e)}insertEntry(t){if(!this.boundary.containsPoint(t.x,t.y))return!1;if(null===this.children)this.entries.push(t),this.entries.length>a.kMaxCapacity&&this.subdivide();else for(const e of this.children)if(e.insertEntry(t))break;return!0}removeEntry(t){if(!this.boundary.containsPoint(t.x,t.y))return!1;if(null===this.children){const e=[];for(const n of this.entries)n.value!==t.value&&e.push(n);this.entries=e}else for(const e of this.children)if(e.removeEntry(t))break;return!0}moveEntry(t,e,n){if(!this.boundary.containsPoint(n.x,n.y))return!1;if(null===this.children){if(n.x=t,n.y=e,this.boundary.containsPoint(t,e))return!0;{const t=[];for(const e of this.entries)e.value!==n.value&&t.push(e);return this.entries=t,this.root.insertEntry(n),!0}}for(const i of this.children)if(i.moveEntry(t,e,n))break;return!0}subdivide(){this.children=[];const t=this.boundary;for(let e of[-1,1])for(let n of[-1,1]){const i=new r.BoundingBox(t.x+e*(t.radius/2),t.y+n*(t.radius/2),t.radius/2),s=new a(i);s.root=this.root,this.children.push(s)}for(const t of this.entries){let e=!1;for(let n of this.children)if(n.insertEntry(t)){e=!0;break}e||(i.Log.error(`Failed to subdivide: ${t.x}, ${t.y}`),i.Log.error(`Box: ${this.boundary.toString()}`))}this.entries=null}}e.QuadTree=a,a.kMaxCapacity=30},90:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BoundingBox=void 0,e.BoundingBox=class{constructor(t,e,n){this.x=t,this.y=e,this.radius=n}containsPoint(t,e){return t>=this.x-this.radius&&e>=this.y-this.radius&&t<this.x+this.radius&&e<this.y+this.radius}intersects(t){for(let e of[-1,1])for(let n of[-1,1]){if(t.containsPoint(this.x-this.radius*e,this.y+this.radius*n))return!0;if(this.containsPoint(t.x-t.radius*e,t.y+t.radius*n))return!0}return!1}toString(){const t=this.radius;return`[${this.x-t}..${this.x+t}, ${this.y-t}..${this.y+t}]`}}},28:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Render=void 0;const a=n(699),o=s(n(887)),u=n(470),c=n(151),h=n(90);e.Render=class{constructor(t,e){this.previousTimestamps=[],this.frameRateDiv=null,this.utilizationDiv=null,this.state=t;for(let t of document.getElementsByTagName("h1"))t.remove();this.canvas=e;let n=document.getElementsByTagName("body")[0];this.focusContainer=document.createElement("div"),this.focusContainer.appendChild(this.canvas),this.focusContainer.tabIndex=1,n.appendChild(this.focusContainer),this.focusContainer.focus()}main(t){const e=t.getUsername();if(this.gl=this.canvas.getContext("webgl"),null==this.gl)return void alert("Your browser doesn't support WebGL");const n=this.initShaderProgram(this.gl,this.getVertexShaderSource(),this.getFragmentShaderSource());this.programInfo=new a.ProgramInfo,this.programInfo.program=n,this.programInfo.vertexPosition=this.gl.getAttribLocation(n,"aVertexPosition"),this.programInfo.vertexNormal=this.gl.getAttribLocation(n,"aVertexNormal"),this.programInfo.textureCoord=this.gl.getAttribLocation(n,"aTextureCoord"),this.programInfo.uSampler=this.gl.getUniformLocation(n,"uSampler"),this.programInfo.projectionMatrix=this.gl.getUniformLocation(n,"uProjectionMatrix"),this.programInfo.modelViewMatrix=this.gl.getUniformLocation(n,"uModelViewMatrix"),this.programInfo.objectTransform=this.gl.getUniformLocation(n,"uObjectTransform"),this.programInfo.eyePosition=this.gl.getUniformLocation(n,"uEyePosition"),c.Log.info(JSON.stringify(this.programInfo)),this.masterControl=new u.MasterControl(this.gl,this.state,this.focusContainer,e),this.focusContainer.focus(),this.renderLoop()}renderLoop(){if(null===this.frameRateDiv){const t=document.createElement("div");t.id="perfDiv",this.frameRateDiv=document.createElement("div"),this.utilizationDiv=document.createElement("div"),t.appendChild(this.frameRateDiv),t.appendChild(this.utilizationDiv),document.getElementsByTagName("body")[0].appendChild(t)}const t=window.performance.now();if(this.previousTimestamps.length>0&&t-this.previousTimestamps[this.previousTimestamps.length-1]<31.25)return void requestAnimationFrame((()=>{this.renderLoop()}));if(this.previousTimestamps.push(t),this.previousTimestamps.length>10){this.previousTimestamps.pop();const e=1e4/(t-this.previousTimestamps[0]);this.previousTimestamps.shift(),this.frameRateDiv.innerText=`${e.toFixed(1)} fps`}const e=this.state.getPlayerCoords();this.setScene(this.gl,this.programInfo,e);for(const t of this.state.getThings(new h.BoundingBox(e[0],e[2]-5,26)))t.render(this.gl,this.programInfo);requestAnimationFrame((()=>this.renderLoop()))}setScene(t,e,n){t.clearColor(.8,.9,1,1),t.clearDepth(1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);const i=15*Math.PI/180,r=this.canvas.clientWidth/this.canvas.clientHeight,s=o.mat4.create();o.mat4.perspective(s,i,r,.1,400);const a=o.mat4.create(),u=n[0],c=n[1],h=n[2],p=o.vec3.fromValues(u,c+60,h+60);o.mat4.lookAt(a,p,[u,c+4,h-2],[0,1,0]),t.useProgram(e.program),t.uniformMatrix4fv(e.projectionMatrix,!1,s),t.uniformMatrix4fv(e.modelViewMatrix,!1,a),t.uniformMatrix3fv(e.eyePosition,!1,o.vec3.fromValues(u,c,h))}initShaderProgram(t,e,n){const i=this.loadShader(t,t.VERTEX_SHADER,e),r=this.loadShader(t,t.FRAGMENT_SHADER,n),s=t.createProgram();return t.attachShader(s,i),t.attachShader(s,r),t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)?s:(alert("Unable to initialize the shader program: "+t.getProgramInfoLog(s)),null)}loadShader(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:(alert("An error occurred compiling the shaders: "+t.getShaderInfoLog(i)),t.deleteShader(i),null)}getVertexShaderSource(){return"\n    attribute vec4 aVertexPosition;\n    attribute vec3 aVertexNormal;\n    attribute vec2 aTextureCoord;\n\n    uniform mat4 uObjectTransform;\n    uniform mat4 uModelViewMatrix;\n    uniform mat4 uProjectionMatrix;\n    uniform vec3 uVertexNormal;\n    uniform vec3 uEyePosition;\n\n    varying highp vec2 vTextureCoord;\n    varying highp vec3 vLighting;\n    varying highp float vFog;\n\n    void main(void) {\n      gl_Position = uProjectionMatrix * \n        uModelViewMatrix * \n        uObjectTransform *\n        aVertexPosition;\n      vTextureCoord = aTextureCoord;\n\n      highp vec4 physicalPosition = uObjectTransform * aVertexPosition;\n      highp float dist = uEyePosition.z - physicalPosition.z;\n      // vFog = max(min(dist / 20.0, 1.0), 0.0);\n      vFog = 0.0;\n\n      highp vec3 ambientLight = vec3(0.3, 0.3, 0.3);\n      highp vec3 directionalLightColor = vec3(0.7, 0.7, 0.7);\n      highp vec3 directionalVector = normalize(vec3(0.3, 0.9, 0.75));\n\n      highp vec3 transformedNormal = \n        normalize(mat3(uObjectTransform) * aVertexNormal);\n\n      highp float directional = max(dot(\n        transformedNormal, directionalVector), 0.0);\n      vLighting = ambientLight + (directionalLightColor * directional);\n    }\n  "}getFragmentShaderSource(){return"\n    varying highp vec2 vTextureCoord;\n    varying highp vec3 vLighting;\n    varying highp float vFog;\n\n    uniform sampler2D uSampler;\n\n    void main(void) {\n      highp vec4 texelColor = texture2D(uSampler, vTextureCoord);\n      highp vec4 pureColor = vec4(texelColor.rgb * vLighting, texelColor.a);      \n      highp vec4 fogPart = vFog * vec4(1.0, 1.0, 1.0, 1.0);\n      highp float q = 1.0 - vFog;\n      highp vec4 colorPart = q * pureColor;\n      gl_FragColor = fogPart + colorPart;\n    }\n    "}}},762:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=void 0;const a=n(534),o=s(n(887)),u=n(677),c=n(151);class h extends u.Thing{constructor(t,e,n){super(),this.gl=t,this.startTimeSeconds=window.performance.now()/1e3,this.state=n,this.setTextureImage(e),this.liftedBy=null,this.lifting=null}createBuffers(t,e,n,i){this.vertexCount=e.length/3,this.positionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),this.textureCoordBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.textureCoordBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(n),t.STATIC_DRAW),this.normalBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW)}getTextureImage(){return this.textureImage}setTextureImage(t){"string"==typeof t?(this.loadTexture(this.gl,t),this.textureImage=t):(c.Log.info("Binding canvas."),this.texture=a.TextureCache.buildTexture(this.gl,t))}loadTexture(t,e){this.texture=a.TextureCache.load(t,e)}getObjectTransform(){let t=o.mat4.create();return null===this.liftedBy?o.mat4.translate(t,t,this.state.xyz):(t=this.liftedBy.getObjectTransform(),o.mat4.translate(t,t,[0,2,0])),o.mat4.rotate(t,t,this.state.heading,[0,-1,0]),t}render(t,e){const n=this.getObjectTransform();t.uniformMatrix4fv(e.objectTransform,!1,n),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.vertexAttribPointer(e.vertexPosition,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(e.vertexPosition),t.bindBuffer(t.ARRAY_BUFFER,this.textureCoordBuffer),t.vertexAttribPointer(e.textureCoord,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(e.textureCoord),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.vertexAttribPointer(e.vertexNormal,3,t.FLOAT,!0,0,0),t.enableVertexAttribArray(e.vertexNormal),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture),t.uniform1i(e.uSampler,0);{const e=this.vertexCount,n=0;t.drawArrays(t.TRIANGLES,n,e)}}isLifted(){return null!==this.liftedBy}isLifting(){return null!==this.lifting}liftedThing(){return this.lifting}trackWithLifter(){this.state.xyz[0]=this.liftedBy.state.xyz[0],this.state.xyz[2]=this.liftedBy.state.xyz[2]}lift(t){if(t.state.gemLevel>this.state.gemLevel)return!1;if(window.performance.now()<this.liftTime+500)return!1;let e=t.lifting;for(;null!==e;){if(e===this)return!1;e=e.lifting}return this.liftTime=window.performance.now(),t.liftedBy=this,this.lifting=t,!0}drop(){if(window.performance.now()<this.liftTime+500)return!1;this.liftTime=window.performance.now();const t=this.lifting;return t.liftedBy=null,this.lifting=null,t.state.xyz[0]=this.state.xyz[0]-1.4*Math.sin(this.state.heading),t.state.xyz[2]=this.state.xyz[2]+1.4*Math.cos(this.state.heading),!0}}e.Shape=h},800:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.State=void 0;const i=n(861),r=n(799),s=n(151),a=n(819),o=n(507),u=n(90),c=n(663),h=n(852),p=n(435),_=n(750);class l{constructor(t,e,n,i=null){this.gl=t,this.worldName=e,this.username=n,this.broadcast=i,this.players=new Map,this.everything=new c.QuadTree(new u.BoundingBox(0,0,1024)),this.thingIndex=new Map,this.library=new r.Library,this.radius=0,this.userId=null,this.saveButton=document.createElement("a"),this.saveButton.innerText="Download";const s=document.createElement("div");s.appendChild(this.saveButton),s.classList.add("download"),document.getElementsByTagName("body")[0].appendChild(s)}getEverything(){return this.everything}insert(t,e,n){this.everything.insert(t,e,n)}remove(t){this.everything.remove(t)}move(t,e,n){null!==this.broadcast&&n instanceof o.Player&&n.state.id===this.userId&&this.broadcast(`Move: ${JSON.stringify(h.ThingCodec.encode(n))}`),this.everything.move(t,e,n)}applyThing(t,e){const n=t.state;let i=!1;if(NaN!==e.turn&&NaN!==e.drive&&null!=e.drive&&0!=e.drive&&null!=e.turn){const t=Math.max(-1,Math.min(1,e.drive));let r=Math.max(-1,Math.min(1,e.turn));e.drive<0&&(r=-r);const s=.2,a=.8,o=t*s*(1-Math.abs(r)),u=t*s/a*r,c=Math.cos(n.heading)*o,h=-Math.sin(n.heading)*o;n.heading+=u,n.heading=(n.heading+Math.PI)%(2*Math.PI)-Math.PI,n.xyz[0]=n.xyz[0]+h,n.xyz[2]=n.xyz[2]+c,i=0!==h||0!==c}null!=e.state&&(n.data=e.state),i&&this.move(n.xyz[0],n.xyz[2],t)}loadPlayers(t){if(null!=t.players)for(let e of Object.keys(t.players)){s.Log.info(`Loading ${e} player info`);const n=t.players[e],i=new p.ThingState([0,0,0]);i.mergeFrom(n),this.players.set(e,i)}}getThings(t){const e=[];return this.everything.appendFromRange(t,e),e}static sortXYs(t){t.sort(((t,e)=>t[0]==e[0]?t[1]-e[1]:t[0]-e[0]))}snapshot(){const t={tiles:[],hazards:[],things:[]};t.radius=this.radius;for(const e of this.everything.allEntries())if(!(e instanceof a.Ocean))if(e instanceof _.Tile)t.tiles.push([e.state.xyz[0],e.state.xyz[2]]);else if(e instanceof i.Hazard)t.hazards.push([e.state.xyz[0],e.state.xyz[2]]);else if(!(e instanceof o.Player)){const n=h.ThingCodec.encode(e);null!==n&&t.things.push(n)}l.sortXYs(t.tiles),l.sortXYs(t.hazards),t.players={};for(const e of this.players.keys())t.players[e]=this.players.get(e);return t}serialize(){return JSON.stringify(this.snapshot())}mergeThing(t){if(!(t instanceof _.Tile))if(this.thingIndex.has(t.state.id)){const e=this.thingIndex.get(t.state.id),n=e.state.xyz[0]!=t.state.xyz[0]||e.state.xyz[2]!=t.state.xyz[2];e.state.mergeFrom(t.state),n&&this.everything.move(e.state.xyz[0],e.state.xyz[2],e)}else this.everything.insert(t.state.xyz[0],t.state.xyz[2],t),this.thingIndex.set(t.state.id,t)}mergeThings(t){for(const e of t){const t=h.ThingCodec.decode(this.gl,e,this.library);this.mergeThing(t)}}deserialize(t){const e=JSON.parse(t);this.loadPlayers(e),s.Log.info("Loaded size: "+t.length.toLocaleString()),e.map,this.radius=e.radius;const n=new Set;for(const t of e.tiles){const e=t[0],i=t[1],r=`${e},${i}`;if(!n.has(r)){n.add(r);const t=new _.Tile(this.gl,new p.ThingState([e,0,i]));this.everything.insert(e,i,t)}}if(e.hazards)for(const t of e.hazards){const e=t[0],r=t[1],s=`${e},${r}`;if(!n.has(s)){n.add(s);const t=new i.Hazard(this.gl,new p.ThingState([e,0,r]));this.everything.insert(e,r,t)}}e.things&&this.mergeThings(e.things);const r=[];for(let t=-this.radius;t<this.radius;t+=2){const e=t;for(let t=-this.radius;t<this.radius;t+=2){const n=t;if(r.splice(0,r.length),this.everything.appendFromRange(new u.BoundingBox(n,e,.5),r),0===r.length){const t=new a.Ocean(this.gl,new p.ThingState([n,0,e]));this.everything.insert(n,e,t)}}}this.materializeUser(this.username)}materializeUser(t){if(this.players.has(t))s.Log.info(`Welcome back, ${t}.`);else{s.Log.info(`${t} is new to this world.`);const e=new p.ThingState([0,0,0]);e.mergeFrom(this.players.get("_prototype")),this.players.set(t,e)}}getPlayerCoords(){this.userId||(this.materializeUser(this.username),this.userId=this.players.get(this.username).id);const t=this.thingIndex.get(this.userId);return t||s.Log.error(`Nothing found for ${this.username} ${this.userId}`),t.state.xyz}subtractThings(t,e){const n={};if(!Object.is(t,e))return e&&"object"==typeof e?(Object.keys(t||{}).concat(Object.keys(e||{})).forEach((i=>{if(e[i]===t[i]||Object.is(t[i],e[i])||(n[i]=e[i]),"object"==typeof e[i]&&"object"==typeof t[i]){const r=this.subtractThings(t[i],e[i]);void 0!==r&&(n[i]=r)}})),n):e}subtract(t,e){const n={};if(e.things){n.things=[],console.log(`Other array size: ${t.things.length}`);const i=new Map;for(const e of t.things)i.set(e.state.id,e);console.log(`Base array size: ${e.things.length}`);const r=new Map;for(const t of e.things)r.set(t.state.id,t);console.log(`Other size: ${i.size}`),console.log(`Base size: ${r.size}`);for(const[t,e]of i)if(r.has(t)){const i=r.get(t),s=this.subtractThings(e,i);n.things.push(s)}else n.things.push(e)}else n.things=t.things;return n}saveLoop(){const t=this.snapshot(),e=JSON.stringify(t);window.localStorage.setItem(`${this.worldName}-world`,e),setTimeout((()=>{this.saveLoop()}),2e3);const n="data:text/javascript;base64,"+btoa(e);this.saveButton.href=n}buildFromString(t){s.Log.info(`Deserializing ${t.length} bytes of encoded state.`),t.length<100&&s.Log.error(`Data: ${t}`),this.deserialize(t),s.Log.info(`Loaded ${this.library.size()} libraries.`);for(const t of this.library.libraryNames())s.Log.info(`Library: ${t}`);this.saveLoop()}}e.State=l},811:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Tablet=void 0;const a=s(n(887)),o=n(974),u=n(762);class c extends u.Shape{constructor(t,e){let n="img/tabletNote.png";if(e.data&&e.data.type)switch(e.data.type){case"lib":n="img/tabletLib.png";break;case"api":n="img/tabletApi.png";break;case"note":n="img/tabletNote.png"}super(t,n,e),this.lightness=0,this.radius=.8;const i=[],r=[],s=[];o.Geometry.addCubeData(i,s,r,.8,.8,.15),o.Geometry.translate(i,0,.5,0),o.Geometry.addTubeData(i,s,r,.1),this.vertexCount=i.length/3,this.positionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW),this.textureCoordBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.textureCoordBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(s),t.STATIC_DRAW),this.normalBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(r),t.STATIC_DRAW)}getObjectTransform(){const t=super.getObjectTransform();return a.mat4.translate(t,t,[0,2,0]),t}}e.Tablet=c},170:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Terminal=void 0;const r=i(n(204)),s=n(962),a=n(151),o=n(507),u=n(762),c=n(811);class h{constructor(t,e,n,i,r=!0){this.img=n,this.img.width=64,this.img.onclick=t=>{h.activateHolder(this,!0)},this.div=document.createElement("div"),this.div.classList.add("terminal"),i&&(this.div.classList.add(i),this.img.classList.add(i)),this.div.contentEditable="true",this.div.spellcheck=!1,this.div.innerText=t,r&&(this.div.addEventListener("focusout",(()=>{this.format()})),this.div.addEventListener("focusin",(()=>{this.format()}))),e.appendChild(this.div),h.allHolders.push(this),h.activateHolder(this,!1)}static activateHolder(t,e){for(const n of h.allHolders)n===t?n.activate(e):n.deactivate()}setStyle(t,e){this.div.classList.remove(this.lastStyleClass),this.div.classList.add(e),this.img.src=t,this.img.classList.remove(this.lastStyleClass),this.img.classList.add(e),this.lastStyleClass=e}setCode(t){this.div.innerText=t}getCode(){return this.div.innerText}format(){let t=this.getCode();t=r.default(t,{indent_size:2,indent_char:" ",max_preserve_newlines:1,preserve_newlines:!0,keep_array_indentation:!1,break_chained_methods:!1,brace_style:"collapse",space_before_conditional:!0,unescape_strings:!1,jslint_happy:!1,end_with_newline:!1,wrap_line_length:80,comma_first:!1,e4x:!1,indent_empty_lines:!1}),a.Log.info("Formatting..."),this.setCode(t)}activate(t){this.div.classList.remove("hidden"),this.img.classList.remove("deactivated"),t&&this.div.focus()}deactivate(){this.div.classList.add("hidden"),this.img.classList.add("deactivated")}}h.allHolders=[],e.Terminal=class{constructor(t){this.otherFocusElement=t;const e=document.getElementsByTagName("body")[0],n=document.createElement("div");n.classList.add("toolbar");const i=document.createElement("img");i.src="img/Camera.png",n.appendChild(i),this.imageCode=new h("",e,i,null,!1);const r=document.createElement("img");r.src="img/Library.gif",n.appendChild(r),this.libraryList=new h("",e,r,null);const s=document.createElement("img");s.src="img/PlayerCode.gif",n.appendChild(s),this.programCode=new h("",e,s,null);{const t=document.createElement("span");t.innerText=" ",n.appendChild(t)}this.uploadButton=document.createElement("img"),this.uploadButton.src="img/Upload.gif",this.uploadButton.alt="Upload",this.uploadButton.width=64,this.uploadButton.addEventListener("click",(t=>{this.upload()})),n.appendChild(this.uploadButton),e.appendChild(n)}setCog(t,e=!1){this.cog=t,this.setThing(t.thing,e,!0)}setThing(t,e=!1,n=!1){if(n||(this.cog=null),this.thing=t,this.libraryList.setCode(t.state.libraryList),this.programCode.setCode(t.state.code),t instanceof o.Player?this.programCode.setStyle("img/PlayerCode.gif","player"):t instanceof c.Tablet?this.programCode.setStyle("img/LibraryCode.png","library"):t instanceof s.BasicBot?this.programCode.setStyle("img/RobotCode.gif","robot"):this.programCode.setStyle("img/PlayerCode.gif","player"),this.imageCode.setCode(""),t instanceof u.Shape){const e=t.getTextureImage();e&&this.imageCode.setCode(e)}h.activateHolder(this.programCode,e)}upload(){const t=this.imageCode.getCode();t&&this.thing instanceof u.Shape&&(this.thing.setTextureImage(t),this.thing.state.imageSource=t),this.programCode.format(),this.libraryList.format();const e=this.programCode.getCode();this.cog?(a.Log.info(`Uploading ${e.length} bytes to cog.`),this.cog.upload(e,this.libraryList.getCode())):(a.Log.info(`Updating state with ${e.length} bytes.`),this.thing,c.Tablet,this.thing.upload(e,this.libraryList.getCode())),this.otherFocusElement.focus()}}},534:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextureCache=void 0;class n{static buildTexture(t,e){let i=t.createTexture();return n.bindTexture(t,i,e),i}static bindTexture(t,e,n){const i=t.RGBA,r=t.RGBA,s=t.UNSIGNED_BYTE;t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,i,r,s,n),t.generateMipmap(t.TEXTURE_2D),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)}static load(t,e){if(n.cache.has(e))return n.cache.get(e);{let i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i);const r=0,s=t.RGBA,a=1,o=1,u=0,c=t.RGBA,h=t.UNSIGNED_BYTE,p=new Uint8Array([255,0,255,255]);t.texImage2D(t.TEXTURE_2D,r,s,a,o,u,c,h,p);const _=new Image;return _.onload=()=>{this.bindTexture(t,i,_)},_.src=e,n.cache.set(e,i),i}}}e.TextureCache=n,n.cache=new Map},677:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Thing=void 0,e.Thing=class{constructor(){this.lightness=0,this.radius=1.128}render(t,e){}upload(t,e){this.state.code=t,this.state.libraryList=e}}},852:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ThingCodec=void 0;const i=n(962),r=n(667),s=n(958),a=n(296),o=n(451),u=n(603),c=n(151),h=n(507),p=n(811),_=n(435);e.ThingCodec=class{static encode(t){const e={};if(t instanceof a.Gopher)e.typeName="Gopher";else if(t instanceof o.GopherHole)e.typeName="GopherHole";else if(t instanceof s.Gem)e.typeName="Gem";else if(t instanceof p.Tablet)e.typeName="Tablet";else if(t instanceof i.BasicBot)e.typeName="BasicBot";else if(t instanceof r.Beacon)e.typeName="Beacon";else{if(!(t instanceof h.Player))return c.Log.error(`Missing encoding ${t.constructor.name}`),null;e.typeName="Player"}return e.state=t.state,e}static decode(t,e,n){const l=new _.ThingState([0,0,0]);switch(e.state&&l.mergeFrom(e.state),e.typeName){case"Gem":return new s.Gem(t,l);case"Gopher":return new a.Gopher(t,l);case"GopherHole":return new o.GopherHole(t,l);case"BasicBot":const e=new i.BasicBot(t,l);return l.imageSource&&e.setTextureImage(l.imageSource),e;case"Beacon":return new r.Beacon(t,l);case"Tablet":return l.libraryList&&"lib"===l.data.type?(c.Log.info(`Tablet: ${l.libraryList}`),new u.LibTablet(t,n,l)):new p.Tablet(t,l);case"Player":return new h.Player(t,l)}return c.Log.error(`Cannot decode type: ${e.typeName}`),null}}},435:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ThingState=void 0;class n{constructor(t){n.numberOfThings+=1,this.id=n.numberOfThings,this.xyz=null!=t?new Float32Array(t):new Float32Array(3),this.heading=0,this.code=null,this.libraryList=null,this.gemLevel=0}mergeFrom(t){null!=t.xyz&&(this.xyz[0]=t.xyz[0],this.xyz[1]=t.xyz[1],this.xyz[2]=t.xyz[2]),null!=t.heading&&(this.heading=t.heading),null!=t.code&&(this.code=t.code),null!=t.libraryList&&(this.libraryList=t.libraryList),null!=t.imageSource&&(this.imageSource=t.imageSource),null!=t.data&&(this.data=t.data),t.id&&(this.id=t.id,n.numberOfThings=Math.max(this.id,n.numberOfThings)),null!=t.gemLevel&&(this.gemLevel=t.gemLevel)}inFrontXZ(t){return[this.xyz[0]-Math.sin(this.heading)*t,this.xyz[2]+Math.cos(this.heading)*t]}}e.ThingState=n,n.numberOfThings=0},750:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tile=void 0;const i=n(701);class r extends i.Ground{constructor(t,e){super(t,"img/Basic Bot-5.png",e)}getObjectTransform(){return super.getObjectTransform()}}e.Tile=r},365:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WorldClient=void 0;const i=n(151),r=n(852);e.WorldClient=class{constructor(t,e,n){this.loadedCallback=null,this.heartbeatGroup=n,this.connection=this.heartbeatGroup.getConnection(),this.gl=t,this.worldName=e,this.username=n.getUsername(),this.state=null,this.updateCallbacks=[],this.connection.addCallback("Move: ",(t=>{if(!this.state)return void i.Log.info("Discarding move... No state.");const e=JSON.parse(t),n=r.ThingCodec.decode(this.gl,e,this.state.library);this.state.mergeThing(n)}))}addCallback(t){this.updateCallbacks.push(t)}getConnection(){return this.connection}setState(t){this.state=t}}},863:function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{u(i.next(t))}catch(t){s(t)}}function o(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}u((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.WorldServer=void 0;const r=n(151),s=n(800);class a{static loadFromSavedState(t){const e=window.localStorage.getItem(`${t}-world`),n=new URL(document.URL);return e&&!n.searchParams.get("reset")?new Promise(((t,n)=>{r.Log.info("Loading from local storage."),t(e)})):(r.Log.info("Loading from json"),a.load("emptyWorld.json"))}static load(t){return new Promise(((e,n)=>{const i=new XMLHttpRequest;i.open("GET",t,!0),i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){var t=i.status;0===t||t>=200&&t<400?e(i.responseText):n("Failed to load world.")}},i.send()}))}static getState(t,e,n,o){return new Promise(((u,c)=>i(this,void 0,void 0,(function*(){r.Log.info("Loading world from saved state."),a.loadFromSavedState(e).then((i=>{const r=new s.State(t,e,n,o);r.buildFromString(i),u(r)})).catch((t=>{c(t)}))}))))}}e.WorldServer=a}},e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(138)})();
//# sourceMappingURL=main.js.map