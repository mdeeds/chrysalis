(()=>{var t={887:(t,e,n)=>{"use strict";n.r(e),n.d(e,{glMatrix:()=>r,mat2:()=>i,mat2d:()=>s,mat3:()=>a,mat4:()=>o,quat:()=>_,quat2:()=>p,vec2:()=>h,vec3:()=>u,vec4:()=>c});var r={};n.r(r),n.d(r,{ARRAY_TYPE:()=>d,EPSILON:()=>l,RANDOM:()=>f,equals:()=>y,setMatrixArrayType:()=>m,toRadian:()=>v});var i={};n.r(i),n.d(i,{LDU:()=>B,add:()=>N,adjoint:()=>E,clone:()=>w,copy:()=>k,create:()=>b,determinant:()=>P,equals:()=>U,exactEquals:()=>F,frob:()=>I,fromRotation:()=>D,fromScaling:()=>A,fromValues:()=>T,identity:()=>x,invert:()=>M,mul:()=>V,multiply:()=>R,multiplyScalar:()=>G,multiplyScalarAndAdd:()=>W,rotate:()=>O,scale:()=>j,set:()=>S,str:()=>L,sub:()=>K,subtract:()=>z,transpose:()=>C});var s={};n.r(s),n.d(s,{add:()=>ct,clone:()=>X,copy:()=>H,create:()=>q,determinant:()=>Z,equals:()=>dt,exactEquals:()=>lt,frob:()=>ut,fromRotation:()=>it,fromScaling:()=>st,fromTranslation:()=>at,fromValues:()=>Y,identity:()=>$,invert:()=>J,mul:()=>ft,multiply:()=>tt,multiplyScalar:()=>pt,multiplyScalarAndAdd:()=>ht,rotate:()=>et,scale:()=>nt,set:()=>Q,str:()=>ot,sub:()=>mt,subtract:()=>_t,translate:()=>rt});var a={};n.r(a),n.d(a,{add:()=>Ut,adjoint:()=>Ct,clone:()=>yt,copy:()=>bt,create:()=>gt,determinant:()=>Mt,equals:()=>qt,exactEquals:()=>Kt,frob:()=>Ft,fromMat2d:()=>Lt,fromMat4:()=>vt,fromQuat:()=>It,fromRotation:()=>Dt,fromScaling:()=>At,fromTranslation:()=>jt,fromValues:()=>wt,identity:()=>xt,invert:()=>St,mul:()=>Xt,multiply:()=>Et,multiplyScalar:()=>Wt,multiplyScalarAndAdd:()=>Vt,normalFromMat4:()=>Bt,projection:()=>Nt,rotate:()=>Rt,scale:()=>Ot,set:()=>kt,str:()=>zt,sub:()=>Ht,subtract:()=>Gt,translate:()=>Pt,transpose:()=>Tt});var o={};n.r(o),n.d(o,{add:()=>Ae,adjoint:()=>re,clone:()=>Yt,copy:()=>Qt,create:()=>$t,determinant:()=>ie,equals:()=>ze,exactEquals:()=>Ne,frob:()=>De,fromQuat:()=>Se,fromQuat2:()=>ye,fromRotation:()=>de,fromRotationTranslation:()=>ve,fromRotationTranslationScale:()=>xe,fromRotationTranslationScaleOrigin:()=>Te,fromScaling:()=>le,fromTranslation:()=>he,fromValues:()=>Jt,fromXRotation:()=>fe,fromYRotation:()=>me,fromZRotation:()=>ge,frustum:()=>Ce,getRotation:()=>ke,getScaling:()=>we,getTranslation:()=>be,identity:()=>te,invert:()=>ne,lookAt:()=>Re,mul:()=>Fe,multiply:()=>se,multiplyScalar:()=>Ie,multiplyScalarAndAdd:()=>Be,ortho:()=>Pe,perspective:()=>Me,perspectiveFromFieldOfView:()=>Ee,rotate:()=>ue,rotateX:()=>ce,rotateY:()=>_e,rotateZ:()=>pe,scale:()=>oe,set:()=>Zt,str:()=>je,sub:()=>Ue,subtract:()=>Le,targetTo:()=>Oe,translate:()=>ae,transpose:()=>ee});var u={};n.r(u),n.d(u,{add:()=>He,angle:()=>Tn,bezier:()=>mn,ceil:()=>Je,clone:()=>We,copy:()=>qe,create:()=>Ge,cross:()=>ln,dist:()=>Dn,distance:()=>an,div:()=>jn,divide:()=>Qe,dot:()=>hn,equals:()=>En,exactEquals:()=>Mn,floor:()=>Ze,forEach:()=>Bn,fromValues:()=>Ke,hermite:()=>fn,inverse:()=>_n,len:()=>Ln,length:()=>Ve,lerp:()=>dn,max:()=>en,min:()=>tn,mul:()=>On,multiply:()=>Ye,negate:()=>cn,normalize:()=>pn,random:()=>gn,rotateX:()=>wn,rotateY:()=>kn,rotateZ:()=>xn,round:()=>nn,scale:()=>rn,scaleAndAdd:()=>sn,set:()=>Xe,sqrDist:()=>An,sqrLen:()=>In,squaredDistance:()=>on,squaredLength:()=>un,str:()=>Cn,sub:()=>Rn,subtract:()=>$e,transformMat3:()=>yn,transformMat4:()=>vn,transformQuat:()=>bn,zero:()=>Sn});var c={};n.r(c),n.d(c,{add:()=>Wn,ceil:()=>Xn,clone:()=>zn,copy:()=>Un,create:()=>Nn,cross:()=>ur,dist:()=>br,distance:()=>tr,div:()=>yr,divide:()=>qn,dot:()=>or,equals:()=>mr,exactEquals:()=>fr,floor:()=>Hn,forEach:()=>Tr,fromValues:()=>Fn,inverse:()=>sr,len:()=>kr,length:()=>nr,lerp:()=>cr,max:()=>Yn,min:()=>$n,mul:()=>vr,multiply:()=>Kn,negate:()=>ir,normalize:()=>ar,random:()=>_r,round:()=>Qn,scale:()=>Jn,scaleAndAdd:()=>Zn,set:()=>Gn,sqrDist:()=>wr,sqrLen:()=>xr,squaredDistance:()=>er,squaredLength:()=>rr,str:()=>dr,sub:()=>gr,subtract:()=>Vn,transformMat4:()=>pr,transformQuat:()=>hr,zero:()=>lr});var _={};n.r(_),n.d(_,{add:()=>ei,calculateW:()=>Ar,clone:()=>Qr,conjugate:()=>Ur,copy:()=>Zr,create:()=>Sr,dot:()=>ii,equals:()=>hi,exactEquals:()=>pi,exp:()=>Lr,fromEuler:()=>Wr,fromMat3:()=>Gr,fromValues:()=>Jr,getAngle:()=>Pr,getAxisAngle:()=>Er,identity:()=>Cr,invert:()=>Fr,len:()=>oi,length:()=>ai,lerp:()=>si,ln:()=>Ir,mul:()=>ni,multiply:()=>Rr,normalize:()=>_i,pow:()=>Br,random:()=>zr,rotateX:()=>Or,rotateY:()=>jr,rotateZ:()=>Dr,rotationTo:()=>li,scale:()=>ri,set:()=>ti,setAxes:()=>fi,setAxisAngle:()=>Mr,slerp:()=>Nr,sqlerp:()=>di,sqrLen:()=>ci,squaredLength:()=>ui,str:()=>Vr});var p={};n.r(p),n.d(p,{add:()=>zi,clone:()=>gi,conjugate:()=>qi,copy:()=>Ti,create:()=>mi,dot:()=>Wi,equals:()=>ts,exactEquals:()=>Zi,fromMat4:()=>xi,fromRotation:()=>ki,fromRotationTranslation:()=>bi,fromRotationTranslationValues:()=>yi,fromTranslation:()=>wi,fromValues:()=>vi,getDual:()=>Ei,getReal:()=>Mi,getTranslation:()=>Oi,identity:()=>Si,invert:()=>Ki,len:()=>Hi,length:()=>Xi,lerp:()=>Vi,mul:()=>Ui,multiply:()=>Fi,normalize:()=>Qi,rotateAroundAxis:()=>Ni,rotateByQuatAppend:()=>Ii,rotateByQuatPrepend:()=>Bi,rotateX:()=>Di,rotateY:()=>Ai,rotateZ:()=>Li,scale:()=>Gi,set:()=>Ci,setDual:()=>Ri,setReal:()=>Pi,sqrLen:()=>Yi,squaredLength:()=>$i,str:()=>Ji,translate:()=>ji});var h={};n.r(h),n.d(h,{add:()=>as,angle:()=>Ds,ceil:()=>_s,clone:()=>ns,copy:()=>is,create:()=>es,cross:()=>Ss,dist:()=>Gs,distance:()=>gs,div:()=>Us,divide:()=>cs,dot:()=>Ts,equals:()=>Bs,exactEquals:()=>Is,floor:()=>ps,forEach:()=>Ks,fromValues:()=>rs,inverse:()=>ks,len:()=>Ns,length:()=>ys,lerp:()=>Cs,max:()=>ls,min:()=>hs,mul:()=>Fs,multiply:()=>us,negate:()=>ws,normalize:()=>xs,random:()=>Ms,rotate:()=>js,round:()=>ds,scale:()=>fs,scaleAndAdd:()=>ms,set:()=>ss,sqrDist:()=>Ws,sqrLen:()=>Vs,squaredDistance:()=>vs,squaredLength:()=>bs,str:()=>Ls,sub:()=>zs,subtract:()=>os,transformMat2:()=>Es,transformMat2d:()=>Ps,transformMat3:()=>Rs,transformMat4:()=>Os,zero:()=>As});var l=1e-6,d="undefined"!=typeof Float32Array?Float32Array:Array,f=Math.random;function m(t){d=t}var g=Math.PI/180;function v(t){return t*g}function y(t,e){return Math.abs(t-e)<=l*Math.max(1,Math.abs(t),Math.abs(e))}function b(){var t=new d(4);return d!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function w(t){var e=new d(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function k(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function x(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function T(t,e,n,r){var i=new d(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function S(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function C(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function M(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=n*s-i*r;return a?(a=1/a,t[0]=s*a,t[1]=-r*a,t[2]=-i*a,t[3]=n*a,t):null}function E(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t}function P(t){return t[0]*t[3]-t[2]*t[1]}function R(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=n[0],u=n[1],c=n[2],_=n[3];return t[0]=r*o+s*u,t[1]=i*o+a*u,t[2]=r*c+s*_,t[3]=i*c+a*_,t}function O(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=r*u+s*o,t[1]=i*u+a*o,t[2]=r*-o+s*u,t[3]=i*-o+a*u,t}function j(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=n[0],u=n[1];return t[0]=r*o,t[1]=i*o,t[2]=s*u,t[3]=a*u,t}function D(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t}function A(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function L(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function I(t){return Math.hypot(t[0],t[1],t[2],t[3])}function B(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]}function N(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function z(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function F(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function U(t,e){var n=t[0],r=t[1],i=t[2],s=t[3],a=e[0],o=e[1],u=e[2],c=e[3];return Math.abs(n-a)<=l*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=l*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-u)<=l*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(s-c)<=l*Math.max(1,Math.abs(s),Math.abs(c))}function G(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function W(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var V=R,K=z;function q(){var t=new d(6);return d!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function X(t){var e=new d(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function H(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function $(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Y(t,e,n,r,i,s){var a=new d(6);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a[4]=i,a[5]=s,a}function Q(t,e,n,r,i,s,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=a,t}function J(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],u=n*s-r*i;return u?(u=1/u,t[0]=s*u,t[1]=-r*u,t[2]=-i*u,t[3]=n*u,t[4]=(i*o-s*a)*u,t[5]=(r*a-n*o)*u,t):null}function Z(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=n[0],_=n[1],p=n[2],h=n[3],l=n[4],d=n[5];return t[0]=r*c+s*_,t[1]=i*c+a*_,t[2]=r*p+s*h,t[3]=i*p+a*h,t[4]=r*l+s*d+o,t[5]=i*l+a*d+u,t}function et(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=Math.sin(n),_=Math.cos(n);return t[0]=r*_+s*c,t[1]=i*_+a*c,t[2]=r*-c+s*_,t[3]=i*-c+a*_,t[4]=o,t[5]=u,t}function nt(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=n[0],_=n[1];return t[0]=r*c,t[1]=i*c,t[2]=s*_,t[3]=a*_,t[4]=o,t[5]=u,t}function rt(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=n[0],_=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=a,t[4]=r*c+s*_+o,t[5]=i*c+a*_+u,t}function it(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t}function st(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function at(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function ot(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ut(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function ct(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t}function _t(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}function pt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t}function ht(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t}function lt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function dt(t,e){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],u=e[0],c=e[1],_=e[2],p=e[3],h=e[4],d=e[5];return Math.abs(n-u)<=l*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-c)<=l*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-_)<=l*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(s-p)<=l*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(a-h)<=l*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(o-d)<=l*Math.max(1,Math.abs(o),Math.abs(d))}var ft=tt,mt=_t;function gt(){var t=new d(9);return d!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function vt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function yt(t){var e=new d(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function bt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function wt(t,e,n,r,i,s,a,o,u){var c=new d(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=i,c[5]=s,c[6]=a,c[7]=o,c[8]=u,c}function kt(t,e,n,r,i,s,a,o,u,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=a,t[6]=o,t[7]=u,t[8]=c,t}function xt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Tt(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function St(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],u=e[6],c=e[7],_=e[8],p=_*a-o*c,h=-_*s+o*u,l=c*s-a*u,d=n*p+r*h+i*l;return d?(d=1/d,t[0]=p*d,t[1]=(-_*r+i*c)*d,t[2]=(o*r-i*a)*d,t[3]=h*d,t[4]=(_*n-i*u)*d,t[5]=(-o*n+i*s)*d,t[6]=l*d,t[7]=(-c*n+r*u)*d,t[8]=(a*n-r*s)*d,t):null}function Ct(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],u=e[6],c=e[7],_=e[8];return t[0]=a*_-o*c,t[1]=i*c-r*_,t[2]=r*o-i*a,t[3]=o*u-s*_,t[4]=n*_-i*u,t[5]=i*s-n*o,t[6]=s*c-a*u,t[7]=r*u-n*c,t[8]=n*a-r*s,t}function Mt(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],a=t[5],o=t[6],u=t[7],c=t[8];return e*(c*s-a*u)+n*(-c*i+a*o)+r*(u*i-s*o)}function Et(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=e[6],_=e[7],p=e[8],h=n[0],l=n[1],d=n[2],f=n[3],m=n[4],g=n[5],v=n[6],y=n[7],b=n[8];return t[0]=h*r+l*a+d*c,t[1]=h*i+l*o+d*_,t[2]=h*s+l*u+d*p,t[3]=f*r+m*a+g*c,t[4]=f*i+m*o+g*_,t[5]=f*s+m*u+g*p,t[6]=v*r+y*a+b*c,t[7]=v*i+y*o+b*_,t[8]=v*s+y*u+b*p,t}function Pt(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=e[6],_=e[7],p=e[8],h=n[0],l=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=a,t[4]=o,t[5]=u,t[6]=h*r+l*a+c,t[7]=h*i+l*o+_,t[8]=h*s+l*u+p,t}function Rt(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=e[6],_=e[7],p=e[8],h=Math.sin(n),l=Math.cos(n);return t[0]=l*r+h*a,t[1]=l*i+h*o,t[2]=l*s+h*u,t[3]=l*a-h*r,t[4]=l*o-h*i,t[5]=l*u-h*s,t[6]=c,t[7]=_,t[8]=p,t}function Ot(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function jt(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Dt(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function At(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Lt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function It(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=n+n,o=r+r,u=i+i,c=n*a,_=r*a,p=r*o,h=i*a,l=i*o,d=i*u,f=s*a,m=s*o,g=s*u;return t[0]=1-p-d,t[3]=_-g,t[6]=h+m,t[1]=_+g,t[4]=1-c-d,t[7]=l-f,t[2]=h-m,t[5]=l+f,t[8]=1-c-p,t}function Bt(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],u=e[6],c=e[7],_=e[8],p=e[9],h=e[10],l=e[11],d=e[12],f=e[13],m=e[14],g=e[15],v=n*o-r*a,y=n*u-i*a,b=n*c-s*a,w=r*u-i*o,k=r*c-s*o,x=i*c-s*u,T=_*f-p*d,S=_*m-h*d,C=_*g-l*d,M=p*m-h*f,E=p*g-l*f,P=h*g-l*m,R=v*P-y*E+b*M+w*C-k*S+x*T;return R?(R=1/R,t[0]=(o*P-u*E+c*M)*R,t[1]=(u*C-a*P-c*S)*R,t[2]=(a*E-o*C+c*T)*R,t[3]=(i*E-r*P-s*M)*R,t[4]=(n*P-i*C+s*S)*R,t[5]=(r*C-n*E-s*T)*R,t[6]=(f*x-m*k+g*w)*R,t[7]=(m*b-d*x-g*y)*R,t[8]=(d*k-f*b+g*v)*R,t):null}function Nt(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function zt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Ft(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function Ut(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function Gt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function Wt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function Vt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function Kt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function qt(t,e){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],u=t[6],c=t[7],_=t[8],p=e[0],h=e[1],d=e[2],f=e[3],m=e[4],g=e[5],v=e[6],y=e[7],b=e[8];return Math.abs(n-p)<=l*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(r-h)<=l*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-d)<=l*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(s-f)<=l*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(a-m)<=l*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(o-g)<=l*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(u-v)<=l*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(c-y)<=l*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(_-b)<=l*Math.max(1,Math.abs(_),Math.abs(b))}var Xt=Et,Ht=Gt;function $t(){var t=new d(16);return d!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Yt(t){var e=new d(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Qt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Jt(t,e,n,r,i,s,a,o,u,c,_,p,h,l,f,m){var g=new d(16);return g[0]=t,g[1]=e,g[2]=n,g[3]=r,g[4]=i,g[5]=s,g[6]=a,g[7]=o,g[8]=u,g[9]=c,g[10]=_,g[11]=p,g[12]=h,g[13]=l,g[14]=f,g[15]=m,g}function Zt(t,e,n,r,i,s,a,o,u,c,_,p,h,l,d,f,m){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=a,t[6]=o,t[7]=u,t[8]=c,t[9]=_,t[10]=p,t[11]=h,t[12]=l,t[13]=d,t[14]=f,t[15]=m,t}function te(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ee(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],a=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=a,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ne(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],u=e[6],c=e[7],_=e[8],p=e[9],h=e[10],l=e[11],d=e[12],f=e[13],m=e[14],g=e[15],v=n*o-r*a,y=n*u-i*a,b=n*c-s*a,w=r*u-i*o,k=r*c-s*o,x=i*c-s*u,T=_*f-p*d,S=_*m-h*d,C=_*g-l*d,M=p*m-h*f,E=p*g-l*f,P=h*g-l*m,R=v*P-y*E+b*M+w*C-k*S+x*T;return R?(R=1/R,t[0]=(o*P-u*E+c*M)*R,t[1]=(i*E-r*P-s*M)*R,t[2]=(f*x-m*k+g*w)*R,t[3]=(h*k-p*x-l*w)*R,t[4]=(u*C-a*P-c*S)*R,t[5]=(n*P-i*C+s*S)*R,t[6]=(m*b-d*x-g*y)*R,t[7]=(_*x-h*b+l*y)*R,t[8]=(a*E-o*C+c*T)*R,t[9]=(r*C-n*E-s*T)*R,t[10]=(d*k-f*b+g*v)*R,t[11]=(p*b-_*k-l*v)*R,t[12]=(o*S-a*M-u*T)*R,t[13]=(n*M-r*S+i*T)*R,t[14]=(f*y-d*w-m*v)*R,t[15]=(_*w-p*y+h*v)*R,t):null}function re(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],u=e[6],c=e[7],_=e[8],p=e[9],h=e[10],l=e[11],d=e[12],f=e[13],m=e[14],g=e[15];return t[0]=o*(h*g-l*m)-p*(u*g-c*m)+f*(u*l-c*h),t[1]=-(r*(h*g-l*m)-p*(i*g-s*m)+f*(i*l-s*h)),t[2]=r*(u*g-c*m)-o*(i*g-s*m)+f*(i*c-s*u),t[3]=-(r*(u*l-c*h)-o*(i*l-s*h)+p*(i*c-s*u)),t[4]=-(a*(h*g-l*m)-_*(u*g-c*m)+d*(u*l-c*h)),t[5]=n*(h*g-l*m)-_*(i*g-s*m)+d*(i*l-s*h),t[6]=-(n*(u*g-c*m)-a*(i*g-s*m)+d*(i*c-s*u)),t[7]=n*(u*l-c*h)-a*(i*l-s*h)+_*(i*c-s*u),t[8]=a*(p*g-l*f)-_*(o*g-c*f)+d*(o*l-c*p),t[9]=-(n*(p*g-l*f)-_*(r*g-s*f)+d*(r*l-s*p)),t[10]=n*(o*g-c*f)-a*(r*g-s*f)+d*(r*c-s*o),t[11]=-(n*(o*l-c*p)-a*(r*l-s*p)+_*(r*c-s*o)),t[12]=-(a*(p*m-h*f)-_*(o*m-u*f)+d*(o*h-u*p)),t[13]=n*(p*m-h*f)-_*(r*m-i*f)+d*(r*h-i*p),t[14]=-(n*(o*m-u*f)-a*(r*m-i*f)+d*(r*u-i*o)),t[15]=n*(o*h-u*p)-a*(r*h-i*p)+_*(r*u-i*o),t}function ie(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],a=t[5],o=t[6],u=t[7],c=t[8],_=t[9],p=t[10],h=t[11],l=t[12],d=t[13],f=t[14],m=t[15];return(e*a-n*s)*(p*m-h*f)-(e*o-r*s)*(_*m-h*d)+(e*u-i*s)*(_*f-p*d)+(n*o-r*a)*(c*m-h*l)-(n*u-i*a)*(c*f-p*l)+(r*u-i*o)*(c*d-_*l)}function se(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=e[6],_=e[7],p=e[8],h=e[9],l=e[10],d=e[11],f=e[12],m=e[13],g=e[14],v=e[15],y=n[0],b=n[1],w=n[2],k=n[3];return t[0]=y*r+b*o+w*p+k*f,t[1]=y*i+b*u+w*h+k*m,t[2]=y*s+b*c+w*l+k*g,t[3]=y*a+b*_+w*d+k*v,y=n[4],b=n[5],w=n[6],k=n[7],t[4]=y*r+b*o+w*p+k*f,t[5]=y*i+b*u+w*h+k*m,t[6]=y*s+b*c+w*l+k*g,t[7]=y*a+b*_+w*d+k*v,y=n[8],b=n[9],w=n[10],k=n[11],t[8]=y*r+b*o+w*p+k*f,t[9]=y*i+b*u+w*h+k*m,t[10]=y*s+b*c+w*l+k*g,t[11]=y*a+b*_+w*d+k*v,y=n[12],b=n[13],w=n[14],k=n[15],t[12]=y*r+b*o+w*p+k*f,t[13]=y*i+b*u+w*h+k*m,t[14]=y*s+b*c+w*l+k*g,t[15]=y*a+b*_+w*d+k*v,t}function ae(t,e,n){var r,i,s,a,o,u,c,_,p,h,l,d,f=n[0],m=n[1],g=n[2];return e===t?(t[12]=e[0]*f+e[4]*m+e[8]*g+e[12],t[13]=e[1]*f+e[5]*m+e[9]*g+e[13],t[14]=e[2]*f+e[6]*m+e[10]*g+e[14],t[15]=e[3]*f+e[7]*m+e[11]*g+e[15]):(r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],c=e[6],_=e[7],p=e[8],h=e[9],l=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=s,t[3]=a,t[4]=o,t[5]=u,t[6]=c,t[7]=_,t[8]=p,t[9]=h,t[10]=l,t[11]=d,t[12]=r*f+o*m+p*g+e[12],t[13]=i*f+u*m+h*g+e[13],t[14]=s*f+c*m+l*g+e[14],t[15]=a*f+_*m+d*g+e[15]),t}function oe(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ue(t,e,n,r){var i,s,a,o,u,c,_,p,h,d,f,m,g,v,y,b,w,k,x,T,S,C,M,E,P=r[0],R=r[1],O=r[2],j=Math.hypot(P,R,O);return j<l?null:(P*=j=1/j,R*=j,O*=j,i=Math.sin(n),a=1-(s=Math.cos(n)),o=e[0],u=e[1],c=e[2],_=e[3],p=e[4],h=e[5],d=e[6],f=e[7],m=e[8],g=e[9],v=e[10],y=e[11],b=P*P*a+s,w=R*P*a+O*i,k=O*P*a-R*i,x=P*R*a-O*i,T=R*R*a+s,S=O*R*a+P*i,C=P*O*a+R*i,M=R*O*a-P*i,E=O*O*a+s,t[0]=o*b+p*w+m*k,t[1]=u*b+h*w+g*k,t[2]=c*b+d*w+v*k,t[3]=_*b+f*w+y*k,t[4]=o*x+p*T+m*S,t[5]=u*x+h*T+g*S,t[6]=c*x+d*T+v*S,t[7]=_*x+f*T+y*S,t[8]=o*C+p*M+m*E,t[9]=u*C+h*M+g*E,t[10]=c*C+d*M+v*E,t[11]=_*C+f*M+y*E,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function ce(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],a=e[5],o=e[6],u=e[7],c=e[8],_=e[9],p=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+c*r,t[5]=a*i+_*r,t[6]=o*i+p*r,t[7]=u*i+h*r,t[8]=c*i-s*r,t[9]=_*i-a*r,t[10]=p*i-o*r,t[11]=h*i-u*r,t}function _e(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],a=e[1],o=e[2],u=e[3],c=e[8],_=e[9],p=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-c*r,t[1]=a*i-_*r,t[2]=o*i-p*r,t[3]=u*i-h*r,t[8]=s*r+c*i,t[9]=a*r+_*i,t[10]=o*r+p*i,t[11]=u*r+h*i,t}function pe(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],a=e[1],o=e[2],u=e[3],c=e[4],_=e[5],p=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+c*r,t[1]=a*i+_*r,t[2]=o*i+p*r,t[3]=u*i+h*r,t[4]=c*i-s*r,t[5]=_*i-a*r,t[6]=p*i-o*r,t[7]=h*i-u*r,t}function he(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function le(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function de(t,e,n){var r,i,s,a=n[0],o=n[1],u=n[2],c=Math.hypot(a,o,u);return c<l?null:(a*=c=1/c,o*=c,u*=c,r=Math.sin(e),s=1-(i=Math.cos(e)),t[0]=a*a*s+i,t[1]=o*a*s+u*r,t[2]=u*a*s-o*r,t[3]=0,t[4]=a*o*s-u*r,t[5]=o*o*s+i,t[6]=u*o*s+a*r,t[7]=0,t[8]=a*u*s+o*r,t[9]=o*u*s-a*r,t[10]=u*u*s+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function fe(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function me(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ge(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ve(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=r+r,u=i+i,c=s+s,_=r*o,p=r*u,h=r*c,l=i*u,d=i*c,f=s*c,m=a*o,g=a*u,v=a*c;return t[0]=1-(l+f),t[1]=p+v,t[2]=h-g,t[3]=0,t[4]=p-v,t[5]=1-(_+f),t[6]=d+m,t[7]=0,t[8]=h+g,t[9]=d-m,t[10]=1-(_+l),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ye(t,e){var n=new d(3),r=-e[0],i=-e[1],s=-e[2],a=e[3],o=e[4],u=e[5],c=e[6],_=e[7],p=r*r+i*i+s*s+a*a;return p>0?(n[0]=2*(o*a+_*r+u*s-c*i)/p,n[1]=2*(u*a+_*i+c*r-o*s)/p,n[2]=2*(c*a+_*s+o*i-u*r)/p):(n[0]=2*(o*a+_*r+u*s-c*i),n[1]=2*(u*a+_*i+c*r-o*s),n[2]=2*(c*a+_*s+o*i-u*r)),ve(t,e,n),t}function be(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function we(t,e){var n=e[0],r=e[1],i=e[2],s=e[4],a=e[5],o=e[6],u=e[8],c=e[9],_=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(s,a,o),t[2]=Math.hypot(u,c,_),t}function ke(t,e){var n=new d(3);we(n,e);var r=1/n[0],i=1/n[1],s=1/n[2],a=e[0]*r,o=e[1]*i,u=e[2]*s,c=e[4]*r,_=e[5]*i,p=e[6]*s,h=e[8]*r,l=e[9]*i,f=e[10]*s,m=a+_+f,g=0;return m>0?(g=2*Math.sqrt(m+1),t[3]=.25*g,t[0]=(p-l)/g,t[1]=(h-u)/g,t[2]=(o-c)/g):a>_&&a>f?(g=2*Math.sqrt(1+a-_-f),t[3]=(p-l)/g,t[0]=.25*g,t[1]=(o+c)/g,t[2]=(h+u)/g):_>f?(g=2*Math.sqrt(1+_-a-f),t[3]=(h-u)/g,t[0]=(o+c)/g,t[1]=.25*g,t[2]=(p+l)/g):(g=2*Math.sqrt(1+f-a-_),t[3]=(o-c)/g,t[0]=(h+u)/g,t[1]=(p+l)/g,t[2]=.25*g),t}function xe(t,e,n,r){var i=e[0],s=e[1],a=e[2],o=e[3],u=i+i,c=s+s,_=a+a,p=i*u,h=i*c,l=i*_,d=s*c,f=s*_,m=a*_,g=o*u,v=o*c,y=o*_,b=r[0],w=r[1],k=r[2];return t[0]=(1-(d+m))*b,t[1]=(h+y)*b,t[2]=(l-v)*b,t[3]=0,t[4]=(h-y)*w,t[5]=(1-(p+m))*w,t[6]=(f+g)*w,t[7]=0,t[8]=(l+v)*k,t[9]=(f-g)*k,t[10]=(1-(p+d))*k,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Te(t,e,n,r,i){var s=e[0],a=e[1],o=e[2],u=e[3],c=s+s,_=a+a,p=o+o,h=s*c,l=s*_,d=s*p,f=a*_,m=a*p,g=o*p,v=u*c,y=u*_,b=u*p,w=r[0],k=r[1],x=r[2],T=i[0],S=i[1],C=i[2],M=(1-(f+g))*w,E=(l+b)*w,P=(d-y)*w,R=(l-b)*k,O=(1-(h+g))*k,j=(m+v)*k,D=(d+y)*x,A=(m-v)*x,L=(1-(h+f))*x;return t[0]=M,t[1]=E,t[2]=P,t[3]=0,t[4]=R,t[5]=O,t[6]=j,t[7]=0,t[8]=D,t[9]=A,t[10]=L,t[11]=0,t[12]=n[0]+T-(M*T+R*S+D*C),t[13]=n[1]+S-(E*T+O*S+A*C),t[14]=n[2]+C-(P*T+j*S+L*C),t[15]=1,t}function Se(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=n+n,o=r+r,u=i+i,c=n*a,_=r*a,p=r*o,h=i*a,l=i*o,d=i*u,f=s*a,m=s*o,g=s*u;return t[0]=1-p-d,t[1]=_+g,t[2]=h-m,t[3]=0,t[4]=_-g,t[5]=1-c-d,t[6]=l+f,t[7]=0,t[8]=h+m,t[9]=l-f,t[10]=1-c-p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ce(t,e,n,r,i,s,a){var o=1/(n-e),u=1/(i-r),c=1/(s-a);return t[0]=2*s*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*u,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(i+r)*u,t[10]=(a+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*s*2*c,t[15]=0,t}function Me(t,e,n,r,i){var s,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(s=1/(r-i),t[10]=(i+r)*s,t[14]=2*i*r*s):(t[10]=-1,t[14]=-2*r),t}function Ee(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+o),c=2/(i+s);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-o)*u*.5,t[9]=(i-s)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function Pe(t,e,n,r,i,s,a){var o=1/(e-n),u=1/(r-i),c=1/(s-a);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*o,t[13]=(i+r)*u,t[14]=(a+s)*c,t[15]=1,t}function Re(t,e,n,r){var i,s,a,o,u,c,_,p,h,d,f=e[0],m=e[1],g=e[2],v=r[0],y=r[1],b=r[2],w=n[0],k=n[1],x=n[2];return Math.abs(f-w)<l&&Math.abs(m-k)<l&&Math.abs(g-x)<l?te(t):(_=f-w,p=m-k,h=g-x,i=y*(h*=d=1/Math.hypot(_,p,h))-b*(p*=d),s=b*(_*=d)-v*h,a=v*p-y*_,(d=Math.hypot(i,s,a))?(i*=d=1/d,s*=d,a*=d):(i=0,s=0,a=0),o=p*a-h*s,u=h*i-_*a,c=_*s-p*i,(d=Math.hypot(o,u,c))?(o*=d=1/d,u*=d,c*=d):(o=0,u=0,c=0),t[0]=i,t[1]=o,t[2]=_,t[3]=0,t[4]=s,t[5]=u,t[6]=p,t[7]=0,t[8]=a,t[9]=c,t[10]=h,t[11]=0,t[12]=-(i*f+s*m+a*g),t[13]=-(o*f+u*m+c*g),t[14]=-(_*f+p*m+h*g),t[15]=1,t)}function Oe(t,e,n,r){var i=e[0],s=e[1],a=e[2],o=r[0],u=r[1],c=r[2],_=i-n[0],p=s-n[1],h=a-n[2],l=_*_+p*p+h*h;l>0&&(_*=l=1/Math.sqrt(l),p*=l,h*=l);var d=u*h-c*p,f=c*_-o*h,m=o*p-u*_;return(l=d*d+f*f+m*m)>0&&(d*=l=1/Math.sqrt(l),f*=l,m*=l),t[0]=d,t[1]=f,t[2]=m,t[3]=0,t[4]=p*m-h*f,t[5]=h*d-_*m,t[6]=_*f-p*d,t[7]=0,t[8]=_,t[9]=p,t[10]=h,t[11]=0,t[12]=i,t[13]=s,t[14]=a,t[15]=1,t}function je(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function De(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Ae(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function Le(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function Ie(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Be(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function Ne(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function ze(t,e){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],u=t[6],c=t[7],_=t[8],p=t[9],h=t[10],d=t[11],f=t[12],m=t[13],g=t[14],v=t[15],y=e[0],b=e[1],w=e[2],k=e[3],x=e[4],T=e[5],S=e[6],C=e[7],M=e[8],E=e[9],P=e[10],R=e[11],O=e[12],j=e[13],D=e[14],A=e[15];return Math.abs(n-y)<=l*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-b)<=l*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-w)<=l*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(s-k)<=l*Math.max(1,Math.abs(s),Math.abs(k))&&Math.abs(a-x)<=l*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(o-T)<=l*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(u-S)<=l*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-C)<=l*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(_-M)<=l*Math.max(1,Math.abs(_),Math.abs(M))&&Math.abs(p-E)<=l*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(h-P)<=l*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(d-R)<=l*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(f-O)<=l*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(m-j)<=l*Math.max(1,Math.abs(m),Math.abs(j))&&Math.abs(g-D)<=l*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(v-A)<=l*Math.max(1,Math.abs(v),Math.abs(A))}var Fe=se,Ue=Le;function Ge(){var t=new d(3);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function We(t){var e=new d(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ve(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function Ke(t,e,n){var r=new d(3);return r[0]=t,r[1]=e,r[2]=n,r}function qe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Xe(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function He(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function $e(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Ye(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Qe(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Je(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Ze(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function tn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function en(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function nn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function rn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function sn(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function an(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function on(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function un(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function cn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function _n(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function pn(t,e){var n=e[0],r=e[1],i=e[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function hn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ln(t,e,n){var r=e[0],i=e[1],s=e[2],a=n[0],o=n[1],u=n[2];return t[0]=i*u-s*o,t[1]=s*a-r*u,t[2]=r*o-i*a,t}function dn(t,e,n,r){var i=e[0],s=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=a+r*(n[2]-a),t}function fn(t,e,n,r,i,s){var a=s*s,o=a*(2*s-3)+1,u=a*(s-2)+s,c=a*(s-1),_=a*(3-2*s);return t[0]=e[0]*o+n[0]*u+r[0]*c+i[0]*_,t[1]=e[1]*o+n[1]*u+r[1]*c+i[1]*_,t[2]=e[2]*o+n[2]*u+r[2]*c+i[2]*_,t}function mn(t,e,n,r,i,s){var a=1-s,o=a*a,u=s*s,c=o*a,_=3*s*o,p=3*u*a,h=u*s;return t[0]=e[0]*c+n[0]*_+r[0]*p+i[0]*h,t[1]=e[1]*c+n[1]*_+r[1]*p+i[1]*h,t[2]=e[2]*c+n[2]*_+r[2]*p+i[2]*h,t}function gn(t,e){e=e||1;var n=2*f()*Math.PI,r=2*f()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function vn(t,e,n){var r=e[0],i=e[1],s=e[2],a=n[3]*r+n[7]*i+n[11]*s+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/a,t}function yn(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function bn(t,e,n){var r=n[0],i=n[1],s=n[2],a=n[3],o=e[0],u=e[1],c=e[2],_=i*c-s*u,p=s*o-r*c,h=r*u-i*o,l=i*h-s*p,d=s*_-r*h,f=r*p-i*_,m=2*a;return _*=m,p*=m,h*=m,l*=2,d*=2,f*=2,t[0]=o+_+l,t[1]=u+p+d,t[2]=c+h+f,t}function wn(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function kn(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function xn(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Tn(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],a=e[1],o=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(s*s+a*a+o*o),c=u&&hn(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}function Sn(t){return t[0]=0,t[1]=0,t[2]=0,t}function Cn(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Mn(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function En(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],a=e[1],o=e[2];return Math.abs(n-s)<=l*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-a)<=l*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=l*Math.max(1,Math.abs(i),Math.abs(o))}var Pn,Rn=$e,On=Ye,jn=Qe,Dn=an,An=on,Ln=Ve,In=un,Bn=(Pn=Ge(),function(t,e,n,r,i,s){var a,o;for(e||(e=3),n||(n=0),o=r?Math.min(r*e+n,t.length):t.length,a=n;a<o;a+=e)Pn[0]=t[a],Pn[1]=t[a+1],Pn[2]=t[a+2],i(Pn,Pn,s),t[a]=Pn[0],t[a+1]=Pn[1],t[a+2]=Pn[2];return t});function Nn(){var t=new d(4);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function zn(t){var e=new d(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Fn(t,e,n,r){var i=new d(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function Un(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Gn(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function Wn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function Vn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function Kn(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function qn(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function Xn(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Hn(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function $n(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function Yn(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function Qn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Jn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Zn(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}function tr(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],s=e[3]-t[3];return Math.hypot(n,r,i,s)}function er(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],s=e[3]-t[3];return n*n+r*r+i*i+s*s}function nr(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function rr(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function ir(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function sr(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function ar(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=n*n+r*r+i*i+s*s;return a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=s*a,t}function or(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function ur(t,e,n,r){var i=n[0]*r[1]-n[1]*r[0],s=n[0]*r[2]-n[2]*r[0],a=n[0]*r[3]-n[3]*r[0],o=n[1]*r[2]-n[2]*r[1],u=n[1]*r[3]-n[3]*r[1],c=n[2]*r[3]-n[3]*r[2],_=e[0],p=e[1],h=e[2],l=e[3];return t[0]=p*c-h*u+l*o,t[1]=-_*c+h*a-l*s,t[2]=_*u-p*a+l*i,t[3]=-_*o+p*s-h*i,t}function cr(t,e,n,r){var i=e[0],s=e[1],a=e[2],o=e[3];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=a+r*(n[2]-a),t[3]=o+r*(n[3]-o),t}function _r(t,e){var n,r,i,s,a,o;e=e||1;do{a=(n=2*f()-1)*n+(r=2*f()-1)*r}while(a>=1);do{o=(i=2*f()-1)*i+(s=2*f()-1)*s}while(o>=1);var u=Math.sqrt((1-a)/o);return t[0]=e*n,t[1]=e*r,t[2]=e*i*u,t[3]=e*s*u,t}function pr(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*a,t}function hr(t,e,n){var r=e[0],i=e[1],s=e[2],a=n[0],o=n[1],u=n[2],c=n[3],_=c*r+o*s-u*i,p=c*i+u*r-a*s,h=c*s+a*i-o*r,l=-a*r-o*i-u*s;return t[0]=_*c+l*-a+p*-u-h*-o,t[1]=p*c+l*-o+h*-a-_*-u,t[2]=h*c+l*-u+_*-o-p*-a,t[3]=e[3],t}function lr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function dr(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function fr(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function mr(t,e){var n=t[0],r=t[1],i=t[2],s=t[3],a=e[0],o=e[1],u=e[2],c=e[3];return Math.abs(n-a)<=l*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=l*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-u)<=l*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(s-c)<=l*Math.max(1,Math.abs(s),Math.abs(c))}var gr=Vn,vr=Kn,yr=qn,br=tr,wr=er,kr=nr,xr=rr,Tr=function(){var t=Nn();return function(e,n,r,i,s,a){var o,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,o=r;o<u;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],s(t,t,a),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}}();function Sr(){var t=new d(4);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Cr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Mr(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Er(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>l?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function Pr(t,e){var n=ii(t,e);return Math.acos(2*n*n-1)}function Rr(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=n[0],u=n[1],c=n[2],_=n[3];return t[0]=r*_+a*o+i*c-s*u,t[1]=i*_+a*u+s*o-r*c,t[2]=s*_+a*c+r*u-i*o,t[3]=a*_-r*o-i*u-s*c,t}function Or(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*o,t[1]=i*u+s*o,t[2]=s*u-i*o,t[3]=a*u-r*o,t}function jr(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=r*u-s*o,t[1]=i*u+a*o,t[2]=s*u+r*o,t[3]=a*u-i*o,t}function Dr(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*o,t[1]=i*u-r*o,t[2]=s*u+a*o,t[3]=a*u-s*o,t}function Ar(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function Lr(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=Math.sqrt(n*n+r*r+i*i),o=Math.exp(s),u=a>0?o*Math.sin(a)/a:0;return t[0]=n*u,t[1]=r*u,t[2]=i*u,t[3]=o*Math.cos(a),t}function Ir(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=Math.sqrt(n*n+r*r+i*i),o=a>0?Math.atan2(a,s)/a:0;return t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=.5*Math.log(n*n+r*r+i*i+s*s),t}function Br(t,e,n){return Ir(t,e),ri(t,t,n),Lr(t,t),t}function Nr(t,e,n,r){var i,s,a,o,u,c=e[0],_=e[1],p=e[2],h=e[3],d=n[0],f=n[1],m=n[2],g=n[3];return(s=c*d+_*f+p*m+h*g)<0&&(s=-s,d=-d,f=-f,m=-m,g=-g),1-s>l?(i=Math.acos(s),a=Math.sin(i),o=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(o=1-r,u=r),t[0]=o*c+u*d,t[1]=o*_+u*f,t[2]=o*p+u*m,t[3]=o*h+u*g,t}function zr(t){var e=f(),n=f(),r=f(),i=Math.sqrt(1-e),s=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=s*Math.sin(2*Math.PI*r),t[3]=s*Math.cos(2*Math.PI*r),t}function Fr(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=n*n+r*r+i*i+s*s,o=a?1/a:0;return t[0]=-n*o,t[1]=-r*o,t[2]=-i*o,t[3]=s*o,t}function Ur(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Gr(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var s=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*s+s]-e[3*a+a]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*s+a]-e[3*a+s])*n,t[s]=(e[3*s+i]+e[3*i+s])*n,t[a]=(e[3*a+i]+e[3*i+a])*n}return t}function Wr(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var s=Math.sin(e),a=Math.cos(e),o=Math.sin(n),u=Math.cos(n),c=Math.sin(r),_=Math.cos(r);return t[0]=s*u*_-a*o*c,t[1]=a*o*_+s*u*c,t[2]=a*u*c-s*o*_,t[3]=a*u*_+s*o*c,t}function Vr(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Kr,qr,Xr,Hr,$r,Yr,Qr=zn,Jr=Fn,Zr=Un,ti=Gn,ei=Wn,ni=Rr,ri=Jn,ii=or,si=cr,ai=nr,oi=ai,ui=rr,ci=ui,_i=ar,pi=fr,hi=mr,li=(Kr=Ge(),qr=Ke(1,0,0),Xr=Ke(0,1,0),function(t,e,n){var r=hn(e,n);return r<-.999999?(ln(Kr,qr,e),Ln(Kr)<1e-6&&ln(Kr,Xr,e),pn(Kr,Kr),Mr(t,Kr,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(ln(Kr,e,n),t[0]=Kr[0],t[1]=Kr[1],t[2]=Kr[2],t[3]=1+r,_i(t,t))}),di=(Hr=Sr(),$r=Sr(),function(t,e,n,r,i,s){return Nr(Hr,e,i,s),Nr($r,n,r,s),Nr(t,Hr,$r,2*s*(1-s)),t}),fi=(Yr=gt(),function(t,e,n,r){return Yr[0]=n[0],Yr[3]=n[1],Yr[6]=n[2],Yr[1]=r[0],Yr[4]=r[1],Yr[7]=r[2],Yr[2]=-e[0],Yr[5]=-e[1],Yr[8]=-e[2],_i(t,Gr(t,Yr))});function mi(){var t=new d(8);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function gi(t){var e=new d(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function vi(t,e,n,r,i,s,a,o){var u=new d(8);return u[0]=t,u[1]=e,u[2]=n,u[3]=r,u[4]=i,u[5]=s,u[6]=a,u[7]=o,u}function yi(t,e,n,r,i,s,a){var o=new d(8);o[0]=t,o[1]=e,o[2]=n,o[3]=r;var u=.5*i,c=.5*s,_=.5*a;return o[4]=u*r+c*n-_*e,o[5]=c*r+_*t-u*n,o[6]=_*r+u*e-c*t,o[7]=-u*t-c*e-_*n,o}function bi(t,e,n){var r=.5*n[0],i=.5*n[1],s=.5*n[2],a=e[0],o=e[1],u=e[2],c=e[3];return t[0]=a,t[1]=o,t[2]=u,t[3]=c,t[4]=r*c+i*u-s*o,t[5]=i*c+s*a-r*u,t[6]=s*c+r*o-i*a,t[7]=-r*a-i*o-s*u,t}function wi(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t}function ki(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function xi(t,e){var n=Sr();ke(n,e);var r=new d(3);return be(r,e),bi(t,n,r),t}function Ti(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Si(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Ci(t,e,n,r,i,s,a,o,u){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=a,t[6]=o,t[7]=u,t}var Mi=Zr;function Ei(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var Pi=Zr;function Ri(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function Oi(t,e){var n=e[4],r=e[5],i=e[6],s=e[7],a=-e[0],o=-e[1],u=-e[2],c=e[3];return t[0]=2*(n*c+s*a+r*u-i*o),t[1]=2*(r*c+s*o+i*a-n*u),t[2]=2*(i*c+s*u+n*o-r*a),t}function ji(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=.5*n[0],u=.5*n[1],c=.5*n[2],_=e[4],p=e[5],h=e[6],l=e[7];return t[0]=r,t[1]=i,t[2]=s,t[3]=a,t[4]=a*o+i*c-s*u+_,t[5]=a*u+s*o-r*c+p,t[6]=a*c+r*u-i*o+h,t[7]=-r*o-i*u-s*c+l,t}function Di(t,e,n){var r=-e[0],i=-e[1],s=-e[2],a=e[3],o=e[4],u=e[5],c=e[6],_=e[7],p=o*a+_*r+u*s-c*i,h=u*a+_*i+c*r-o*s,l=c*a+_*s+o*i-u*r,d=_*a-o*r-u*i-c*s;return Or(t,e,n),r=t[0],i=t[1],s=t[2],a=t[3],t[4]=p*a+d*r+h*s-l*i,t[5]=h*a+d*i+l*r-p*s,t[6]=l*a+d*s+p*i-h*r,t[7]=d*a-p*r-h*i-l*s,t}function Ai(t,e,n){var r=-e[0],i=-e[1],s=-e[2],a=e[3],o=e[4],u=e[5],c=e[6],_=e[7],p=o*a+_*r+u*s-c*i,h=u*a+_*i+c*r-o*s,l=c*a+_*s+o*i-u*r,d=_*a-o*r-u*i-c*s;return jr(t,e,n),r=t[0],i=t[1],s=t[2],a=t[3],t[4]=p*a+d*r+h*s-l*i,t[5]=h*a+d*i+l*r-p*s,t[6]=l*a+d*s+p*i-h*r,t[7]=d*a-p*r-h*i-l*s,t}function Li(t,e,n){var r=-e[0],i=-e[1],s=-e[2],a=e[3],o=e[4],u=e[5],c=e[6],_=e[7],p=o*a+_*r+u*s-c*i,h=u*a+_*i+c*r-o*s,l=c*a+_*s+o*i-u*r,d=_*a-o*r-u*i-c*s;return Dr(t,e,n),r=t[0],i=t[1],s=t[2],a=t[3],t[4]=p*a+d*r+h*s-l*i,t[5]=h*a+d*i+l*r-p*s,t[6]=l*a+d*s+p*i-h*r,t[7]=d*a-p*r-h*i-l*s,t}function Ii(t,e,n){var r=n[0],i=n[1],s=n[2],a=n[3],o=e[0],u=e[1],c=e[2],_=e[3];return t[0]=o*a+_*r+u*s-c*i,t[1]=u*a+_*i+c*r-o*s,t[2]=c*a+_*s+o*i-u*r,t[3]=_*a-o*r-u*i-c*s,o=e[4],u=e[5],c=e[6],_=e[7],t[4]=o*a+_*r+u*s-c*i,t[5]=u*a+_*i+c*r-o*s,t[6]=c*a+_*s+o*i-u*r,t[7]=_*a-o*r-u*i-c*s,t}function Bi(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=n[0],u=n[1],c=n[2],_=n[3];return t[0]=r*_+a*o+i*c-s*u,t[1]=i*_+a*u+s*o-r*c,t[2]=s*_+a*c+r*u-i*o,t[3]=a*_-r*o-i*u-s*c,o=n[4],u=n[5],c=n[6],_=n[7],t[4]=r*_+a*o+i*c-s*u,t[5]=i*_+a*u+s*o-r*c,t[6]=s*_+a*c+r*u-i*o,t[7]=a*_-r*o-i*u-s*c,t}function Ni(t,e,n,r){if(Math.abs(r)<l)return Ti(t,e);var i=Math.hypot(n[0],n[1],n[2]);r*=.5;var s=Math.sin(r),a=s*n[0]/i,o=s*n[1]/i,u=s*n[2]/i,c=Math.cos(r),_=e[0],p=e[1],h=e[2],d=e[3];t[0]=_*c+d*a+p*u-h*o,t[1]=p*c+d*o+h*a-_*u,t[2]=h*c+d*u+_*o-p*a,t[3]=d*c-_*a-p*o-h*u;var f=e[4],m=e[5],g=e[6],v=e[7];return t[4]=f*c+v*a+m*u-g*o,t[5]=m*c+v*o+g*a-f*u,t[6]=g*c+v*u+f*o-m*a,t[7]=v*c-f*a-m*o-g*u,t}function zi(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t}function Fi(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=n[4],u=n[5],c=n[6],_=n[7],p=e[4],h=e[5],l=e[6],d=e[7],f=n[0],m=n[1],g=n[2],v=n[3];return t[0]=r*v+a*f+i*g-s*m,t[1]=i*v+a*m+s*f-r*g,t[2]=s*v+a*g+r*m-i*f,t[3]=a*v-r*f-i*m-s*g,t[4]=r*_+a*o+i*c-s*u+p*v+d*f+h*g-l*m,t[5]=i*_+a*u+s*o-r*c+h*v+d*m+l*f-p*g,t[6]=s*_+a*c+r*u-i*o+l*v+d*g+p*m-h*f,t[7]=a*_-r*o-i*u-s*c+d*v-p*f-h*m-l*g,t}var Ui=Fi;function Gi(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t}var Wi=ii;function Vi(t,e,n,r){var i=1-r;return Wi(e,n)<0&&(r=-r),t[0]=e[0]*i+n[0]*r,t[1]=e[1]*i+n[1]*r,t[2]=e[2]*i+n[2]*r,t[3]=e[3]*i+n[3]*r,t[4]=e[4]*i+n[4]*r,t[5]=e[5]*i+n[5]*r,t[6]=e[6]*i+n[6]*r,t[7]=e[7]*i+n[7]*r,t}function Ki(t,e){var n=$i(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t}function qi(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var Xi=ai,Hi=Xi,$i=ui,Yi=$i;function Qi(t,e){var n=$i(e);if(n>0){n=Math.sqrt(n);var r=e[0]/n,i=e[1]/n,s=e[2]/n,a=e[3]/n,o=e[4],u=e[5],c=e[6],_=e[7],p=r*o+i*u+s*c+a*_;t[0]=r,t[1]=i,t[2]=s,t[3]=a,t[4]=(o-r*p)/n,t[5]=(u-i*p)/n,t[6]=(c-s*p)/n,t[7]=(_-a*p)/n}return t}function Ji(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function Zi(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function ts(t,e){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],u=t[6],c=t[7],_=e[0],p=e[1],h=e[2],d=e[3],f=e[4],m=e[5],g=e[6],v=e[7];return Math.abs(n-_)<=l*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(r-p)<=l*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(i-h)<=l*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(s-d)<=l*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(a-f)<=l*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(o-m)<=l*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(u-g)<=l*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(c-v)<=l*Math.max(1,Math.abs(c),Math.abs(v))}function es(){var t=new d(2);return d!=Float32Array&&(t[0]=0,t[1]=0),t}function ns(t){var e=new d(2);return e[0]=t[0],e[1]=t[1],e}function rs(t,e){var n=new d(2);return n[0]=t,n[1]=e,n}function is(t,e){return t[0]=e[0],t[1]=e[1],t}function ss(t,e,n){return t[0]=e,t[1]=n,t}function as(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function os(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function us(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function cs(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function _s(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function ps(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function hs(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function ls(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function ds(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function fs(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function ms(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function gs(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.hypot(n,r)}function vs(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function ys(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function bs(t){var e=t[0],n=t[1];return e*e+n*n}function ws(t,e){return t[0]=-e[0],t[1]=-e[1],t}function ks(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function xs(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function Ts(t,e){return t[0]*e[0]+t[1]*e[1]}function Ss(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function Cs(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function Ms(t,e){e=e||1;var n=2*f()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function Es(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function Ps(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function Rs(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function Os(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function js(t,e,n,r){var i=e[0]-n[0],s=e[1]-n[1],a=Math.sin(r),o=Math.cos(r);return t[0]=i*o-s*a+n[0],t[1]=i*a+s*o+n[1],t}function Ds(t,e){var n=t[0],r=t[1],i=e[0],s=e[1],a=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+s*s),o=a&&(n*i+r*s)/a;return Math.acos(Math.min(Math.max(o,-1),1))}function As(t){return t[0]=0,t[1]=0,t}function Ls(t){return"vec2("+t[0]+", "+t[1]+")"}function Is(t,e){return t[0]===e[0]&&t[1]===e[1]}function Bs(t,e){var n=t[0],r=t[1],i=e[0],s=e[1];return Math.abs(n-i)<=l*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-s)<=l*Math.max(1,Math.abs(r),Math.abs(s))}var Ns=ys,zs=os,Fs=us,Us=cs,Gs=gs,Ws=vs,Vs=bs,Ks=function(){var t=es();return function(e,n,r,i,s,a){var o,u;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,o=r;o<u;o+=n)t[0]=e[o],t[1]=e[o+1],s(t,t,a),e[o]=t[0],e[o+1]=t[1];return e}}()},204:(t,e,n)=>{"use strict";var r,i;r=[n(937),n(40),n(566)],void 0===(i=function(t,e,n){return function(t,e,n){var r=function(e,n){return t.js_beautify(e,n)};return r.js=t.js_beautify,r.css=e.css_beautify,r.html=n.html_beautify,r.js_beautify=t.js_beautify,r.css_beautify=e.css_beautify,r.html_beautify=n.html_beautify,r}(t,e,n)}.apply(e,r))||(t.exports=i)},40:(t,e)=>{var n,r;r=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=15)}([,,function(t,e,n){"use strict";function r(t){this.__parent=t,this.__character_count=0,this.__indent_count=-1,this.__alignment_count=0,this.__wrap_point_index=0,this.__wrap_point_character_count=0,this.__wrap_point_indent_count=-1,this.__wrap_point_alignment_count=0,this.__items=[]}function i(t,e){this.__cache=[""],this.__indent_size=t.indent_size,this.__indent_string=t.indent_char,t.indent_with_tabs||(this.__indent_string=new Array(t.indent_size+1).join(t.indent_char)),e=e||"",t.indent_level>0&&(e=new Array(t.indent_level+1).join(this.__indent_string)),this.__base_string=e,this.__base_string_length=e.length}function s(t,e){this.__indent_cache=new i(t,e),this.raw=!1,this._end_with_newline=t.end_with_newline,this.indent_size=t.indent_size,this.wrap_line_length=t.wrap_line_length,this.indent_empty_lines=t.indent_empty_lines,this.__lines=[],this.previous_line=null,this.current_line=null,this.next_line=new r(this),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1,this.__add_outputline()}r.prototype.clone_empty=function(){var t=new r(this.__parent);return t.set_indent(this.__indent_count,this.__alignment_count),t},r.prototype.item=function(t){return t<0?this.__items[this.__items.length+t]:this.__items[t]},r.prototype.has_match=function(t){for(var e=this.__items.length-1;e>=0;e--)if(this.__items[e].match(t))return!0;return!1},r.prototype.set_indent=function(t,e){this.is_empty()&&(this.__indent_count=t||0,this.__alignment_count=e||0,this.__character_count=this.__parent.get_indent_size(this.__indent_count,this.__alignment_count))},r.prototype._set_wrap_point=function(){this.__parent.wrap_line_length&&(this.__wrap_point_index=this.__items.length,this.__wrap_point_character_count=this.__character_count,this.__wrap_point_indent_count=this.__parent.next_line.__indent_count,this.__wrap_point_alignment_count=this.__parent.next_line.__alignment_count)},r.prototype._should_wrap=function(){return this.__wrap_point_index&&this.__character_count>this.__parent.wrap_line_length&&this.__wrap_point_character_count>this.__parent.next_line.__character_count},r.prototype._allow_wrap=function(){if(this._should_wrap()){this.__parent.add_new_line();var t=this.__parent.current_line;return t.set_indent(this.__wrap_point_indent_count,this.__wrap_point_alignment_count),t.__items=this.__items.slice(this.__wrap_point_index),this.__items=this.__items.slice(0,this.__wrap_point_index),t.__character_count+=this.__character_count-this.__wrap_point_character_count,this.__character_count=this.__wrap_point_character_count," "===t.__items[0]&&(t.__items.splice(0,1),t.__character_count-=1),!0}return!1},r.prototype.is_empty=function(){return 0===this.__items.length},r.prototype.last=function(){return this.is_empty()?null:this.__items[this.__items.length-1]},r.prototype.push=function(t){this.__items.push(t);var e=t.lastIndexOf("\n");-1!==e?this.__character_count=t.length-e:this.__character_count+=t.length},r.prototype.pop=function(){var t=null;return this.is_empty()||(t=this.__items.pop(),this.__character_count-=t.length),t},r.prototype._remove_indent=function(){this.__indent_count>0&&(this.__indent_count-=1,this.__character_count-=this.__parent.indent_size)},r.prototype._remove_wrap_indent=function(){this.__wrap_point_indent_count>0&&(this.__wrap_point_indent_count-=1)},r.prototype.trim=function(){for(;" "===this.last();)this.__items.pop(),this.__character_count-=1},r.prototype.toString=function(){var t="";return this.is_empty()?this.__parent.indent_empty_lines&&(t=this.__parent.get_indent_string(this.__indent_count)):(t=this.__parent.get_indent_string(this.__indent_count,this.__alignment_count),t+=this.__items.join("")),t},i.prototype.get_indent_size=function(t,e){var n=this.__base_string_length;return e=e||0,t<0&&(n=0),(n+=t*this.__indent_size)+e},i.prototype.get_indent_string=function(t,e){var n=this.__base_string;return e=e||0,t<0&&(t=0,n=""),e+=t*this.__indent_size,this.__ensure_cache(e),n+this.__cache[e]},i.prototype.__ensure_cache=function(t){for(;t>=this.__cache.length;)this.__add_column()},i.prototype.__add_column=function(){var t=this.__cache.length,e=0,n="";this.__indent_size&&t>=this.__indent_size&&(t-=(e=Math.floor(t/this.__indent_size))*this.__indent_size,n=new Array(e+1).join(this.__indent_string)),t&&(n+=new Array(t+1).join(" ")),this.__cache.push(n)},s.prototype.__add_outputline=function(){this.previous_line=this.current_line,this.current_line=this.next_line.clone_empty(),this.__lines.push(this.current_line)},s.prototype.get_line_number=function(){return this.__lines.length},s.prototype.get_indent_string=function(t,e){return this.__indent_cache.get_indent_string(t,e)},s.prototype.get_indent_size=function(t,e){return this.__indent_cache.get_indent_size(t,e)},s.prototype.is_empty=function(){return!this.previous_line&&this.current_line.is_empty()},s.prototype.add_new_line=function(t){return!(this.is_empty()||!t&&this.just_added_newline()||(this.raw||this.__add_outputline(),0))},s.prototype.get_code=function(t){this.trim(!0);var e=this.current_line.pop();e&&("\n"===e[e.length-1]&&(e=e.replace(/\n+$/g,"")),this.current_line.push(e)),this._end_with_newline&&this.__add_outputline();var n=this.__lines.join("\n");return"\n"!==t&&(n=n.replace(/[\n]/g,t)),n},s.prototype.set_wrap_point=function(){this.current_line._set_wrap_point()},s.prototype.set_indent=function(t,e){return t=t||0,e=e||0,this.next_line.set_indent(t,e),this.__lines.length>1?(this.current_line.set_indent(t,e),!0):(this.current_line.set_indent(),!1)},s.prototype.add_raw_token=function(t){for(var e=0;e<t.newlines;e++)this.__add_outputline();this.current_line.set_indent(-1),this.current_line.push(t.whitespace_before),this.current_line.push(t.text),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1},s.prototype.add_token=function(t){this.__add_space_before_token(),this.current_line.push(t),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=this.current_line._allow_wrap()},s.prototype.__add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&(this.non_breaking_space||this.set_wrap_point(),this.current_line.push(" "))},s.prototype.remove_indent=function(t){for(var e=this.__lines.length;t<e;)this.__lines[t]._remove_indent(),t++;this.current_line._remove_wrap_indent()},s.prototype.trim=function(t){for(t=void 0!==t&&t,this.current_line.trim();t&&this.__lines.length>1&&this.current_line.is_empty();)this.__lines.pop(),this.current_line=this.__lines[this.__lines.length-1],this.current_line.trim();this.previous_line=this.__lines.length>1?this.__lines[this.__lines.length-2]:null},s.prototype.just_added_newline=function(){return this.current_line.is_empty()},s.prototype.just_added_blankline=function(){return this.is_empty()||this.current_line.is_empty()&&this.previous_line.is_empty()},s.prototype.ensure_empty_line_above=function(t,e){for(var n=this.__lines.length-2;n>=0;){var i=this.__lines[n];if(i.is_empty())break;if(0!==i.item(0).indexOf(t)&&i.item(-1)!==e){this.__lines.splice(n+1,0,new r(this)),this.previous_line=this.__lines[this.__lines.length-2];break}n--}},t.exports.Output=s},,,,function(t,e,n){"use strict";function r(t,e){this.raw_options=i(t,e),this.disabled=this._get_boolean("disabled"),this.eol=this._get_characters("eol","auto"),this.end_with_newline=this._get_boolean("end_with_newline"),this.indent_size=this._get_number("indent_size",4),this.indent_char=this._get_characters("indent_char"," "),this.indent_level=this._get_number("indent_level"),this.preserve_newlines=this._get_boolean("preserve_newlines",!0),this.max_preserve_newlines=this._get_number("max_preserve_newlines",32786),this.preserve_newlines||(this.max_preserve_newlines=0),this.indent_with_tabs=this._get_boolean("indent_with_tabs","\t"===this.indent_char),this.indent_with_tabs&&(this.indent_char="\t",1===this.indent_size&&(this.indent_size=4)),this.wrap_line_length=this._get_number("wrap_line_length",this._get_number("max_char")),this.indent_empty_lines=this._get_boolean("indent_empty_lines"),this.templating=this._get_selection_list("templating",["auto","none","django","erb","handlebars","php","smarty"],["auto"])}function i(t,e){var n,r={};for(n in t=s(t))n!==e&&(r[n]=t[n]);if(e&&t[e])for(n in t[e])r[n]=t[e][n];return r}function s(t){var e,n={};for(e in t)n[e.replace(/-/g,"_")]=t[e];return n}r.prototype._get_array=function(t,e){var n=this.raw_options[t],r=e||[];return"object"==typeof n?null!==n&&"function"==typeof n.concat&&(r=n.concat()):"string"==typeof n&&(r=n.split(/[^a-zA-Z0-9_\/\-]+/)),r},r.prototype._get_boolean=function(t,e){var n=this.raw_options[t];return void 0===n?!!e:!!n},r.prototype._get_characters=function(t,e){var n=this.raw_options[t],r=e||"";return"string"==typeof n&&(r=n.replace(/\\r/,"\r").replace(/\\n/,"\n").replace(/\\t/,"\t")),r},r.prototype._get_number=function(t,e){var n=this.raw_options[t];e=parseInt(e,10),isNaN(e)&&(e=0);var r=parseInt(n,10);return isNaN(r)&&(r=e),r},r.prototype._get_selection=function(t,e,n){var r=this._get_selection_list(t,e,n);if(1!==r.length)throw new Error("Invalid Option Value: The option '"+t+"' can only be one of the following values:\n"+e+"\nYou passed in: '"+this.raw_options[t]+"'");return r[0]},r.prototype._get_selection_list=function(t,e,n){if(!e||0===e.length)throw new Error("Selection list cannot be empty.");if(n=n||[e[0]],!this._is_valid_selection(n,e))throw new Error("Invalid Default Value!");var r=this._get_array(t,n);if(!this._is_valid_selection(r,e))throw new Error("Invalid Option Value: The option '"+t+"' can contain only the following values:\n"+e+"\nYou passed in: '"+this.raw_options[t]+"'");return r},r.prototype._is_valid_selection=function(t,e){return t.length&&e.length&&!t.some((function(t){return-1===e.indexOf(t)}))},t.exports.Options=r,t.exports.normalizeOpts=s,t.exports.mergeOpts=i},,function(t,e,n){"use strict";var r=RegExp.prototype.hasOwnProperty("sticky");function i(t){this.__input=t||"",this.__input_length=this.__input.length,this.__position=0}i.prototype.restart=function(){this.__position=0},i.prototype.back=function(){this.__position>0&&(this.__position-=1)},i.prototype.hasNext=function(){return this.__position<this.__input_length},i.prototype.next=function(){var t=null;return this.hasNext()&&(t=this.__input.charAt(this.__position),this.__position+=1),t},i.prototype.peek=function(t){var e=null;return t=t||0,(t+=this.__position)>=0&&t<this.__input_length&&(e=this.__input.charAt(t)),e},i.prototype.__match=function(t,e){t.lastIndex=e;var n=t.exec(this.__input);return!n||r&&t.sticky||n.index!==e&&(n=null),n},i.prototype.test=function(t,e){return e=e||0,(e+=this.__position)>=0&&e<this.__input_length&&!!this.__match(t,e)},i.prototype.testChar=function(t,e){var n=this.peek(e);return t.lastIndex=0,null!==n&&t.test(n)},i.prototype.match=function(t){var e=this.__match(t,this.__position);return e?this.__position+=e[0].length:e=null,e},i.prototype.read=function(t,e,n){var r,i="";return t&&(r=this.match(t))&&(i+=r[0]),!e||!r&&t||(i+=this.readUntil(e,n)),i},i.prototype.readUntil=function(t,e){var n,r=this.__position;t.lastIndex=this.__position;var i=t.exec(this.__input);return i?(r=i.index,e&&(r+=i[0].length)):r=this.__input_length,n=this.__input.substring(this.__position,r),this.__position=r,n},i.prototype.readUntilAfter=function(t){return this.readUntil(t,!0)},i.prototype.get_regexp=function(t,e){var n=null,i="g";return e&&r&&(i="y"),"string"==typeof t&&""!==t?n=new RegExp(t,i):t&&(n=new RegExp(t.source,i)),n},i.prototype.get_literal_regexp=function(t){return RegExp(t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))},i.prototype.peekUntilAfter=function(t){var e=this.__position,n=this.readUntilAfter(t);return this.__position=e,n},i.prototype.lookBack=function(t){var e=this.__position-1;return e>=t.length&&this.__input.substring(e-t.length,e).toLowerCase()===t},t.exports.InputScanner=i},,,,,function(t,e,n){"use strict";function r(t,e){t="string"==typeof t?t:t.source,e="string"==typeof e?e:e.source,this.__directives_block_pattern=new RegExp(t+/ beautify( \w+[:]\w+)+ /.source+e,"g"),this.__directive_pattern=/ (\w+)[:](\w+)/g,this.__directives_end_ignore_pattern=new RegExp(t+/\sbeautify\signore:end\s/.source+e,"g")}r.prototype.get_directives=function(t){if(!t.match(this.__directives_block_pattern))return null;var e={};this.__directive_pattern.lastIndex=0;for(var n=this.__directive_pattern.exec(t);n;)e[n[1]]=n[2],n=this.__directive_pattern.exec(t);return e},r.prototype.readIgnored=function(t){return t.readUntilAfter(this.__directives_end_ignore_pattern)},t.exports.Directives=r},,function(t,e,n){"use strict";var r=n(16).Beautifier,i=n(17).Options;t.exports=function(t,e){return new r(t,e).beautify()},t.exports.defaultOptions=function(){return new i}},function(t,e,n){"use strict";var r=n(17).Options,i=n(2).Output,s=n(8).InputScanner,a=new(0,n(13).Directives)(/\/\*/,/\*\//),o=/\r\n|[\r\n]/,u=/\r\n|[\r\n]/g,c=/\s/,_=/(?:\s|\n)+/g,p=/\/\*(?:[\s\S]*?)((?:\*\/)|$)/g,h=/\/\/(?:[^\n\r\u2028\u2029]*)/g;function l(t,e){this._source_text=t||"",this._options=new r(e),this._ch=null,this._input=null,this.NESTED_AT_RULE={"@page":!0,"@font-face":!0,"@keyframes":!0,"@media":!0,"@supports":!0,"@document":!0},this.CONDITIONAL_GROUP_RULE={"@media":!0,"@supports":!0,"@document":!0}}l.prototype.eatString=function(t){var e="";for(this._ch=this._input.next();this._ch;){if(e+=this._ch,"\\"===this._ch)e+=this._input.next();else if(-1!==t.indexOf(this._ch)||"\n"===this._ch)break;this._ch=this._input.next()}return e},l.prototype.eatWhitespace=function(t){for(var e=c.test(this._input.peek()),n=0;c.test(this._input.peek());)this._ch=this._input.next(),t&&"\n"===this._ch&&(0===n||n<this._options.max_preserve_newlines)&&(n++,this._output.add_new_line(!0));return e},l.prototype.foundNestedPseudoClass=function(){for(var t=0,e=1,n=this._input.peek(e);n;){if("{"===n)return!0;if("("===n)t+=1;else if(")"===n){if(0===t)return!1;t-=1}else if(";"===n||"}"===n)return!1;e++,n=this._input.peek(e)}return!1},l.prototype.print_string=function(t){this._output.set_indent(this._indentLevel),this._output.non_breaking_space=!0,this._output.add_token(t)},l.prototype.preserveSingleSpace=function(t){t&&(this._output.space_before_token=!0)},l.prototype.indent=function(){this._indentLevel++},l.prototype.outdent=function(){this._indentLevel>0&&this._indentLevel--},l.prototype.beautify=function(){if(this._options.disabled)return this._source_text;var t=this._source_text,e=this._options.eol;"auto"===e&&(e="\n",t&&o.test(t||"")&&(e=t.match(o)[0]));var n=(t=t.replace(u,"\n")).match(/^[\t ]*/)[0];this._output=new i(this._options,n),this._input=new s(t),this._indentLevel=0,this._nestedLevel=0,this._ch=null;for(var r,l,d=0,f=!1,m=!1,g=!1,v=!1,y=!1,b=this._ch;r=""!==this._input.read(_),l=b,this._ch=this._input.next(),"\\"===this._ch&&this._input.hasNext()&&(this._ch+=this._input.next()),b=this._ch,this._ch;)if("/"===this._ch&&"*"===this._input.peek()){this._output.add_new_line(),this._input.back();var w=this._input.read(p),k=a.get_directives(w);k&&"start"===k.ignore&&(w+=a.readIgnored(this._input)),this.print_string(w),this.eatWhitespace(!0),this._output.add_new_line()}else if("/"===this._ch&&"/"===this._input.peek())this._output.space_before_token=!0,this._input.back(),this.print_string(this._input.read(h)),this.eatWhitespace(!0);else if("@"===this._ch)if(this.preserveSingleSpace(r),"{"===this._input.peek())this.print_string(this._ch+this.eatString("}"));else{this.print_string(this._ch);var x=this._input.peekUntilAfter(/[: ,;{}()[\]\/='"]/g);x.match(/[ :]$/)&&(x=this.eatString(": ").replace(/\s$/,""),this.print_string(x),this._output.space_before_token=!0),"extend"===(x=x.replace(/\s$/,""))?v=!0:"import"===x&&(y=!0),x in this.NESTED_AT_RULE?(this._nestedLevel+=1,x in this.CONDITIONAL_GROUP_RULE&&(g=!0)):f||0!==d||-1===x.indexOf(":")||(m=!0,this.indent())}else"#"===this._ch&&"{"===this._input.peek()?(this.preserveSingleSpace(r),this.print_string(this._ch+this.eatString("}"))):"{"===this._ch?(m&&(m=!1,this.outdent()),g?(g=!1,f=this._indentLevel>=this._nestedLevel):f=this._indentLevel>=this._nestedLevel-1,this._options.newline_between_rules&&f&&this._output.previous_line&&"{"!==this._output.previous_line.item(-1)&&this._output.ensure_empty_line_above("/",","),this._output.space_before_token=!0,"expand"===this._options.brace_style?(this._output.add_new_line(),this.print_string(this._ch),this.indent(),this._output.set_indent(this._indentLevel)):(this.indent(),this.print_string(this._ch)),this.eatWhitespace(!0),this._output.add_new_line()):"}"===this._ch?(this.outdent(),this._output.add_new_line(),"{"===l&&this._output.trim(!0),y=!1,v=!1,m&&(this.outdent(),m=!1),this.print_string(this._ch),f=!1,this._nestedLevel&&this._nestedLevel--,this.eatWhitespace(!0),this._output.add_new_line(),this._options.newline_between_rules&&!this._output.just_added_blankline()&&"}"!==this._input.peek()&&this._output.add_new_line(!0)):":"===this._ch?!f&&!g||this._input.lookBack("&")||this.foundNestedPseudoClass()||this._input.lookBack("(")||v||0!==d?(this._input.lookBack(" ")&&(this._output.space_before_token=!0),":"===this._input.peek()?(this._ch=this._input.next(),this.print_string("::")):this.print_string(":")):(this.print_string(":"),m||(m=!0,this._output.space_before_token=!0,this.eatWhitespace(!0),this.indent())):'"'===this._ch||"'"===this._ch?(this.preserveSingleSpace(r),this.print_string(this._ch+this.eatString(this._ch)),this.eatWhitespace(!0)):";"===this._ch?0===d?(m&&(this.outdent(),m=!1),v=!1,y=!1,this.print_string(this._ch),this.eatWhitespace(!0),"/"!==this._input.peek()&&this._output.add_new_line()):(this.print_string(this._ch),this.eatWhitespace(!0),this._output.space_before_token=!0):"("===this._ch?this._input.lookBack("url")?(this.print_string(this._ch),this.eatWhitespace(),d++,this.indent(),this._ch=this._input.next(),")"===this._ch||'"'===this._ch||"'"===this._ch?this._input.back():this._ch&&(this.print_string(this._ch+this.eatString(")")),d&&(d--,this.outdent()))):(this.preserveSingleSpace(r),this.print_string(this._ch),this.eatWhitespace(),d++,this.indent()):")"===this._ch?(d&&(d--,this.outdent()),this.print_string(this._ch)):","===this._ch?(this.print_string(this._ch),this.eatWhitespace(!0),!this._options.selector_separator_newline||m||0!==d||y?this._output.space_before_token=!0:this._output.add_new_line()):">"!==this._ch&&"+"!==this._ch&&"~"!==this._ch||m||0!==d?"]"===this._ch?this.print_string(this._ch):"["===this._ch?(this.preserveSingleSpace(r),this.print_string(this._ch)):"="===this._ch?(this.eatWhitespace(),this.print_string("="),c.test(this._ch)&&(this._ch="")):"!"!==this._ch||this._input.lookBack("\\")?(this.preserveSingleSpace(r),this.print_string(this._ch)):(this.print_string(" "),this.print_string(this._ch)):this._options.space_around_combinator?(this._output.space_before_token=!0,this.print_string(this._ch),this._output.space_before_token=!0):(this.print_string(this._ch),this.eatWhitespace(),this._ch&&c.test(this._ch)&&(this._ch=""));return this._output.get_code(e)},t.exports.Beautifier=l},function(t,e,n){"use strict";var r=n(6).Options;function i(t){r.call(this,t,"css"),this.selector_separator_newline=this._get_boolean("selector_separator_newline",!0),this.newline_between_rules=this._get_boolean("newline_between_rules",!0);var e=this._get_boolean("space_around_selector_separator");this.space_around_combinator=this._get_boolean("space_around_combinator")||e;var n=this._get_selection_list("brace_style",["collapse","expand","end-expand","none","preserve-inline"]);this.brace_style="collapse";for(var i=0;i<n.length;i++)"expand"!==n[i]?this.brace_style="collapse":this.brace_style=n[i]}i.prototype=new r,t.exports.Options=i}]),void 0===(n=function(){return{css_beautify:r}}.apply(e,[]))||(t.exports=n)},566:(t,e,n)=>{var r,i,s;s=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=18)}([,,function(t,e,n){"use strict";function r(t){this.__parent=t,this.__character_count=0,this.__indent_count=-1,this.__alignment_count=0,this.__wrap_point_index=0,this.__wrap_point_character_count=0,this.__wrap_point_indent_count=-1,this.__wrap_point_alignment_count=0,this.__items=[]}function i(t,e){this.__cache=[""],this.__indent_size=t.indent_size,this.__indent_string=t.indent_char,t.indent_with_tabs||(this.__indent_string=new Array(t.indent_size+1).join(t.indent_char)),e=e||"",t.indent_level>0&&(e=new Array(t.indent_level+1).join(this.__indent_string)),this.__base_string=e,this.__base_string_length=e.length}function s(t,e){this.__indent_cache=new i(t,e),this.raw=!1,this._end_with_newline=t.end_with_newline,this.indent_size=t.indent_size,this.wrap_line_length=t.wrap_line_length,this.indent_empty_lines=t.indent_empty_lines,this.__lines=[],this.previous_line=null,this.current_line=null,this.next_line=new r(this),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1,this.__add_outputline()}r.prototype.clone_empty=function(){var t=new r(this.__parent);return t.set_indent(this.__indent_count,this.__alignment_count),t},r.prototype.item=function(t){return t<0?this.__items[this.__items.length+t]:this.__items[t]},r.prototype.has_match=function(t){for(var e=this.__items.length-1;e>=0;e--)if(this.__items[e].match(t))return!0;return!1},r.prototype.set_indent=function(t,e){this.is_empty()&&(this.__indent_count=t||0,this.__alignment_count=e||0,this.__character_count=this.__parent.get_indent_size(this.__indent_count,this.__alignment_count))},r.prototype._set_wrap_point=function(){this.__parent.wrap_line_length&&(this.__wrap_point_index=this.__items.length,this.__wrap_point_character_count=this.__character_count,this.__wrap_point_indent_count=this.__parent.next_line.__indent_count,this.__wrap_point_alignment_count=this.__parent.next_line.__alignment_count)},r.prototype._should_wrap=function(){return this.__wrap_point_index&&this.__character_count>this.__parent.wrap_line_length&&this.__wrap_point_character_count>this.__parent.next_line.__character_count},r.prototype._allow_wrap=function(){if(this._should_wrap()){this.__parent.add_new_line();var t=this.__parent.current_line;return t.set_indent(this.__wrap_point_indent_count,this.__wrap_point_alignment_count),t.__items=this.__items.slice(this.__wrap_point_index),this.__items=this.__items.slice(0,this.__wrap_point_index),t.__character_count+=this.__character_count-this.__wrap_point_character_count,this.__character_count=this.__wrap_point_character_count," "===t.__items[0]&&(t.__items.splice(0,1),t.__character_count-=1),!0}return!1},r.prototype.is_empty=function(){return 0===this.__items.length},r.prototype.last=function(){return this.is_empty()?null:this.__items[this.__items.length-1]},r.prototype.push=function(t){this.__items.push(t);var e=t.lastIndexOf("\n");-1!==e?this.__character_count=t.length-e:this.__character_count+=t.length},r.prototype.pop=function(){var t=null;return this.is_empty()||(t=this.__items.pop(),this.__character_count-=t.length),t},r.prototype._remove_indent=function(){this.__indent_count>0&&(this.__indent_count-=1,this.__character_count-=this.__parent.indent_size)},r.prototype._remove_wrap_indent=function(){this.__wrap_point_indent_count>0&&(this.__wrap_point_indent_count-=1)},r.prototype.trim=function(){for(;" "===this.last();)this.__items.pop(),this.__character_count-=1},r.prototype.toString=function(){var t="";return this.is_empty()?this.__parent.indent_empty_lines&&(t=this.__parent.get_indent_string(this.__indent_count)):(t=this.__parent.get_indent_string(this.__indent_count,this.__alignment_count),t+=this.__items.join("")),t},i.prototype.get_indent_size=function(t,e){var n=this.__base_string_length;return e=e||0,t<0&&(n=0),(n+=t*this.__indent_size)+e},i.prototype.get_indent_string=function(t,e){var n=this.__base_string;return e=e||0,t<0&&(t=0,n=""),e+=t*this.__indent_size,this.__ensure_cache(e),n+this.__cache[e]},i.prototype.__ensure_cache=function(t){for(;t>=this.__cache.length;)this.__add_column()},i.prototype.__add_column=function(){var t=this.__cache.length,e=0,n="";this.__indent_size&&t>=this.__indent_size&&(t-=(e=Math.floor(t/this.__indent_size))*this.__indent_size,n=new Array(e+1).join(this.__indent_string)),t&&(n+=new Array(t+1).join(" ")),this.__cache.push(n)},s.prototype.__add_outputline=function(){this.previous_line=this.current_line,this.current_line=this.next_line.clone_empty(),this.__lines.push(this.current_line)},s.prototype.get_line_number=function(){return this.__lines.length},s.prototype.get_indent_string=function(t,e){return this.__indent_cache.get_indent_string(t,e)},s.prototype.get_indent_size=function(t,e){return this.__indent_cache.get_indent_size(t,e)},s.prototype.is_empty=function(){return!this.previous_line&&this.current_line.is_empty()},s.prototype.add_new_line=function(t){return!(this.is_empty()||!t&&this.just_added_newline()||(this.raw||this.__add_outputline(),0))},s.prototype.get_code=function(t){this.trim(!0);var e=this.current_line.pop();e&&("\n"===e[e.length-1]&&(e=e.replace(/\n+$/g,"")),this.current_line.push(e)),this._end_with_newline&&this.__add_outputline();var n=this.__lines.join("\n");return"\n"!==t&&(n=n.replace(/[\n]/g,t)),n},s.prototype.set_wrap_point=function(){this.current_line._set_wrap_point()},s.prototype.set_indent=function(t,e){return t=t||0,e=e||0,this.next_line.set_indent(t,e),this.__lines.length>1?(this.current_line.set_indent(t,e),!0):(this.current_line.set_indent(),!1)},s.prototype.add_raw_token=function(t){for(var e=0;e<t.newlines;e++)this.__add_outputline();this.current_line.set_indent(-1),this.current_line.push(t.whitespace_before),this.current_line.push(t.text),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1},s.prototype.add_token=function(t){this.__add_space_before_token(),this.current_line.push(t),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=this.current_line._allow_wrap()},s.prototype.__add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&(this.non_breaking_space||this.set_wrap_point(),this.current_line.push(" "))},s.prototype.remove_indent=function(t){for(var e=this.__lines.length;t<e;)this.__lines[t]._remove_indent(),t++;this.current_line._remove_wrap_indent()},s.prototype.trim=function(t){for(t=void 0!==t&&t,this.current_line.trim();t&&this.__lines.length>1&&this.current_line.is_empty();)this.__lines.pop(),this.current_line=this.__lines[this.__lines.length-1],this.current_line.trim();this.previous_line=this.__lines.length>1?this.__lines[this.__lines.length-2]:null},s.prototype.just_added_newline=function(){return this.current_line.is_empty()},s.prototype.just_added_blankline=function(){return this.is_empty()||this.current_line.is_empty()&&this.previous_line.is_empty()},s.prototype.ensure_empty_line_above=function(t,e){for(var n=this.__lines.length-2;n>=0;){var i=this.__lines[n];if(i.is_empty())break;if(0!==i.item(0).indexOf(t)&&i.item(-1)!==e){this.__lines.splice(n+1,0,new r(this)),this.previous_line=this.__lines[this.__lines.length-2];break}n--}},t.exports.Output=s},function(t,e,n){"use strict";t.exports.Token=function(t,e,n,r){this.type=t,this.text=e,this.comments_before=null,this.newlines=n||0,this.whitespace_before=r||"",this.parent=null,this.next=null,this.previous=null,this.opened=null,this.closed=null,this.directives=null}},,,function(t,e,n){"use strict";function r(t,e){this.raw_options=i(t,e),this.disabled=this._get_boolean("disabled"),this.eol=this._get_characters("eol","auto"),this.end_with_newline=this._get_boolean("end_with_newline"),this.indent_size=this._get_number("indent_size",4),this.indent_char=this._get_characters("indent_char"," "),this.indent_level=this._get_number("indent_level"),this.preserve_newlines=this._get_boolean("preserve_newlines",!0),this.max_preserve_newlines=this._get_number("max_preserve_newlines",32786),this.preserve_newlines||(this.max_preserve_newlines=0),this.indent_with_tabs=this._get_boolean("indent_with_tabs","\t"===this.indent_char),this.indent_with_tabs&&(this.indent_char="\t",1===this.indent_size&&(this.indent_size=4)),this.wrap_line_length=this._get_number("wrap_line_length",this._get_number("max_char")),this.indent_empty_lines=this._get_boolean("indent_empty_lines"),this.templating=this._get_selection_list("templating",["auto","none","django","erb","handlebars","php","smarty"],["auto"])}function i(t,e){var n,r={};for(n in t=s(t))n!==e&&(r[n]=t[n]);if(e&&t[e])for(n in t[e])r[n]=t[e][n];return r}function s(t){var e,n={};for(e in t)n[e.replace(/-/g,"_")]=t[e];return n}r.prototype._get_array=function(t,e){var n=this.raw_options[t],r=e||[];return"object"==typeof n?null!==n&&"function"==typeof n.concat&&(r=n.concat()):"string"==typeof n&&(r=n.split(/[^a-zA-Z0-9_\/\-]+/)),r},r.prototype._get_boolean=function(t,e){var n=this.raw_options[t];return void 0===n?!!e:!!n},r.prototype._get_characters=function(t,e){var n=this.raw_options[t],r=e||"";return"string"==typeof n&&(r=n.replace(/\\r/,"\r").replace(/\\n/,"\n").replace(/\\t/,"\t")),r},r.prototype._get_number=function(t,e){var n=this.raw_options[t];e=parseInt(e,10),isNaN(e)&&(e=0);var r=parseInt(n,10);return isNaN(r)&&(r=e),r},r.prototype._get_selection=function(t,e,n){var r=this._get_selection_list(t,e,n);if(1!==r.length)throw new Error("Invalid Option Value: The option '"+t+"' can only be one of the following values:\n"+e+"\nYou passed in: '"+this.raw_options[t]+"'");return r[0]},r.prototype._get_selection_list=function(t,e,n){if(!e||0===e.length)throw new Error("Selection list cannot be empty.");if(n=n||[e[0]],!this._is_valid_selection(n,e))throw new Error("Invalid Default Value!");var r=this._get_array(t,n);if(!this._is_valid_selection(r,e))throw new Error("Invalid Option Value: The option '"+t+"' can contain only the following values:\n"+e+"\nYou passed in: '"+this.raw_options[t]+"'");return r},r.prototype._is_valid_selection=function(t,e){return t.length&&e.length&&!t.some((function(t){return-1===e.indexOf(t)}))},t.exports.Options=r,t.exports.normalizeOpts=s,t.exports.mergeOpts=i},,function(t,e,n){"use strict";var r=RegExp.prototype.hasOwnProperty("sticky");function i(t){this.__input=t||"",this.__input_length=this.__input.length,this.__position=0}i.prototype.restart=function(){this.__position=0},i.prototype.back=function(){this.__position>0&&(this.__position-=1)},i.prototype.hasNext=function(){return this.__position<this.__input_length},i.prototype.next=function(){var t=null;return this.hasNext()&&(t=this.__input.charAt(this.__position),this.__position+=1),t},i.prototype.peek=function(t){var e=null;return t=t||0,(t+=this.__position)>=0&&t<this.__input_length&&(e=this.__input.charAt(t)),e},i.prototype.__match=function(t,e){t.lastIndex=e;var n=t.exec(this.__input);return!n||r&&t.sticky||n.index!==e&&(n=null),n},i.prototype.test=function(t,e){return e=e||0,(e+=this.__position)>=0&&e<this.__input_length&&!!this.__match(t,e)},i.prototype.testChar=function(t,e){var n=this.peek(e);return t.lastIndex=0,null!==n&&t.test(n)},i.prototype.match=function(t){var e=this.__match(t,this.__position);return e?this.__position+=e[0].length:e=null,e},i.prototype.read=function(t,e,n){var r,i="";return t&&(r=this.match(t))&&(i+=r[0]),!e||!r&&t||(i+=this.readUntil(e,n)),i},i.prototype.readUntil=function(t,e){var n,r=this.__position;t.lastIndex=this.__position;var i=t.exec(this.__input);return i?(r=i.index,e&&(r+=i[0].length)):r=this.__input_length,n=this.__input.substring(this.__position,r),this.__position=r,n},i.prototype.readUntilAfter=function(t){return this.readUntil(t,!0)},i.prototype.get_regexp=function(t,e){var n=null,i="g";return e&&r&&(i="y"),"string"==typeof t&&""!==t?n=new RegExp(t,i):t&&(n=new RegExp(t.source,i)),n},i.prototype.get_literal_regexp=function(t){return RegExp(t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))},i.prototype.peekUntilAfter=function(t){var e=this.__position,n=this.readUntilAfter(t);return this.__position=e,n},i.prototype.lookBack=function(t){var e=this.__position-1;return e>=t.length&&this.__input.substring(e-t.length,e).toLowerCase()===t},t.exports.InputScanner=i},function(t,e,n){"use strict";var r=n(8).InputScanner,i=n(3).Token,s=n(10).TokenStream,a=n(11).WhitespacePattern,o={START:"TK_START",RAW:"TK_RAW",EOF:"TK_EOF"},u=function(t,e){this._input=new r(t),this._options=e||{},this.__tokens=null,this._patterns={},this._patterns.whitespace=new a(this._input)};u.prototype.tokenize=function(){var t;this._input.restart(),this.__tokens=new s,this._reset();for(var e=new i(o.START,""),n=null,r=[],a=new s;e.type!==o.EOF;){for(t=this._get_next_token(e,n);this._is_comment(t);)a.add(t),t=this._get_next_token(e,n);a.isEmpty()||(t.comments_before=a,a=new s),t.parent=n,this._is_opening(t)?(r.push(n),n=t):n&&this._is_closing(t,n)&&(t.opened=n,n.closed=t,n=r.pop(),t.parent=n),t.previous=e,e.next=t,this.__tokens.add(t),e=t}return this.__tokens},u.prototype._is_first_token=function(){return this.__tokens.isEmpty()},u.prototype._reset=function(){},u.prototype._get_next_token=function(t,e){this._readWhitespace();var n=this._input.read(/.+/g);return n?this._create_token(o.RAW,n):this._create_token(o.EOF,"")},u.prototype._is_comment=function(t){return!1},u.prototype._is_opening=function(t){return!1},u.prototype._is_closing=function(t,e){return!1},u.prototype._create_token=function(t,e){return new i(t,e,this._patterns.whitespace.newline_count,this._patterns.whitespace.whitespace_before_token)},u.prototype._readWhitespace=function(){return this._patterns.whitespace.read()},t.exports.Tokenizer=u,t.exports.TOKEN=o},function(t,e,n){"use strict";function r(t){this.__tokens=[],this.__tokens_length=this.__tokens.length,this.__position=0,this.__parent_token=t}r.prototype.restart=function(){this.__position=0},r.prototype.isEmpty=function(){return 0===this.__tokens_length},r.prototype.hasNext=function(){return this.__position<this.__tokens_length},r.prototype.next=function(){var t=null;return this.hasNext()&&(t=this.__tokens[this.__position],this.__position+=1),t},r.prototype.peek=function(t){var e=null;return t=t||0,(t+=this.__position)>=0&&t<this.__tokens_length&&(e=this.__tokens[t]),e},r.prototype.add=function(t){this.__parent_token&&(t.parent=this.__parent_token),this.__tokens.push(t),this.__tokens_length+=1},t.exports.TokenStream=r},function(t,e,n){"use strict";var r=n(12).Pattern;function i(t,e){r.call(this,t,e),e?this._line_regexp=this._input.get_regexp(e._line_regexp):this.__set_whitespace_patterns("",""),this.newline_count=0,this.whitespace_before_token=""}i.prototype=new r,i.prototype.__set_whitespace_patterns=function(t,e){t+="\\t ",e+="\\n\\r",this._match_pattern=this._input.get_regexp("["+t+e+"]+",!0),this._newline_regexp=this._input.get_regexp("\\r\\n|["+e+"]")},i.prototype.read=function(){this.newline_count=0,this.whitespace_before_token="";var t=this._input.read(this._match_pattern);if(" "===t)this.whitespace_before_token=" ";else if(t){var e=this.__split(this._newline_regexp,t);this.newline_count=e.length-1,this.whitespace_before_token=e[this.newline_count]}return t},i.prototype.matching=function(t,e){var n=this._create();return n.__set_whitespace_patterns(t,e),n._update(),n},i.prototype._create=function(){return new i(this._input,this)},i.prototype.__split=function(t,e){t.lastIndex=0;for(var n=0,r=[],i=t.exec(e);i;)r.push(e.substring(n,i.index)),n=i.index+i[0].length,i=t.exec(e);return n<e.length?r.push(e.substring(n,e.length)):r.push(""),r},t.exports.WhitespacePattern=i},function(t,e,n){"use strict";function r(t,e){this._input=t,this._starting_pattern=null,this._match_pattern=null,this._until_pattern=null,this._until_after=!1,e&&(this._starting_pattern=this._input.get_regexp(e._starting_pattern,!0),this._match_pattern=this._input.get_regexp(e._match_pattern,!0),this._until_pattern=this._input.get_regexp(e._until_pattern),this._until_after=e._until_after)}r.prototype.read=function(){var t=this._input.read(this._starting_pattern);return this._starting_pattern&&!t||(t+=this._input.read(this._match_pattern,this._until_pattern,this._until_after)),t},r.prototype.read_match=function(){return this._input.match(this._match_pattern)},r.prototype.until_after=function(t){var e=this._create();return e._until_after=!0,e._until_pattern=this._input.get_regexp(t),e._update(),e},r.prototype.until=function(t){var e=this._create();return e._until_after=!1,e._until_pattern=this._input.get_regexp(t),e._update(),e},r.prototype.starting_with=function(t){var e=this._create();return e._starting_pattern=this._input.get_regexp(t,!0),e._update(),e},r.prototype.matching=function(t){var e=this._create();return e._match_pattern=this._input.get_regexp(t,!0),e._update(),e},r.prototype._create=function(){return new r(this._input,this)},r.prototype._update=function(){},t.exports.Pattern=r},function(t,e,n){"use strict";function r(t,e){t="string"==typeof t?t:t.source,e="string"==typeof e?e:e.source,this.__directives_block_pattern=new RegExp(t+/ beautify( \w+[:]\w+)+ /.source+e,"g"),this.__directive_pattern=/ (\w+)[:](\w+)/g,this.__directives_end_ignore_pattern=new RegExp(t+/\sbeautify\signore:end\s/.source+e,"g")}r.prototype.get_directives=function(t){if(!t.match(this.__directives_block_pattern))return null;var e={};this.__directive_pattern.lastIndex=0;for(var n=this.__directive_pattern.exec(t);n;)e[n[1]]=n[2],n=this.__directive_pattern.exec(t);return e},r.prototype.readIgnored=function(t){return t.readUntilAfter(this.__directives_end_ignore_pattern)},t.exports.Directives=r},function(t,e,n){"use strict";var r=n(12).Pattern,i={django:!1,erb:!1,handlebars:!1,php:!1,smarty:!1};function s(t,e){r.call(this,t,e),this.__template_pattern=null,this._disabled=Object.assign({},i),this._excluded=Object.assign({},i),e&&(this.__template_pattern=this._input.get_regexp(e.__template_pattern),this._excluded=Object.assign(this._excluded,e._excluded),this._disabled=Object.assign(this._disabled,e._disabled));var n=new r(t);this.__patterns={handlebars_comment:n.starting_with(/{{!--/).until_after(/--}}/),handlebars_unescaped:n.starting_with(/{{{/).until_after(/}}}/),handlebars:n.starting_with(/{{/).until_after(/}}/),php:n.starting_with(/<\?(?:[=]|php)/).until_after(/\?>/),erb:n.starting_with(/<%[^%]/).until_after(/[^%]%>/),django:n.starting_with(/{%/).until_after(/%}/),django_value:n.starting_with(/{{/).until_after(/}}/),django_comment:n.starting_with(/{#/).until_after(/#}/),smarty:n.starting_with(/{(?=[^}{\s\n])/).until_after(/[^\s\n]}/),smarty_comment:n.starting_with(/{\*/).until_after(/\*}/),smarty_literal:n.starting_with(/{literal}/).until_after(/{\/literal}/)}}s.prototype=new r,s.prototype._create=function(){return new s(this._input,this)},s.prototype._update=function(){this.__set_templated_pattern()},s.prototype.disable=function(t){var e=this._create();return e._disabled[t]=!0,e._update(),e},s.prototype.read_options=function(t){var e=this._create();for(var n in i)e._disabled[n]=-1===t.templating.indexOf(n);return e._update(),e},s.prototype.exclude=function(t){var e=this._create();return e._excluded[t]=!0,e._update(),e},s.prototype.read=function(){var t="";t=this._match_pattern?this._input.read(this._starting_pattern):this._input.read(this._starting_pattern,this.__template_pattern);for(var e=this._read_template();e;)this._match_pattern?e+=this._input.read(this._match_pattern):e+=this._input.readUntil(this.__template_pattern),t+=e,e=this._read_template();return this._until_after&&(t+=this._input.readUntilAfter(this._until_pattern)),t},s.prototype.__set_templated_pattern=function(){var t=[];this._disabled.php||t.push(this.__patterns.php._starting_pattern.source),this._disabled.handlebars||t.push(this.__patterns.handlebars._starting_pattern.source),this._disabled.erb||t.push(this.__patterns.erb._starting_pattern.source),this._disabled.django||(t.push(this.__patterns.django._starting_pattern.source),t.push(this.__patterns.django_value._starting_pattern.source),t.push(this.__patterns.django_comment._starting_pattern.source)),this._disabled.smarty||t.push(this.__patterns.smarty._starting_pattern.source),this._until_pattern&&t.push(this._until_pattern.source),this.__template_pattern=this._input.get_regexp("(?:"+t.join("|")+")")},s.prototype._read_template=function(){var t="",e=this._input.peek();if("<"===e){var n=this._input.peek(1);this._disabled.php||this._excluded.php||"?"!==n||(t=t||this.__patterns.php.read()),this._disabled.erb||this._excluded.erb||"%"!==n||(t=t||this.__patterns.erb.read())}else"{"===e&&(this._disabled.handlebars||this._excluded.handlebars||(t=(t=(t=t||this.__patterns.handlebars_comment.read())||this.__patterns.handlebars_unescaped.read())||this.__patterns.handlebars.read()),this._disabled.django||(this._excluded.django||this._excluded.handlebars||(t=t||this.__patterns.django_value.read()),this._excluded.django||(t=(t=t||this.__patterns.django_comment.read())||this.__patterns.django.read())),this._disabled.smarty||this._disabled.django&&this._disabled.handlebars&&(t=(t=(t=t||this.__patterns.smarty_comment.read())||this.__patterns.smarty_literal.read())||this.__patterns.smarty.read()));return t},t.exports.TemplatablePattern=s},,,,function(t,e,n){"use strict";var r=n(19).Beautifier,i=n(20).Options;t.exports=function(t,e,n,i){return new r(t,e,n,i).beautify()},t.exports.defaultOptions=function(){return new i}},function(t,e,n){"use strict";var r=n(20).Options,i=n(2).Output,s=n(21).Tokenizer,a=n(21).TOKEN,o=/\r\n|[\r\n]/,u=/\r\n|[\r\n]/g,c=function(t,e){this.indent_level=0,this.alignment_size=0,this.max_preserve_newlines=t.max_preserve_newlines,this.preserve_newlines=t.preserve_newlines,this._output=new i(t,e)};c.prototype.current_line_has_match=function(t){return this._output.current_line.has_match(t)},c.prototype.set_space_before_token=function(t,e){this._output.space_before_token=t,this._output.non_breaking_space=e},c.prototype.set_wrap_point=function(){this._output.set_indent(this.indent_level,this.alignment_size),this._output.set_wrap_point()},c.prototype.add_raw_token=function(t){this._output.add_raw_token(t)},c.prototype.print_preserved_newlines=function(t){var e=0;t.type!==a.TEXT&&t.previous.type!==a.TEXT&&(e=t.newlines?1:0),this.preserve_newlines&&(e=t.newlines<this.max_preserve_newlines+1?t.newlines:this.max_preserve_newlines+1);for(var n=0;n<e;n++)this.print_newline(n>0);return 0!==e},c.prototype.traverse_whitespace=function(t){return!(!t.whitespace_before&&!t.newlines||(this.print_preserved_newlines(t)||(this._output.space_before_token=!0),0))},c.prototype.previous_token_wrapped=function(){return this._output.previous_token_wrapped},c.prototype.print_newline=function(t){this._output.add_new_line(t)},c.prototype.print_token=function(t){t.text&&(this._output.set_indent(this.indent_level,this.alignment_size),this._output.add_token(t.text))},c.prototype.indent=function(){this.indent_level++},c.prototype.get_full_indent=function(t){return(t=this.indent_level+(t||0))<1?"":this._output.get_indent_string(t)};function _(t,e){return-1!==e.indexOf(t)}function p(t,e,n){this.parent=t||null,this.tag=e?e.tag_name:"",this.indent_level=n||0,this.parser_token=e||null}function h(t){this._printer=t,this._current_frame=null}function l(t,e,n,i){this._source_text=t||"",e=e||{},this._js_beautify=n,this._css_beautify=i,this._tag_stack=null;var s=new r(e,"html");this._options=s,this._is_wrap_attributes_force="force"===this._options.wrap_attributes.substr(0,"force".length),this._is_wrap_attributes_force_expand_multiline="force-expand-multiline"===this._options.wrap_attributes,this._is_wrap_attributes_force_aligned="force-aligned"===this._options.wrap_attributes,this._is_wrap_attributes_aligned_multiple="aligned-multiple"===this._options.wrap_attributes,this._is_wrap_attributes_preserve="preserve"===this._options.wrap_attributes.substr(0,"preserve".length),this._is_wrap_attributes_preserve_aligned="preserve-aligned"===this._options.wrap_attributes}h.prototype.get_parser_token=function(){return this._current_frame?this._current_frame.parser_token:null},h.prototype.record_tag=function(t){var e=new p(this._current_frame,t,this._printer.indent_level);this._current_frame=e},h.prototype._try_pop_frame=function(t){var e=null;return t&&(e=t.parser_token,this._printer.indent_level=t.indent_level,this._current_frame=t.parent),e},h.prototype._get_frame=function(t,e){for(var n=this._current_frame;n&&-1===t.indexOf(n.tag);){if(e&&-1!==e.indexOf(n.tag)){n=null;break}n=n.parent}return n},h.prototype.try_pop=function(t,e){var n=this._get_frame([t],e);return this._try_pop_frame(n)},h.prototype.indent_to_tag=function(t){var e=this._get_frame(t);e&&(this._printer.indent_level=e.indent_level)},l.prototype.beautify=function(){if(this._options.disabled)return this._source_text;var t=this._source_text,e=this._options.eol;"auto"===this._options.eol&&(e="\n",t&&o.test(t)&&(e=t.match(o)[0]));var n=(t=t.replace(u,"\n")).match(/^[\t ]*/)[0],r={text:"",type:""},i=new d,_=new c(this._options,n),p=new s(t,this._options).tokenize();this._tag_stack=new h(_);for(var l=null,f=p.next();f.type!==a.EOF;)f.type===a.TAG_OPEN||f.type===a.COMMENT?i=l=this._handle_tag_open(_,f,i,r):f.type===a.ATTRIBUTE||f.type===a.EQUALS||f.type===a.VALUE||f.type===a.TEXT&&!i.tag_complete?l=this._handle_inside_tag(_,f,i,p):f.type===a.TAG_CLOSE?l=this._handle_tag_close(_,f,i):f.type===a.TEXT?l=this._handle_text(_,f,i):_.add_raw_token(f),r=l,f=p.next();return _._output.get_code(e)},l.prototype._handle_tag_close=function(t,e,n){var r={text:e.text,type:e.type};return t.alignment_size=0,n.tag_complete=!0,t.set_space_before_token(e.newlines||""!==e.whitespace_before,!0),n.is_unformatted?t.add_raw_token(e):("<"===n.tag_start_char&&(t.set_space_before_token("/"===e.text[0],!0),this._is_wrap_attributes_force_expand_multiline&&n.has_wrapped_attrs&&t.print_newline(!1)),t.print_token(e)),!n.indent_content||n.is_unformatted||n.is_content_unformatted||(t.indent(),n.indent_content=!1),n.is_inline_element||n.is_unformatted||n.is_content_unformatted||t.set_wrap_point(),r},l.prototype._handle_inside_tag=function(t,e,n,r){var i=n.has_wrapped_attrs,s={text:e.text,type:e.type};if(t.set_space_before_token(e.newlines||""!==e.whitespace_before,!0),n.is_unformatted)t.add_raw_token(e);else if("{"===n.tag_start_char&&e.type===a.TEXT)t.print_preserved_newlines(e)?(e.newlines=0,t.add_raw_token(e)):t.print_token(e);else{if(e.type===a.ATTRIBUTE?(t.set_space_before_token(!0),n.attr_count+=1):(e.type===a.EQUALS||e.type===a.VALUE&&e.previous.type===a.EQUALS)&&t.set_space_before_token(!1),e.type===a.ATTRIBUTE&&"<"===n.tag_start_char&&((this._is_wrap_attributes_preserve||this._is_wrap_attributes_preserve_aligned)&&(t.traverse_whitespace(e),i=i||0!==e.newlines),this._is_wrap_attributes_force)){var o=n.attr_count>1;if(this._is_wrap_attributes_force_expand_multiline&&1===n.attr_count){var u,c=!0,_=0;do{if((u=r.peek(_)).type===a.ATTRIBUTE){c=!1;break}_+=1}while(_<4&&u.type!==a.EOF&&u.type!==a.TAG_CLOSE);o=!c}o&&(t.print_newline(!1),i=!0)}t.print_token(e),i=i||t.previous_token_wrapped(),n.has_wrapped_attrs=i}return s},l.prototype._handle_text=function(t,e,n){var r={text:e.text,type:"TK_CONTENT"};return n.custom_beautifier_name?this._print_custom_beatifier_text(t,e,n):n.is_unformatted||n.is_content_unformatted?t.add_raw_token(e):(t.traverse_whitespace(e),t.print_token(e)),r},l.prototype._print_custom_beatifier_text=function(t,e,n){var r=this;if(""!==e.text){var i,s=e.text,a=1,o="",u="";"javascript"===n.custom_beautifier_name&&"function"==typeof this._js_beautify?i=this._js_beautify:"css"===n.custom_beautifier_name&&"function"==typeof this._css_beautify?i=this._css_beautify:"html"===n.custom_beautifier_name&&(i=function(t,e){return new l(t,e,r._js_beautify,r._css_beautify).beautify()}),"keep"===this._options.indent_scripts?a=0:"separate"===this._options.indent_scripts&&(a=-t.indent_level);var c=t.get_full_indent(a);if(s=s.replace(/\n[ \t]*$/,""),"html"!==n.custom_beautifier_name&&"<"===s[0]&&s.match(/^(<!--|<!\[CDATA\[)/)){var _=/^(<!--[^\n]*|<!\[CDATA\[)(\n?)([ \t\n]*)([\s\S]*)(-->|]]>)$/.exec(s);if(!_)return void t.add_raw_token(e);o=c+_[1]+"\n",s=_[4],_[5]&&(u=c+_[5]),s=s.replace(/\n[ \t]*$/,""),(_[2]||-1!==_[3].indexOf("\n"))&&(_=_[3].match(/[ \t]+$/))&&(e.whitespace_before=_[0])}if(s)if(i){var p=function(){this.eol="\n"};p.prototype=this._options.raw_options,s=i(c+s,new p)}else{var h=e.whitespace_before;h&&(s=s.replace(new RegExp("\n("+h+")?","g"),"\n")),s=c+s.replace(/\n/g,"\n"+c)}o&&(s=s?o+s+"\n"+u:o+u),t.print_newline(!1),s&&(e.text=s,e.whitespace_before="",e.newlines=0,t.add_raw_token(e),t.print_newline(!0))}},l.prototype._handle_tag_open=function(t,e,n,r){var i=this._get_tag_open_token(e);return!n.is_unformatted&&!n.is_content_unformatted||n.is_empty_element||e.type!==a.TAG_OPEN||0!==e.text.indexOf("</")?(t.traverse_whitespace(e),this._set_tag_position(t,e,i,n,r),i.is_inline_element||t.set_wrap_point(),t.print_token(e)):(t.add_raw_token(e),i.start_tag_token=this._tag_stack.try_pop(i.tag_name)),(this._is_wrap_attributes_force_aligned||this._is_wrap_attributes_aligned_multiple||this._is_wrap_attributes_preserve_aligned)&&(i.alignment_size=e.text.length+1),i.tag_complete||i.is_unformatted||(t.alignment_size=i.alignment_size),i};var d=function(t,e){var n;this.parent=t||null,this.text="",this.type="TK_TAG_OPEN",this.tag_name="",this.is_inline_element=!1,this.is_unformatted=!1,this.is_content_unformatted=!1,this.is_empty_element=!1,this.is_start_tag=!1,this.is_end_tag=!1,this.indent_content=!1,this.multiline_content=!1,this.custom_beautifier_name=null,this.start_tag_token=null,this.attr_count=0,this.has_wrapped_attrs=!1,this.alignment_size=0,this.tag_complete=!1,this.tag_start_char="",this.tag_check="",e?(this.tag_start_char=e.text[0],this.text=e.text,"<"===this.tag_start_char?(n=e.text.match(/^<([^\s>]*)/),this.tag_check=n?n[1]:""):(n=e.text.match(/^{{(?:[\^]|#\*?)?([^\s}]+)/),this.tag_check=n?n[1]:"","{{#>"===e.text&&">"===this.tag_check&&null!==e.next&&(this.tag_check=e.next.text)),this.tag_check=this.tag_check.toLowerCase(),e.type===a.COMMENT&&(this.tag_complete=!0),this.is_start_tag="/"!==this.tag_check.charAt(0),this.tag_name=this.is_start_tag?this.tag_check:this.tag_check.substr(1),this.is_end_tag=!this.is_start_tag||e.closed&&"/>"===e.closed.text,this.is_end_tag=this.is_end_tag||"{"===this.tag_start_char&&(this.text.length<3||/[^#\^]/.test(this.text.charAt(2)))):this.tag_complete=!0};l.prototype._get_tag_open_token=function(t){var e=new d(this._tag_stack.get_parser_token(),t);return e.alignment_size=this._options.wrap_attributes_indent_size,e.is_end_tag=e.is_end_tag||_(e.tag_check,this._options.void_elements),e.is_empty_element=e.tag_complete||e.is_start_tag&&e.is_end_tag,e.is_unformatted=!e.tag_complete&&_(e.tag_check,this._options.unformatted),e.is_content_unformatted=!e.is_empty_element&&_(e.tag_check,this._options.content_unformatted),e.is_inline_element=_(e.tag_name,this._options.inline)||"{"===e.tag_start_char,e},l.prototype._set_tag_position=function(t,e,n,r,i){if(n.is_empty_element||(n.is_end_tag?n.start_tag_token=this._tag_stack.try_pop(n.tag_name):(this._do_optional_end_element(n)&&(n.is_inline_element||t.print_newline(!1)),this._tag_stack.record_tag(n),"script"!==n.tag_name&&"style"!==n.tag_name||n.is_unformatted||n.is_content_unformatted||(n.custom_beautifier_name=function(t,e){var n=null,r=null;return e.closed?("script"===t?n="text/javascript":"style"===t&&(n="text/css"),(n=function(t){for(var e=null,n=t.next;n.type!==a.EOF&&t.closed!==n;){if(n.type===a.ATTRIBUTE&&"type"===n.text){n.next&&n.next.type===a.EQUALS&&n.next.next&&n.next.next.type===a.VALUE&&(e=n.next.next.text);break}n=n.next}return e}(e)||n).search("text/css")>-1?r="css":n.search(/module|((text|application|dojo)\/(x-)?(javascript|ecmascript|jscript|livescript|(ld\+)?json|method|aspect))/)>-1?r="javascript":n.search(/(text|application|dojo)\/(x-)?(html)/)>-1?r="html":n.search(/test\/null/)>-1&&(r="null"),r):null}(n.tag_check,e)))),_(n.tag_check,this._options.extra_liners)&&(t.print_newline(!1),t._output.just_added_blankline()||t.print_newline(!0)),n.is_empty_element)"{"===n.tag_start_char&&"else"===n.tag_check&&(this._tag_stack.indent_to_tag(["if","unless","each"]),n.indent_content=!0,t.current_line_has_match(/{{#if/)||t.print_newline(!1)),"!--"===n.tag_name&&i.type===a.TAG_CLOSE&&r.is_end_tag&&-1===n.text.indexOf("\n")||(n.is_inline_element||n.is_unformatted||t.print_newline(!1),this._calcluate_parent_multiline(t,n));else if(n.is_end_tag){var s=!1;s=(s=n.start_tag_token&&n.start_tag_token.multiline_content)||!n.is_inline_element&&!(r.is_inline_element||r.is_unformatted)&&!(i.type===a.TAG_CLOSE&&n.start_tag_token===r)&&"TK_CONTENT"!==i.type,(n.is_content_unformatted||n.is_unformatted)&&(s=!1),s&&t.print_newline(!1)}else n.indent_content=!n.custom_beautifier_name,"<"===n.tag_start_char&&("html"===n.tag_name?n.indent_content=this._options.indent_inner_html:"head"===n.tag_name?n.indent_content=this._options.indent_head_inner_html:"body"===n.tag_name&&(n.indent_content=this._options.indent_body_inner_html)),n.is_inline_element||n.is_unformatted||"TK_CONTENT"===i.type&&!n.is_content_unformatted||t.print_newline(!1),this._calcluate_parent_multiline(t,n)},l.prototype._calcluate_parent_multiline=function(t,e){!e.parent||!t._output.just_added_newline()||(e.is_inline_element||e.is_unformatted)&&e.parent.is_inline_element||(e.parent.multiline_content=!0)};var f=["address","article","aside","blockquote","details","div","dl","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","main","nav","ol","p","pre","section","table","ul"],m=["a","audio","del","ins","map","noscript","video"];l.prototype._do_optional_end_element=function(t){var e=null;if(!t.is_empty_element&&t.is_start_tag&&t.parent){if("body"===t.tag_name)e=e||this._tag_stack.try_pop("head");else if("li"===t.tag_name)e=e||this._tag_stack.try_pop("li",["ol","ul"]);else if("dd"===t.tag_name||"dt"===t.tag_name)e=(e=e||this._tag_stack.try_pop("dt",["dl"]))||this._tag_stack.try_pop("dd",["dl"]);else if("p"===t.parent.tag_name&&-1!==f.indexOf(t.tag_name)){var n=t.parent.parent;n&&-1!==m.indexOf(n.tag_name)||(e=e||this._tag_stack.try_pop("p"))}else"rp"===t.tag_name||"rt"===t.tag_name?e=(e=e||this._tag_stack.try_pop("rt",["ruby","rtc"]))||this._tag_stack.try_pop("rp",["ruby","rtc"]):"optgroup"===t.tag_name?e=e||this._tag_stack.try_pop("optgroup",["select"]):"option"===t.tag_name?e=e||this._tag_stack.try_pop("option",["select","datalist","optgroup"]):"colgroup"===t.tag_name?e=e||this._tag_stack.try_pop("caption",["table"]):"thead"===t.tag_name?e=(e=e||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]):"tbody"===t.tag_name||"tfoot"===t.tag_name?e=(e=(e=(e=e||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]))||this._tag_stack.try_pop("thead",["table"]))||this._tag_stack.try_pop("tbody",["table"]):"tr"===t.tag_name?e=(e=(e=e||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]))||this._tag_stack.try_pop("tr",["table","thead","tbody","tfoot"]):"th"!==t.tag_name&&"td"!==t.tag_name||(e=(e=e||this._tag_stack.try_pop("td",["table","thead","tbody","tfoot","tr"]))||this._tag_stack.try_pop("th",["table","thead","tbody","tfoot","tr"]));return t.parent=this._tag_stack.get_parser_token(),e}},t.exports.Beautifier=l},function(t,e,n){"use strict";var r=n(6).Options;function i(t){r.call(this,t,"html"),1===this.templating.length&&"auto"===this.templating[0]&&(this.templating=["django","erb","handlebars","php"]),this.indent_inner_html=this._get_boolean("indent_inner_html"),this.indent_body_inner_html=this._get_boolean("indent_body_inner_html",!0),this.indent_head_inner_html=this._get_boolean("indent_head_inner_html",!0),this.indent_handlebars=this._get_boolean("indent_handlebars",!0),this.wrap_attributes=this._get_selection("wrap_attributes",["auto","force","force-aligned","force-expand-multiline","aligned-multiple","preserve","preserve-aligned"]),this.wrap_attributes_indent_size=this._get_number("wrap_attributes_indent_size",this.indent_size),this.extra_liners=this._get_array("extra_liners",["head","body","/html"]),this.inline=this._get_array("inline",["a","abbr","area","audio","b","bdi","bdo","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","meter","noscript","object","output","progress","q","ruby","s","samp","select","small","span","strong","sub","sup","svg","template","textarea","time","u","var","video","wbr","text","acronym","big","strike","tt"]),this.void_elements=this._get_array("void_elements",["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","!doctype","?xml","basefont","isindex"]),this.unformatted=this._get_array("unformatted",[]),this.content_unformatted=this._get_array("content_unformatted",["pre","textarea"]),this.unformatted_content_delimiter=this._get_characters("unformatted_content_delimiter"),this.indent_scripts=this._get_selection("indent_scripts",["normal","keep","separate"])}i.prototype=new r,t.exports.Options=i},function(t,e,n){"use strict";var r=n(9).Tokenizer,i=n(9).TOKEN,s=n(13).Directives,a=n(14).TemplatablePattern,o=n(12).Pattern,u={TAG_OPEN:"TK_TAG_OPEN",TAG_CLOSE:"TK_TAG_CLOSE",ATTRIBUTE:"TK_ATTRIBUTE",EQUALS:"TK_EQUALS",VALUE:"TK_VALUE",COMMENT:"TK_COMMENT",TEXT:"TK_TEXT",UNKNOWN:"TK_UNKNOWN",START:i.START,RAW:i.RAW,EOF:i.EOF},c=new s(/<\!--/,/-->/),_=function(t,e){r.call(this,t,e),this._current_tag_name="";var n=new a(this._input).read_options(this._options),i=new o(this._input);if(this.__patterns={word:n.until(/[\n\r\t <]/),single_quote:n.until_after(/'/),double_quote:n.until_after(/"/),attribute:n.until(/[\n\r\t =>]|\/>/),element_name:n.until(/[\n\r\t >\/]/),handlebars_comment:i.starting_with(/{{!--/).until_after(/--}}/),handlebars:i.starting_with(/{{/).until_after(/}}/),handlebars_open:i.until(/[\n\r\t }]/),handlebars_raw_close:i.until(/}}/),comment:i.starting_with(/<!--/).until_after(/-->/),cdata:i.starting_with(/<!\[CDATA\[/).until_after(/]]>/),conditional_comment:i.starting_with(/<!\[/).until_after(/]>/),processing:i.starting_with(/<\?/).until_after(/\?>/)},this._options.indent_handlebars&&(this.__patterns.word=this.__patterns.word.exclude("handlebars")),this._unformatted_content_delimiter=null,this._options.unformatted_content_delimiter){var s=this._input.get_literal_regexp(this._options.unformatted_content_delimiter);this.__patterns.unformatted_content_delimiter=i.matching(s).until_after(s)}};(_.prototype=new r)._is_comment=function(t){return!1},_.prototype._is_opening=function(t){return t.type===u.TAG_OPEN},_.prototype._is_closing=function(t,e){return t.type===u.TAG_CLOSE&&e&&((">"===t.text||"/>"===t.text)&&"<"===e.text[0]||"}}"===t.text&&"{"===e.text[0]&&"{"===e.text[1])},_.prototype._reset=function(){this._current_tag_name=""},_.prototype._get_next_token=function(t,e){var n=null;this._readWhitespace();var r=this._input.peek();return null===r?this._create_token(u.EOF,""):n=(n=(n=(n=(n=(n=(n=(n=(n=n||this._read_open_handlebars(r,e))||this._read_attribute(r,t,e))||this._read_close(r,e))||this._read_raw_content(r,t,e))||this._read_content_word(r))||this._read_comment_or_cdata(r))||this._read_processing(r))||this._read_open(r,e))||this._create_token(u.UNKNOWN,this._input.next())},_.prototype._read_comment_or_cdata=function(t){var e=null,n=null,r=null;return"<"===t&&("!"===this._input.peek(1)&&((n=this.__patterns.comment.read())?(r=c.get_directives(n))&&"start"===r.ignore&&(n+=c.readIgnored(this._input)):n=this.__patterns.cdata.read()),n&&((e=this._create_token(u.COMMENT,n)).directives=r)),e},_.prototype._read_processing=function(t){var e=null,n=null;if("<"===t){var r=this._input.peek(1);"!"!==r&&"?"!==r||(n=(n=this.__patterns.conditional_comment.read())||this.__patterns.processing.read()),n&&((e=this._create_token(u.COMMENT,n)).directives=null)}return e},_.prototype._read_open=function(t,e){var n=null,r=null;return e||"<"===t&&(n=this._input.next(),"/"===this._input.peek()&&(n+=this._input.next()),n+=this.__patterns.element_name.read(),r=this._create_token(u.TAG_OPEN,n)),r},_.prototype._read_open_handlebars=function(t,e){var n=null,r=null;return e||this._options.indent_handlebars&&"{"===t&&"{"===this._input.peek(1)&&("!"===this._input.peek(2)?(n=(n=this.__patterns.handlebars_comment.read())||this.__patterns.handlebars.read(),r=this._create_token(u.COMMENT,n)):(n=this.__patterns.handlebars_open.read(),r=this._create_token(u.TAG_OPEN,n))),r},_.prototype._read_close=function(t,e){var n=null,r=null;return e&&("<"===e.text[0]&&(">"===t||"/"===t&&">"===this._input.peek(1))?(n=this._input.next(),"/"===t&&(n+=this._input.next()),r=this._create_token(u.TAG_CLOSE,n)):"{"===e.text[0]&&"}"===t&&"}"===this._input.peek(1)&&(this._input.next(),this._input.next(),r=this._create_token(u.TAG_CLOSE,"}}"))),r},_.prototype._read_attribute=function(t,e,n){var r=null,i="";if(n&&"<"===n.text[0])if("="===t)r=this._create_token(u.EQUALS,this._input.next());else if('"'===t||"'"===t){var s=this._input.next();s+='"'===t?this.__patterns.double_quote.read():this.__patterns.single_quote.read(),r=this._create_token(u.VALUE,s)}else(i=this.__patterns.attribute.read())&&(r=e.type===u.EQUALS?this._create_token(u.VALUE,i):this._create_token(u.ATTRIBUTE,i));return r},_.prototype._is_content_unformatted=function(t){return-1===this._options.void_elements.indexOf(t)&&(-1!==this._options.content_unformatted.indexOf(t)||-1!==this._options.unformatted.indexOf(t))},_.prototype._read_raw_content=function(t,e,n){var r="";if(n&&"{"===n.text[0])r=this.__patterns.handlebars_raw_close.read();else if(e.type===u.TAG_CLOSE&&"<"===e.opened.text[0]&&"/"!==e.text[0]){var i=e.opened.text.substr(1).toLowerCase();if("script"===i||"style"===i){var s=this._read_comment_or_cdata(t);if(s)return s.type=u.TEXT,s;r=this._input.readUntil(new RegExp("</"+i+"[\\n\\r\\t ]*?>","ig"))}else this._is_content_unformatted(i)&&(r=this._input.readUntil(new RegExp("</"+i+"[\\n\\r\\t ]*?>","ig")))}return r?this._create_token(u.TEXT,r):null},_.prototype._read_content_word=function(t){var e="";if(this._options.unformatted_content_delimiter&&t===this._options.unformatted_content_delimiter[0]&&(e=this.__patterns.unformatted_content_delimiter.read()),e||(e=this.__patterns.word.read()),e)return this._create_token(u.TEXT,e)},t.exports.Tokenizer=_,t.exports.TOKEN=u}]),r=[n,n(937),n(40)],void 0===(i=function(t){var e=n(937),r=n(40);return{html_beautify:function(t,n){return s(t,n,e.js_beautify,r.css_beautify)}}}.apply(e,r))||(t.exports=i)},937:(t,e)=>{var n,r;r=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";var r=n(1).Beautifier,i=n(5).Options;t.exports=function(t,e){return new r(t,e).beautify()},t.exports.defaultOptions=function(){return new i}},function(t,e,n){"use strict";var r=n(2).Output,i=n(3).Token,s=n(4),a=n(5).Options,o=n(7).Tokenizer,u=n(7).line_starters,c=n(7).positionable_operators,_=n(7).TOKEN;function p(t,e){return-1!==e.indexOf(t)}function h(t,e){return t&&t.type===_.RESERVED&&t.text===e}function l(t,e){return t&&t.type===_.RESERVED&&p(t.text,e)}var d=["case","return","do","if","throw","else","await","break","continue","async"],f=function(t){for(var e={},n=0;n<t.length;n++)e[t[n].replace(/-/g,"_")]=t[n];return e}(["before-newline","after-newline","preserve-newline"]),m=[f.before_newline,f.preserve_newline],g="BlockStatement",v="Statement",y="ObjectLiteral",b="ArrayLiteral",w="ForInitializer",k="Conditional",x="Expression";function T(t,e){e.multiline_frame||e.mode===w||e.mode===k||t.remove_indent(e.start_line_index)}function S(t){return t===b}function C(t){return p(t,[x,w,k])}function M(t,e){e=e||{},this._source_text=t||"",this._output=null,this._tokens=null,this._last_last_text=null,this._flags=null,this._previous_flags=null,this._flag_store=null,this._options=new a(e)}M.prototype.create_flags=function(t,e){var n=0;return t&&(n=t.indentation_level,!this._output.just_added_newline()&&t.line_indent_level>n&&(n=t.line_indent_level)),{mode:e,parent:t,last_token:t?t.last_token:new i(_.START_BLOCK,""),last_word:t?t.last_word:"",declaration_statement:!1,declaration_assignment:!1,multiline_frame:!1,inline_frame:!1,if_block:!1,else_block:!1,do_block:!1,do_while:!1,import_block:!1,in_case_statement:!1,in_case:!1,case_body:!1,indentation_level:n,alignment:0,line_indent_level:t?t.line_indent_level:n,start_line_index:this._output.get_line_number(),ternary_depth:0}},M.prototype._reset=function(t){var e=t.match(/^[\t ]*/)[0];this._last_last_text="",this._output=new r(this._options,e),this._output.raw=this._options.test_output_raw,this._flag_store=[],this.set_mode(g);var n=new o(t,this._options);return this._tokens=n.tokenize(),t},M.prototype.beautify=function(){if(this._options.disabled)return this._source_text;var t=this._reset(this._source_text),e=this._options.eol;"auto"===this._options.eol&&(e="\n",t&&s.lineBreak.test(t||"")&&(e=t.match(s.lineBreak)[0]));for(var n=this._tokens.next();n;)this.handle_token(n),this._last_last_text=this._flags.last_token.text,this._flags.last_token=n,n=this._tokens.next();return this._output.get_code(e)},M.prototype.handle_token=function(t,e){t.type===_.START_EXPR?this.handle_start_expr(t):t.type===_.END_EXPR?this.handle_end_expr(t):t.type===_.START_BLOCK?this.handle_start_block(t):t.type===_.END_BLOCK?this.handle_end_block(t):t.type===_.WORD||t.type===_.RESERVED?this.handle_word(t):t.type===_.SEMICOLON?this.handle_semicolon(t):t.type===_.STRING?this.handle_string(t):t.type===_.EQUALS?this.handle_equals(t):t.type===_.OPERATOR?this.handle_operator(t):t.type===_.COMMA?this.handle_comma(t):t.type===_.BLOCK_COMMENT?this.handle_block_comment(t,e):t.type===_.COMMENT?this.handle_comment(t,e):t.type===_.DOT?this.handle_dot(t):t.type===_.EOF?this.handle_eof(t):(t.type,_.UNKNOWN,this.handle_unknown(t,e))},M.prototype.handle_whitespace_and_comments=function(t,e){var n=t.newlines,r=this._options.keep_array_indentation&&S(this._flags.mode);if(t.comments_before)for(var i=t.comments_before.next();i;)this.handle_whitespace_and_comments(i,e),this.handle_token(i,e),i=t.comments_before.next();if(r)for(var s=0;s<n;s+=1)this.print_newline(s>0,e);else if(this._options.max_preserve_newlines&&n>this._options.max_preserve_newlines&&(n=this._options.max_preserve_newlines),this._options.preserve_newlines&&n>1){this.print_newline(!1,e);for(var a=1;a<n;a+=1)this.print_newline(!0,e)}};var E=["async","break","continue","return","throw","yield"];M.prototype.allow_wrap_or_preserved_newline=function(t,e){if(e=void 0!==e&&e,!this._output.just_added_newline()){var n=this._options.preserve_newlines&&t.newlines||e;if(p(this._flags.last_token.text,c)||p(t.text,c)){var r=p(this._flags.last_token.text,c)&&p(this._options.operator_position,m)||p(t.text,c);n=n&&r}if(n)this.print_newline(!1,!0);else if(this._options.wrap_line_length){if(l(this._flags.last_token,E))return;this._output.set_wrap_point()}}},M.prototype.print_newline=function(t,e){if(!e&&";"!==this._flags.last_token.text&&","!==this._flags.last_token.text&&"="!==this._flags.last_token.text&&(this._flags.last_token.type!==_.OPERATOR||"--"===this._flags.last_token.text||"++"===this._flags.last_token.text))for(var n=this._tokens.peek();!(this._flags.mode!==v||this._flags.if_block&&h(n,"else")||this._flags.do_block);)this.restore_mode();this._output.add_new_line(t)&&(this._flags.multiline_frame=!0)},M.prototype.print_token_line_indentation=function(t){this._output.just_added_newline()&&(this._options.keep_array_indentation&&t.newlines&&("["===t.text||S(this._flags.mode))?(this._output.current_line.set_indent(-1),this._output.current_line.push(t.whitespace_before),this._output.space_before_token=!1):this._output.set_indent(this._flags.indentation_level,this._flags.alignment)&&(this._flags.line_indent_level=this._flags.indentation_level))},M.prototype.print_token=function(t){if(this._output.raw)this._output.add_raw_token(t);else{if(this._options.comma_first&&t.previous&&t.previous.type===_.COMMA&&this._output.just_added_newline()&&","===this._output.previous_line.last()){var e=this._output.previous_line.pop();this._output.previous_line.is_empty()&&(this._output.previous_line.push(e),this._output.trim(!0),this._output.current_line.pop(),this._output.trim()),this.print_token_line_indentation(t),this._output.add_token(","),this._output.space_before_token=!0}this.print_token_line_indentation(t),this._output.non_breaking_space=!0,this._output.add_token(t.text),this._output.previous_token_wrapped&&(this._flags.multiline_frame=!0)}},M.prototype.indent=function(){this._flags.indentation_level+=1,this._output.set_indent(this._flags.indentation_level,this._flags.alignment)},M.prototype.deindent=function(){this._flags.indentation_level>0&&(!this._flags.parent||this._flags.indentation_level>this._flags.parent.indentation_level)&&(this._flags.indentation_level-=1,this._output.set_indent(this._flags.indentation_level,this._flags.alignment))},M.prototype.set_mode=function(t){this._flags?(this._flag_store.push(this._flags),this._previous_flags=this._flags):this._previous_flags=this.create_flags(null,t),this._flags=this.create_flags(this._previous_flags,t),this._output.set_indent(this._flags.indentation_level,this._flags.alignment)},M.prototype.restore_mode=function(){this._flag_store.length>0&&(this._previous_flags=this._flags,this._flags=this._flag_store.pop(),this._previous_flags.mode===v&&T(this._output,this._previous_flags),this._output.set_indent(this._flags.indentation_level,this._flags.alignment))},M.prototype.start_of_object_property=function(){return this._flags.parent.mode===y&&this._flags.mode===v&&(":"===this._flags.last_token.text&&0===this._flags.ternary_depth||l(this._flags.last_token,["get","set"]))},M.prototype.start_of_statement=function(t){var e=!1;return!!(e=(e=(e=(e=(e=(e=(e=e||l(this._flags.last_token,["var","let","const"])&&t.type===_.WORD)||h(this._flags.last_token,"do"))||!(this._flags.parent.mode===y&&this._flags.mode===v)&&l(this._flags.last_token,E)&&!t.newlines)||h(this._flags.last_token,"else")&&!(h(t,"if")&&!t.comments_before))||this._flags.last_token.type===_.END_EXPR&&(this._previous_flags.mode===w||this._previous_flags.mode===k))||this._flags.last_token.type===_.WORD&&this._flags.mode===g&&!this._flags.in_case&&!("--"===t.text||"++"===t.text)&&"function"!==this._last_last_text&&t.type!==_.WORD&&t.type!==_.RESERVED)||this._flags.mode===y&&(":"===this._flags.last_token.text&&0===this._flags.ternary_depth||l(this._flags.last_token,["get","set"])))&&(this.set_mode(v),this.indent(),this.handle_whitespace_and_comments(t,!0),this.start_of_object_property()||this.allow_wrap_or_preserved_newline(t,l(t,["do","for","if","while"])),!0)},M.prototype.handle_start_expr=function(t){this.start_of_statement(t)||this.handle_whitespace_and_comments(t);var e=x;if("["===t.text){if(this._flags.last_token.type===_.WORD||")"===this._flags.last_token.text)return l(this._flags.last_token,u)&&(this._output.space_before_token=!0),this.print_token(t),this.set_mode(e),this.indent(),void(this._options.space_in_paren&&(this._output.space_before_token=!0));e=b,S(this._flags.mode)&&("["!==this._flags.last_token.text&&(","!==this._flags.last_token.text||"]"!==this._last_last_text&&"}"!==this._last_last_text)||this._options.keep_array_indentation||this.print_newline()),p(this._flags.last_token.type,[_.START_EXPR,_.END_EXPR,_.WORD,_.OPERATOR])||(this._output.space_before_token=!0)}else{if(this._flags.last_token.type===_.RESERVED)"for"===this._flags.last_token.text?(this._output.space_before_token=this._options.space_before_conditional,e=w):p(this._flags.last_token.text,["if","while"])?(this._output.space_before_token=this._options.space_before_conditional,e=k):p(this._flags.last_word,["await","async"])?this._output.space_before_token=!0:"import"===this._flags.last_token.text&&""===t.whitespace_before?this._output.space_before_token=!1:(p(this._flags.last_token.text,u)||"catch"===this._flags.last_token.text)&&(this._output.space_before_token=!0);else if(this._flags.last_token.type===_.EQUALS||this._flags.last_token.type===_.OPERATOR)this.start_of_object_property()||this.allow_wrap_or_preserved_newline(t);else if(this._flags.last_token.type===_.WORD){this._output.space_before_token=!1;var n=this._tokens.peek(-3);if(this._options.space_after_named_function&&n){var r=this._tokens.peek(-4);l(n,["async","function"])||"*"===n.text&&l(r,["async","function"])?this._output.space_before_token=!0:this._flags.mode===y&&("{"!==n.text&&","!==n.text&&("*"!==n.text||"{"!==r.text&&","!==r.text)||(this._output.space_before_token=!0))}}else this.allow_wrap_or_preserved_newline(t);(this._flags.last_token.type===_.RESERVED&&("function"===this._flags.last_word||"typeof"===this._flags.last_word)||"*"===this._flags.last_token.text&&(p(this._last_last_text,["function","yield"])||this._flags.mode===y&&p(this._last_last_text,["{",","])))&&(this._output.space_before_token=this._options.space_after_anon_function)}";"===this._flags.last_token.text||this._flags.last_token.type===_.START_BLOCK?this.print_newline():this._flags.last_token.type!==_.END_EXPR&&this._flags.last_token.type!==_.START_EXPR&&this._flags.last_token.type!==_.END_BLOCK&&"."!==this._flags.last_token.text&&this._flags.last_token.type!==_.COMMA||this.allow_wrap_or_preserved_newline(t,t.newlines),this.print_token(t),this.set_mode(e),this._options.space_in_paren&&(this._output.space_before_token=!0),this.indent()},M.prototype.handle_end_expr=function(t){for(;this._flags.mode===v;)this.restore_mode();this.handle_whitespace_and_comments(t),this._flags.multiline_frame&&this.allow_wrap_or_preserved_newline(t,"]"===t.text&&S(this._flags.mode)&&!this._options.keep_array_indentation),this._options.space_in_paren&&(this._flags.last_token.type!==_.START_EXPR||this._options.space_in_empty_paren?this._output.space_before_token=!0:(this._output.trim(),this._output.space_before_token=!1)),this.deindent(),this.print_token(t),this.restore_mode(),T(this._output,this._previous_flags),this._flags.do_while&&this._previous_flags.mode===k&&(this._previous_flags.mode=x,this._flags.do_block=!1,this._flags.do_while=!1)},M.prototype.handle_start_block=function(t){this.handle_whitespace_and_comments(t);var e=this._tokens.peek(),n=this._tokens.peek(1);"switch"===this._flags.last_word&&this._flags.last_token.type===_.END_EXPR?(this.set_mode(g),this._flags.in_case_statement=!0):this._flags.case_body?this.set_mode(g):n&&(p(n.text,[":",","])&&p(e.type,[_.STRING,_.WORD,_.RESERVED])||p(e.text,["get","set","..."])&&p(n.type,[_.WORD,_.RESERVED]))?p(this._last_last_text,["class","interface"])?this.set_mode(g):this.set_mode(y):this._flags.last_token.type===_.OPERATOR&&"=>"===this._flags.last_token.text?this.set_mode(g):p(this._flags.last_token.type,[_.EQUALS,_.START_EXPR,_.COMMA,_.OPERATOR])||l(this._flags.last_token,["return","throw","import","default"])?this.set_mode(y):this.set_mode(g);var r=!e.comments_before&&"}"===e.text,i=r&&"function"===this._flags.last_word&&this._flags.last_token.type===_.END_EXPR;if(this._options.brace_preserve_inline){var s=0,a=null;this._flags.inline_frame=!0;do{if(s+=1,(a=this._tokens.peek(s-1)).newlines){this._flags.inline_frame=!1;break}}while(a.type!==_.EOF&&(a.type!==_.END_BLOCK||a.opened!==t))}("expand"===this._options.brace_style||"none"===this._options.brace_style&&t.newlines)&&!this._flags.inline_frame?this._flags.last_token.type!==_.OPERATOR&&(i||this._flags.last_token.type===_.EQUALS||l(this._flags.last_token,d)&&"else"!==this._flags.last_token.text)?this._output.space_before_token=!0:this.print_newline(!1,!0):(!S(this._previous_flags.mode)||this._flags.last_token.type!==_.START_EXPR&&this._flags.last_token.type!==_.COMMA||((this._flags.last_token.type===_.COMMA||this._options.space_in_paren)&&(this._output.space_before_token=!0),(this._flags.last_token.type===_.COMMA||this._flags.last_token.type===_.START_EXPR&&this._flags.inline_frame)&&(this.allow_wrap_or_preserved_newline(t),this._previous_flags.multiline_frame=this._previous_flags.multiline_frame||this._flags.multiline_frame,this._flags.multiline_frame=!1)),this._flags.last_token.type!==_.OPERATOR&&this._flags.last_token.type!==_.START_EXPR&&(this._flags.last_token.type!==_.START_BLOCK||this._flags.inline_frame?this._output.space_before_token=!0:this.print_newline())),this.print_token(t),this.indent(),r||this._options.brace_preserve_inline&&this._flags.inline_frame||this.print_newline()},M.prototype.handle_end_block=function(t){for(this.handle_whitespace_and_comments(t);this._flags.mode===v;)this.restore_mode();var e=this._flags.last_token.type===_.START_BLOCK;this._flags.inline_frame&&!e?this._output.space_before_token=!0:"expand"===this._options.brace_style?e||this.print_newline():e||(S(this._flags.mode)&&this._options.keep_array_indentation?(this._options.keep_array_indentation=!1,this.print_newline(),this._options.keep_array_indentation=!0):this.print_newline()),this.restore_mode(),this.print_token(t)},M.prototype.handle_word=function(t){if(t.type===_.RESERVED&&(p(t.text,["set","get"])&&this._flags.mode!==y||"import"===t.text&&"("===this._tokens.peek().text||p(t.text,["as","from"])&&!this._flags.import_block||this._flags.mode===y&&":"===this._tokens.peek().text)&&(t.type=_.WORD),this.start_of_statement(t)?l(this._flags.last_token,["var","let","const"])&&t.type===_.WORD&&(this._flags.declaration_statement=!0):!t.newlines||C(this._flags.mode)||this._flags.last_token.type===_.OPERATOR&&"--"!==this._flags.last_token.text&&"++"!==this._flags.last_token.text||this._flags.last_token.type===_.EQUALS||!this._options.preserve_newlines&&l(this._flags.last_token,["var","let","const","set","get"])?this.handle_whitespace_and_comments(t):(this.handle_whitespace_and_comments(t),this.print_newline()),this._flags.do_block&&!this._flags.do_while){if(h(t,"while"))return this._output.space_before_token=!0,this.print_token(t),this._output.space_before_token=!0,void(this._flags.do_while=!0);this.print_newline(),this._flags.do_block=!1}if(this._flags.if_block)if(!this._flags.else_block&&h(t,"else"))this._flags.else_block=!0;else{for(;this._flags.mode===v;)this.restore_mode();this._flags.if_block=!1,this._flags.else_block=!1}if(this._flags.in_case_statement&&l(t,["case","default"]))return this.print_newline(),this._flags.last_token.type!==_.END_BLOCK&&(this._flags.case_body||this._options.jslint_happy)&&this.deindent(),this._flags.case_body=!1,this.print_token(t),void(this._flags.in_case=!0);if(this._flags.last_token.type!==_.COMMA&&this._flags.last_token.type!==_.START_EXPR&&this._flags.last_token.type!==_.EQUALS&&this._flags.last_token.type!==_.OPERATOR||this.start_of_object_property()||this.allow_wrap_or_preserved_newline(t),h(t,"function"))return(p(this._flags.last_token.text,["}",";"])||this._output.just_added_newline()&&!p(this._flags.last_token.text,["(","[","{",":","=",","])&&this._flags.last_token.type!==_.OPERATOR)&&(this._output.just_added_blankline()||t.comments_before||(this.print_newline(),this.print_newline(!0))),this._flags.last_token.type===_.RESERVED||this._flags.last_token.type===_.WORD?l(this._flags.last_token,["get","set","new","export"])||l(this._flags.last_token,E)||h(this._flags.last_token,"default")&&"export"===this._last_last_text||"declare"===this._flags.last_token.text?this._output.space_before_token=!0:this.print_newline():this._flags.last_token.type===_.OPERATOR||"="===this._flags.last_token.text?this._output.space_before_token=!0:(this._flags.multiline_frame||!C(this._flags.mode)&&!S(this._flags.mode))&&this.print_newline(),this.print_token(t),void(this._flags.last_word=t.text);var e="NONE";this._flags.last_token.type===_.END_BLOCK?this._previous_flags.inline_frame?e="SPACE":l(t,["else","catch","finally","from"])?"expand"===this._options.brace_style||"end-expand"===this._options.brace_style||"none"===this._options.brace_style&&t.newlines?e="NEWLINE":(e="SPACE",this._output.space_before_token=!0):e="NEWLINE":this._flags.last_token.type===_.SEMICOLON&&this._flags.mode===g?e="NEWLINE":this._flags.last_token.type===_.SEMICOLON&&C(this._flags.mode)?e="SPACE":this._flags.last_token.type===_.STRING?e="NEWLINE":this._flags.last_token.type===_.RESERVED||this._flags.last_token.type===_.WORD||"*"===this._flags.last_token.text&&(p(this._last_last_text,["function","yield"])||this._flags.mode===y&&p(this._last_last_text,["{",","]))?e="SPACE":this._flags.last_token.type===_.START_BLOCK?e=this._flags.inline_frame?"SPACE":"NEWLINE":this._flags.last_token.type===_.END_EXPR&&(this._output.space_before_token=!0,e="NEWLINE"),l(t,u)&&")"!==this._flags.last_token.text&&(e=this._flags.inline_frame||"else"===this._flags.last_token.text||"export"===this._flags.last_token.text?"SPACE":"NEWLINE"),l(t,["else","catch","finally"])?(this._flags.last_token.type!==_.END_BLOCK||this._previous_flags.mode!==g||"expand"===this._options.brace_style||"end-expand"===this._options.brace_style||"none"===this._options.brace_style&&t.newlines)&&!this._flags.inline_frame?this.print_newline():(this._output.trim(!0),"}"!==this._output.current_line.last()&&this.print_newline(),this._output.space_before_token=!0):"NEWLINE"===e?l(this._flags.last_token,d)||"declare"===this._flags.last_token.text&&l(t,["var","let","const"])?this._output.space_before_token=!0:this._flags.last_token.type!==_.END_EXPR?this._flags.last_token.type===_.START_EXPR&&l(t,["var","let","const"])||":"===this._flags.last_token.text||(h(t,"if")&&h(t.previous,"else")?this._output.space_before_token=!0:this.print_newline()):l(t,u)&&")"!==this._flags.last_token.text&&this.print_newline():this._flags.multiline_frame&&S(this._flags.mode)&&","===this._flags.last_token.text&&"}"===this._last_last_text?this.print_newline():"SPACE"===e&&(this._output.space_before_token=!0),!t.previous||t.previous.type!==_.WORD&&t.previous.type!==_.RESERVED||(this._output.space_before_token=!0),this.print_token(t),this._flags.last_word=t.text,t.type===_.RESERVED&&("do"===t.text?this._flags.do_block=!0:"if"===t.text?this._flags.if_block=!0:"import"===t.text?this._flags.import_block=!0:this._flags.import_block&&h(t,"from")&&(this._flags.import_block=!1))},M.prototype.handle_semicolon=function(t){this.start_of_statement(t)?this._output.space_before_token=!1:this.handle_whitespace_and_comments(t);for(var e=this._tokens.peek();!(this._flags.mode!==v||this._flags.if_block&&h(e,"else")||this._flags.do_block);)this.restore_mode();this._flags.import_block&&(this._flags.import_block=!1),this.print_token(t)},M.prototype.handle_string=function(t){(!t.text.startsWith("`")||0!==t.newlines||""!==t.whitespace_before||")"!==t.previous.text&&this._flags.last_token.type!==_.WORD)&&(this.start_of_statement(t)?this._output.space_before_token=!0:(this.handle_whitespace_and_comments(t),this._flags.last_token.type===_.RESERVED||this._flags.last_token.type===_.WORD||this._flags.inline_frame?this._output.space_before_token=!0:this._flags.last_token.type===_.COMMA||this._flags.last_token.type===_.START_EXPR||this._flags.last_token.type===_.EQUALS||this._flags.last_token.type===_.OPERATOR?this.start_of_object_property()||this.allow_wrap_or_preserved_newline(t):!t.text.startsWith("`")||this._flags.last_token.type!==_.END_EXPR||"]"!==t.previous.text&&")"!==t.previous.text||0!==t.newlines?this.print_newline():this._output.space_before_token=!0)),this.print_token(t)},M.prototype.handle_equals=function(t){this.start_of_statement(t)||this.handle_whitespace_and_comments(t),this._flags.declaration_statement&&(this._flags.declaration_assignment=!0),this._output.space_before_token=!0,this.print_token(t),this._output.space_before_token=!0},M.prototype.handle_comma=function(t){this.handle_whitespace_and_comments(t,!0),this.print_token(t),this._output.space_before_token=!0,this._flags.declaration_statement?(C(this._flags.parent.mode)&&(this._flags.declaration_assignment=!1),this._flags.declaration_assignment?(this._flags.declaration_assignment=!1,this.print_newline(!1,!0)):this._options.comma_first&&this.allow_wrap_or_preserved_newline(t)):this._flags.mode===y||this._flags.mode===v&&this._flags.parent.mode===y?(this._flags.mode===v&&this.restore_mode(),this._flags.inline_frame||this.print_newline()):this._options.comma_first&&this.allow_wrap_or_preserved_newline(t)},M.prototype.handle_operator=function(t){var e="*"===t.text&&(l(this._flags.last_token,["function","yield"])||p(this._flags.last_token.type,[_.START_BLOCK,_.COMMA,_.END_BLOCK,_.SEMICOLON])),n=p(t.text,["-","+"])&&(p(this._flags.last_token.type,[_.START_BLOCK,_.START_EXPR,_.EQUALS,_.OPERATOR])||p(this._flags.last_token.text,u)||","===this._flags.last_token.text);if(this.start_of_statement(t));else{var r=!e;this.handle_whitespace_and_comments(t,r)}if(l(this._flags.last_token,d))return this._output.space_before_token=!0,void this.print_token(t);if("*"!==t.text||this._flags.last_token.type!==_.DOT)if("::"!==t.text){if(this._flags.last_token.type===_.OPERATOR&&p(this._options.operator_position,m)&&this.allow_wrap_or_preserved_newline(t),":"===t.text&&this._flags.in_case)return this.print_token(t),this._flags.in_case=!1,this._flags.case_body=!0,void(this._tokens.peek().type!==_.START_BLOCK?(this.indent(),this.print_newline()):this._output.space_before_token=!0);var i=!0,s=!0,a=!1;if(":"===t.text?0===this._flags.ternary_depth?i=!1:(this._flags.ternary_depth-=1,a=!0):"?"===t.text&&(this._flags.ternary_depth+=1),!n&&!e&&this._options.preserve_newlines&&p(t.text,c)){var o=":"===t.text,h=o&&a,y=o&&!a;switch(this._options.operator_position){case f.before_newline:return this._output.space_before_token=!y,this.print_token(t),o&&!h||this.allow_wrap_or_preserved_newline(t),void(this._output.space_before_token=!0);case f.after_newline:return this._output.space_before_token=!0,!o||h?this._tokens.peek().newlines?this.print_newline(!1,!0):this.allow_wrap_or_preserved_newline(t):this._output.space_before_token=!1,this.print_token(t),void(this._output.space_before_token=!0);case f.preserve_newline:return y||this.allow_wrap_or_preserved_newline(t),i=!(this._output.just_added_newline()||y),this._output.space_before_token=i,this.print_token(t),void(this._output.space_before_token=!0)}}if(e){this.allow_wrap_or_preserved_newline(t),i=!1;var b=this._tokens.peek();s=b&&p(b.type,[_.WORD,_.RESERVED])}else"..."===t.text?(this.allow_wrap_or_preserved_newline(t),i=this._flags.last_token.type===_.START_BLOCK,s=!1):(p(t.text,["--","++","!","~"])||n)&&(this._flags.last_token.type!==_.COMMA&&this._flags.last_token.type!==_.START_EXPR||this.allow_wrap_or_preserved_newline(t),i=!1,s=!1,!t.newlines||"--"!==t.text&&"++"!==t.text||this.print_newline(!1,!0),";"===this._flags.last_token.text&&C(this._flags.mode)&&(i=!0),this._flags.last_token.type===_.RESERVED?i=!0:this._flags.last_token.type===_.END_EXPR?i=!("]"===this._flags.last_token.text&&("--"===t.text||"++"===t.text)):this._flags.last_token.type===_.OPERATOR&&(i=p(t.text,["--","-","++","+"])&&p(this._flags.last_token.text,["--","-","++","+"]),p(t.text,["+","-"])&&p(this._flags.last_token.text,["--","++"])&&(s=!0)),(this._flags.mode!==g||this._flags.inline_frame)&&this._flags.mode!==v||"{"!==this._flags.last_token.text&&";"!==this._flags.last_token.text||this.print_newline());this._output.space_before_token=this._output.space_before_token||i,this.print_token(t),this._output.space_before_token=s}else this.print_token(t);else this.print_token(t)},M.prototype.handle_block_comment=function(t,e){return this._output.raw?(this._output.add_raw_token(t),void(t.directives&&"end"===t.directives.preserve&&(this._output.raw=this._options.test_output_raw))):t.directives?(this.print_newline(!1,e),this.print_token(t),"start"===t.directives.preserve&&(this._output.raw=!0),void this.print_newline(!1,!0)):s.newline.test(t.text)||t.newlines?void this.print_block_commment(t,e):(this._output.space_before_token=!0,this.print_token(t),void(this._output.space_before_token=!0))},M.prototype.print_block_commment=function(t,e){var n,r=function(t){for(var e=[],n=(t=t.replace(s.allLineBreaks,"\n")).indexOf("\n");-1!==n;)e.push(t.substring(0,n)),n=(t=t.substring(n+1)).indexOf("\n");return t.length&&e.push(t),e}(t.text),i=!1,a=!1,o=t.whitespace_before,u=o.length;if(this.print_newline(!1,e),this.print_token_line_indentation(t),this._output.add_token(r[0]),this.print_newline(!1,e),r.length>1){for(i=function(t,e){for(var n=0;n<t.length;n++)if("*"!==t[n].trim().charAt(0))return!1;return!0}(r=r.slice(1)),a=function(t,e){for(var n,r=0,i=t.length;r<i;r++)if((n=t[r])&&0!==n.indexOf(e))return!1;return!0}(r,o),i&&(this._flags.alignment=1),n=0;n<r.length;n++)i?(this.print_token_line_indentation(t),this._output.add_token(r[n].replace(/^\s+/g,""))):a&&r[n]?(this.print_token_line_indentation(t),this._output.add_token(r[n].substring(u))):(this._output.current_line.set_indent(-1),this._output.add_token(r[n])),this.print_newline(!1,e);this._flags.alignment=0}},M.prototype.handle_comment=function(t,e){t.newlines?this.print_newline(!1,e):this._output.trim(!0),this._output.space_before_token=!0,this.print_token(t),this.print_newline(!1,e)},M.prototype.handle_dot=function(t){this.start_of_statement(t)||this.handle_whitespace_and_comments(t,!0),l(this._flags.last_token,d)?this._output.space_before_token=!1:this.allow_wrap_or_preserved_newline(t,")"===this._flags.last_token.text&&this._options.break_chained_methods),this._options.unindent_chained_methods&&this._output.just_added_newline()&&this.deindent(),this.print_token(t)},M.prototype.handle_unknown=function(t,e){this.print_token(t),"\n"===t.text[t.text.length-1]&&this.print_newline(!1,e)},M.prototype.handle_eof=function(t){for(;this._flags.mode===v;)this.restore_mode();this.handle_whitespace_and_comments(t)},t.exports.Beautifier=M},function(t,e,n){"use strict";function r(t){this.__parent=t,this.__character_count=0,this.__indent_count=-1,this.__alignment_count=0,this.__wrap_point_index=0,this.__wrap_point_character_count=0,this.__wrap_point_indent_count=-1,this.__wrap_point_alignment_count=0,this.__items=[]}function i(t,e){this.__cache=[""],this.__indent_size=t.indent_size,this.__indent_string=t.indent_char,t.indent_with_tabs||(this.__indent_string=new Array(t.indent_size+1).join(t.indent_char)),e=e||"",t.indent_level>0&&(e=new Array(t.indent_level+1).join(this.__indent_string)),this.__base_string=e,this.__base_string_length=e.length}function s(t,e){this.__indent_cache=new i(t,e),this.raw=!1,this._end_with_newline=t.end_with_newline,this.indent_size=t.indent_size,this.wrap_line_length=t.wrap_line_length,this.indent_empty_lines=t.indent_empty_lines,this.__lines=[],this.previous_line=null,this.current_line=null,this.next_line=new r(this),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1,this.__add_outputline()}r.prototype.clone_empty=function(){var t=new r(this.__parent);return t.set_indent(this.__indent_count,this.__alignment_count),t},r.prototype.item=function(t){return t<0?this.__items[this.__items.length+t]:this.__items[t]},r.prototype.has_match=function(t){for(var e=this.__items.length-1;e>=0;e--)if(this.__items[e].match(t))return!0;return!1},r.prototype.set_indent=function(t,e){this.is_empty()&&(this.__indent_count=t||0,this.__alignment_count=e||0,this.__character_count=this.__parent.get_indent_size(this.__indent_count,this.__alignment_count))},r.prototype._set_wrap_point=function(){this.__parent.wrap_line_length&&(this.__wrap_point_index=this.__items.length,this.__wrap_point_character_count=this.__character_count,this.__wrap_point_indent_count=this.__parent.next_line.__indent_count,this.__wrap_point_alignment_count=this.__parent.next_line.__alignment_count)},r.prototype._should_wrap=function(){return this.__wrap_point_index&&this.__character_count>this.__parent.wrap_line_length&&this.__wrap_point_character_count>this.__parent.next_line.__character_count},r.prototype._allow_wrap=function(){if(this._should_wrap()){this.__parent.add_new_line();var t=this.__parent.current_line;return t.set_indent(this.__wrap_point_indent_count,this.__wrap_point_alignment_count),t.__items=this.__items.slice(this.__wrap_point_index),this.__items=this.__items.slice(0,this.__wrap_point_index),t.__character_count+=this.__character_count-this.__wrap_point_character_count,this.__character_count=this.__wrap_point_character_count," "===t.__items[0]&&(t.__items.splice(0,1),t.__character_count-=1),!0}return!1},r.prototype.is_empty=function(){return 0===this.__items.length},r.prototype.last=function(){return this.is_empty()?null:this.__items[this.__items.length-1]},r.prototype.push=function(t){this.__items.push(t);var e=t.lastIndexOf("\n");-1!==e?this.__character_count=t.length-e:this.__character_count+=t.length},r.prototype.pop=function(){var t=null;return this.is_empty()||(t=this.__items.pop(),this.__character_count-=t.length),t},r.prototype._remove_indent=function(){this.__indent_count>0&&(this.__indent_count-=1,this.__character_count-=this.__parent.indent_size)},r.prototype._remove_wrap_indent=function(){this.__wrap_point_indent_count>0&&(this.__wrap_point_indent_count-=1)},r.prototype.trim=function(){for(;" "===this.last();)this.__items.pop(),this.__character_count-=1},r.prototype.toString=function(){var t="";return this.is_empty()?this.__parent.indent_empty_lines&&(t=this.__parent.get_indent_string(this.__indent_count)):(t=this.__parent.get_indent_string(this.__indent_count,this.__alignment_count),t+=this.__items.join("")),t},i.prototype.get_indent_size=function(t,e){var n=this.__base_string_length;return e=e||0,t<0&&(n=0),(n+=t*this.__indent_size)+e},i.prototype.get_indent_string=function(t,e){var n=this.__base_string;return e=e||0,t<0&&(t=0,n=""),e+=t*this.__indent_size,this.__ensure_cache(e),n+this.__cache[e]},i.prototype.__ensure_cache=function(t){for(;t>=this.__cache.length;)this.__add_column()},i.prototype.__add_column=function(){var t=this.__cache.length,e=0,n="";this.__indent_size&&t>=this.__indent_size&&(t-=(e=Math.floor(t/this.__indent_size))*this.__indent_size,n=new Array(e+1).join(this.__indent_string)),t&&(n+=new Array(t+1).join(" ")),this.__cache.push(n)},s.prototype.__add_outputline=function(){this.previous_line=this.current_line,this.current_line=this.next_line.clone_empty(),this.__lines.push(this.current_line)},s.prototype.get_line_number=function(){return this.__lines.length},s.prototype.get_indent_string=function(t,e){return this.__indent_cache.get_indent_string(t,e)},s.prototype.get_indent_size=function(t,e){return this.__indent_cache.get_indent_size(t,e)},s.prototype.is_empty=function(){return!this.previous_line&&this.current_line.is_empty()},s.prototype.add_new_line=function(t){return!(this.is_empty()||!t&&this.just_added_newline()||(this.raw||this.__add_outputline(),0))},s.prototype.get_code=function(t){this.trim(!0);var e=this.current_line.pop();e&&("\n"===e[e.length-1]&&(e=e.replace(/\n+$/g,"")),this.current_line.push(e)),this._end_with_newline&&this.__add_outputline();var n=this.__lines.join("\n");return"\n"!==t&&(n=n.replace(/[\n]/g,t)),n},s.prototype.set_wrap_point=function(){this.current_line._set_wrap_point()},s.prototype.set_indent=function(t,e){return t=t||0,e=e||0,this.next_line.set_indent(t,e),this.__lines.length>1?(this.current_line.set_indent(t,e),!0):(this.current_line.set_indent(),!1)},s.prototype.add_raw_token=function(t){for(var e=0;e<t.newlines;e++)this.__add_outputline();this.current_line.set_indent(-1),this.current_line.push(t.whitespace_before),this.current_line.push(t.text),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1},s.prototype.add_token=function(t){this.__add_space_before_token(),this.current_line.push(t),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=this.current_line._allow_wrap()},s.prototype.__add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&(this.non_breaking_space||this.set_wrap_point(),this.current_line.push(" "))},s.prototype.remove_indent=function(t){for(var e=this.__lines.length;t<e;)this.__lines[t]._remove_indent(),t++;this.current_line._remove_wrap_indent()},s.prototype.trim=function(t){for(t=void 0!==t&&t,this.current_line.trim();t&&this.__lines.length>1&&this.current_line.is_empty();)this.__lines.pop(),this.current_line=this.__lines[this.__lines.length-1],this.current_line.trim();this.previous_line=this.__lines.length>1?this.__lines[this.__lines.length-2]:null},s.prototype.just_added_newline=function(){return this.current_line.is_empty()},s.prototype.just_added_blankline=function(){return this.is_empty()||this.current_line.is_empty()&&this.previous_line.is_empty()},s.prototype.ensure_empty_line_above=function(t,e){for(var n=this.__lines.length-2;n>=0;){var i=this.__lines[n];if(i.is_empty())break;if(0!==i.item(0).indexOf(t)&&i.item(-1)!==e){this.__lines.splice(n+1,0,new r(this)),this.previous_line=this.__lines[this.__lines.length-2];break}n--}},t.exports.Output=s},function(t,e,n){"use strict";t.exports.Token=function(t,e,n,r){this.type=t,this.text=e,this.comments_before=null,this.newlines=n||0,this.whitespace_before=r||"",this.parent=null,this.next=null,this.previous=null,this.opened=null,this.closed=null,this.directives=null}},function(t,e,n){"use strict";var r="\\xaa\\xb5\\xba\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u02c1\\u02c6-\\u02d1\\u02e0-\\u02e4\\u02ec\\u02ee\\u0370-\\u0374\\u0376\\u0377\\u037a-\\u037d\\u0386\\u0388-\\u038a\\u038c\\u038e-\\u03a1\\u03a3-\\u03f5\\u03f7-\\u0481\\u048a-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05d0-\\u05ea\\u05f0-\\u05f2\\u0620-\\u064a\\u066e\\u066f\\u0671-\\u06d3\\u06d5\\u06e5\\u06e6\\u06ee\\u06ef\\u06fa-\\u06fc\\u06ff\\u0710\\u0712-\\u072f\\u074d-\\u07a5\\u07b1\\u07ca-\\u07ea\\u07f4\\u07f5\\u07fa\\u0800-\\u0815\\u081a\\u0824\\u0828\\u0840-\\u0858\\u08a0\\u08a2-\\u08ac\\u0904-\\u0939\\u093d\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097f\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bd\\u09ce\\u09dc\\u09dd\\u09df-\\u09e1\\u09f0\\u09f1\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a59-\\u0a5c\\u0a5e\\u0a72-\\u0a74\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abd\\u0ad0\\u0ae0\\u0ae1\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3d\\u0b5c\\u0b5d\\u0b5f-\\u0b61\\u0b71\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bd0\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c33\\u0c35-\\u0c39\\u0c3d\\u0c58\\u0c59\\u0c60\\u0c61\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbd\\u0cde\\u0ce0\\u0ce1\\u0cf1\\u0cf2\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d\\u0d4e\\u0d60\\u0d61\\u0d7a-\\u0d7f\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0e01-\\u0e30\\u0e32\\u0e33\\u0e40-\\u0e46\\u0e81\\u0e82\\u0e84\\u0e87\\u0e88\\u0e8a\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5\\u0ea7\\u0eaa\\u0eab\\u0ead-\\u0eb0\\u0eb2\\u0eb3\\u0ebd\\u0ec0-\\u0ec4\\u0ec6\\u0edc-\\u0edf\\u0f00\\u0f40-\\u0f47\\u0f49-\\u0f6c\\u0f88-\\u0f8c\\u1000-\\u102a\\u103f\\u1050-\\u1055\\u105a-\\u105d\\u1061\\u1065\\u1066\\u106e-\\u1070\\u1075-\\u1081\\u108e\\u10a0-\\u10c5\\u10c7\\u10cd\\u10d0-\\u10fa\\u10fc-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u1380-\\u138f\\u13a0-\\u13f4\\u1401-\\u166c\\u166f-\\u167f\\u1681-\\u169a\\u16a0-\\u16ea\\u16ee-\\u16f0\\u1700-\\u170c\\u170e-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176c\\u176e-\\u1770\\u1780-\\u17b3\\u17d7\\u17dc\\u1820-\\u1877\\u1880-\\u18a8\\u18aa\\u18b0-\\u18f5\\u1900-\\u191c\\u1950-\\u196d\\u1970-\\u1974\\u1980-\\u19ab\\u19c1-\\u19c7\\u1a00-\\u1a16\\u1a20-\\u1a54\\u1aa7\\u1b05-\\u1b33\\u1b45-\\u1b4b\\u1b83-\\u1ba0\\u1bae\\u1baf\\u1bba-\\u1be5\\u1c00-\\u1c23\\u1c4d-\\u1c4f\\u1c5a-\\u1c7d\\u1ce9-\\u1cec\\u1cee-\\u1cf1\\u1cf5\\u1cf6\\u1d00-\\u1dbf\\u1e00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59\\u1f5b\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fbc\\u1fbe\\u1fc2-\\u1fc4\\u1fc6-\\u1fcc\\u1fd0-\\u1fd3\\u1fd6-\\u1fdb\\u1fe0-\\u1fec\\u1ff2-\\u1ff4\\u1ff6-\\u1ffc\\u2071\\u207f\\u2090-\\u209c\\u2102\\u2107\\u210a-\\u2113\\u2115\\u2119-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u212d\\u212f-\\u2139\\u213c-\\u213f\\u2145-\\u2149\\u214e\\u2160-\\u2188\\u2c00-\\u2c2e\\u2c30-\\u2c5e\\u2c60-\\u2ce4\\u2ceb-\\u2cee\\u2cf2\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\u2d30-\\u2d67\\u2d6f\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\u2e2f\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303c\\u3041-\\u3096\\u309d-\\u309f\\u30a1-\\u30fa\\u30fc-\\u30ff\\u3105-\\u312d\\u3131-\\u318e\\u31a0-\\u31ba\\u31f0-\\u31ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\ua000-\\ua48c\\ua4d0-\\ua4fd\\ua500-\\ua60c\\ua610-\\ua61f\\ua62a\\ua62b\\ua640-\\ua66e\\ua67f-\\ua697\\ua6a0-\\ua6ef\\ua717-\\ua71f\\ua722-\\ua788\\ua78b-\\ua78e\\ua790-\\ua793\\ua7a0-\\ua7aa\\ua7f8-\\ua801\\ua803-\\ua805\\ua807-\\ua80a\\ua80c-\\ua822\\ua840-\\ua873\\ua882-\\ua8b3\\ua8f2-\\ua8f7\\ua8fb\\ua90a-\\ua925\\ua930-\\ua946\\ua960-\\ua97c\\ua984-\\ua9b2\\ua9cf\\uaa00-\\uaa28\\uaa40-\\uaa42\\uaa44-\\uaa4b\\uaa60-\\uaa76\\uaa7a\\uaa80-\\uaaaf\\uaab1\\uaab5\\uaab6\\uaab9-\\uaabd\\uaac0\\uaac2\\uaadb-\\uaadd\\uaae0-\\uaaea\\uaaf2-\\uaaf4\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e\\uabc0-\\uabe2\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uf900-\\ufa6d\\ufa70-\\ufad9\\ufb00-\\ufb06\\ufb13-\\ufb17\\ufb1d\\ufb1f-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc",i="(?:\\\\u[0-9a-fA-F]{4}|[\\x23\\x24\\x40\\x41-\\x5a\\x5f\\x61-\\x7a"+r+"])";e.identifier=new RegExp(i+"(?:\\\\u[0-9a-fA-F]{4}|[\\x24\\x30-\\x39\\x41-\\x5a\\x5f\\x61-\\x7a\\xaa\\xb5\\xba\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u02c1\\u02c6-\\u02d1\\u02e0-\\u02e4\\u02ec\\u02ee\\u0370-\\u0374\\u0376\\u0377\\u037a-\\u037d\\u0386\\u0388-\\u038a\\u038c\\u038e-\\u03a1\\u03a3-\\u03f5\\u03f7-\\u0481\\u048a-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05d0-\\u05ea\\u05f0-\\u05f2\\u0620-\\u064a\\u066e\\u066f\\u0671-\\u06d3\\u06d5\\u06e5\\u06e6\\u06ee\\u06ef\\u06fa-\\u06fc\\u06ff\\u0710\\u0712-\\u072f\\u074d-\\u07a5\\u07b1\\u07ca-\\u07ea\\u07f4\\u07f5\\u07fa\\u0800-\\u0815\\u081a\\u0824\\u0828\\u0840-\\u0858\\u08a0\\u08a2-\\u08ac\\u0904-\\u0939\\u093d\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097f\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bd\\u09ce\\u09dc\\u09dd\\u09df-\\u09e1\\u09f0\\u09f1\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a59-\\u0a5c\\u0a5e\\u0a72-\\u0a74\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abd\\u0ad0\\u0ae0\\u0ae1\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3d\\u0b5c\\u0b5d\\u0b5f-\\u0b61\\u0b71\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bd0\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c33\\u0c35-\\u0c39\\u0c3d\\u0c58\\u0c59\\u0c60\\u0c61\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbd\\u0cde\\u0ce0\\u0ce1\\u0cf1\\u0cf2\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d\\u0d4e\\u0d60\\u0d61\\u0d7a-\\u0d7f\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0e01-\\u0e30\\u0e32\\u0e33\\u0e40-\\u0e46\\u0e81\\u0e82\\u0e84\\u0e87\\u0e88\\u0e8a\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5\\u0ea7\\u0eaa\\u0eab\\u0ead-\\u0eb0\\u0eb2\\u0eb3\\u0ebd\\u0ec0-\\u0ec4\\u0ec6\\u0edc-\\u0edf\\u0f00\\u0f40-\\u0f47\\u0f49-\\u0f6c\\u0f88-\\u0f8c\\u1000-\\u102a\\u103f\\u1050-\\u1055\\u105a-\\u105d\\u1061\\u1065\\u1066\\u106e-\\u1070\\u1075-\\u1081\\u108e\\u10a0-\\u10c5\\u10c7\\u10cd\\u10d0-\\u10fa\\u10fc-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u1380-\\u138f\\u13a0-\\u13f4\\u1401-\\u166c\\u166f-\\u167f\\u1681-\\u169a\\u16a0-\\u16ea\\u16ee-\\u16f0\\u1700-\\u170c\\u170e-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176c\\u176e-\\u1770\\u1780-\\u17b3\\u17d7\\u17dc\\u1820-\\u1877\\u1880-\\u18a8\\u18aa\\u18b0-\\u18f5\\u1900-\\u191c\\u1950-\\u196d\\u1970-\\u1974\\u1980-\\u19ab\\u19c1-\\u19c7\\u1a00-\\u1a16\\u1a20-\\u1a54\\u1aa7\\u1b05-\\u1b33\\u1b45-\\u1b4b\\u1b83-\\u1ba0\\u1bae\\u1baf\\u1bba-\\u1be5\\u1c00-\\u1c23\\u1c4d-\\u1c4f\\u1c5a-\\u1c7d\\u1ce9-\\u1cec\\u1cee-\\u1cf1\\u1cf5\\u1cf6\\u1d00-\\u1dbf\\u1e00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59\\u1f5b\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fbc\\u1fbe\\u1fc2-\\u1fc4\\u1fc6-\\u1fcc\\u1fd0-\\u1fd3\\u1fd6-\\u1fdb\\u1fe0-\\u1fec\\u1ff2-\\u1ff4\\u1ff6-\\u1ffc\\u2071\\u207f\\u2090-\\u209c\\u2102\\u2107\\u210a-\\u2113\\u2115\\u2119-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u212d\\u212f-\\u2139\\u213c-\\u213f\\u2145-\\u2149\\u214e\\u2160-\\u2188\\u2c00-\\u2c2e\\u2c30-\\u2c5e\\u2c60-\\u2ce4\\u2ceb-\\u2cee\\u2cf2\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\u2d30-\\u2d67\\u2d6f\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\u2e2f\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303c\\u3041-\\u3096\\u309d-\\u309f\\u30a1-\\u30fa\\u30fc-\\u30ff\\u3105-\\u312d\\u3131-\\u318e\\u31a0-\\u31ba\\u31f0-\\u31ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\ua000-\\ua48c\\ua4d0-\\ua4fd\\ua500-\\ua60c\\ua610-\\ua61f\\ua62a\\ua62b\\ua640-\\ua66e\\ua67f-\\ua697\\ua6a0-\\ua6ef\\ua717-\\ua71f\\ua722-\\ua788\\ua78b-\\ua78e\\ua790-\\ua793\\ua7a0-\\ua7aa\\ua7f8-\\ua801\\ua803-\\ua805\\ua807-\\ua80a\\ua80c-\\ua822\\ua840-\\ua873\\ua882-\\ua8b3\\ua8f2-\\ua8f7\\ua8fb\\ua90a-\\ua925\\ua930-\\ua946\\ua960-\\ua97c\\ua984-\\ua9b2\\ua9cf\\uaa00-\\uaa28\\uaa40-\\uaa42\\uaa44-\\uaa4b\\uaa60-\\uaa76\\uaa7a\\uaa80-\\uaaaf\\uaab1\\uaab5\\uaab6\\uaab9-\\uaabd\\uaac0\\uaac2\\uaadb-\\uaadd\\uaae0-\\uaaea\\uaaf2-\\uaaf4\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e\\uabc0-\\uabe2\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uf900-\\ufa6d\\ufa70-\\ufad9\\ufb00-\\ufb06\\ufb13-\\ufb17\\ufb1d\\ufb1f-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc\\u0300-\\u036f\\u0483-\\u0487\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u0620-\\u0649\\u0672-\\u06d3\\u06e7-\\u06e8\\u06fb-\\u06fc\\u0730-\\u074a\\u0800-\\u0814\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0840-\\u0857\\u08e4-\\u08fe\\u0900-\\u0903\\u093a-\\u093c\\u093e-\\u094f\\u0951-\\u0957\\u0962-\\u0963\\u0966-\\u096f\\u0981-\\u0983\\u09bc\\u09be-\\u09c4\\u09c7\\u09c8\\u09d7\\u09df-\\u09e0\\u0a01-\\u0a03\\u0a3c\\u0a3e-\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a66-\\u0a71\\u0a75\\u0a81-\\u0a83\\u0abc\\u0abe-\\u0ac5\\u0ac7-\\u0ac9\\u0acb-\\u0acd\\u0ae2-\\u0ae3\\u0ae6-\\u0aef\\u0b01-\\u0b03\\u0b3c\\u0b3e-\\u0b44\\u0b47\\u0b48\\u0b4b-\\u0b4d\\u0b56\\u0b57\\u0b5f-\\u0b60\\u0b66-\\u0b6f\\u0b82\\u0bbe-\\u0bc2\\u0bc6-\\u0bc8\\u0bca-\\u0bcd\\u0bd7\\u0be6-\\u0bef\\u0c01-\\u0c03\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62-\\u0c63\\u0c66-\\u0c6f\\u0c82\\u0c83\\u0cbc\\u0cbe-\\u0cc4\\u0cc6-\\u0cc8\\u0cca-\\u0ccd\\u0cd5\\u0cd6\\u0ce2-\\u0ce3\\u0ce6-\\u0cef\\u0d02\\u0d03\\u0d46-\\u0d48\\u0d57\\u0d62-\\u0d63\\u0d66-\\u0d6f\\u0d82\\u0d83\\u0dca\\u0dcf-\\u0dd4\\u0dd6\\u0dd8-\\u0ddf\\u0df2\\u0df3\\u0e34-\\u0e3a\\u0e40-\\u0e45\\u0e50-\\u0e59\\u0eb4-\\u0eb9\\u0ec8-\\u0ecd\\u0ed0-\\u0ed9\\u0f18\\u0f19\\u0f20-\\u0f29\\u0f35\\u0f37\\u0f39\\u0f41-\\u0f47\\u0f71-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u1000-\\u1029\\u1040-\\u1049\\u1067-\\u106d\\u1071-\\u1074\\u1082-\\u108d\\u108f-\\u109d\\u135d-\\u135f\\u170e-\\u1710\\u1720-\\u1730\\u1740-\\u1750\\u1772\\u1773\\u1780-\\u17b2\\u17dd\\u17e0-\\u17e9\\u180b-\\u180d\\u1810-\\u1819\\u1920-\\u192b\\u1930-\\u193b\\u1951-\\u196d\\u19b0-\\u19c0\\u19c8-\\u19c9\\u19d0-\\u19d9\\u1a00-\\u1a15\\u1a20-\\u1a53\\u1a60-\\u1a7c\\u1a7f-\\u1a89\\u1a90-\\u1a99\\u1b46-\\u1b4b\\u1b50-\\u1b59\\u1b6b-\\u1b73\\u1bb0-\\u1bb9\\u1be6-\\u1bf3\\u1c00-\\u1c22\\u1c40-\\u1c49\\u1c5b-\\u1c7d\\u1cd0-\\u1cd2\\u1d00-\\u1dbe\\u1e01-\\u1f15\\u200c\\u200d\\u203f\\u2040\\u2054\\u20d0-\\u20dc\\u20e1\\u20e5-\\u20f0\\u2d81-\\u2d96\\u2de0-\\u2dff\\u3021-\\u3028\\u3099\\u309a\\ua640-\\ua66d\\ua674-\\ua67d\\ua69f\\ua6f0-\\ua6f1\\ua7f8-\\ua800\\ua806\\ua80b\\ua823-\\ua827\\ua880-\\ua881\\ua8b4-\\ua8c4\\ua8d0-\\ua8d9\\ua8f3-\\ua8f7\\ua900-\\ua909\\ua926-\\ua92d\\ua930-\\ua945\\ua980-\\ua983\\ua9b3-\\ua9c0\\uaa00-\\uaa27\\uaa40-\\uaa41\\uaa4c-\\uaa4d\\uaa50-\\uaa59\\uaa7b\\uaae0-\\uaae9\\uaaf2-\\uaaf3\\uabc0-\\uabe1\\uabec\\uabed\\uabf0-\\uabf9\\ufb20-\\ufb28\\ufe00-\\ufe0f\\ufe20-\\ufe26\\ufe33\\ufe34\\ufe4d-\\ufe4f\\uff10-\\uff19\\uff3f])*","g"),e.identifierStart=new RegExp(i),e.identifierMatch=new RegExp("(?:\\\\u[0-9a-fA-F]{4}|[\\x24\\x30-\\x39\\x41-\\x5a\\x5f\\x61-\\x7a"+r+"\\u0300-\\u036f\\u0483-\\u0487\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u0620-\\u0649\\u0672-\\u06d3\\u06e7-\\u06e8\\u06fb-\\u06fc\\u0730-\\u074a\\u0800-\\u0814\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0840-\\u0857\\u08e4-\\u08fe\\u0900-\\u0903\\u093a-\\u093c\\u093e-\\u094f\\u0951-\\u0957\\u0962-\\u0963\\u0966-\\u096f\\u0981-\\u0983\\u09bc\\u09be-\\u09c4\\u09c7\\u09c8\\u09d7\\u09df-\\u09e0\\u0a01-\\u0a03\\u0a3c\\u0a3e-\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a66-\\u0a71\\u0a75\\u0a81-\\u0a83\\u0abc\\u0abe-\\u0ac5\\u0ac7-\\u0ac9\\u0acb-\\u0acd\\u0ae2-\\u0ae3\\u0ae6-\\u0aef\\u0b01-\\u0b03\\u0b3c\\u0b3e-\\u0b44\\u0b47\\u0b48\\u0b4b-\\u0b4d\\u0b56\\u0b57\\u0b5f-\\u0b60\\u0b66-\\u0b6f\\u0b82\\u0bbe-\\u0bc2\\u0bc6-\\u0bc8\\u0bca-\\u0bcd\\u0bd7\\u0be6-\\u0bef\\u0c01-\\u0c03\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62-\\u0c63\\u0c66-\\u0c6f\\u0c82\\u0c83\\u0cbc\\u0cbe-\\u0cc4\\u0cc6-\\u0cc8\\u0cca-\\u0ccd\\u0cd5\\u0cd6\\u0ce2-\\u0ce3\\u0ce6-\\u0cef\\u0d02\\u0d03\\u0d46-\\u0d48\\u0d57\\u0d62-\\u0d63\\u0d66-\\u0d6f\\u0d82\\u0d83\\u0dca\\u0dcf-\\u0dd4\\u0dd6\\u0dd8-\\u0ddf\\u0df2\\u0df3\\u0e34-\\u0e3a\\u0e40-\\u0e45\\u0e50-\\u0e59\\u0eb4-\\u0eb9\\u0ec8-\\u0ecd\\u0ed0-\\u0ed9\\u0f18\\u0f19\\u0f20-\\u0f29\\u0f35\\u0f37\\u0f39\\u0f41-\\u0f47\\u0f71-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u1000-\\u1029\\u1040-\\u1049\\u1067-\\u106d\\u1071-\\u1074\\u1082-\\u108d\\u108f-\\u109d\\u135d-\\u135f\\u170e-\\u1710\\u1720-\\u1730\\u1740-\\u1750\\u1772\\u1773\\u1780-\\u17b2\\u17dd\\u17e0-\\u17e9\\u180b-\\u180d\\u1810-\\u1819\\u1920-\\u192b\\u1930-\\u193b\\u1951-\\u196d\\u19b0-\\u19c0\\u19c8-\\u19c9\\u19d0-\\u19d9\\u1a00-\\u1a15\\u1a20-\\u1a53\\u1a60-\\u1a7c\\u1a7f-\\u1a89\\u1a90-\\u1a99\\u1b46-\\u1b4b\\u1b50-\\u1b59\\u1b6b-\\u1b73\\u1bb0-\\u1bb9\\u1be6-\\u1bf3\\u1c00-\\u1c22\\u1c40-\\u1c49\\u1c5b-\\u1c7d\\u1cd0-\\u1cd2\\u1d00-\\u1dbe\\u1e01-\\u1f15\\u200c\\u200d\\u203f\\u2040\\u2054\\u20d0-\\u20dc\\u20e1\\u20e5-\\u20f0\\u2d81-\\u2d96\\u2de0-\\u2dff\\u3021-\\u3028\\u3099\\u309a\\ua640-\\ua66d\\ua674-\\ua67d\\ua69f\\ua6f0-\\ua6f1\\ua7f8-\\ua800\\ua806\\ua80b\\ua823-\\ua827\\ua880-\\ua881\\ua8b4-\\ua8c4\\ua8d0-\\ua8d9\\ua8f3-\\ua8f7\\ua900-\\ua909\\ua926-\\ua92d\\ua930-\\ua945\\ua980-\\ua983\\ua9b3-\\ua9c0\\uaa00-\\uaa27\\uaa40-\\uaa41\\uaa4c-\\uaa4d\\uaa50-\\uaa59\\uaa7b\\uaae0-\\uaae9\\uaaf2-\\uaaf3\\uabc0-\\uabe1\\uabec\\uabed\\uabf0-\\uabf9\\ufb20-\\ufb28\\ufe00-\\ufe0f\\ufe20-\\ufe26\\ufe33\\ufe34\\ufe4d-\\ufe4f\\uff10-\\uff19\\uff3f])+"),e.newline=/[\n\r\u2028\u2029]/,e.lineBreak=new RegExp("\r\n|"+e.newline.source),e.allLineBreaks=new RegExp(e.lineBreak.source,"g")},function(t,e,n){"use strict";var r=n(6).Options,i=["before-newline","after-newline","preserve-newline"];function s(t){r.call(this,t,"js");var e=this.raw_options.brace_style||null;"expand-strict"===e?this.raw_options.brace_style="expand":"collapse-preserve-inline"===e?this.raw_options.brace_style="collapse,preserve-inline":void 0!==this.raw_options.braces_on_own_line&&(this.raw_options.brace_style=this.raw_options.braces_on_own_line?"expand":"collapse");var n=this._get_selection_list("brace_style",["collapse","expand","end-expand","none","preserve-inline"]);this.brace_preserve_inline=!1,this.brace_style="collapse";for(var s=0;s<n.length;s++)"preserve-inline"===n[s]?this.brace_preserve_inline=!0:this.brace_style=n[s];this.unindent_chained_methods=this._get_boolean("unindent_chained_methods"),this.break_chained_methods=this._get_boolean("break_chained_methods"),this.space_in_paren=this._get_boolean("space_in_paren"),this.space_in_empty_paren=this._get_boolean("space_in_empty_paren"),this.jslint_happy=this._get_boolean("jslint_happy"),this.space_after_anon_function=this._get_boolean("space_after_anon_function"),this.space_after_named_function=this._get_boolean("space_after_named_function"),this.keep_array_indentation=this._get_boolean("keep_array_indentation"),this.space_before_conditional=this._get_boolean("space_before_conditional",!0),this.unescape_strings=this._get_boolean("unescape_strings"),this.e4x=this._get_boolean("e4x"),this.comma_first=this._get_boolean("comma_first"),this.operator_position=this._get_selection("operator_position",i),this.test_output_raw=this._get_boolean("test_output_raw"),this.jslint_happy&&(this.space_after_anon_function=!0)}s.prototype=new r,t.exports.Options=s},function(t,e,n){"use strict";function r(t,e){this.raw_options=i(t,e),this.disabled=this._get_boolean("disabled"),this.eol=this._get_characters("eol","auto"),this.end_with_newline=this._get_boolean("end_with_newline"),this.indent_size=this._get_number("indent_size",4),this.indent_char=this._get_characters("indent_char"," "),this.indent_level=this._get_number("indent_level"),this.preserve_newlines=this._get_boolean("preserve_newlines",!0),this.max_preserve_newlines=this._get_number("max_preserve_newlines",32786),this.preserve_newlines||(this.max_preserve_newlines=0),this.indent_with_tabs=this._get_boolean("indent_with_tabs","\t"===this.indent_char),this.indent_with_tabs&&(this.indent_char="\t",1===this.indent_size&&(this.indent_size=4)),this.wrap_line_length=this._get_number("wrap_line_length",this._get_number("max_char")),this.indent_empty_lines=this._get_boolean("indent_empty_lines"),this.templating=this._get_selection_list("templating",["auto","none","django","erb","handlebars","php","smarty"],["auto"])}function i(t,e){var n,r={};for(n in t=s(t))n!==e&&(r[n]=t[n]);if(e&&t[e])for(n in t[e])r[n]=t[e][n];return r}function s(t){var e,n={};for(e in t)n[e.replace(/-/g,"_")]=t[e];return n}r.prototype._get_array=function(t,e){var n=this.raw_options[t],r=e||[];return"object"==typeof n?null!==n&&"function"==typeof n.concat&&(r=n.concat()):"string"==typeof n&&(r=n.split(/[^a-zA-Z0-9_\/\-]+/)),r},r.prototype._get_boolean=function(t,e){var n=this.raw_options[t];return void 0===n?!!e:!!n},r.prototype._get_characters=function(t,e){var n=this.raw_options[t],r=e||"";return"string"==typeof n&&(r=n.replace(/\\r/,"\r").replace(/\\n/,"\n").replace(/\\t/,"\t")),r},r.prototype._get_number=function(t,e){var n=this.raw_options[t];e=parseInt(e,10),isNaN(e)&&(e=0);var r=parseInt(n,10);return isNaN(r)&&(r=e),r},r.prototype._get_selection=function(t,e,n){var r=this._get_selection_list(t,e,n);if(1!==r.length)throw new Error("Invalid Option Value: The option '"+t+"' can only be one of the following values:\n"+e+"\nYou passed in: '"+this.raw_options[t]+"'");return r[0]},r.prototype._get_selection_list=function(t,e,n){if(!e||0===e.length)throw new Error("Selection list cannot be empty.");if(n=n||[e[0]],!this._is_valid_selection(n,e))throw new Error("Invalid Default Value!");var r=this._get_array(t,n);if(!this._is_valid_selection(r,e))throw new Error("Invalid Option Value: The option '"+t+"' can contain only the following values:\n"+e+"\nYou passed in: '"+this.raw_options[t]+"'");return r},r.prototype._is_valid_selection=function(t,e){return t.length&&e.length&&!t.some((function(t){return-1===e.indexOf(t)}))},t.exports.Options=r,t.exports.normalizeOpts=s,t.exports.mergeOpts=i},function(t,e,n){"use strict";var r=n(8).InputScanner,i=n(9).Tokenizer,s=n(9).TOKEN,a=n(13).Directives,o=n(4),u=n(12).Pattern,c=n(14).TemplatablePattern;function _(t,e){return-1!==e.indexOf(t)}var p={START_EXPR:"TK_START_EXPR",END_EXPR:"TK_END_EXPR",START_BLOCK:"TK_START_BLOCK",END_BLOCK:"TK_END_BLOCK",WORD:"TK_WORD",RESERVED:"TK_RESERVED",SEMICOLON:"TK_SEMICOLON",STRING:"TK_STRING",EQUALS:"TK_EQUALS",OPERATOR:"TK_OPERATOR",COMMA:"TK_COMMA",BLOCK_COMMENT:"TK_BLOCK_COMMENT",COMMENT:"TK_COMMENT",DOT:"TK_DOT",UNKNOWN:"TK_UNKNOWN",START:s.START,RAW:s.RAW,EOF:s.EOF},h=new a(/\/\*/,/\*\//),l=/0[xX][0123456789abcdefABCDEF]*|0[oO][01234567]*|0[bB][01]*|\d+n|(?:\.\d+|\d+\.?\d*)(?:[eE][+-]?\d+)?/,d=/[0-9]/,f=/[^\d\.]/,m=">>> === !== << && >= ** != == <= >> || ?? |> < / - + > : & % ? ^ | *".split(" "),g=">>>= ... >>= <<= === >>> !== **= => ^= :: /= << <= == && -= >= >> != -- += ** || ?? ++ %= &= *= |= |> = ! ? > < : / ^ - + * & % ~ |";g=(g="\\?\\.(?!\\d) "+(g=g.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&"))).replace(/ /g,"|");var v,y=new RegExp(g),b="continue,try,throw,return,var,let,const,if,switch,case,default,for,while,break,function,import,export".split(","),w=b.concat(["do","in","of","else","get","set","new","catch","finally","typeof","yield","async","await","from","as"]),k=new RegExp("^(?:"+w.join("|")+")$"),x=function(t,e){i.call(this,t,e),this._patterns.whitespace=this._patterns.whitespace.matching(/\u00A0\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff/.source,/\u2028\u2029/.source);var n=new u(this._input),r=new c(this._input).read_options(this._options);this.__patterns={template:r,identifier:r.starting_with(o.identifier).matching(o.identifierMatch),number:n.matching(l),punct:n.matching(y),comment:n.starting_with(/\/\//).until(/[\n\r\u2028\u2029]/),block_comment:n.starting_with(/\/\*/).until_after(/\*\//),html_comment_start:n.matching(/<!--/),html_comment_end:n.matching(/-->/),include:n.starting_with(/#include/).until_after(o.lineBreak),shebang:n.starting_with(/#!/).until_after(o.lineBreak),xml:n.matching(/[\s\S]*?<(\/?)([-a-zA-Z:0-9_.]+|{[\s\S]+?}|!\[CDATA\[[\s\S]*?\]\]|)(\s+{[\s\S]+?}|\s+[-a-zA-Z:0-9_.]+|\s+[-a-zA-Z:0-9_.]+\s*=\s*('[^']*'|"[^"]*"|{[\s\S]+?}))*\s*(\/?)\s*>/),single_quote:r.until(/['\\\n\r\u2028\u2029]/),double_quote:r.until(/["\\\n\r\u2028\u2029]/),template_text:r.until(/[`\\$]/),template_expression:r.until(/[`}\\]/)}};(x.prototype=new i)._is_comment=function(t){return t.type===p.COMMENT||t.type===p.BLOCK_COMMENT||t.type===p.UNKNOWN},x.prototype._is_opening=function(t){return t.type===p.START_BLOCK||t.type===p.START_EXPR},x.prototype._is_closing=function(t,e){return(t.type===p.END_BLOCK||t.type===p.END_EXPR)&&e&&("]"===t.text&&"["===e.text||")"===t.text&&"("===e.text||"}"===t.text&&"{"===e.text)},x.prototype._reset=function(){v=!1},x.prototype._get_next_token=function(t,e){var n=null;this._readWhitespace();var r=this._input.peek();return null===r?this._create_token(p.EOF,""):n=(n=(n=(n=(n=(n=(n=(n=(n=n||this._read_non_javascript(r))||this._read_string(r))||this._read_word(t))||this._read_singles(r))||this._read_comment(r))||this._read_regexp(r,t))||this._read_xml(r,t))||this._read_punctuation())||this._create_token(p.UNKNOWN,this._input.next())},x.prototype._read_word=function(t){var e;return""!==(e=this.__patterns.identifier.read())?(e=e.replace(o.allLineBreaks,"\n"),t.type!==p.DOT&&(t.type!==p.RESERVED||"set"!==t.text&&"get"!==t.text)&&k.test(e)?"in"===e||"of"===e?this._create_token(p.OPERATOR,e):this._create_token(p.RESERVED,e):this._create_token(p.WORD,e)):""!==(e=this.__patterns.number.read())?this._create_token(p.WORD,e):void 0},x.prototype._read_singles=function(t){var e=null;return"("===t||"["===t?e=this._create_token(p.START_EXPR,t):")"===t||"]"===t?e=this._create_token(p.END_EXPR,t):"{"===t?e=this._create_token(p.START_BLOCK,t):"}"===t?e=this._create_token(p.END_BLOCK,t):";"===t?e=this._create_token(p.SEMICOLON,t):"."===t&&f.test(this._input.peek(1))?e=this._create_token(p.DOT,t):","===t&&(e=this._create_token(p.COMMA,t)),e&&this._input.next(),e},x.prototype._read_punctuation=function(){var t=this.__patterns.punct.read();if(""!==t)return"="===t?this._create_token(p.EQUALS,t):"?."===t?this._create_token(p.DOT,t):this._create_token(p.OPERATOR,t)},x.prototype._read_non_javascript=function(t){var e="";if("#"===t){if(this._is_first_token()&&(e=this.__patterns.shebang.read()))return this._create_token(p.UNKNOWN,e.trim()+"\n");if(e=this.__patterns.include.read())return this._create_token(p.UNKNOWN,e.trim()+"\n");t=this._input.next();var n="#";if(this._input.hasNext()&&this._input.testChar(d)){do{n+=t=this._input.next()}while(this._input.hasNext()&&"#"!==t&&"="!==t);return"#"===t||("["===this._input.peek()&&"]"===this._input.peek(1)?(n+="[]",this._input.next(),this._input.next()):"{"===this._input.peek()&&"}"===this._input.peek(1)&&(n+="{}",this._input.next(),this._input.next())),this._create_token(p.WORD,n)}this._input.back()}else if("<"===t&&this._is_first_token()){if(e=this.__patterns.html_comment_start.read()){for(;this._input.hasNext()&&!this._input.testChar(o.newline);)e+=this._input.next();return v=!0,this._create_token(p.COMMENT,e)}}else if(v&&"-"===t&&(e=this.__patterns.html_comment_end.read()))return v=!1,this._create_token(p.COMMENT,e);return null},x.prototype._read_comment=function(t){var e=null;if("/"===t){var n="";if("*"===this._input.peek(1)){n=this.__patterns.block_comment.read();var r=h.get_directives(n);r&&"start"===r.ignore&&(n+=h.readIgnored(this._input)),n=n.replace(o.allLineBreaks,"\n"),(e=this._create_token(p.BLOCK_COMMENT,n)).directives=r}else"/"===this._input.peek(1)&&(n=this.__patterns.comment.read(),e=this._create_token(p.COMMENT,n))}return e},x.prototype._read_string=function(t){if("`"===t||"'"===t||'"'===t){var e=this._input.next();return this.has_char_escapes=!1,e+="`"===t?this._read_string_recursive("`",!0,"${"):this._read_string_recursive(t),this.has_char_escapes&&this._options.unescape_strings&&(e=function(t){for(var e="",n=0,i=new r(t),s=null;i.hasNext();)if((s=i.match(/([\s]|[^\\]|\\\\)+/g))&&(e+=s[0]),"\\"===i.peek()){if(i.next(),"x"===i.peek())s=i.match(/x([0-9A-Fa-f]{2})/g);else{if("u"!==i.peek()){e+="\\",i.hasNext()&&(e+=i.next());continue}s=i.match(/u([0-9A-Fa-f]{4})/g)}if(!s)return t;if((n=parseInt(s[1],16))>126&&n<=255&&0===s[0].indexOf("x"))return t;if(n>=0&&n<32){e+="\\"+s[0];continue}e+=34===n||39===n||92===n?"\\"+String.fromCharCode(n):String.fromCharCode(n)}return e}(e)),this._input.peek()===t&&(e+=this._input.next()),e=e.replace(o.allLineBreaks,"\n"),this._create_token(p.STRING,e)}return null},x.prototype._allow_regexp_or_xml=function(t){return t.type===p.RESERVED&&_(t.text,["return","case","throw","else","do","typeof","yield"])||t.type===p.END_EXPR&&")"===t.text&&t.opened.previous.type===p.RESERVED&&_(t.opened.previous.text,["if","while","for"])||_(t.type,[p.COMMENT,p.START_EXPR,p.START_BLOCK,p.START,p.END_BLOCK,p.OPERATOR,p.EQUALS,p.EOF,p.SEMICOLON,p.COMMA])},x.prototype._read_regexp=function(t,e){if("/"===t&&this._allow_regexp_or_xml(e)){for(var n=this._input.next(),r=!1,i=!1;this._input.hasNext()&&(r||i||this._input.peek()!==t)&&!this._input.testChar(o.newline);)n+=this._input.peek(),r?r=!1:(r="\\"===this._input.peek(),"["===this._input.peek()?i=!0:"]"===this._input.peek()&&(i=!1)),this._input.next();return this._input.peek()===t&&(n+=this._input.next(),n+=this._input.read(o.identifier)),this._create_token(p.STRING,n)}return null},x.prototype._read_xml=function(t,e){if(this._options.e4x&&"<"===t&&this._allow_regexp_or_xml(e)){var n="",r=this.__patterns.xml.read_match();if(r){for(var i=r[2].replace(/^{\s+/,"{").replace(/\s+}$/,"}"),s=0===i.indexOf("{"),a=0;r;){var u=!!r[1],c=r[2];if(!(r[r.length-1]||"![CDATA["===c.slice(0,8))&&(c===i||s&&c.replace(/^{\s+/,"{").replace(/\s+}$/,"}"))&&(u?--a:++a),n+=r[0],a<=0)break;r=this.__patterns.xml.read_match()}return r||(n+=this._input.match(/[\s\S]*/g)[0]),n=n.replace(o.allLineBreaks,"\n"),this._create_token(p.STRING,n)}}return null},x.prototype._read_string_recursive=function(t,e,n){var r,i;"'"===t?i=this.__patterns.single_quote:'"'===t?i=this.__patterns.double_quote:"`"===t?i=this.__patterns.template_text:"}"===t&&(i=this.__patterns.template_expression);for(var s=i.read(),a="";this._input.hasNext();){if((a=this._input.next())===t||!e&&o.newline.test(a)){this._input.back();break}"\\"===a&&this._input.hasNext()?("x"===(r=this._input.peek())||"u"===r?this.has_char_escapes=!0:"\r"===r&&"\n"===this._input.peek(1)&&this._input.next(),a+=this._input.next()):n&&("${"===n&&"$"===a&&"{"===this._input.peek()&&(a+=this._input.next()),n===a&&(a+="`"===t?this._read_string_recursive("}",e,"`"):this._read_string_recursive("`",e,"${"),this._input.hasNext()&&(a+=this._input.next()))),s+=a+=i.read()}return s},t.exports.Tokenizer=x,t.exports.TOKEN=p,t.exports.positionable_operators=m.slice(),t.exports.line_starters=b.slice()},function(t,e,n){"use strict";var r=RegExp.prototype.hasOwnProperty("sticky");function i(t){this.__input=t||"",this.__input_length=this.__input.length,this.__position=0}i.prototype.restart=function(){this.__position=0},i.prototype.back=function(){this.__position>0&&(this.__position-=1)},i.prototype.hasNext=function(){return this.__position<this.__input_length},i.prototype.next=function(){var t=null;return this.hasNext()&&(t=this.__input.charAt(this.__position),this.__position+=1),t},i.prototype.peek=function(t){var e=null;return t=t||0,(t+=this.__position)>=0&&t<this.__input_length&&(e=this.__input.charAt(t)),e},i.prototype.__match=function(t,e){t.lastIndex=e;var n=t.exec(this.__input);return!n||r&&t.sticky||n.index!==e&&(n=null),n},i.prototype.test=function(t,e){return e=e||0,(e+=this.__position)>=0&&e<this.__input_length&&!!this.__match(t,e)},i.prototype.testChar=function(t,e){var n=this.peek(e);return t.lastIndex=0,null!==n&&t.test(n)},i.prototype.match=function(t){var e=this.__match(t,this.__position);return e?this.__position+=e[0].length:e=null,e},i.prototype.read=function(t,e,n){var r,i="";return t&&(r=this.match(t))&&(i+=r[0]),!e||!r&&t||(i+=this.readUntil(e,n)),i},i.prototype.readUntil=function(t,e){var n,r=this.__position;t.lastIndex=this.__position;var i=t.exec(this.__input);return i?(r=i.index,e&&(r+=i[0].length)):r=this.__input_length,n=this.__input.substring(this.__position,r),this.__position=r,n},i.prototype.readUntilAfter=function(t){return this.readUntil(t,!0)},i.prototype.get_regexp=function(t,e){var n=null,i="g";return e&&r&&(i="y"),"string"==typeof t&&""!==t?n=new RegExp(t,i):t&&(n=new RegExp(t.source,i)),n},i.prototype.get_literal_regexp=function(t){return RegExp(t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))},i.prototype.peekUntilAfter=function(t){var e=this.__position,n=this.readUntilAfter(t);return this.__position=e,n},i.prototype.lookBack=function(t){var e=this.__position-1;return e>=t.length&&this.__input.substring(e-t.length,e).toLowerCase()===t},t.exports.InputScanner=i},function(t,e,n){"use strict";var r=n(8).InputScanner,i=n(3).Token,s=n(10).TokenStream,a=n(11).WhitespacePattern,o={START:"TK_START",RAW:"TK_RAW",EOF:"TK_EOF"},u=function(t,e){this._input=new r(t),this._options=e||{},this.__tokens=null,this._patterns={},this._patterns.whitespace=new a(this._input)};u.prototype.tokenize=function(){var t;this._input.restart(),this.__tokens=new s,this._reset();for(var e=new i(o.START,""),n=null,r=[],a=new s;e.type!==o.EOF;){for(t=this._get_next_token(e,n);this._is_comment(t);)a.add(t),t=this._get_next_token(e,n);a.isEmpty()||(t.comments_before=a,a=new s),t.parent=n,this._is_opening(t)?(r.push(n),n=t):n&&this._is_closing(t,n)&&(t.opened=n,n.closed=t,n=r.pop(),t.parent=n),t.previous=e,e.next=t,this.__tokens.add(t),e=t}return this.__tokens},u.prototype._is_first_token=function(){return this.__tokens.isEmpty()},u.prototype._reset=function(){},u.prototype._get_next_token=function(t,e){this._readWhitespace();var n=this._input.read(/.+/g);return n?this._create_token(o.RAW,n):this._create_token(o.EOF,"")},u.prototype._is_comment=function(t){return!1},u.prototype._is_opening=function(t){return!1},u.prototype._is_closing=function(t,e){return!1},u.prototype._create_token=function(t,e){return new i(t,e,this._patterns.whitespace.newline_count,this._patterns.whitespace.whitespace_before_token)},u.prototype._readWhitespace=function(){return this._patterns.whitespace.read()},t.exports.Tokenizer=u,t.exports.TOKEN=o},function(t,e,n){"use strict";function r(t){this.__tokens=[],this.__tokens_length=this.__tokens.length,this.__position=0,this.__parent_token=t}r.prototype.restart=function(){this.__position=0},r.prototype.isEmpty=function(){return 0===this.__tokens_length},r.prototype.hasNext=function(){return this.__position<this.__tokens_length},r.prototype.next=function(){var t=null;return this.hasNext()&&(t=this.__tokens[this.__position],this.__position+=1),t},r.prototype.peek=function(t){var e=null;return t=t||0,(t+=this.__position)>=0&&t<this.__tokens_length&&(e=this.__tokens[t]),e},r.prototype.add=function(t){this.__parent_token&&(t.parent=this.__parent_token),this.__tokens.push(t),this.__tokens_length+=1},t.exports.TokenStream=r},function(t,e,n){"use strict";var r=n(12).Pattern;function i(t,e){r.call(this,t,e),e?this._line_regexp=this._input.get_regexp(e._line_regexp):this.__set_whitespace_patterns("",""),this.newline_count=0,this.whitespace_before_token=""}i.prototype=new r,i.prototype.__set_whitespace_patterns=function(t,e){t+="\\t ",e+="\\n\\r",this._match_pattern=this._input.get_regexp("["+t+e+"]+",!0),this._newline_regexp=this._input.get_regexp("\\r\\n|["+e+"]")},i.prototype.read=function(){this.newline_count=0,this.whitespace_before_token="";var t=this._input.read(this._match_pattern);if(" "===t)this.whitespace_before_token=" ";else if(t){var e=this.__split(this._newline_regexp,t);this.newline_count=e.length-1,this.whitespace_before_token=e[this.newline_count]}return t},i.prototype.matching=function(t,e){var n=this._create();return n.__set_whitespace_patterns(t,e),n._update(),n},i.prototype._create=function(){return new i(this._input,this)},i.prototype.__split=function(t,e){t.lastIndex=0;for(var n=0,r=[],i=t.exec(e);i;)r.push(e.substring(n,i.index)),n=i.index+i[0].length,i=t.exec(e);return n<e.length?r.push(e.substring(n,e.length)):r.push(""),r},t.exports.WhitespacePattern=i},function(t,e,n){"use strict";function r(t,e){this._input=t,this._starting_pattern=null,this._match_pattern=null,this._until_pattern=null,this._until_after=!1,e&&(this._starting_pattern=this._input.get_regexp(e._starting_pattern,!0),this._match_pattern=this._input.get_regexp(e._match_pattern,!0),this._until_pattern=this._input.get_regexp(e._until_pattern),this._until_after=e._until_after)}r.prototype.read=function(){var t=this._input.read(this._starting_pattern);return this._starting_pattern&&!t||(t+=this._input.read(this._match_pattern,this._until_pattern,this._until_after)),t},r.prototype.read_match=function(){return this._input.match(this._match_pattern)},r.prototype.until_after=function(t){var e=this._create();return e._until_after=!0,e._until_pattern=this._input.get_regexp(t),e._update(),e},r.prototype.until=function(t){var e=this._create();return e._until_after=!1,e._until_pattern=this._input.get_regexp(t),e._update(),e},r.prototype.starting_with=function(t){var e=this._create();return e._starting_pattern=this._input.get_regexp(t,!0),e._update(),e},r.prototype.matching=function(t){var e=this._create();return e._match_pattern=this._input.get_regexp(t,!0),e._update(),e},r.prototype._create=function(){return new r(this._input,this)},r.prototype._update=function(){},t.exports.Pattern=r},function(t,e,n){"use strict";function r(t,e){t="string"==typeof t?t:t.source,e="string"==typeof e?e:e.source,this.__directives_block_pattern=new RegExp(t+/ beautify( \w+[:]\w+)+ /.source+e,"g"),this.__directive_pattern=/ (\w+)[:](\w+)/g,this.__directives_end_ignore_pattern=new RegExp(t+/\sbeautify\signore:end\s/.source+e,"g")}r.prototype.get_directives=function(t){if(!t.match(this.__directives_block_pattern))return null;var e={};this.__directive_pattern.lastIndex=0;for(var n=this.__directive_pattern.exec(t);n;)e[n[1]]=n[2],n=this.__directive_pattern.exec(t);return e},r.prototype.readIgnored=function(t){return t.readUntilAfter(this.__directives_end_ignore_pattern)},t.exports.Directives=r},function(t,e,n){"use strict";var r=n(12).Pattern,i={django:!1,erb:!1,handlebars:!1,php:!1,smarty:!1};function s(t,e){r.call(this,t,e),this.__template_pattern=null,this._disabled=Object.assign({},i),this._excluded=Object.assign({},i),e&&(this.__template_pattern=this._input.get_regexp(e.__template_pattern),this._excluded=Object.assign(this._excluded,e._excluded),this._disabled=Object.assign(this._disabled,e._disabled));var n=new r(t);this.__patterns={handlebars_comment:n.starting_with(/{{!--/).until_after(/--}}/),handlebars_unescaped:n.starting_with(/{{{/).until_after(/}}}/),handlebars:n.starting_with(/{{/).until_after(/}}/),php:n.starting_with(/<\?(?:[=]|php)/).until_after(/\?>/),erb:n.starting_with(/<%[^%]/).until_after(/[^%]%>/),django:n.starting_with(/{%/).until_after(/%}/),django_value:n.starting_with(/{{/).until_after(/}}/),django_comment:n.starting_with(/{#/).until_after(/#}/),smarty:n.starting_with(/{(?=[^}{\s\n])/).until_after(/[^\s\n]}/),smarty_comment:n.starting_with(/{\*/).until_after(/\*}/),smarty_literal:n.starting_with(/{literal}/).until_after(/{\/literal}/)}}s.prototype=new r,s.prototype._create=function(){return new s(this._input,this)},s.prototype._update=function(){this.__set_templated_pattern()},s.prototype.disable=function(t){var e=this._create();return e._disabled[t]=!0,e._update(),e},s.prototype.read_options=function(t){var e=this._create();for(var n in i)e._disabled[n]=-1===t.templating.indexOf(n);return e._update(),e},s.prototype.exclude=function(t){var e=this._create();return e._excluded[t]=!0,e._update(),e},s.prototype.read=function(){var t="";t=this._match_pattern?this._input.read(this._starting_pattern):this._input.read(this._starting_pattern,this.__template_pattern);for(var e=this._read_template();e;)this._match_pattern?e+=this._input.read(this._match_pattern):e+=this._input.readUntil(this.__template_pattern),t+=e,e=this._read_template();return this._until_after&&(t+=this._input.readUntilAfter(this._until_pattern)),t},s.prototype.__set_templated_pattern=function(){var t=[];this._disabled.php||t.push(this.__patterns.php._starting_pattern.source),this._disabled.handlebars||t.push(this.__patterns.handlebars._starting_pattern.source),this._disabled.erb||t.push(this.__patterns.erb._starting_pattern.source),this._disabled.django||(t.push(this.__patterns.django._starting_pattern.source),t.push(this.__patterns.django_value._starting_pattern.source),t.push(this.__patterns.django_comment._starting_pattern.source)),this._disabled.smarty||t.push(this.__patterns.smarty._starting_pattern.source),this._until_pattern&&t.push(this._until_pattern.source),this.__template_pattern=this._input.get_regexp("(?:"+t.join("|")+")")},s.prototype._read_template=function(){var t="",e=this._input.peek();if("<"===e){var n=this._input.peek(1);this._disabled.php||this._excluded.php||"?"!==n||(t=t||this.__patterns.php.read()),this._disabled.erb||this._excluded.erb||"%"!==n||(t=t||this.__patterns.erb.read())}else"{"===e&&(this._disabled.handlebars||this._excluded.handlebars||(t=(t=(t=t||this.__patterns.handlebars_comment.read())||this.__patterns.handlebars_unescaped.read())||this.__patterns.handlebars.read()),this._disabled.django||(this._excluded.django||this._excluded.handlebars||(t=t||this.__patterns.django_value.read()),this._excluded.django||(t=(t=t||this.__patterns.django_comment.read())||this.__patterns.django.read())),this._disabled.smarty||this._disabled.django&&this._disabled.handlebars&&(t=(t=(t=t||this.__patterns.smarty_comment.read())||this.__patterns.smarty_literal.read())||this.__patterns.smarty.read()));return t},t.exports.TemplatablePattern=s}]),void 0===(n=function(){return{js_beautify:r}}.apply(e,[]))||(t.exports=n)},391:(t,e,n)=>{parcelRequire=function(e,r,i,s){var a,o="function"==typeof parcelRequire&&parcelRequire;function u(t,i){if(!r[t]){if(!e[t]){var s="function"==typeof parcelRequire&&parcelRequire;if(!i&&s)return s(t,!0);if(o)return o(t,!0);if("string"==typeof t)return n(784)(t);var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}_.resolve=function(n){return e[t][1][n]||n},_.cache={};var c=r[t]=new u.Module(t);e[t][0].call(c.exports,_,c,c.exports,this)}return r[t].exports;function _(t){return u(_.resolve(t))}}u.isParcelRequire=!0,u.Module=function(t){this.id=t,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=o,u.register=function(t,n){e[t]=[function(t,e){e.exports=n},{}]};for(var c=0;c<i.length;c++)try{u(i[c])}catch(e){a||(a=e)}if(i.length){var _=u(i[i.length-1]);t.exports=_}if(parcelRequire=u,a)throw a;return u}({EgBh:[function(t,e,n){var r={};r.useBlobBuilder=function(){try{return new Blob([]),!1}catch(t){return!0}}(),r.useArrayBufferView=!r.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(t){return!0}}(),e.exports.binaryFeatures=r;var i=e.exports.BlobBuilder;function s(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(i=e.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),s.prototype.append=function(t){"number"==typeof t?this._pieces.push(t):(this.flush(),this._parts.push(t))},s.prototype.flush=function(){if(this._pieces.length>0){var t=new Uint8Array(this._pieces);r.useArrayBufferView||(t=t.buffer),this._parts.push(t),this._pieces=[]}},s.prototype.getBuffer=function(){if(this.flush(),r.useBlobBuilder){for(var t=new i,e=0,n=this._parts.length;e<n;e++)t.append(this._parts[e]);return t.getBlob()}return new Blob(this._parts)},e.exports.BufferBuilder=s},{}],kdPp:[function(t,e,n){var r=t("./bufferbuilder").BufferBuilder,i=t("./bufferbuilder").binaryFeatures,s={unpack:function(t){return new a(t).unpack()},pack:function(t){var e=new o;return e.pack(t),e.getBuffer()}};function a(t){this.index=0,this.dataBuffer=t,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function o(){this.bufferBuilder=new r}function u(t){var e=t.charCodeAt(0);return e<=2047?"00":e<=65535?"000":e<=2097151?"0000":e<=67108863?"00000":"000000"}e.exports=s,a.prototype.unpack=function(){var t,e=this.unpack_uint8();if(e<128)return e;if((224^e)<32)return(224^e)-32;if((t=160^e)<=15)return this.unpack_raw(t);if((t=176^e)<=15)return this.unpack_string(t);if((t=144^e)<=15)return this.unpack_array(t);if((t=128^e)<=15)return this.unpack_map(t);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:case 213:case 214:case 215:return;case 216:return t=this.unpack_uint16(),this.unpack_string(t);case 217:return t=this.unpack_uint32(),this.unpack_string(t);case 218:return t=this.unpack_uint16(),this.unpack_raw(t);case 219:return t=this.unpack_uint32(),this.unpack_raw(t);case 220:return t=this.unpack_uint16(),this.unpack_array(t);case 221:return t=this.unpack_uint32(),this.unpack_array(t);case 222:return t=this.unpack_uint16(),this.unpack_map(t);case 223:return t=this.unpack_uint32(),this.unpack_map(t)}},a.prototype.unpack_uint8=function(){var t=255&this.dataView[this.index];return this.index++,t},a.prototype.unpack_uint16=function(){var t=this.read(2),e=256*(255&t[0])+(255&t[1]);return this.index+=2,e},a.prototype.unpack_uint32=function(){var t=this.read(4),e=256*(256*(256*t[0]+t[1])+t[2])+t[3];return this.index+=4,e},a.prototype.unpack_uint64=function(){var t=this.read(8),e=256*(256*(256*(256*(256*(256*(256*t[0]+t[1])+t[2])+t[3])+t[4])+t[5])+t[6])+t[7];return this.index+=8,e},a.prototype.unpack_int8=function(){var t=this.unpack_uint8();return t<128?t:t-256},a.prototype.unpack_int16=function(){var t=this.unpack_uint16();return t<32768?t:t-65536},a.prototype.unpack_int32=function(){var t=this.unpack_uint32();return t<Math.pow(2,31)?t:t-Math.pow(2,32)},a.prototype.unpack_int64=function(){var t=this.unpack_uint64();return t<Math.pow(2,63)?t:t-Math.pow(2,64)},a.prototype.unpack_raw=function(t){if(this.length<this.index+t)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+t+" "+this.length);var e=this.dataBuffer.slice(this.index,this.index+t);return this.index+=t,e},a.prototype.unpack_string=function(t){for(var e,n,r=this.read(t),i=0,s="";i<t;)(e=r[i])<128?(s+=String.fromCharCode(e),i++):(192^e)<32?(n=(192^e)<<6|63&r[i+1],s+=String.fromCharCode(n),i+=2):(n=(15&e)<<12|(63&r[i+1])<<6|63&r[i+2],s+=String.fromCharCode(n),i+=3);return this.index+=t,s},a.prototype.unpack_array=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=this.unpack();return e},a.prototype.unpack_map=function(t){for(var e={},n=0;n<t;n++){var r=this.unpack(),i=this.unpack();e[r]=i}return e},a.prototype.unpack_float=function(){var t=this.unpack_uint32(),e=(t>>23&255)-127;return(0==t>>31?1:-1)*(8388607&t|8388608)*Math.pow(2,e-23)},a.prototype.unpack_double=function(){var t=this.unpack_uint32(),e=this.unpack_uint32(),n=(t>>20&2047)-1023;return(0==t>>31?1:-1)*((1048575&t|1048576)*Math.pow(2,n-20)+e*Math.pow(2,n-52))},a.prototype.read=function(t){var e=this.index;if(e+t<=this.length)return this.dataView.subarray(e,e+t);throw new Error("BinaryPackFailure: read index out of range")},o.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},o.prototype.pack=function(t){var e=typeof t;if("string"===e)this.pack_string(t);else if("number"===e)Math.floor(t)===t?this.pack_integer(t):this.pack_double(t);else if("boolean"===e)!0===t?this.bufferBuilder.append(195):!1===t&&this.bufferBuilder.append(194);else if("undefined"===e)this.bufferBuilder.append(192);else{if("object"!==e)throw new Error('Type "'+e+'" not yet supported');if(null===t)this.bufferBuilder.append(192);else{var n=t.constructor;if(n==Array)this.pack_array(t);else if(n==Blob||n==File||t instanceof Blob||t instanceof File)this.pack_bin(t);else if(n==ArrayBuffer)i.useArrayBufferView?this.pack_bin(new Uint8Array(t)):this.pack_bin(t);else if("BYTES_PER_ELEMENT"in t)i.useArrayBufferView?this.pack_bin(new Uint8Array(t.buffer)):this.pack_bin(t.buffer);else if(n==Object||n.toString().startsWith("class"))this.pack_object(t);else if(n==Date)this.pack_string(t.toString());else{if("function"!=typeof t.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(t.toBinaryPack())}}}this.bufferBuilder.flush()},o.prototype.pack_bin=function(t){var e=t.length||t.byteLength||t.size;if(e<=15)this.pack_uint8(160+e);else if(e<=65535)this.bufferBuilder.append(218),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(e)}this.bufferBuilder.append(t)},o.prototype.pack_string=function(t){var e=function(t){return t.length>600?new Blob([t]).size:t.replace(/[^\u0000-\u007F]/g,u).length}(t);if(e<=15)this.pack_uint8(176+e);else if(e<=65535)this.bufferBuilder.append(216),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(e)}this.bufferBuilder.append(t)},o.prototype.pack_array=function(t){var e=t.length;if(e<=15)this.pack_uint8(144+e);else if(e<=65535)this.bufferBuilder.append(220),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(e)}for(var n=0;n<e;n++)this.pack(t[n])},o.prototype.pack_integer=function(t){if(t>=-32&&t<=127)this.bufferBuilder.append(255&t);else if(t>=0&&t<=255)this.bufferBuilder.append(204),this.pack_uint8(t);else if(t>=-128&&t<=127)this.bufferBuilder.append(208),this.pack_int8(t);else if(t>=0&&t<=65535)this.bufferBuilder.append(205),this.pack_uint16(t);else if(t>=-32768&&t<=32767)this.bufferBuilder.append(209),this.pack_int16(t);else if(t>=0&&t<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(t);else if(t>=-2147483648&&t<=2147483647)this.bufferBuilder.append(210),this.pack_int32(t);else if(t>=-0x8000000000000000&&t<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(t);else{if(!(t>=0&&t<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(t)}},o.prototype.pack_double=function(t){var e=0;t<0&&(e=1,t=-t);var n=Math.floor(Math.log(t)/Math.LN2),r=t/Math.pow(2,n)-1,i=Math.floor(r*Math.pow(2,52)),s=Math.pow(2,32),a=e<<31|n+1023<<20|i/s&1048575,o=i%s;this.bufferBuilder.append(203),this.pack_int32(a),this.pack_int32(o)},o.prototype.pack_object=function(t){var e=Object.keys(t).length;if(e<=15)this.pack_uint8(128+e);else if(e<=65535)this.bufferBuilder.append(222),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(e)}for(var n in t)t.hasOwnProperty(n)&&(this.pack(n),this.pack(t[n]))},o.prototype.pack_uint8=function(t){this.bufferBuilder.append(t)},o.prototype.pack_uint16=function(t){this.bufferBuilder.append(t>>8),this.bufferBuilder.append(255&t)},o.prototype.pack_uint32=function(t){var e=4294967295&t;this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},o.prototype.pack_uint64=function(t){var e=t/Math.pow(2,32),n=t%Math.pow(2,32);this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},o.prototype.pack_int8=function(t){this.bufferBuilder.append(255&t)},o.prototype.pack_int16=function(t){this.bufferBuilder.append((65280&t)>>8),this.bufferBuilder.append(255&t)},o.prototype.pack_int32=function(t){this.bufferBuilder.append(t>>>24&255),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},o.prototype.pack_int64=function(t){var e=Math.floor(t/Math.pow(2,32)),n=t%Math.pow(2,32);this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}},{"./bufferbuilder":"EgBh"}],iSxC:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.extractVersion=a,n.wrapPeerConnectionEvent=function(t,e,n){if(t.RTCPeerConnection){var r=t.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(t,r){if(t!==e)return i.apply(this,arguments);var s=function(t){var e=n(t);e&&r(e)};return this._eventMap=this._eventMap||{},this._eventMap[r]=s,i.apply(this,[t,s])};var s=r.removeEventListener;r.removeEventListener=function(t,n){if(t!==e||!this._eventMap||!this._eventMap[n])return s.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],s.apply(this,[t,r])},Object.defineProperty(r,"on"+e,{get:function(){return this["_on"+e]},set:function(t){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),t&&this.addEventListener(e,this["_on"+e]=t)},enumerable:!0,configurable:!0})}},n.disableLog=function(t){return"boolean"!=typeof t?new Error("Argument type: "+r(t)+". Please use a boolean."):(i=t,t?"adapter.js logging disabled":"adapter.js logging enabled")},n.disableWarnings=function(t){return"boolean"!=typeof t?new Error("Argument type: "+r(t)+". Please use a boolean."):(s=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))},n.log=function(){if("object"===("undefined"==typeof window?"undefined":r(window))){if(i)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},n.deprecated=function(t,e){s&&console.warn(t+" is deprecated, please use "+e+" instead.")},n.detectBrowser=function(t){var{navigator:e}=t,n={browser:null,version:null};if(void 0===t||!t.navigator)return n.browser="Not a browser.",n;if(e.mozGetUserMedia)n.browser="firefox",n.version=a(e.userAgent,/Firefox\/(\d+)\./,1);else if(e.webkitGetUserMedia||!1===t.isSecureContext&&t.webkitRTCPeerConnection&&!t.RTCIceGatherer)n.browser="chrome",n.version=a(e.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(e.mediaDevices&&e.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=a(e.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!t.RTCPeerConnection||!e.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=a(e.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype}return n},n.compactObject=function t(e){return o(e)?Object.keys(e).reduce((function(n,r){var i=o(e[r]),s=i?t(e[r]):e[r],a=i&&!Object.keys(s).length;return void 0===s||a?n:Object.assign(n,function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},r,s))}),{}):e},n.walkStats=u,n.filterStats=function(t,e,n){var r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===e)return i;var s=[];return t.forEach((function(t){"track"===t.type&&t.trackIdentifier===e.id&&s.push(t)})),s.forEach((function(e){t.forEach((function(n){n.type===r&&n.trackId===e.id&&u(t,n,i)}))})),i};var i=!0,s=!0;function a(t,e,n){var r=t.match(e);return r&&r.length>=n&&parseInt(r[n],10)}function o(t){return"[object Object]"===Object.prototype.toString.call(t)}function u(t,e,n){e&&!n.has(e.id)&&(n.set(e.id,e),Object.keys(e).forEach((function(r){r.endsWith("Id")?u(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach((function(e){u(t,t.get(e),n)}))})))}},{}],s6SN:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(t){var e=t&&t.navigator;if(e.mediaDevices){var n=r.detectBrowser(t),i=function(t){if("object"!==s(t)||t.mandatory||t.optional)return t;var e={};return Object.keys(t).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===s(t[n])?t[n]:{ideal:t[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(t,e){return t?t+e.charAt(0).toUpperCase()+e.slice(1):"deviceId"===e?"sourceId":e};if(void 0!==r.ideal){e.optional=e.optional||[];var a={};"number"==typeof r.ideal?(a[i("min",n)]=r.ideal,e.optional.push(a),(a={})[i("max",n)]=r.ideal,e.optional.push(a)):(a[i("",n)]=r.ideal,e.optional.push(a))}void 0!==r.exact&&"number"!=typeof r.exact?(e.mandatory=e.mandatory||{},e.mandatory[i("",n)]=r.exact):["min","max"].forEach((function(t){void 0!==r[t]&&(e.mandatory=e.mandatory||{},e.mandatory[i(t,n)]=r[t])}))}})),t.advanced&&(e.optional=(e.optional||[]).concat(t.advanced)),e},o=function(t,r){if(n.version>=61)return r(t);if((t=JSON.parse(JSON.stringify(t)))&&"object"===s(t.audio)){var o=function(t,e,n){e in t&&!(n in t)&&(t[n]=t[e],delete t[e])};o((t=JSON.parse(JSON.stringify(t))).audio,"autoGainControl","googAutoGainControl"),o(t.audio,"noiseSuppression","googNoiseSuppression"),t.audio=i(t.audio)}if(t&&"object"===s(t.video)){var u=t.video.facingMode;u=u&&("object"===s(u)?u:{ideal:u});var c,_=n.version<66;if(u&&("user"===u.exact||"environment"===u.exact||"user"===u.ideal||"environment"===u.ideal)&&(!e.mediaDevices.getSupportedConstraints||!e.mediaDevices.getSupportedConstraints().facingMode||_)&&(delete t.video.facingMode,"environment"===u.exact||"environment"===u.ideal?c=["back","rear"]:"user"!==u.exact&&"user"!==u.ideal||(c=["front"]),c))return e.mediaDevices.enumerateDevices().then((function(e){var n=(e=e.filter((function(t){return"videoinput"===t.kind}))).find((function(t){return c.some((function(e){return t.label.toLowerCase().includes(e)}))}));return!n&&e.length&&c.includes("back")&&(n=e[e.length-1]),n&&(t.video.deviceId=u.exact?{exact:n.deviceId}:{ideal:n.deviceId}),t.video=i(t.video),a("chrome: "+JSON.stringify(t)),r(t)}));t.video=i(t.video)}return a("chrome: "+JSON.stringify(t)),r(t)},u=function(t){return n.version>=64?t:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[t.name]||t.name,message:t.message,constraint:t.constraint||t.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(e.getUserMedia=function(t,n,r){o(t,(function(t){e.webkitGetUserMedia(t,n,(function(t){r&&r(u(t))}))}))}.bind(e),e.mediaDevices.getUserMedia){var c=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(t){return o(t,(function(t){return c(t).then((function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((function(t){t.stop()})),new DOMException("","NotFoundError");return e}),(function(t){return Promise.reject(u(t))}))}))}}}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var a=r?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}return n.default=t,e&&e.set(t,n),n}(t("../utils.js"));function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a=r.log},{"../utils.js":"iSxC"}],VHa8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&("function"==typeof e?t.navigator.mediaDevices.getDisplayMedia=function(n){return e(n).then((function(e){var r=n.video&&n.video.width,i=n.video&&n.video.height,s=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:s||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),t.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],uI5X:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimMediaStream=function(t){t.MediaStream=t.MediaStream||t.webkitMediaStream},n.shimOnTrack=function(t){if("object"!==u(t)||!t.RTCPeerConnection||"ontrack"in t.RTCPeerConnection.prototype)r.wrapPeerConnectionEvent(t,"track",(function(t){return t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t}));else{Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});var e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(e){e.stream.addEventListener("addtrack",(function(r){var i;i=t.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(t){return t.track&&t.track.id===r.track.id})):{track:r.track};var s=new Event("track");s.track=r.track,s.receiver=i,s.transceiver={receiver:i},s.streams=[e.stream],n.dispatchEvent(s)})),e.stream.getTracks().forEach((function(r){var i;i=t.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(t){return t.track&&t.track.id===r.id})):{track:r};var s=new Event("track");s.track=r,s.receiver=i,s.transceiver={receiver:i},s.streams=[e.stream],n.dispatchEvent(s)}))},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}},n.shimGetSendersWithDtmf=function(t){if("object"===u(t)&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){var e=function(t,e){return{track:e,get dtmf(){return void 0===this._dtmf&&("audio"===e.kind?this._dtmf=t.createDTMFSender(e):this._dtmf=null),this._dtmf},_pc:t}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(t,r){var i=n.apply(this,arguments);return i||(i=e(this,t),this._senders.push(i)),i};var r=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(t){r.apply(this,arguments);var e=this._senders.indexOf(t);-1!==e&&this._senders.splice(e,1)}}var i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(t){var n=this;this._senders=this._senders||[],i.apply(this,[t]),t.getTracks().forEach((function(t){n._senders.push(e(n,t))}))};var s=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(t){var e=this;this._senders=this._senders||[],s.apply(this,[t]),t.getTracks().forEach((function(t){var n=e._senders.find((function(e){return e.track===t}));n&&e._senders.splice(e._senders.indexOf(n),1)}))}}else if("object"===u(t)&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){var a=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=a.apply(this,[]);return e.forEach((function(e){return e._pc=t})),e},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},n.shimGetStats=function(t){if(t.RTCPeerConnection){var e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){var t=this,[n,r,i]=arguments;if(arguments.length>0&&"function"==typeof n)return e.apply(this,arguments);if(0===e.length&&(0===arguments.length||"function"!=typeof n))return e.apply(this,[]);var s=function(t){var e={};return t.result().forEach((function(t){var n={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach((function(e){n[e]=t.stat(e)})),e[n.id]=n})),e},a=function(t){return new Map(Object.keys(t).map((function(e){return[e,t[e]]})))};return arguments.length>=2?e.apply(this,[function(t){r(a(s(t)))},n]):new Promise((function(n,r){e.apply(t,[function(t){n(a(s(t)))},r])})).then(r,i)}}},n.shimSenderReceiverGetStats=function(t){if("object"===u(t)&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver){if(!("getStats"in t.RTCRtpSender.prototype)){var e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){var t=this,n=e.apply(this,[]);return n.forEach((function(e){return e._pc=t})),n});var n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){var t=n.apply(this,arguments);return t._pc=this,t}),t.RTCRtpSender.prototype.getStats=function(){var t=this;return this._pc.getStats().then((function(e){return r.filterStats(e,t.track,!0)}))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){var i=t.RTCPeerConnection.prototype.getReceivers;i&&(t.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=i.apply(this,[]);return e.forEach((function(e){return e._pc=t})),e}),r.wrapPeerConnectionEvent(t,"track",(function(t){return t.receiver._pc=t.srcElement,t})),t.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this._pc.getStats().then((function(e){return r.filterStats(e,t.track,!1)}))}}if("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype){var s=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){var e,n,r,i=arguments[0];return this.getSenders().forEach((function(t){t.track===i&&(e?r=!0:e=t)})),this.getReceivers().forEach((function(t){return t.track===i&&(n?r=!0:n=t),t.track===i})),r||e&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):e?e.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return s.apply(this,arguments)}}}},n.shimAddTrackRemoveTrackWithNative=c,n.shimAddTrackRemoveTrack=function(t){if(t.RTCPeerConnection){var e=r.detectBrowser(t);if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return c(t);var n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this,e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((function(e){return t._reverseStreams[e.id]}))};var i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(e){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},e.getTracks().forEach((function(t){if(n.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[e.id]){var r=new t.MediaStream(e.getTracks());this._streams[e.id]=r,this._reverseStreams[r.id]=e,e=r}i.apply(this,[e])};var s=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(t){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[t.id]||t]),delete this._reverseStreams[this._streams[t.id]?this._streams[t.id].id:t.id],delete this._streams[t.id]},t.RTCPeerConnection.prototype.addTrack=function(e,n){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(t){return t===e})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var s=this._streams[n.id];if(s)s.addTrack(e),Promise.resolve().then((function(){r.dispatchEvent(new Event("negotiationneeded"))}));else{var a=new t.MediaStream([e]);this._streams[n.id]=a,this._reverseStreams[a.id]=n,this.addStream(a)}return this.getSenders().find((function(t){return t.track===e}))},["createOffer","createAnswer"].forEach((function(e){var n=t.RTCPeerConnection.prototype[e],r=o({},e,(function(){var t=this,e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[function(n){var r=_(t,n);e[0].apply(null,[r])},function(t){e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((function(e){return _(t,e)}))}));t.RTCPeerConnection.prototype[e]=r[e]}));var a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(t=this,n=(e=arguments[0]).sdp,Object.keys(t._reverseStreams||[]).forEach((function(e){var r=t._reverseStreams[e],i=t._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:e.type,sdp:n})),a.apply(this,arguments)):a.apply(this,arguments);var t,e,n};var u=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get:function(){var t=u.get.apply(this);return""===t.type?t:_(this,t)}}),t.RTCPeerConnection.prototype.removeTrack=function(t){var e,n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(t._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(r){n._streams[r].getTracks().find((function(e){return t.track===e}))&&(e=n._streams[r])})),e&&(1===e.getTracks().length?this.removeStream(this._reverseStreams[e.id]):e.removeTrack(t.track),this.dispatchEvent(new Event("negotiationneeded")))}}function _(t,e){var n=e.sdp;return Object.keys(t._reverseStreams||[]).forEach((function(e){var r=t._reverseStreams[e],i=t._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:e.type,sdp:n})}},n.shimPeerConnection=function(t){var e=r.detectBrowser(t);if(!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection){e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(e){var n=t.RTCPeerConnection.prototype[e],r=o({},e,(function(){return arguments[0]=new("addIceCandidate"===e?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));t.RTCPeerConnection.prototype[e]=r[e]}));var n=t.RTCPeerConnection.prototype.addIceCandidate;t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},n.fixNegotiationNeeded=function(t){r.wrapPeerConnectionEvent(t,"negotiationneeded",(function(t){if("stable"===t.target.signalingState)return t}))},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}});var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("../utils.js")),i=t("./getusermedia"),s=t("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(e){return t._shimmedLocalStreams[e][0]}))};var e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(t,n){if(!n)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=e.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(t){var e=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},t.getTracks().forEach((function(t){if(e.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError")}));var r=this.getSenders();n.apply(this,arguments);var i=this.getSenders().filter((function(t){return-1===r.indexOf(t)}));this._shimmedLocalStreams[t.id]=[t].concat(i)};var r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(t){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[t.id],r.apply(this,arguments)};var i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(t){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},t&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var r=e._shimmedLocalStreams[n].indexOf(t);-1!==r&&e._shimmedLocalStreams[n].splice(r,1),1===e._shimmedLocalStreams[n].length&&delete e._shimmedLocalStreams[n]})),i.apply(this,arguments)}}},{"../utils.js":"iSxC","./getusermedia":"s6SN","./getdisplaymedia":"VHa8"}],NZ1C:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(t,e){var n=!1;return(t=JSON.parse(JSON.stringify(t))).filter((function(t){if(t&&(t.urls||t.url)){var e=t.urls||t.url;t.url&&!t.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var i="string"==typeof e;return i&&(e=[e]),e=e.filter((function(t){if(0===t.indexOf("stun:"))return!1;var e=t.startsWith("turn")&&!t.startsWith("turn:[")&&t.includes("transport=udp");return e&&!n?(n=!0,!0):e&&!n})),delete t.url,t.urls=i?e[0]:e,!!e.length}}))};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var a=r?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}return n.default=t,e&&e.set(t,n),n}(t("../utils"));function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}},{"../utils":"iSxC"}],YHvh:[function(t,e,n){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(t){return t.trim().split("\n").map((function(t){return t.trim()}))},r.splitSections=function(t){return t.split("\nm=").map((function(t,e){return(e>0?"m="+t:t).trim()+"\r\n"}))},r.getDescription=function(t){var e=r.splitSections(t);return e&&e[0]},r.getMediaSections=function(t){var e=r.splitSections(t);return e.shift(),e},r.matchPrefix=function(t,e){return r.splitLines(t).filter((function(t){return 0===t.indexOf(e)}))},r.parseCandidate=function(t){for(var e,n={foundation:(e=0===t.indexOf("a=candidate:")?t.substring(12).split(" "):t.substring(10).split(" "))[0],component:parseInt(e[1],10),protocol:e[2].toLowerCase(),priority:parseInt(e[3],10),ip:e[4],address:e[4],port:parseInt(e[5],10),type:e[7]},r=8;r<e.length;r+=2)switch(e[r]){case"raddr":n.relatedAddress=e[r+1];break;case"rport":n.relatedPort=parseInt(e[r+1],10);break;case"tcptype":n.tcpType=e[r+1];break;case"ufrag":n.ufrag=e[r+1],n.usernameFragment=e[r+1];break;default:n[e[r]]=e[r+1]}return n},r.writeCandidate=function(t){var e=[];e.push(t.foundation),e.push(t.component),e.push(t.protocol.toUpperCase()),e.push(t.priority),e.push(t.address||t.ip),e.push(t.port);var n=t.type;return e.push("typ"),e.push(n),"host"!==n&&t.relatedAddress&&t.relatedPort&&(e.push("raddr"),e.push(t.relatedAddress),e.push("rport"),e.push(t.relatedPort)),t.tcpType&&"tcp"===t.protocol.toLowerCase()&&(e.push("tcptype"),e.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(e.push("ufrag"),e.push(t.usernameFragment||t.ufrag)),"candidate:"+e.join(" ")},r.parseIceOptions=function(t){return t.substr(14).split(" ")},r.parseRtpMap=function(t){var e=t.substr(9).split(" "),n={payloadType:parseInt(e.shift(),10)};return e=e[0].split("/"),n.name=e[0],n.clockRate=parseInt(e[1],10),n.channels=3===e.length?parseInt(e[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(t){var e=t.payloadType;void 0!==t.preferredPayloadType&&(e=t.preferredPayloadType);var n=t.channels||t.numChannels||1;return"a=rtpmap:"+e+" "+t.name+"/"+t.clockRate+(1!==n?"/"+n:"")+"\r\n"},r.parseExtmap=function(t){var e=t.substr(9).split(" ");return{id:parseInt(e[0],10),direction:e[0].indexOf("/")>0?e[0].split("/")[1]:"sendrecv",uri:e[1]}},r.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&"sendrecv"!==t.direction?"/"+t.direction:"")+" "+t.uri+"\r\n"},r.parseFmtp=function(t){for(var e,n={},r=t.substr(t.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(e=r[i].trim().split("="))[0].trim()]=e[1];return n},r.writeFmtp=function(t){var e="",n=t.payloadType;if(void 0!==t.preferredPayloadType&&(n=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){var r=[];Object.keys(t.parameters).forEach((function(e){t.parameters[e]?r.push(e+"="+t.parameters[e]):r.push(e)})),e+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return e},r.parseRtcpFb=function(t){var e=t.substr(t.indexOf(" ")+1).split(" ");return{type:e.shift(),parameter:e.join(" ")}},r.writeRtcpFb=function(t){var e="",n=t.payloadType;return void 0!==t.preferredPayloadType&&(n=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach((function(t){e+="a=rtcp-fb:"+n+" "+t.type+(t.parameter&&t.parameter.length?" "+t.parameter:"")+"\r\n"})),e},r.parseSsrcMedia=function(t){var e=t.indexOf(" "),n={ssrc:parseInt(t.substr(7,e-7),10)},r=t.indexOf(":",e);return r>-1?(n.attribute=t.substr(e+1,r-e-1),n.value=t.substr(r+1)):n.attribute=t.substr(e+1),n},r.parseSsrcGroup=function(t){var e=t.substr(13).split(" ");return{semantics:e.shift(),ssrcs:e.map((function(t){return parseInt(t,10)}))}},r.getMid=function(t){var e=r.matchPrefix(t,"a=mid:")[0];if(e)return e.substr(6)},r.parseFingerprint=function(t){var e=t.substr(14).split(" ");return{algorithm:e[0].toLowerCase(),value:e[1]}},r.getDtlsParameters=function(t,e){return{role:"auto",fingerprints:r.matchPrefix(t+e,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(t,e){var n="a=setup:"+e+"\r\n";return t.fingerprints.forEach((function(t){n+="a=fingerprint:"+t.algorithm+" "+t.value+"\r\n"})),n},r.getIceParameters=function(t,e){var n=r.splitLines(t);return{usernameFragment:(n=n.concat(r.splitLines(e))).filter((function(t){return 0===t.indexOf("a=ice-ufrag:")}))[0].substr(12),password:n.filter((function(t){return 0===t.indexOf("a=ice-pwd:")}))[0].substr(10)}},r.writeIceParameters=function(t){return"a=ice-ufrag:"+t.usernameFragment+"\r\na=ice-pwd:"+t.password+"\r\n"},r.parseRtpParameters=function(t){for(var e={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(t)[0].split(" "),i=3;i<n.length;i++){var s=n[i],a=r.matchPrefix(t,"a=rtpmap:"+s+" ")[0];if(a){var o=r.parseRtpMap(a),u=r.matchPrefix(t,"a=fmtp:"+s+" ");switch(o.parameters=u.length?r.parseFmtp(u[0]):{},o.rtcpFeedback=r.matchPrefix(t,"a=rtcp-fb:"+s+" ").map(r.parseRtcpFb),e.codecs.push(o),o.name.toUpperCase()){case"RED":case"ULPFEC":e.fecMechanisms.push(o.name.toUpperCase())}}}return r.matchPrefix(t,"a=extmap:").forEach((function(t){e.headerExtensions.push(r.parseExtmap(t))})),e},r.writeRtpDescription=function(t,e){var n="";n+="m="+t+" ",n+=e.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=e.codecs.map((function(t){return void 0!==t.preferredPayloadType?t.preferredPayloadType:t.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",e.codecs.forEach((function(t){n+=r.writeRtpMap(t),n+=r.writeFmtp(t),n+=r.writeRtcpFb(t)}));var i=0;return e.codecs.forEach((function(t){t.maxptime>i&&(i=t.maxptime)})),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",e.headerExtensions&&e.headerExtensions.forEach((function(t){n+=r.writeExtmap(t)})),n},r.parseRtpEncodingParameters=function(t){var e,n=[],i=r.parseRtpParameters(t),s=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),o=r.matchPrefix(t,"a=ssrc:").map((function(t){return r.parseSsrcMedia(t)})).filter((function(t){return"cname"===t.attribute})),u=o.length>0&&o[0].ssrc,c=r.matchPrefix(t,"a=ssrc-group:FID").map((function(t){return t.substr(17).split(" ").map((function(t){return parseInt(t,10)}))}));c.length>0&&c[0].length>1&&c[0][0]===u&&(e=c[0][1]),i.codecs.forEach((function(t){if("RTX"===t.name.toUpperCase()&&t.parameters.apt){var r={ssrc:u,codecPayloadType:parseInt(t.parameters.apt,10)};u&&e&&(r.rtx={ssrc:e}),n.push(r),s&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:u,mechanism:a?"red+ulpfec":"red"},n.push(r))}})),0===n.length&&u&&n.push({ssrc:u});var _=r.matchPrefix(t,"b=");return _.length&&(_=0===_[0].indexOf("b=TIAS:")?parseInt(_[0].substr(7),10):0===_[0].indexOf("b=AS:")?1e3*parseInt(_[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(t){t.maxBitrate=_}))),n},r.parseRtcpParameters=function(t){var e={},n=r.matchPrefix(t,"a=ssrc:").map((function(t){return r.parseSsrcMedia(t)})).filter((function(t){return"cname"===t.attribute}))[0];n&&(e.cname=n.value,e.ssrc=n.ssrc);var i=r.matchPrefix(t,"a=rtcp-rsize");e.reducedSize=i.length>0,e.compound=0===i.length;var s=r.matchPrefix(t,"a=rtcp-mux");return e.mux=s.length>0,e},r.parseMsid=function(t){var e,n=r.matchPrefix(t,"a=msid:");if(1===n.length)return{stream:(e=n[0].substr(7).split(" "))[0],track:e[1]};var i=r.matchPrefix(t,"a=ssrc:").map((function(t){return r.parseSsrcMedia(t)})).filter((function(t){return"msid"===t.attribute}));return i.length>0?{stream:(e=i[0].value.split(" "))[0],track:e[1]}:void 0},r.parseSctpDescription=function(t){var e,n=r.parseMLine(t),i=r.matchPrefix(t,"a=max-message-size:");i.length>0&&(e=parseInt(i[0].substr(19),10)),isNaN(e)&&(e=65536);var s=r.matchPrefix(t,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substr(12),10),protocol:n.fmt,maxMessageSize:e};if(r.matchPrefix(t,"a=sctpmap:").length>0){var a=r.matchPrefix(t,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:e}}},r.writeSctpDescription=function(t,e){var n=[];return n="DTLS/SCTP"!==t.protocol?["m="+t.kind+" 9 "+t.protocol+" "+e.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+e.port+"\r\n"]:["m="+t.kind+" 9 "+t.protocol+" "+e.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+e.port+" "+e.protocol+" 65535\r\n"],void 0!==e.maxMessageSize&&n.push("a=max-message-size:"+e.maxMessageSize+"\r\n"),n.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(t,e,n){var i=void 0!==e?e:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(t||r.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(t,e,n,i){var s=r.writeRtpDescription(t.kind,e);if(s+=r.writeIceParameters(t.iceGatherer.getLocalParameters()),s+=r.writeDtlsParameters(t.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),s+="a=mid:"+t.mid+"\r\n",t.direction?s+="a="+t.direction+"\r\n":t.rtpSender&&t.rtpReceiver?s+="a=sendrecv\r\n":t.rtpSender?s+="a=sendonly\r\n":t.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",t.rtpSender){var a="msid:"+i.id+" "+t.rtpSender.track.id+"\r\n";s+="a="+a,s+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" "+a,t.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" "+a,s+="a=ssrc-group:FID "+t.sendEncodingParameters[0].ssrc+" "+t.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",t.rtpSender&&t.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),s},r.getDirection=function(t,e){for(var n=r.splitLines(t),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return e?r.getDirection(e):"sendrecv"},r.getKind=function(t){return r.splitLines(t)[0].split(" ")[0].substr(2)},r.isRejected=function(t){return"0"===t.split(" ",2)[1]},r.parseMLine=function(t){var e=r.splitLines(t)[0].substr(2).split(" ");return{kind:e[0],port:parseInt(e[1],10),protocol:e[2],fmt:e.slice(3).join(" ")}},r.parseOLine=function(t){var e=r.matchPrefix(t,"o=")[0].substr(2).split(" ");return{username:e[0],sessionId:e[1],sessionVersion:parseInt(e[2],10),netType:e[3],addressType:e[4],address:e[5]}},r.isValidSDP=function(t){if("string"!=typeof t||0===t.length)return!1;for(var e=r.splitLines(t),n=0;n<e.length;n++)if(e[n].length<2||"="!==e[n].charAt(1))return!1;return!0},"object"==typeof e&&(e.exports=r)},{}],NJ2u:[function(t,e,n){"use strict";var r=t("sdp");function i(t,e,n,i,s){var a=r.writeRtpDescription(t.kind,e);if(a+=r.writeIceParameters(t.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(t.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":s||"active"),a+="a=mid:"+t.mid+"\r\n",t.rtpSender&&t.rtpReceiver?a+="a=sendrecv\r\n":t.rtpSender?a+="a=sendonly\r\n":t.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",t.rtpSender){var o=t.rtpSender._initialTrackId||t.rtpSender.track.id;t.rtpSender._initialTrackId=o;var u="msid:"+(i?i.id:"-")+" "+o+"\r\n";a+="a="+u,a+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" "+u,t.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" "+u,a+="a=ssrc-group:FID "+t.sendEncodingParameters[0].ssrc+" "+t.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",t.rtpSender&&t.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),a}function s(t,e){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(t,e){t=parseInt(t,10);for(var n=0;n<e.length;n++)if(e[n].payloadType===t||e[n].preferredPayloadType===t)return e[n]},i=function(t,e,n,i){var s=r(t.parameters.apt,n),a=r(e.parameters.apt,i);return s&&a&&s.name.toLowerCase()===a.name.toLowerCase()};return t.codecs.forEach((function(r){for(var s=0;s<e.codecs.length;s++){var a=e.codecs[s];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&a.parameters.apt&&!i(r,a,t.codecs,e.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(t){for(var e=0;e<r.rtcpFeedback.length;e++)if(r.rtcpFeedback[e].type===t.type&&r.rtcpFeedback[e].parameter===t.parameter)return!0;return!1}));break}}})),t.headerExtensions.forEach((function(t){for(var r=0;r<e.headerExtensions.length;r++){var i=e.headerExtensions[r];if(t.uri===i.uri){n.headerExtensions.push(i);break}}})),n}function a(t,e,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[e][t].indexOf(n)}function o(t,e){var n=t.getRemoteCandidates().find((function(t){return e.foundation===t.foundation&&e.ip===t.ip&&e.port===t.port&&e.priority===t.priority&&e.protocol===t.protocol&&e.type===t.type}));return n||t.addRemoteCandidate(e),!n}function u(t,e){var n=new Error(e);return n.name=t,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[t],n}e.exports=function(t,e){function n(e,n){n.addTrack(e),n.dispatchEvent(new t.MediaStreamTrackEvent("addtrack",{track:e}))}function c(e,n,r,i){var s=new Event("track");s.track=n,s.receiver=r,s.transceiver={receiver:r},s.streams=i,t.setTimeout((function(){e._dispatchEvent("track",s)}))}var _=function(n){var i=this,s=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(t){i[t]=s[t].bind(s)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw u("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(t,e){var n=!1;return(t=JSON.parse(JSON.stringify(t))).filter((function(t){if(t&&(t.urls||t.url)){var r=t.urls||t.url;t.url&&!t.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter((function(t){return 0!==t.indexOf("turn:")||-1===t.indexOf("transport=udp")||-1!==t.indexOf("turn:[")||n?0===t.indexOf("stun:")&&e>=14393&&-1===t.indexOf("?transport=udp"):(n=!0,!0)})),delete t.url,t.urls=i?r[0]:r,!!r.length}}))}(n.iceServers||[],e),this._iceGatherers=[],n.iceCandidatePoolSize)for(var a=n.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new t.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(_.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(_.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),_.prototype.onicecandidate=null,_.prototype.onaddstream=null,_.prototype.ontrack=null,_.prototype.onremovestream=null,_.prototype.onsignalingstatechange=null,_.prototype.oniceconnectionstatechange=null,_.prototype.onconnectionstatechange=null,_.prototype.onicegatheringstatechange=null,_.prototype.onnegotiationneeded=null,_.prototype.ondatachannel=null,_.prototype._dispatchEvent=function(t,e){this._isClosed||(this.dispatchEvent(e),"function"==typeof this["on"+t]&&this["on"+t](e))},_.prototype._emitGatheringStateChange=function(){var t=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",t)},_.prototype.getConfiguration=function(){return this._config},_.prototype.getLocalStreams=function(){return this.localStreams},_.prototype.getRemoteStreams=function(){return this.remoteStreams},_.prototype._createTransceiver=function(t,e){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:t,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return e||this.transceivers.push(r),r},_.prototype.addTrack=function(e,n){if(this._isClosed)throw u("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(t){return t.track===e})))throw u("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==e.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(e.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=e,r.stream=n,r.rtpSender=new t.RTCRtpSender(e,r.dtlsTransport),r.rtpSender},_.prototype.addStream=function(t){var n=this;if(e>=15025)t.getTracks().forEach((function(e){n.addTrack(e,t)}));else{var r=t.clone();t.getTracks().forEach((function(t,e){var n=r.getTracks()[e];t.addEventListener("enabled",(function(t){n.enabled=t.enabled}))})),r.getTracks().forEach((function(t){n.addTrack(t,r)}))}},_.prototype.removeTrack=function(e){if(this._isClosed)throw u("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(e instanceof t.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(t){return t.rtpSender===e}));if(!n)throw u("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(t){return t.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},_.prototype.removeStream=function(t){var e=this;t.getTracks().forEach((function(t){var n=e.getSenders().find((function(e){return e.track===t}));n&&e.removeTrack(n)}))},_.prototype.getSenders=function(){return this.transceivers.filter((function(t){return!!t.rtpSender})).map((function(t){return t.rtpSender}))},_.prototype.getReceivers=function(){return this.transceivers.filter((function(t){return!!t.rtpReceiver})).map((function(t){return t.rtpReceiver}))},_.prototype._createIceGatherer=function(e,n){var r=this;if(n&&e>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new t.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[e].bufferedCandidateEvents=[],this.transceivers[e].bufferCandidates=function(t){var n=!t.candidate||0===Object.keys(t.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[e].bufferedCandidateEvents&&r.transceivers[e].bufferedCandidateEvents.push(t)},i.addEventListener("localcandidate",this.transceivers[e].bufferCandidates),i},_.prototype._gather=function(e,n){var i=this,s=this.transceivers[n].iceGatherer;if(!s.onlocalcandidate){var a=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,s.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),s.onlocalcandidate=function(t){if(!(i.usingBundle&&n>0)){var a=new Event("icecandidate");a.candidate={sdpMid:e,sdpMLineIndex:n};var o=t.candidate,u=!o||0===Object.keys(o).length;if(u)"new"!==s.state&&"gathering"!==s.state||(s.state="completed");else{"new"===s.state&&(s.state="gathering"),o.component=1,o.ufrag=s.getLocalParameters().usernameFragment;var c=r.writeCandidate(o);a.candidate=Object.assign(a.candidate,r.parseCandidate(c)),a.candidate.candidate=c,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var _=r.getMediaSections(i._localDescription.sdp);_[a.candidate.sdpMLineIndex]+=u?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+_.join("");var p=i.transceivers.every((function(t){return t.iceGatherer&&"completed"===t.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),u||i._dispatchEvent("icecandidate",a),p&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},t.setTimeout((function(){a.forEach((function(t){s.onlocalcandidate(t)}))}),0)}},_.prototype._createIceAndDtlsTransports=function(){var e=this,n=new t.RTCIceTransport(null);n.onicestatechange=function(){e._updateIceConnectionState(),e._updateConnectionState()};var r=new t.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){e._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),e._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},_.prototype._disposeIceAndDtlsTransports=function(t){var e=this.transceivers[t].iceGatherer;e&&(delete e.onlocalcandidate,delete this.transceivers[t].iceGatherer);var n=this.transceivers[t].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[t].iceTransport);var r=this.transceivers[t].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[t].dtlsTransport)},_.prototype._transceive=function(t,n,i){var a=s(t.localCapabilities,t.remoteCapabilities);n&&t.rtpSender&&(a.encodings=t.sendEncodingParameters,a.rtcp={cname:r.localCName,compound:t.rtcpParameters.compound},t.recvEncodingParameters.length&&(a.rtcp.ssrc=t.recvEncodingParameters[0].ssrc),t.rtpSender.send(a)),i&&t.rtpReceiver&&a.codecs.length>0&&("video"===t.kind&&t.recvEncodingParameters&&e<15019&&t.recvEncodingParameters.forEach((function(t){delete t.rtx})),t.recvEncodingParameters.length?a.encodings=t.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:t.rtcpParameters.compound},t.rtcpParameters.cname&&(a.rtcp.cname=t.rtcpParameters.cname),t.sendEncodingParameters.length&&(a.rtcp.ssrc=t.sendEncodingParameters[0].ssrc),t.rtpReceiver.receive(a))},_.prototype.setLocalDescription=function(t){var e,n,i=this;if(-1===["offer","answer"].indexOf(t.type))return Promise.reject(u("TypeError",'Unsupported type "'+t.type+'"'));if(!a("setLocalDescription",t.type,i.signalingState)||i._isClosed)return Promise.reject(u("InvalidStateError","Can not set local "+t.type+" in state "+i.signalingState));if("offer"===t.type)e=r.splitSections(t.sdp),n=e.shift(),e.forEach((function(t,e){var n=r.parseRtpParameters(t);i.transceivers[e].localCapabilities=n})),i.transceivers.forEach((function(t,e){i._gather(t.mid,e)}));else if("answer"===t.type){e=r.splitSections(i._remoteDescription.sdp),n=e.shift();var o=r.matchPrefix(n,"a=ice-lite").length>0;e.forEach((function(t,e){var a=i.transceivers[e],u=a.iceGatherer,c=a.iceTransport,_=a.dtlsTransport,p=a.localCapabilities,h=a.remoteCapabilities;if(!(r.isRejected(t)&&0===r.matchPrefix(t,"a=bundle-only").length||a.rejected)){var l=r.getIceParameters(t,n),d=r.getDtlsParameters(t,n);o&&(d.role="server"),i.usingBundle&&0!==e||(i._gather(a.mid,e),"new"===c.state&&c.start(u,l,o?"controlling":"controlled"),"new"===_.state&&_.start(d));var f=s(p,h);i._transceive(a,f.codecs.length>0,!1)}}))}return i._localDescription={type:t.type,sdp:t.sdp},"offer"===t.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},_.prototype.setRemoteDescription=function(i){var _=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(u("TypeError",'Unsupported type "'+i.type+'"'));if(!a("setRemoteDescription",i.type,_.signalingState)||_._isClosed)return Promise.reject(u("InvalidStateError","Can not set remote "+i.type+" in state "+_.signalingState));var p={};_.remoteStreams.forEach((function(t){p[t.id]=t}));var h=[],l=r.splitSections(i.sdp),d=l.shift(),f=r.matchPrefix(d,"a=ice-lite").length>0,m=r.matchPrefix(d,"a=group:BUNDLE ").length>0;_.usingBundle=m;var g=r.matchPrefix(d,"a=ice-options:")[0];return _.canTrickleIceCandidates=!!g&&g.substr(14).split(" ").indexOf("trickle")>=0,l.forEach((function(a,u){var c=r.splitLines(a),l=r.getKind(a),g=r.isRejected(a)&&0===r.matchPrefix(a,"a=bundle-only").length,v=c[0].substr(2).split(" ")[2],y=r.getDirection(a,d),b=r.parseMsid(a),w=r.getMid(a)||r.generateIdentifier();if(g||"application"===l&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))_.transceivers[u]={mid:w,kind:l,protocol:v,rejected:!0};else{var k,x,T,S,C,M,E,P,R;!g&&_.transceivers[u]&&_.transceivers[u].rejected&&(_.transceivers[u]=_._createTransceiver(l,!0));var O,j,D=r.parseRtpParameters(a);g||(O=r.getIceParameters(a,d),(j=r.getDtlsParameters(a,d)).role="client"),E=r.parseRtpEncodingParameters(a);var A=r.parseRtcpParameters(a),L=r.matchPrefix(a,"a=end-of-candidates",d).length>0,I=r.matchPrefix(a,"a=candidate:").map((function(t){return r.parseCandidate(t)})).filter((function(t){return 1===t.component}));if(("offer"===i.type||"answer"===i.type)&&!g&&m&&u>0&&_.transceivers[u]&&(_._disposeIceAndDtlsTransports(u),_.transceivers[u].iceGatherer=_.transceivers[0].iceGatherer,_.transceivers[u].iceTransport=_.transceivers[0].iceTransport,_.transceivers[u].dtlsTransport=_.transceivers[0].dtlsTransport,_.transceivers[u].rtpSender&&_.transceivers[u].rtpSender.setTransport(_.transceivers[0].dtlsTransport),_.transceivers[u].rtpReceiver&&_.transceivers[u].rtpReceiver.setTransport(_.transceivers[0].dtlsTransport)),"offer"!==i.type||g)"answer"!==i.type||g||(x=(k=_.transceivers[u]).iceGatherer,T=k.iceTransport,S=k.dtlsTransport,C=k.rtpReceiver,M=k.sendEncodingParameters,P=k.localCapabilities,_.transceivers[u].recvEncodingParameters=E,_.transceivers[u].remoteCapabilities=D,_.transceivers[u].rtcpParameters=A,I.length&&"new"===T.state&&(!f&&!L||m&&0!==u?I.forEach((function(t){o(k.iceTransport,t)})):T.setRemoteCandidates(I)),m&&0!==u||("new"===T.state&&T.start(x,O,"controlling"),"new"===S.state&&S.start(j)),!s(k.localCapabilities,k.remoteCapabilities).codecs.filter((function(t){return"rtx"===t.name.toLowerCase()})).length&&k.sendEncodingParameters[0].rtx&&delete k.sendEncodingParameters[0].rtx,_._transceive(k,"sendrecv"===y||"recvonly"===y,"sendrecv"===y||"sendonly"===y),!C||"sendrecv"!==y&&"sendonly"!==y?delete k.rtpReceiver:(R=C.track,b?(p[b.stream]||(p[b.stream]=new t.MediaStream),n(R,p[b.stream]),h.push([R,C,p[b.stream]])):(p.default||(p.default=new t.MediaStream),n(R,p.default),h.push([R,C,p.default]))));else{(k=_.transceivers[u]||_._createTransceiver(l)).mid=w,k.iceGatherer||(k.iceGatherer=_._createIceGatherer(u,m)),I.length&&"new"===k.iceTransport.state&&(!L||m&&0!==u?I.forEach((function(t){o(k.iceTransport,t)})):k.iceTransport.setRemoteCandidates(I)),P=t.RTCRtpReceiver.getCapabilities(l),e<15019&&(P.codecs=P.codecs.filter((function(t){return"rtx"!==t.name}))),M=k.sendEncodingParameters||[{ssrc:1001*(2*u+2)}];var B,N=!1;"sendrecv"===y||"sendonly"===y?(N=!k.rtpReceiver,C=k.rtpReceiver||new t.RTCRtpReceiver(k.dtlsTransport,l),N&&(R=C.track,b&&"-"===b.stream||(b?(p[b.stream]||(p[b.stream]=new t.MediaStream,Object.defineProperty(p[b.stream],"id",{get:function(){return b.stream}})),Object.defineProperty(R,"id",{get:function(){return b.track}}),B=p[b.stream]):(p.default||(p.default=new t.MediaStream),B=p.default)),B&&(n(R,B),k.associatedRemoteMediaStreams.push(B)),h.push([R,C,B]))):k.rtpReceiver&&k.rtpReceiver.track&&(k.associatedRemoteMediaStreams.forEach((function(e){var n,r,i=e.getTracks().find((function(t){return t.id===k.rtpReceiver.track.id}));i&&(n=i,(r=e).removeTrack(n),r.dispatchEvent(new t.MediaStreamTrackEvent("removetrack",{track:n})))})),k.associatedRemoteMediaStreams=[]),k.localCapabilities=P,k.remoteCapabilities=D,k.rtpReceiver=C,k.rtcpParameters=A,k.sendEncodingParameters=M,k.recvEncodingParameters=E,_._transceive(_.transceivers[u],!1,N)}}})),void 0===_._dtlsRole&&(_._dtlsRole="offer"===i.type?"active":"passive"),_._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?_._updateSignalingState("have-remote-offer"):_._updateSignalingState("stable"),Object.keys(p).forEach((function(e){var n=p[e];if(n.getTracks().length){if(-1===_.remoteStreams.indexOf(n)){_.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,t.setTimeout((function(){_._dispatchEvent("addstream",r)}))}h.forEach((function(t){var e=t[0],r=t[1];n.id===t[2].id&&c(_,e,r,[n])}))}})),h.forEach((function(t){t[2]||c(_,t[0],t[1],[])})),t.setTimeout((function(){_&&_.transceivers&&_.transceivers.forEach((function(t){t.iceTransport&&"new"===t.iceTransport.state&&t.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),t.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},_.prototype.close=function(){this.transceivers.forEach((function(t){t.iceTransport&&t.iceTransport.stop(),t.dtlsTransport&&t.dtlsTransport.stop(),t.rtpSender&&t.rtpSender.stop(),t.rtpReceiver&&t.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},_.prototype._updateSignalingState=function(t){this.signalingState=t;var e=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",e)},_.prototype._maybeFireNegotiationNeeded=function(){var e=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,t.setTimeout((function(){if(e.needNegotiation){e.needNegotiation=!1;var t=new Event("negotiationneeded");e._dispatchEvent("negotiationneeded",t)}}),0))},_.prototype._updateIceConnectionState=function(){var t,e={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(t){t.iceTransport&&!t.rejected&&e[t.iceTransport.state]++})),t="new",e.failed>0?t="failed":e.checking>0?t="checking":e.disconnected>0?t="disconnected":e.new>0?t="new":e.connected>0?t="connected":e.completed>0&&(t="completed"),t!==this.iceConnectionState){this.iceConnectionState=t;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},_.prototype._updateConnectionState=function(){var t,e={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(t){t.iceTransport&&t.dtlsTransport&&!t.rejected&&(e[t.iceTransport.state]++,e[t.dtlsTransport.state]++)})),e.connected+=e.completed,t="new",e.failed>0?t="failed":e.connecting>0?t="connecting":e.disconnected>0?t="disconnected":e.new>0?t="new":e.connected>0&&(t="connected"),t!==this.connectionState){this.connectionState=t;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},_.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(u("InvalidStateError","Can not call createOffer after close"));var s=n.transceivers.filter((function(t){return"audio"===t.kind})).length,a=n.transceivers.filter((function(t){return"video"===t.kind})).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==o.offerToReceiveAudio&&(s=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(a=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(n.transceivers.forEach((function(t){"audio"===t.kind?--s<0&&(t.wantReceive=!1):"video"===t.kind&&--a<0&&(t.wantReceive=!1)}));s>0||a>0;)s>0&&(n._createTransceiver("audio"),s--),a>0&&(n._createTransceiver("video"),a--);var c=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(i,s){var a=i.track,o=i.kind,u=i.mid||r.generateIdentifier();i.mid=u,i.iceGatherer||(i.iceGatherer=n._createIceGatherer(s,n.usingBundle));var c=t.RTCRtpSender.getCapabilities(o);e<15019&&(c.codecs=c.codecs.filter((function(t){return"rtx"!==t.name}))),c.codecs.forEach((function(t){"H264"===t.name&&void 0===t.parameters["level-asymmetry-allowed"]&&(t.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(e){t.name.toLowerCase()===e.name.toLowerCase()&&t.clockRate===e.clockRate&&(t.preferredPayloadType=e.payloadType)}))})),c.headerExtensions.forEach((function(t){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(e){t.uri===e.uri&&(t.id=e.id)}))}));var _=i.sendEncodingParameters||[{ssrc:1001*(2*s+1)}];a&&e>=15019&&"video"===o&&!_[0].rtx&&(_[0].rtx={ssrc:_[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new t.RTCRtpReceiver(i.dtlsTransport,o)),i.localCapabilities=c,i.sendEncodingParameters=_})),"max-compat"!==n._config.bundlePolicy&&(c+="a=group:BUNDLE "+n.transceivers.map((function(t){return t.mid})).join(" ")+"\r\n"),c+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(t,e){c+=i(t,t.localCapabilities,"offer",t.stream,n._dtlsRole),c+="a=rtcp-rsize\r\n",!t.iceGatherer||"new"===n.iceGatheringState||0!==e&&n.usingBundle||(t.iceGatherer.getLocalCandidates().forEach((function(t){t.component=1,c+="a="+r.writeCandidate(t)+"\r\n"})),"completed"===t.iceGatherer.state&&(c+="a=end-of-candidates\r\n"))}));var _=new t.RTCSessionDescription({type:"offer",sdp:c});return Promise.resolve(_)},_.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(u("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(u("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var a=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(a+="a=group:BUNDLE "+n.transceivers.map((function(t){return t.mid})).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var o=r.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(t,r){if(!(r+1>o)){if(t.rejected)return"application"===t.kind?"DTLS/SCTP"===t.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+t.protocol+" webrtc-datachannel\r\n":"audio"===t.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===t.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+t.mid+"\r\n");var u;t.stream&&("audio"===t.kind?u=t.stream.getAudioTracks()[0]:"video"===t.kind&&(u=t.stream.getVideoTracks()[0]),u&&e>=15019&&"video"===t.kind&&!t.sendEncodingParameters[0].rtx&&(t.sendEncodingParameters[0].rtx={ssrc:t.sendEncodingParameters[0].ssrc+1}));var c=s(t.localCapabilities,t.remoteCapabilities);!c.codecs.filter((function(t){return"rtx"===t.name.toLowerCase()})).length&&t.sendEncodingParameters[0].rtx&&delete t.sendEncodingParameters[0].rtx,a+=i(t,c,"answer",t.stream,n._dtlsRole),t.rtcpParameters&&t.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}}));var c=new t.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(c)},_.prototype.addIceCandidate=function(t){var e,n=this;return t&&void 0===t.sdpMLineIndex&&!t.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,s){if(!n._remoteDescription)return s(u("InvalidStateError","Can not add ICE candidate without a remote description"));if(t&&""!==t.candidate){var a=t.sdpMLineIndex;if(t.sdpMid)for(var c=0;c<n.transceivers.length;c++)if(n.transceivers[c].mid===t.sdpMid){a=c;break}var _=n.transceivers[a];if(!_)return s(u("OperationError","Can not add ICE candidate"));if(_.rejected)return i();var p=Object.keys(t.candidate).length>0?r.parseCandidate(t.candidate):{};if("tcp"===p.protocol&&(0===p.port||9===p.port))return i();if(p.component&&1!==p.component)return i();if((0===a||a>0&&_.iceTransport!==n.transceivers[0].iceTransport)&&!o(_.iceTransport,p))return s(u("OperationError","Can not add ICE candidate"));var h=t.candidate.trim();0===h.indexOf("a=")&&(h=h.substr(2)),(e=r.getMediaSections(n._remoteDescription.sdp))[a]+="a="+(p.type?h:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+e.join("")}else for(var l=0;l<n.transceivers.length&&(n.transceivers[l].rejected||(n.transceivers[l].iceTransport.addRemoteCandidate({}),(e=r.getMediaSections(n._remoteDescription.sdp))[l]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+e.join(""),!n.usingBundle));l++);i()}))},_.prototype.getStats=function(e){if(e&&e instanceof t.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(t){t.rtpSender&&t.rtpSender.track===e?n=t.rtpSender:t.rtpReceiver&&t.rtpReceiver.track===e&&(n=t.rtpReceiver)})),!n)throw u("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach((function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(e){t[e]&&r.push(t[e].getStats())}))})),Promise.all(r).then((function(t){var e=new Map;return t.forEach((function(t){t.forEach((function(t){e.set(t.id,t)}))})),e}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(e){var n=t[e];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(t){var e=new Map;return Object.keys(t).forEach((function(n){t[n].type=function(t){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type}(t[n]),e.set(n,t[n])})),e}))}}}));var p=["createOffer","createAnswer"];return p.forEach((function(t){var e=_.prototype[t];_.prototype[t]=function(){var t=arguments;return"function"==typeof t[0]||"function"==typeof t[1]?e.apply(this,[arguments[2]]).then((function(e){"function"==typeof t[0]&&t[0].apply(null,[e])}),(function(e){"function"==typeof t[1]&&t[1].apply(null,[e])})):e.apply(this,arguments)}})),(p=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(t){var e=_.prototype[t];_.prototype[t]=function(){var t=arguments;return"function"==typeof t[1]||"function"==typeof t[2]?e.apply(this,arguments).then((function(){"function"==typeof t[1]&&t[1].apply(null)}),(function(e){"function"==typeof t[2]&&t[2].apply(null,[e])})):e.apply(this,arguments)}})),["getStats"].forEach((function(t){var e=_.prototype[t];_.prototype[t]=function(){var t=arguments;return"function"==typeof t[1]?e.apply(this,arguments).then((function(){"function"==typeof t[1]&&t[1].apply(null)})):e.apply(this,arguments)}})),_}},{sdp:"YHvh"}],YdKx:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(t){var e=t&&t.navigator,n=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(t){return n(t).catch((function(t){return Promise.reject(function(t){return{name:{PermissionDeniedError:"NotAllowedError"}[t.name]||t.name,message:t.message,constraint:t.constraint,toString:function(){return this.name}}}(t))}))}}},{}],P3bV:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(t){"getDisplayMedia"in t.navigator&&t.navigator.mediaDevices&&(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||(t.navigator.mediaDevices.getDisplayMedia=t.navigator.getDisplayMedia.bind(t.navigator)))}},{}],XRic:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimPeerConnection=function(t){var e=r.detectBrowser(t);if(t.RTCIceGatherer&&(t.RTCIceCandidate||(t.RTCIceCandidate=function(t){return t}),t.RTCSessionDescription||(t.RTCSessionDescription=function(t){return t}),e.version<15025)){var n=Object.getOwnPropertyDescriptor(t.MediaStreamTrack.prototype,"enabled");Object.defineProperty(t.MediaStreamTrack.prototype,"enabled",{set:function(t){n.set.call(this,t);var e=new Event("enabled");e.enabled=t,this.dispatchEvent(e)}})}!t.RTCRtpSender||"dtmf"in t.RTCRtpSender.prototype||Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new t.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),t.RTCDtmfSender&&!t.RTCDTMFSender&&(t.RTCDTMFSender=t.RTCDtmfSender);var a=(0,s.default)(t,e.version);t.RTCPeerConnection=function(t){return t&&t.iceServers&&(t.iceServers=(0,i.filterIceServers)(t.iceServers,e.version),r.log("ICE servers after filtering:",t.iceServers)),new a(t)},t.RTCPeerConnection.prototype=a.prototype},n.shimReplaceTrack=function(t){!t.RTCRtpSender||"replaceTrack"in t.RTCRtpSender.prototype||(t.RTCRtpSender.prototype.replaceTrack=t.RTCRtpSender.prototype.setTrack)},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return a.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}});var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("../utils")),i=t("./filtericeservers"),s=function(t){return t&&t.__esModule?t:{default:t}}(t("rtcpeerconnection-shim")),a=t("./getusermedia"),o=t("./getdisplaymedia");function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}},{"../utils":"iSxC","./filtericeservers":"NZ1C","rtcpeerconnection-shim":"NJ2u","./getusermedia":"YdKx","./getdisplaymedia":"P3bV"}],GzSv:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(t){var e=r.detectBrowser(t),n=t&&t.navigator,i=t&&t.MediaStreamTrack;if(n.getUserMedia=function(t,e,i){r.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(t).then(e,i)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var a=function(t,e,n){e in t&&!(n in t)&&(t[n]=t[e],delete t[e])},o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(t){return"object"===s(t)&&"object"===s(t.audio)&&(t=JSON.parse(JSON.stringify(t)),a(t.audio,"autoGainControl","mozAutoGainControl"),a(t.audio,"noiseSuppression","mozNoiseSuppression")),o(t)},i&&i.prototype.getSettings){var u=i.prototype.getSettings;i.prototype.getSettings=function(){var t=u.apply(this,arguments);return a(t,"mozAutoGainControl","autoGainControl"),a(t,"mozNoiseSuppression","noiseSuppression"),t}}if(i&&i.prototype.applyConstraints){var c=i.prototype.applyConstraints;i.prototype.applyConstraints=function(t){return"audio"===this.kind&&"object"===s(t)&&(t=JSON.parse(JSON.stringify(t)),a(t,"autoGainControl","mozAutoGainControl"),a(t,"noiseSuppression","mozNoiseSuppression")),c.apply(this,[t])}}}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var a=r?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}return n.default=t,e&&e.set(t,n),n}(t("../utils"));function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}},{"../utils":"iSxC"}],UuGU:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return!0===n.video?n.video={mediaSource:e}:n.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(n)})}},{}],Fzdr:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimOnTrack=function(t){"object"===o(t)&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(t){var e=r.detectBrowser(t);if("object"===o(t)&&(t.RTCPeerConnection||t.mozRTCPeerConnection)){if(!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(e){var n=t.RTCPeerConnection.prototype[e],r=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},e,(function(){return arguments[0]=new("addIceCandidate"===e?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));t.RTCPeerConnection.prototype[e]=r[e]})),e.version<68){var n=t.RTCPeerConnection.prototype.addIceCandidate;t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){var[t,n,r]=arguments;return s.apply(this,[t||null]).then((function(t){if(e.version<53&&!n)try{t.forEach((function(t){t.type=i[t.type]||t.type}))}catch(e){if("TypeError"!==e.name)throw e;t.forEach((function(e,n){t.set(n,Object.assign({},e,{type:i[e.type]||e.type}))}))}return t})).then(n,r)}}},n.shimSenderGetStats=function(t){if("object"===o(t)&&t.RTCPeerConnection&&t.RTCRtpSender&&(!t.RTCRtpSender||!("getStats"in t.RTCRtpSender.prototype))){var e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){var t=this,n=e.apply(this,[]);return n.forEach((function(e){return e._pc=t})),n});var n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){var t=n.apply(this,arguments);return t._pc=this,t}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},n.shimReceiverGetStats=function(t){if("object"===o(t)&&t.RTCPeerConnection&&t.RTCRtpSender&&(!t.RTCRtpSender||!("getStats"in t.RTCRtpReceiver.prototype))){var e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){var t=this,n=e.apply(this,[]);return n.forEach((function(e){return e._pc=t})),n}),r.wrapPeerConnectionEvent(t,"track",(function(t){return t.receiver._pc=t.srcElement,t})),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},n.shimRemoveStream=function(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(t){var e=this;r.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&t.getTracks().includes(n.track)&&e.removeTrack(n)}))})},n.shimRTCDataChannel=function(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)},n.shimAddTransceiver=function(t){if("object"===o(t)&&t.RTCPeerConnection){var e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var t=arguments[1],n=t&&"sendEncodings"in t;n&&t.sendEncodings.forEach((function(t){if("rid"in t&&!/^[a-z0-9]{0,16}$/i.test(t.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in t&&!(parseFloat(t.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in t&&!(parseFloat(t.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var r=e.apply(this,arguments);if(n){var{sender:i}=r,s=i.getParameters();"encodings"in s||(s.encodings=t.sendEncodings,this.setParametersPromises.push(i.setParameters(s).catch((function(){}))))}return r})}},n.shimCreateOffer=function(t){if("object"===o(t)&&t.RTCPeerConnection){var e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){var t=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return e.apply(n,t)})).finally((function(){n.setParametersPromises=[]})):e.apply(this,arguments)}}},n.shimCreateAnswer=function(t){if("object"===o(t)&&t.RTCPeerConnection){var e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){var t=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return e.apply(n,t)})).finally((function(){n.setParametersPromises=[]})):e.apply(this,arguments)}}},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}});var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("../utils")),i=t("./getusermedia"),s=t("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}},{"../utils":"iSxC","./getusermedia":"GzSv","./getdisplaymedia":"UuGU"}],t1lL:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimLocalStreamsAPI=function(t){if("object"===s(t)&&t.RTCPeerConnection){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){var e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(t){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach((function(r){return e.call(n,r,t)})),t.getVideoTracks().forEach((function(r){return e.call(n,r,t)}))},t.RTCPeerConnection.prototype.addTrack=function(t){var n=arguments[1];return n&&(this._localStreams?this._localStreams.includes(n)||this._localStreams.push(n):this._localStreams=[n]),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(t){var e=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(t);if(-1!==n){this._localStreams.splice(n,1);var r=t.getTracks();this.getSenders().forEach((function(t){r.includes(t.track)&&e.removeTrack(t)}))}})}},n.shimRemoteStreamsAPI=function(t){if("object"===s(t)&&t.RTCPeerConnection&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(t){var e=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!e._remoteStreams.includes(t)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))})}});var e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){var t=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!(t._remoteStreams.indexOf(e)>=0)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}}))}),e.apply(t,arguments)}}},n.shimCallbacksAPI=function(t){if("object"===s(t)&&t.RTCPeerConnection){var e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,a=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(t,e){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return e?(i.then(t,e),Promise.resolve()):i},e.createAnswer=function(t,e){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return e?(i.then(t,e),Promise.resolve()):i};var u=function(t,e,n){var r=i.apply(this,[t]);return n?(r.then(e,n),Promise.resolve()):r};e.setLocalDescription=u,u=function(t,e,n){var r=a.apply(this,[t]);return n?(r.then(e,n),Promise.resolve()):r},e.setRemoteDescription=u,u=function(t,e,n){var r=o.apply(this,[t]);return n?(r.then(e,n),Promise.resolve()):r},e.addIceCandidate=u}},n.shimGetUserMedia=function(t){var e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){var n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=function(t){return r(a(t))}}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=function(t,n,r){e.mediaDevices.getUserMedia(t).then(n,r)}.bind(e))},n.shimConstraints=a,n.shimRTCIceServerUrls=function(t){var e=t.RTCPeerConnection;t.RTCPeerConnection=function(t,n){if(t&&t.iceServers){for(var i=[],s=0;s<t.iceServers.length;s++){var a=t.iceServers[s];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,i.push(a)):i.push(t.iceServers[s])}t.iceServers=i}return new e(t,n)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in t.RTCPeerConnection&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:function(){return e.generateCertificate}})},n.shimTrackEventTransceiver=function(t){"object"===s(t)&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function(t){var e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(t){if(t){void 0!==t.offerToReceiveAudio&&(t.offerToReceiveAudio=!!t.offerToReceiveAudio);var n=this.getTransceivers().find((function(t){return"audio"===t.receiver.track.kind}));!1===t.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==t.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==t.offerToReceiveVideo&&(t.offerToReceiveVideo=!!t.offerToReceiveVideo);var r=this.getTransceivers().find((function(t){return"video"===t.receiver.track.kind}));!1===t.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==t.offerToReceiveVideo||r||this.addTransceiver("video")}return e.apply(this,arguments)}};var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var a=r?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}return n.default=t,e&&e.set(t,n),n}(t("../utils"));function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){return t&&void 0!==t.video?Object.assign({},t,{video:r.compactObject(t.video)}):t}},{"../utils":"iSxC"}],GOQK:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimRTCIceCandidate=function(t){if(t.RTCIceCandidate&&(!t.RTCIceCandidate||!("foundation"in t.RTCIceCandidate.prototype))){var e=t.RTCIceCandidate;t.RTCIceCandidate=function(t){if("object"===a(t)&&t.candidate&&0===t.candidate.indexOf("a=")&&((t=JSON.parse(JSON.stringify(t))).candidate=t.candidate.substr(2)),t.candidate&&t.candidate.length){var n=new e(t),i=r.default.parseCandidate(t.candidate),s=Object.assign(n,i);return s.toJSON=function(){return{candidate:s.candidate,sdpMid:s.sdpMid,sdpMLineIndex:s.sdpMLineIndex,usernameFragment:s.usernameFragment}},s}return new e(t)},t.RTCIceCandidate.prototype=e.prototype,i.wrapPeerConnectionEvent(t,"icecandidate",(function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new t.RTCIceCandidate(e.candidate),writable:"false"}),e}))}},n.shimMaxMessageSize=function(t){if(t.RTCPeerConnection){var e=i.detectBrowser(t);"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===e.browser&&e.version>=76){var{sdpSemantics:t}=this.getConfiguration();"plan-b"===t&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(t){if(!t||!t.sdp)return!1;var e=r.default.splitSections(t.sdp);return e.shift(),e.some((function(t){var e=r.default.parseMLine(t);return e&&"application"===e.kind&&-1!==e.protocol.indexOf("SCTP")}))}(arguments[0])){var i,s=function(t){var e=t.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===e||e.length<2)return-1;var n=parseInt(e[1],10);return n!=n?-1:n}(arguments[0]),a=(c=s,_=65536,"firefox"===e.browser&&(_=e.version<57?-1===c?16384:2147483637:e.version<60?57===e.version?65535:65536:2147483637),_),o=function(t,n){var i=65536;"firefox"===e.browser&&57===e.version&&(i=65535);var s=r.default.matchPrefix(t.sdp,"a=max-message-size:");return s.length>0?i=parseInt(s[0].substr(19),10):"firefox"===e.browser&&-1!==n&&(i=2147483637),i}(arguments[0],s);i=0===a&&0===o?Number.POSITIVE_INFINITY:0===a||0===o?Math.max(a,o):Math.min(a,o);var u={};Object.defineProperty(u,"maxMessageSize",{get:function(){return i}}),this._sctp=u}var c,_;return n.apply(this,arguments)}}},n.shimSendThrowTypeError=function(t){if(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype){var e=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){var t=e.apply(this,arguments);return n(t,this),t},i.wrapPeerConnectionEvent(t,"datachannel",(function(t){return n(t.channel,t.target),t}))}function n(t,e){var n=t.send;t.send=function(){var r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===t.readyState&&e.sctp&&i>e.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+e.sctp.maxMessageSize+" bytes)");return n.apply(t,arguments)}}},n.shimConnectionState=function(t){if(t.RTCPeerConnection&&!("connectionState"in t.RTCPeerConnection.prototype)){var e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(t){var n=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(t){var e=t.target;if(e._lastConnectionState!==e.connectionState){e._lastConnectionState=e.connectionState;var n=new Event("connectionstatechange",t);e.dispatchEvent(n)}return t},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}},n.removeAllowExtmapMixed=function(t){if(t.RTCPeerConnection){var e=i.detectBrowser(t);if(!("chrome"===e.browser&&e.version>=71)){var n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(t){return t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")&&(t.sdp=t.sdp.split("\n").filter((function(t){return"a=extmap-allow-mixed"!==t.trim()})).join("\n")),n.apply(this,arguments)}}}};var r=function(t){return t&&t.__esModule?t:{default:t}}(t("sdp")),i=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var a=r?Object.getOwnPropertyDescriptor(t,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}(t("./utils"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}},{sdp:"YHvh","./utils":"iSxC"}],KtlG:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var{window:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},n=r.log,c=r.detectBrowser(t),_={browserDetails:c,commonShim:u,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings};switch(c.browser){case"chrome":if(!i||!i.shimPeerConnection||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),_;n("adapter.js shimming chrome."),_.browserShim=i,i.shimGetUserMedia(t),i.shimMediaStream(t),i.shimPeerConnection(t),i.shimOnTrack(t),i.shimAddTrackRemoveTrack(t),i.shimGetSendersWithDtmf(t),i.shimGetStats(t),i.shimSenderReceiverGetStats(t),i.fixNegotiationNeeded(t),u.shimRTCIceCandidate(t),u.shimConnectionState(t),u.shimMaxMessageSize(t),u.shimSendThrowTypeError(t),u.removeAllowExtmapMixed(t);break;case"firefox":if(!a||!a.shimPeerConnection||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),_;n("adapter.js shimming firefox."),_.browserShim=a,a.shimGetUserMedia(t),a.shimPeerConnection(t),a.shimOnTrack(t),a.shimRemoveStream(t),a.shimSenderGetStats(t),a.shimReceiverGetStats(t),a.shimRTCDataChannel(t),a.shimAddTransceiver(t),a.shimCreateOffer(t),a.shimCreateAnswer(t),u.shimRTCIceCandidate(t),u.shimConnectionState(t),u.shimMaxMessageSize(t),u.shimSendThrowTypeError(t);break;case"edge":if(!s||!s.shimPeerConnection||!e.shimEdge)return n("MS edge shim is not included in this adapter release."),_;n("adapter.js shimming edge."),_.browserShim=s,s.shimGetUserMedia(t),s.shimGetDisplayMedia(t),s.shimPeerConnection(t),s.shimReplaceTrack(t),u.shimMaxMessageSize(t),u.shimSendThrowTypeError(t);break;case"safari":if(!o||!e.shimSafari)return n("Safari shim is not included in this adapter release."),_;n("adapter.js shimming safari."),_.browserShim=o,o.shimRTCIceServerUrls(t),o.shimCreateOfferLegacy(t),o.shimCallbacksAPI(t),o.shimLocalStreamsAPI(t),o.shimRemoteStreamsAPI(t),o.shimTrackEventTransceiver(t),o.shimGetUserMedia(t),u.shimRTCIceCandidate(t),u.shimMaxMessageSize(t),u.shimSendThrowTypeError(t),u.removeAllowExtmapMixed(t);break;default:n("Unsupported browser!")}return _};var r=_(t("./utils")),i=_(t("./chrome/chrome_shim")),s=_(t("./edge/edge_shim")),a=_(t("./firefox/firefox_shim")),o=_(t("./safari/safari_shim")),u=_(t("./common_shim"));function c(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return c=function(){return t},t}function _(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=c();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}},{"./utils":"iSxC","./chrome/chrome_shim":"uI5X","./edge/edge_shim":"XRic","./firefox/firefox_shim":"Fzdr","./safari/safari_shim":"t1lL","./common_shim":"GOQK"}],tI1X:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=(0,t("./adapter_factory.js").adapterFactory)({window});n.default=r},{"./adapter_factory.js":"KtlG"}],sXtV:[function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var i=r(t("webrtc-adapter"));n.webRTCAdapter=i.default},{"webrtc-adapter":"tI1X"}],I31f:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("./adapter");n.Supports=new(function(){function t(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return t.prototype.isWebRTCSupported=function(){return"undefined"!=typeof RTCPeerConnection},t.prototype.isBrowserSupported=function(){var t=this.getBrowser(),e=this.getVersion();return!!this.supportedBrowsers.includes(t)&&("chrome"===t?e>=this.minChromeVersion:"firefox"===t?e>=this.minFirefoxVersion:"safari"===t&&!this.isIOS&&e>=this.minSafariVersion)},t.prototype.getBrowser=function(){return r.webRTCAdapter.browserDetails.browser},t.prototype.getVersion=function(){return r.webRTCAdapter.browserDetails.version||0},t.prototype.isUnifiedPlanSupported=function(){var t,e=this.getBrowser(),n=r.webRTCAdapter.browserDetails.version||0;if("chrome"===e&&n<72)return!1;if("firefox"===e&&n>=59)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var i=!1;try{(t=new RTCPeerConnection).addTransceiver("audio"),i=!0}catch(t){}finally{t&&t.close()}return i},t.prototype.toString=function(){return"Supports: \n    browser:"+this.getBrowser()+" \n    version:"+this.getVersion()+" \n    isIOS:"+this.isIOS+" \n    isWebRTCSupported:"+this.isWebRTCSupported()+" \n    isBrowserSupported:"+this.isBrowserSupported()+" \n    isUnifiedPlanSupported:"+this.isUnifiedPlanSupported()},t}())},{"./adapter":"sXtV"}],BHXf:[function(t,e,n){"use strict";var r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(n,"__esModule",{value:!0});var i=r(t("peerjs-js-binarypack")),s=t("./supports"),a={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0.peerjs.com:3478",username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};n.util=new(function(){function t(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=a,this.browser=s.Supports.getBrowser(),this.browserVersion=s.Supports.getVersion(),this.supports=function(){var t,e={browser:s.Supports.isBrowserSupported(),webRTC:s.Supports.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!e.webRTC)return e;try{t=new RTCPeerConnection(a),e.audioVideo=!0;var n=void 0;try{n=t.createDataChannel("_PEERJSTEST",{ordered:!0}),e.data=!0,e.reliable=!!n.ordered;try{n.binaryType="blob",e.binaryBlob=!s.Supports.isIOS}catch(t){}}catch(t){}finally{n&&n.close()}}catch(t){}finally{t&&t.close()}return e}(),this.pack=i.pack,this.unpack=i.unpack,this._dataCount=1}return t.prototype.noop=function(){},t.prototype.validateId=function(t){return!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(t)},t.prototype.chunk=function(t){for(var e=[],r=t.size,i=Math.ceil(r/n.util.chunkedMTU),s=0,a=0;a<r;){var o=Math.min(r,a+n.util.chunkedMTU),u=t.slice(a,o),c={__peerData:this._dataCount,n:s,data:u,total:i};e.push(c),a=o,s++}return this._dataCount++,e},t.prototype.blobToArrayBuffer=function(t,e){var n=new FileReader;return n.onload=function(t){t.target&&e(t.target.result)},n.readAsArrayBuffer(t),n},t.prototype.binaryStringToArrayBuffer=function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=255&t.charCodeAt(n);return e.buffer},t.prototype.randomToken=function(){return Math.random().toString(36).substr(2)},t.prototype.isSecure=function(){return"https:"===location.protocol},t}())},{"peerjs-js-binarypack":"kdPp","./supports":"I31f"}],JJlS:[function(t,e,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function s(){}function a(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(t,e,n,r,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var o=new a(n,r||t,s),u=i?i+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],o]:t._events[u].push(o):(t._events[u]=o,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new s:delete t._events[e]}function c(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(i=!1)),c.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)r.call(t,e)&&n.push(i?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},c.prototype.listeners=function(t){var e=i?i+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,s=n.length,a=new Array(s);r<s;r++)a[r]=n[r].fn;return a},c.prototype.listenerCount=function(t){var e=i?i+t:t,n=this._events[e];return n?n.fn?1:n.length:0},c.prototype.emit=function(t,e,n,r,s,a){var o=i?i+t:t;if(!this._events[o])return!1;var u,c,_=this._events[o],p=arguments.length;if(_.fn){switch(_.once&&this.removeListener(t,_.fn,void 0,!0),p){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,e),!0;case 3:return _.fn.call(_.context,e,n),!0;case 4:return _.fn.call(_.context,e,n,r),!0;case 5:return _.fn.call(_.context,e,n,r,s),!0;case 6:return _.fn.call(_.context,e,n,r,s,a),!0}for(c=1,u=new Array(p-1);c<p;c++)u[c-1]=arguments[c];_.fn.apply(_.context,u)}else{var h,l=_.length;for(c=0;c<l;c++)switch(_[c].once&&this.removeListener(t,_[c].fn,void 0,!0),p){case 1:_[c].fn.call(_[c].context);break;case 2:_[c].fn.call(_[c].context,e);break;case 3:_[c].fn.call(_[c].context,e,n);break;case 4:_[c].fn.call(_[c].context,e,n,r);break;default:if(!u)for(h=1,u=new Array(p-1);h<p;h++)u[h-1]=arguments[h];_[c].fn.apply(_[c].context,u)}}return!0},c.prototype.on=function(t,e,n){return o(this,t,e,n,!1)},c.prototype.once=function(t,e,n){return o(this,t,e,n,!0)},c.prototype.removeListener=function(t,e,n,r){var s=i?i+t:t;if(!this._events[s])return this;if(!e)return u(this,s),this;var a=this._events[s];if(a.fn)a.fn!==e||r&&!a.once||n&&a.context!==n||u(this,s);else{for(var o=0,c=[],_=a.length;o<_;o++)(a[o].fn!==e||r&&!a[o].once||n&&a[o].context!==n)&&c.push(a[o]);c.length?this._events[s]=1===c.length?c[0]:c:u(this,s)}return this},c.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&u(this,e)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=i,c.EventEmitter=c,void 0!==e&&(e.exports=c)},{}],WOs9:[function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return a},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t};Object.defineProperty(n,"__esModule",{value:!0});var s,a="PeerJS: ";!function(t){t[t.Disabled=0]="Disabled",t[t.Errors=1]="Errors",t[t.Warnings=2]="Warnings",t[t.All=3]="All"}(s=n.LogLevel||(n.LogLevel={}));var o=function(){function t(){this._logLevel=s.Disabled}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){this._logLevel=t},enumerable:!0,configurable:!0}),t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logLevel>=s.All&&this._print.apply(this,i([s.All],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logLevel>=s.Warnings&&this._print.apply(this,i([s.Warnings],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logLevel>=s.Errors&&this._print.apply(this,i([s.Errors],t))},t.prototype.setLogFunction=function(t){this._print=t},t.prototype._print=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=i([a],e);for(var o in r)r[o]instanceof Error&&(r[o]="("+r[o].name+") "+r[o].message);t>=s.All?console.log.apply(console,i(r)):t>=s.Warnings?console.warn.apply(console,i(["WARNING"],r)):t>=s.Errors&&console.error.apply(console,i(["ERROR"],r))},t}();n.default=new o},{}],ZRYf:[function(t,e,n){"use strict";var r;Object.defineProperty(n,"__esModule",{value:!0}),(r=n.ConnectionEventType||(n.ConnectionEventType={})).Open="open",r.Stream="stream",r.Data="data",r.Close="close",r.Error="error",r.IceStateChanged="iceStateChanged",function(t){t.Data="data",t.Media="media"}(n.ConnectionType||(n.ConnectionType={})),function(t){t.Open="open",t.Close="close",t.Connection="connection",t.Call="call",t.Disconnected="disconnected",t.Error="error"}(n.PeerEventType||(n.PeerEventType={})),function(t){t.BrowserIncompatible="browser-incompatible",t.Disconnected="disconnected",t.InvalidID="invalid-id",t.InvalidKey="invalid-key",t.Network="network",t.PeerUnavailable="peer-unavailable",t.SslUnavailable="ssl-unavailable",t.ServerError="server-error",t.SocketError="socket-error",t.SocketClosed="socket-closed",t.UnavailableID="unavailable-id",t.WebRTC="webrtc"}(n.PeerErrorType||(n.PeerErrorType={})),function(t){t.Binary="binary",t.BinaryUTF8="binary-utf8",t.JSON="json"}(n.SerializationType||(n.SerializationType={})),function(t){t.Message="message",t.Disconnected="disconnected",t.Error="error",t.Close="close"}(n.SocketEventType||(n.SocketEventType={})),function(t){t.Heartbeat="HEARTBEAT",t.Candidate="CANDIDATE",t.Offer="OFFER",t.Answer="ANSWER",t.Open="OPEN",t.Error="ERROR",t.IdTaken="ID-TAKEN",t.InvalidKey="INVALID-KEY",t.Leave="LEAVE",t.Expire="EXPIRE"}(n.ServerMessageType||(n.ServerMessageType={}))},{}],wJlv:[function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return a},s=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var u=t("eventemitter3"),c=o(t("./logger")),_=t("./enums"),p=function(t){function e(e,n,r,i,s,a){void 0===a&&(a=5e3);var o=t.call(this)||this;o.pingInterval=a,o._disconnected=!0,o._messagesQueue=[];var u=e?"wss://":"ws://";return o._baseUrl=u+n+":"+r+i+"peerjs?key="+s,o}return r(e,t),e.prototype.start=function(t,e){var n=this;this._id=t;var r=this._baseUrl+"&id="+t+"&token="+e;!this._socket&&this._disconnected&&(this._socket=new WebSocket(r),this._disconnected=!1,this._socket.onmessage=function(t){var e;try{e=JSON.parse(t.data),c.default.log("Server message received:",e)}catch(e){return void c.default.log("Invalid server message",t.data)}n.emit(_.SocketEventType.Message,e)},this._socket.onclose=function(t){n._disconnected||(c.default.log("Socket closed.",t),n._cleanup(),n._disconnected=!0,n.emit(_.SocketEventType.Disconnected))},this._socket.onopen=function(){n._disconnected||(n._sendQueuedMessages(),c.default.log("Socket open"),n._scheduleHeartbeat())})},e.prototype._scheduleHeartbeat=function(){var t=this;this._wsPingTimer=setTimeout((function(){t._sendHeartbeat()}),this.pingInterval)},e.prototype._sendHeartbeat=function(){if(this._wsOpen()){var t=JSON.stringify({type:_.ServerMessageType.Heartbeat});this._socket.send(t),this._scheduleHeartbeat()}else c.default.log("Cannot send heartbeat, because socket closed")},e.prototype._wsOpen=function(){return!!this._socket&&1===this._socket.readyState},e.prototype._sendQueuedMessages=function(){var t,e,n=s(this._messagesQueue);this._messagesQueue=[];try{for(var r=a(n),i=r.next();!i.done;i=r.next()){var o=i.value;this.send(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.send=function(t){if(!this._disconnected)if(this._id)if(t.type){if(this._wsOpen()){var e=JSON.stringify(t);this._socket.send(e)}}else this.emit(_.SocketEventType.Error,"Invalid message");else this._messagesQueue.push(t)},e.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},e.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},e}(u.EventEmitter);n.Socket=p},{eventemitter3:"JJlS","./logger":"WOs9","./enums":"ZRYf"}],HCdX:[function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function a(t){try{u(r.next(t))}catch(t){s(t)}}function o(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var o=t("./util"),u=a(t("./logger")),c=t("./enums"),_=function(){function t(t){this.connection=t}return t.prototype.startConnection=function(t){var e=this._startPeerConnection();if(this.connection.peerConnection=e,this.connection.type===c.ConnectionType.Media&&t._stream&&this._addTracksToConnection(t._stream,e),t.originator){if(this.connection.type===c.ConnectionType.Data){var n=this.connection,r={ordered:!!t.reliable},i=e.createDataChannel(n.label,r);n.initialize(i)}this._makeOffer()}else this.handleSDP("OFFER",t.sdp)},t.prototype._startPeerConnection=function(){u.default.log("Creating RTCPeerConnection.");var t=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(t),t},t.prototype._setupListeners=function(t){var e=this,n=this.connection.peer,r=this.connection.connectionId,i=this.connection.type,s=this.connection.provider;u.default.log("Listening for ICE candidates."),t.onicecandidate=function(t){t.candidate&&t.candidate.candidate&&(u.default.log("Received ICE candidates for "+n+":",t.candidate),s.socket.send({type:c.ServerMessageType.Candidate,payload:{candidate:t.candidate,type:i,connectionId:r},dst:n}))},t.oniceconnectionstatechange=function(){switch(t.iceConnectionState){case"failed":u.default.log("iceConnectionState is failed, closing connections to "+n),e.connection.emit(c.ConnectionEventType.Error,new Error("Negotiation of connection to "+n+" failed.")),e.connection.close();break;case"closed":u.default.log("iceConnectionState is closed, closing connections to "+n),e.connection.emit(c.ConnectionEventType.Error,new Error("Connection to "+n+" closed.")),e.connection.close();break;case"disconnected":u.default.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":t.onicecandidate=o.util.noop}e.connection.emit(c.ConnectionEventType.IceStateChanged,t.iceConnectionState)},u.default.log("Listening for data channel"),t.ondatachannel=function(t){u.default.log("Received data channel");var e=t.channel;s.getConnection(n,r).initialize(e)},u.default.log("Listening for remote stream"),t.ontrack=function(t){u.default.log("Received remote stream");var i=t.streams[0],a=s.getConnection(n,r);if(a.type===c.ConnectionType.Media){var o=a;e._addStreamToMediaConnection(i,o)}}},t.prototype.cleanup=function(){u.default.log("Cleaning up PeerConnection to "+this.connection.peer);var t=this.connection.peerConnection;if(t){this.connection.peerConnection=null,t.onicecandidate=t.oniceconnectionstatechange=t.ondatachannel=t.ontrack=function(){};var e="closed"!==t.signalingState,n=!1;if(this.connection.type===c.ConnectionType.Data){var r=this.connection.dataChannel;r&&(n=!!r.readyState&&"closed"!==r.readyState)}(e||n)&&t.close()}},t.prototype._makeOffer=function(){return i(this,void 0,Promise,(function(){var t,e,n,i,a,_,p;return s(this,(function(s){switch(s.label){case 0:t=this.connection.peerConnection,e=this.connection.provider,s.label=1;case 1:return s.trys.push([1,7,,8]),[4,t.createOffer(this.connection.options.constraints)];case 2:n=s.sent(),u.default.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),s.label=3;case 3:return s.trys.push([3,5,,6]),[4,t.setLocalDescription(n)];case 4:return s.sent(),u.default.log("Set localDescription:",n,"for:"+this.connection.peer),i={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:o.util.browser},this.connection.type===c.ConnectionType.Data&&(a=this.connection,i=r(r({},i),{label:a.label,reliable:a.reliable,serialization:a.serialization})),e.socket.send({type:c.ServerMessageType.Offer,payload:i,dst:this.connection.peer}),[3,6];case 5:return"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=(_=s.sent())&&(e.emitError(c.PeerErrorType.WebRTC,_),u.default.log("Failed to setLocalDescription, ",_)),[3,6];case 6:return[3,8];case 7:return p=s.sent(),e.emitError(c.PeerErrorType.WebRTC,p),u.default.log("Failed to createOffer, ",p),[3,8];case 8:return[2]}}))}))},t.prototype._makeAnswer=function(){return i(this,void 0,Promise,(function(){var t,e,n,r,i;return s(this,(function(s){switch(s.label){case 0:t=this.connection.peerConnection,e=this.connection.provider,s.label=1;case 1:return s.trys.push([1,7,,8]),[4,t.createAnswer()];case 2:n=s.sent(),u.default.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),s.label=3;case 3:return s.trys.push([3,5,,6]),[4,t.setLocalDescription(n)];case 4:return s.sent(),u.default.log("Set localDescription:",n,"for:"+this.connection.peer),e.socket.send({type:c.ServerMessageType.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,browser:o.util.browser},dst:this.connection.peer}),[3,6];case 5:return r=s.sent(),e.emitError(c.PeerErrorType.WebRTC,r),u.default.log("Failed to setLocalDescription, ",r),[3,6];case 6:return[3,8];case 7:return i=s.sent(),e.emitError(c.PeerErrorType.WebRTC,i),u.default.log("Failed to create answer, ",i),[3,8];case 8:return[2]}}))}))},t.prototype.handleSDP=function(t,e){return i(this,void 0,Promise,(function(){var n,r,i,a;return s(this,(function(s){switch(s.label){case 0:e=new RTCSessionDescription(e),n=this.connection.peerConnection,r=this.connection.provider,u.default.log("Setting remote description",e),i=this,s.label=1;case 1:return s.trys.push([1,5,,6]),[4,n.setRemoteDescription(e)];case 2:return s.sent(),u.default.log("Set remoteDescription:"+t+" for:"+this.connection.peer),"OFFER"!==t?[3,4]:[4,i._makeAnswer()];case 3:s.sent(),s.label=4;case 4:return[3,6];case 5:return a=s.sent(),r.emitError(c.PeerErrorType.WebRTC,a),u.default.log("Failed to setRemoteDescription, ",a),[3,6];case 6:return[2]}}))}))},t.prototype.handleCandidate=function(t){return i(this,void 0,Promise,(function(){var e,n,r,i,a,o;return s(this,(function(s){switch(s.label){case 0:u.default.log("handleCandidate:",t),e=t.candidate,n=t.sdpMLineIndex,r=t.sdpMid,i=this.connection.peerConnection,a=this.connection.provider,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,i.addIceCandidate(new RTCIceCandidate({sdpMid:r,sdpMLineIndex:n,candidate:e}))];case 2:return s.sent(),u.default.log("Added ICE candidate for:"+this.connection.peer),[3,4];case 3:return o=s.sent(),a.emitError(c.PeerErrorType.WebRTC,o),u.default.log("Failed to handleCandidate, ",o),[3,4];case 4:return[2]}}))}))},t.prototype._addTracksToConnection=function(t,e){if(u.default.log("add tracks from stream "+t.id+" to peer connection"),!e.addTrack)return u.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");t.getTracks().forEach((function(n){e.addTrack(n,t)}))},t.prototype._addStreamToMediaConnection=function(t,e){u.default.log("add stream "+t.id+" to media connection "+e.connectionId),e.addStream(t)},t}();n.Negotiator=_},{"./util":"BHXf","./logger":"WOs9","./enums":"ZRYf"}],tQFK:[function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(e,n,r){var i=t.call(this)||this;return i.peer=e,i.provider=n,i.options=r,i._open=!1,i.metadata=r.metadata,i}return r(e,t),Object.defineProperty(e.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),e}(t("eventemitter3").EventEmitter);n.BaseConnection=i},{eventemitter3:"JJlS"}],dbHP:[function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var o=t("./util"),u=a(t("./logger")),c=t("./negotiator"),_=t("./enums"),p=function(t){function e(n,r,i){var s=t.call(this,n,r,i)||this;return s._localStream=s.options._stream,s.connectionId=s.options.connectionId||e.ID_PREFIX+o.util.randomToken(),s._negotiator=new c.Negotiator(s),s._localStream&&s._negotiator.startConnection({_stream:s._localStream,originator:!0}),s}return r(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return _.ConnectionType.Media},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localStream",{get:function(){return this._localStream},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!0,configurable:!0}),e.prototype.addStream=function(e){u.default.log("Receiving stream",e),this._remoteStream=e,t.prototype.emit.call(this,_.ConnectionEventType.Stream,e)},e.prototype.handleMessage=function(t){var e=t.type,n=t.payload;switch(t.type){case _.ServerMessageType.Answer:this._negotiator.handleSDP(e,n.sdp),this._open=!0;break;case _.ServerMessageType.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:u.default.warn("Unrecognized message type:"+e+" from peer:"+this.peer)}},e.prototype.answer=function(t,e){var n,r;if(void 0===e&&(e={}),this._localStream)u.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this._localStream=t,e&&e.sdpTransform&&(this.options.sdpTransform=e.sdpTransform),this._negotiator.startConnection(i(i({},this.options._payload),{_stream:t}));var a=this.provider._getMessages(this.connectionId);try{for(var o=s(a),c=o.next();!c.done;c=o.next()){var _=c.value;this.handleMessage(_)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}this._open=!0}},e.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,t.prototype.emit.call(this,_.ConnectionEventType.Close))},e.ID_PREFIX="mc_",e}(t("./baseconnection").BaseConnection);n.MediaConnection=p},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK"}],GGp6:[function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("eventemitter3"),a=i(t("./logger")),o=function(t){function e(){var e=t.call(this)||this;return e.fileReader=new FileReader,e._queue=[],e._processing=!1,e.fileReader.onload=function(t){e._processing=!1,t.target&&e.emit("done",t.target.result),e.doNextTask()},e.fileReader.onerror=function(t){a.default.error("EncodingQueue error:",t),e._processing=!1,e.destroy(),e.emit("error",t)},e}return r(e,t),Object.defineProperty(e.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"processing",{get:function(){return this._processing},enumerable:!0,configurable:!0}),e.prototype.enque=function(t){this.queue.push(t),this.processing||this.doNextTask()},e.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},e.prototype.doNextTask=function(){0!==this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},e}(s.EventEmitter);n.EncodingQueue=o},{eventemitter3:"JJlS","./logger":"WOs9"}],GBTQ:[function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var a=t("./util"),o=s(t("./logger")),u=t("./negotiator"),c=t("./enums"),_=t("./baseconnection"),p=t("./encodingQueue"),h=function(t){function e(n,r,i){var s=t.call(this,n,r,i)||this;return s.stringify=JSON.stringify,s.parse=JSON.parse,s._buffer=[],s._bufferSize=0,s._buffering=!1,s._chunkedData={},s._encodingQueue=new p.EncodingQueue,s.connectionId=s.options.connectionId||e.ID_PREFIX+a.util.randomToken(),s.label=s.options.label||s.connectionId,s.serialization=s.options.serialization||c.SerializationType.Binary,s.reliable=!!s.options.reliable,s._encodingQueue.on("done",(function(t){s._bufferedSend(t)})),s._encodingQueue.on("error",(function(){o.default.error("DC#"+s.connectionId+": Error occured in encoding from blob to arraybuffer, close DC"),s.close()})),s._negotiator=new u.Negotiator(s),s._negotiator.startConnection(s.options._payload||{originator:!0}),s}return r(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return c.ConnectionType.Data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!0,configurable:!0}),e.prototype.initialize=function(t){this._dc=t,this._configureDataChannel()},e.prototype._configureDataChannel=function(){var t=this;a.util.supports.binaryBlob&&!a.util.supports.reliable||(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){o.default.log("DC#"+t.connectionId+" dc connection success"),t._open=!0,t.emit(c.ConnectionEventType.Open)},this.dataChannel.onmessage=function(e){o.default.log("DC#"+t.connectionId+" dc onmessage:",e.data),t._handleDataMessage(e)},this.dataChannel.onclose=function(){o.default.log("DC#"+t.connectionId+" dc closed for:",t.peer),t.close()}},e.prototype._handleDataMessage=function(e){var n=this,r=e.data,i=r.constructor,s=r;if(this.serialization===c.SerializationType.Binary||this.serialization===c.SerializationType.BinaryUTF8){if(i===Blob)return void a.util.blobToArrayBuffer(r,(function(t){var e=a.util.unpack(t);n.emit(c.ConnectionEventType.Data,e)}));if(i===ArrayBuffer)s=a.util.unpack(r);else if(i===String){var o=a.util.binaryStringToArrayBuffer(r);s=a.util.unpack(o)}}else this.serialization===c.SerializationType.JSON&&(s=this.parse(r));s.__peerData?this._handleChunk(s):t.prototype.emit.call(this,c.ConnectionEventType.Data,s)},e.prototype._handleChunk=function(t){var e=t.__peerData,n=this._chunkedData[e]||{data:[],count:0,total:t.total};if(n.data[t.n]=t.data,n.count++,this._chunkedData[e]=n,n.total===n.count){delete this._chunkedData[e];var r=new Blob(n.data);this._handleDataMessage({data:r})}},e.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,t.prototype.emit.call(this,c.ConnectionEventType.Close))},e.prototype.send=function(e,n){if(this.open)if(this.serialization===c.SerializationType.JSON)this._bufferedSend(this.stringify(e));else if(this.serialization===c.SerializationType.Binary||this.serialization===c.SerializationType.BinaryUTF8){var r=a.util.pack(e);if(!n&&r.size>a.util.chunkedMTU)return void this._sendChunks(r);a.util.supports.binaryBlob?this._bufferedSend(r):this._encodingQueue.enque(r)}else this._bufferedSend(e);else t.prototype.emit.call(this,c.ConnectionEventType.Error,new Error("Connection is not open. You should listen for the `open` event before sending messages."))},e.prototype._bufferedSend=function(t){!this._buffering&&this._trySend(t)||(this._buffer.push(t),this._bufferSize=this._buffer.length)},e.prototype._trySend=function(t){var n=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>e.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout((function(){n._buffering=!1,n._tryBuffer()}),50),!1;try{this.dataChannel.send(t)}catch(t){return o.default.error("DC#:"+this.connectionId+" Error when sending:",t),this._buffering=!0,this.close(),!1}return!0},e.prototype._tryBuffer=function(){if(this.open&&0!==this._buffer.length){var t=this._buffer[0];this._trySend(t)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}},e.prototype._sendChunks=function(t){var e,n,r=a.util.chunk(t);o.default.log("DC#"+this.connectionId+" Try to send "+r.length+" chunks...");try{for(var s=i(r),u=s.next();!u.done;u=s.next()){var c=u.value;this.send(c,!0)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}},e.prototype.handleMessage=function(t){var e=t.payload;switch(t.type){case c.ServerMessageType.Answer:this._negotiator.handleSDP(t.type,e.sdp);break;case c.ServerMessageType.Candidate:this._negotiator.handleCandidate(e.candidate);break;default:o.default.warn("Unrecognized message type:",t.type,"from peer:",this.peer)}},e.ID_PREFIX="dc_",e.MAX_BUFFERED_AMOUNT=8388608,e}(_.BaseConnection);n.DataConnection=h},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK","./encodingQueue":"GGp6"}],in7L:[function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function a(t){try{u(r.next(t))}catch(t){s(t)}}function o(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var a=t("./util"),o=s(t("./logger")),u=function(){function t(t){this._options=t}return t.prototype._buildUrl=function(t){return(this._options.secure?"https://":"http://")+this._options.host+":"+this._options.port+this._options.path+this._options.key+"/"+t+"?ts="+(new Date).getTime()+Math.random()},t.prototype.retrieveId=function(){return r(this,void 0,Promise,(function(){var t,e,n,r;return i(this,(function(i){switch(i.label){case 0:t=this._buildUrl("id"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(t)];case 2:if(200!==(e=i.sent()).status)throw new Error("Error. Status:"+e.status);return[2,e.text()];case 3:throw n=i.sent(),o.default.error("Error retrieving ID",n),r="","/"===this._options.path&&this._options.host!==a.util.CLOUD_HOST&&(r=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+r);case 4:return[2]}}))}))},t.prototype.listAllPeers=function(){return r(this,void 0,Promise,(function(){var t,e,n,r;return i(this,(function(i){switch(i.label){case 0:t=this._buildUrl("peers"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(t)];case 2:if(200!==(e=i.sent()).status){if(401===e.status)throw n=this._options.host===a.util.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+n);throw new Error("Error. Status:"+e.status)}return[2,e.json()];case 3:throw r=i.sent(),o.default.error("Error retrieving list peers",r),new Error("Could not get list peers from the server."+r);case 4:return[2]}}))}))},t}();n.API=u},{"./util":"BHXf","./logger":"WOs9"}],Hxpd:[function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return a},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var u=t("eventemitter3"),c=t("./util"),_=o(t("./logger")),p=t("./socket"),h=t("./mediaconnection"),l=t("./dataconnection"),d=t("./enums"),f=t("./api"),m=function(t){function e(n,r){var s,a=t.call(this)||this;return a._id=null,a._lastServerId=null,a._destroyed=!1,a._disconnected=!1,a._open=!1,a._connections=new Map,a._lostMessages=new Map,n&&n.constructor==Object?r=n:n&&(s=n.toString()),r=i({debug:0,host:c.util.CLOUD_HOST,port:c.util.CLOUD_PORT,path:"/",key:e.DEFAULT_KEY,token:c.util.randomToken(),config:c.util.defaultConfig},r),a._options=r,"/"===a._options.host&&(a._options.host=window.location.hostname),a._options.path&&("/"!==a._options.path[0]&&(a._options.path="/"+a._options.path),"/"!==a._options.path[a._options.path.length-1]&&(a._options.path+="/")),void 0===a._options.secure&&a._options.host!==c.util.CLOUD_HOST?a._options.secure=c.util.isSecure():a._options.host==c.util.CLOUD_HOST&&(a._options.secure=!0),a._options.logFunction&&_.default.setLogFunction(a._options.logFunction),_.default.logLevel=a._options.debug||0,a._api=new f.API(r),a._socket=a._createServerConnection(),c.util.supports.audioVideo||c.util.supports.data?s&&!c.util.validateId(s)?(a._delayedAbort(d.PeerErrorType.InvalidID,'ID "'+s+'" is invalid'),a):(s?a._initialize(s):a._api.retrieveId().then((function(t){return a._initialize(t)})).catch((function(t){return a._abort(d.PeerErrorType.ServerError,t)})),a):(a._delayedAbort(d.PeerErrorType.BrowserIncompatible,"The current browser does not support WebRTC"),a)}return r(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"socket",{get:function(){return this._socket},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connections",{get:function(){var t,e,n=Object.create(null);try{for(var r=s(this._connections),i=r.next();!i.done;i=r.next()){var o=a(i.value,2),u=o[0],c=o[1];n[u]=c}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!0,configurable:!0}),e.prototype._createServerConnection=function(){var t=this,e=new p.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(d.SocketEventType.Message,(function(e){t._handleMessage(e)})),e.on(d.SocketEventType.Error,(function(e){t._abort(d.PeerErrorType.SocketError,e)})),e.on(d.SocketEventType.Disconnected,(function(){t.disconnected||(t.emitError(d.PeerErrorType.Network,"Lost connection to server."),t.disconnect())})),e.on(d.SocketEventType.Close,(function(){t.disconnected||t._abort(d.PeerErrorType.SocketClosed,"Underlying socket is already closed.")})),e},e.prototype._initialize=function(t){this._id=t,this.socket.start(t,this._options.token)},e.prototype._handleMessage=function(t){var e,n,r=t.type,i=t.payload,a=t.src;switch(r){case d.ServerMessageType.Open:this._lastServerId=this.id,this._open=!0,this.emit(d.PeerEventType.Open,this.id);break;case d.ServerMessageType.Error:this._abort(d.PeerErrorType.ServerError,i.msg);break;case d.ServerMessageType.IdTaken:this._abort(d.PeerErrorType.UnavailableID,'ID "'+this.id+'" is taken');break;case d.ServerMessageType.InvalidKey:this._abort(d.PeerErrorType.InvalidKey,'API KEY "'+this._options.key+'" is invalid');break;case d.ServerMessageType.Leave:_.default.log("Received leave message from "+a),this._cleanupPeer(a),this._connections.delete(a);break;case d.ServerMessageType.Expire:this.emitError(d.PeerErrorType.PeerUnavailable,"Could not connect to peer "+a);break;case d.ServerMessageType.Offer:var o=i.connectionId;if((m=this.getConnection(a,o))&&(m.close(),_.default.warn("Offer received for existing Connection ID:"+o)),i.type===d.ConnectionType.Media)m=new h.MediaConnection(a,this,{connectionId:o,_payload:i,metadata:i.metadata}),this._addConnection(a,m),this.emit(d.PeerEventType.Call,m);else{if(i.type!==d.ConnectionType.Data)return void _.default.warn("Received malformed connection type:"+i.type);m=new l.DataConnection(a,this,{connectionId:o,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable}),this._addConnection(a,m),this.emit(d.PeerEventType.Connection,m)}var u=this._getMessages(o);try{for(var c=s(u),p=c.next();!p.done;p=c.next()){var f=p.value;m.handleMessage(f)}}catch(t){e={error:t}}finally{try{p&&!p.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}break;default:if(!i)return void _.default.warn("You received a malformed message from "+a+" of type "+r);var m;o=i.connectionId,(m=this.getConnection(a,o))&&m.peerConnection?m.handleMessage(t):o?this._storeMessage(o,t):_.default.warn("You received an unrecognized message:",t)}},e.prototype._storeMessage=function(t,e){this._lostMessages.has(t)||this._lostMessages.set(t,[]),this._lostMessages.get(t).push(e)},e.prototype._getMessages=function(t){var e=this._lostMessages.get(t);return e?(this._lostMessages.delete(t),e):[]},e.prototype.connect=function(t,e){if(void 0===e&&(e={}),this.disconnected)return _.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(d.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");var n=new l.DataConnection(t,this,e);return this._addConnection(t,n),n},e.prototype.call=function(t,e,n){if(void 0===n&&(n={}),this.disconnected)return _.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(d.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");if(e){n._stream=e;var r=new h.MediaConnection(t,this,n);return this._addConnection(t,r),r}_.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},e.prototype._addConnection=function(t,e){_.default.log("add connection "+e.type+":"+e.connectionId+" to peerId:"+t),this._connections.has(t)||this._connections.set(t,[]),this._connections.get(t).push(e)},e.prototype._removeConnection=function(t){var e=this._connections.get(t.peer);if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}this._lostMessages.delete(t.connectionId)},e.prototype.getConnection=function(t,e){var n,r,i=this._connections.get(t);if(!i)return null;try{for(var a=s(i),o=a.next();!o.done;o=a.next()){var u=o.value;if(u.connectionId===e)return u}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return null},e.prototype._delayedAbort=function(t,e){var n=this;setTimeout((function(){n._abort(t,e)}),0)},e.prototype._abort=function(t,e){_.default.error("Aborting!"),this.emitError(t,e),this._lastServerId?this.disconnect():this.destroy()},e.prototype.emitError=function(t,e){var n;_.default.error("Error:",e),(n="string"==typeof e?new Error(e):e).type=t,this.emit(d.PeerEventType.Error,n)},e.prototype.destroy=function(){this.destroyed||(_.default.log("Destroy peer with ID:"+this.id),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit(d.PeerEventType.Close))},e.prototype._cleanup=function(){var t,e;try{for(var n=s(this._connections.keys()),r=n.next();!r.done;r=n.next()){var i=r.value;this._cleanupPeer(i),this._connections.delete(i)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.socket.removeAllListeners()},e.prototype._cleanupPeer=function(t){var e,n,r=this._connections.get(t);if(r)try{for(var i=s(r),a=i.next();!a.done;a=i.next())a.value.close()}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},e.prototype.disconnect=function(){if(!this.disconnected){var t=this.id;_.default.log("Disconnect peer with ID:"+t),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=t,this._id=null,this.emit(d.PeerEventType.Disconnected,t)}},e.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)_.default.log("Attempting reconnection to server with ID "+this._lastServerId),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");_.default.error("In a hurry? We're still trying to make the initial connection!")}},e.prototype.listAllPeers=function(t){var e=this;void 0===t&&(t=function(t){}),this._api.listAllPeers().then((function(e){return t(e)})).catch((function(t){return e._abort(d.PeerErrorType.ServerError,t)}))},e.DEFAULT_KEY="peerjs",e}(u.EventEmitter);n.Peer=m},{eventemitter3:"JJlS","./util":"BHXf","./logger":"WOs9","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ","./enums":"ZRYf","./api":"in7L"}],iTK6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("./util"),i=t("./peer");n.peerjs={Peer:i.Peer,util:r.util},n.default=i.Peer,window.peerjs=n.peerjs,window.Peer=i.Peer},{"./util":"BHXf","./peer":"Hxpd"}]},{},["iTK6"])},784:t=>{function e(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=()=>[],e.resolve=e,e.id=784,t.exports=e},962:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.BasicBot=void 0;const a=s(n(887)),o=n(4);class u extends o.Cube{constructor(t,e){super(t,"Basic Bot.png",e),this.lightness=.5}getObjectTransform(){const t=super.getObjectTransform();return a.mat4.translate(t,t,[0,2,0]),t}}e.BasicBot=u},667:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Beacon=void 0;const a=s(n(887)),o=n(974),u=n(762);class c extends u.Shape{constructor(t,e){super(t,"Beacon.png",e),this.radius=.4;const n=[],r=[],i=[];o.Geometry.addCubeData(n,i,r,.4,.6,.4),o.Geometry.translate(n,0,1.8,0),o.Geometry.addTubeData(n,i,r,.2),this.createBuffers(t,n,i,r)}getObjectTransform(){const t=super.getObjectTransform();return a.mat4.translate(t,t,[0,2,0]),t}}e.Beacon=c},719:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Bubble=void 0;const a=s(n(887)),o=n(974),u=n(762);class c extends u.Shape{constructor(t,e,n){const r=document.createElement("canvas");r.width=512,r.height=256;const i=r.getContext("2d");i.fillStyle="white",i.clearRect(0,0,512,256),i.beginPath(),i.fillRect(0,0,512,256),i.beginPath(),i.fillStyle="green",i.font="128px 'Courier New', Courier, monospace",i.fillText(e,0,128,512),super(t,r,n),this.canvas=r;const s=[],a=[],u=[];o.Geometry.addRectangleData(s,a,u,1.5,.75),this.createBuffers(t,s,u,a)}getObjectTransform(){const t=super.getObjectTransform();return a.mat4.translate(t,t,[0,3.5,0]),t}makeMessageSVG(t){const e=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","text");n.innerHTML=t,n.setAttribute("x","50"),n.setAttribute("y","50"),n.setAttribute("font-size","30"),e.appendChild(n);const r=(new XMLSerializer).serializeToString(e),i=`data:image/svg+xml;base64,${btoa(r)}`,s=document.createElement("img");return s.src=i,s}}e.Bubble=c},823:function(t,e){"use strict";var n=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function a(t){try{u(r.next(t))}catch(t){s(t)}}function o(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Cog=void 0,e.Cog=class{constructor(t,e){this.thing=t,this.computer=e}update(t){return n(this,void 0,void 0,(function*(){return yield this.computer.getDelta(t)}))}upload(t,e){this.thing.state.code=t,this.thing.state.libraryList=e,this.computer.upload(t,e)}}},723:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function a(t){try{u(r.next(t))}catch(t){s(t)}}function o(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Computer=void 0;const i=n(151);e.Computer=class{constructor(t,e,n){this.library=n,this.startWorker(t,e)}startWorker(t,e){let n="";for(const t of e.split(/[ ,\n\r]+/))n+=this.library.getCode(t),n+="\n";const r="data:text/javascript;base64,"+btoa(`\n    var perspective;\n    var delta;\n    ${n}\n    onmessage = function(eventMessage) {\n      perspective = eventMessage.data;\n      delta = { turn: 0.0 };\n      ${t}\n      postMessage(delta); \n    }\n    `);this.worker=new Worker(r),this.working=!1,this.worker.onerror=t=>{i.Log.error(`line ${t.lineno-2}: ${t.message}`),this.worker.terminate()},this.clearResponseHandler()}getDelta(t){return r(this,void 0,void 0,(function*(){return this.working?new Promise(((t,e)=>{e("Worker is busy.")})):(this.worker.postMessage(t),new Promise(((t,e)=>{this.worker.onmessage=e=>{t(e.data)}})))}))}clearResponseHandler(){this.worker.onmessage=t=>{i.Log.error("No one is listening.")}}upload(t,e){this.worker.terminate(),this.startWorker(t,e)}}},4:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Cube=void 0;const r=n(974),i=n(762);class s extends i.Shape{constructor(t,e,n){super(t,e,n),this.loadTexture(t,e);const i=[],s=[],a=[];r.Geometry.addCubeData(i,s,a,1,1,1),this.createBuffers(t,i,s,a)}}e.Cube=s},154:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Flower=void 0;const a=s(n(887)),o=n(974),u=n(762);class c extends u.Shape{constructor(t,e){super(t,"Flower.png",e),this.lightness=0,this.radius=.2;const n=[],r=[],i=[];o.Geometry.addCylinderData(n,i,r,.2),this.createBuffers(t,n,i,r)}getObjectTransform(){const t=super.getObjectTransform();return a.mat4.translate(t,t,[0,.7*this.state.data.position,0]),t}}e.Flower=c},974:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Geometry=void 0;class n{static translate(t,e,n,r){for(let i=0;i<t.length;i+=3)t[i]+=e,t[i+1]+=n,t[i+2]+=r}static addTubeData(t,e,n,r){const i=2*Math.PI/16,s=.75/16;for(let a=0;a<16;++a){let o=a*i-Math.PI/2;const u=Math.cos(o)*r,c=Math.sin(o)*r,_=Math.cos(o+i)*r,p=Math.sin(o+i)*r;t.push(u,1,c),t.push(_,1,p),t.push(u,-1,c),t.push(_,1,p),t.push(u,-1,c),t.push(_,-1,p);let h=.25+a*s;e.push(h,0),e.push(h+s,0),e.push(h,.5),e.push(h+s,0),e.push(h,.5),e.push(h+s,.5),n.push(u,0,c),n.push(_,0,p),n.push(u,0,c),n.push(_,0,p),n.push(u,0,c),n.push(_,0,p)}}static addDiscData(t,e,n,r){const i=2*Math.PI/16;for(let s=0;s<16;++s){let a=s*i-Math.PI/2;const o=Math.cos(a)*r,u=Math.sin(a)*r,c=Math.cos(a+i)*r,_=Math.sin(a+i)*r;t.push(0,1,0),t.push(o,1,u),t.push(c,1,_);const p=.125+.125*Math.cos(a),h=.125+.125*Math.sin(a),l=.125+.125*Math.cos(a+i),d=.125+.125*Math.sin(a+i);e.push(.125,.125),e.push(p,h),e.push(l,d),n.push(0,1,0),n.push(0,1,0),n.push(0,1,0)}}static addCylinderData(t,e,r,i){n.addTubeData(t,e,r,i),n.addDiscData(t,e,r,i)}static addCubeData(t,e,n,r,i,s){t.push(-r,i,-s),t.push(r,i,-s),t.push(r,i,s),t.push(-r,i,-s),t.push(r,i,s),t.push(-r,i,s),t.push(-r,i,s),t.push(r,i,s),t.push(r,-i,s),t.push(-r,i,s),t.push(r,-i,s),t.push(-r,-i,s),t.push(r,i,s),t.push(r,i,-s),t.push(r,-i,-s),t.push(r,i,s),t.push(r,-i,-s),t.push(r,-i,s),t.push(r,i,-s),t.push(-r,i,-s),t.push(-r,-i,-s),t.push(r,i,-s),t.push(-r,-i,-s),t.push(r,-i,-s),t.push(-r,i,-s),t.push(-r,i,s),t.push(-r,-i,s),t.push(-r,i,-s),t.push(-r,-i,s),t.push(-r,-i,-s),e.push(0,0,.25,0,.25,.5,0,0,.25,.5,0,.5,0,.5,.25,.5,.25,1,0,.5,.25,1,0,1,.25,.5,.5,.5,.5,1,.25,.5,.5,1,.25,1,.5,.5,.75,.5,.75,1,.5,.5,.75,1,.5,1,.75,.5,1,.5,1,1,.75,.5,1,1,.75,1),n.push(0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0)}static addGemData(t,e,n){const r=.8,i=2*Math.PI/4;for(let s=0;s<4;++s){let a=s*i,o=0,u=.7,c=0,_=Math.cos(a),p=0,h=Math.sin(a),l=Math.cos(a+i),d=0,f=Math.sin(a+i);t.push(o*r,u,c*r),e.push((_+l)/4,0,(h+f)/4),n.push(.25,.5),t.push(l*r,d,f*r),e.push(l,d,f),n.push(.25+.25*l,.5+.5*f),t.push(_*r,p,h*r),e.push(_,p,h),n.push(.25+.25*_,.5+.5*h),u=-u,t.push(o*r,u,c*r),e.push((_+l)/4,0,(h+f)/4),n.push(.75,.5),t.push(l*r,d,f*r),e.push(l,d,f),n.push(.75+.25*l,.5+.5*f),t.push(_*r,p,h*r),e.push(_,p,h),n.push(.75+.25*_,.5+.5*h)}}static addRectangleData(t,e,n,r,i){t.push(-r,i,0),t.push(r,i,0),t.push(-r,-i,0),t.push(r,i,0),t.push(-r,-i,0),t.push(r,-i,0),n.push(0,0),n.push(1,0),n.push(0,1),n.push(1,0),n.push(0,1),n.push(1,1),e.push(-r,i,1),e.push(r,i,1),e.push(-r,-i,1),e.push(r,i,1),e.push(-r,-i,1),e.push(r,-i,1)}}e.Geometry=n},296:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Gopher=void 0;const a=s(n(887)),o=n(974),u=n(762);class c extends u.Shape{constructor(t,e){super(t,"Gopher.png",e),this.radius=.5;const n=[],r=[],i=[];o.Geometry.addCubeData(n,i,r,.5,.8,.5),o.Geometry.translate(n,0,0,0),this.createBuffers(t,n,i,r)}getObjectTransform(){const t=super.getObjectTransform();return a.mat4.translate(t,t,[0,1.6,0]),a.mat4.rotate(t,t,Math.PI/4,[0,-1,0]),t}}e.Gopher=c},451:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.GopherHole=void 0;const a=n(974),o=n(762),u=s(n(887));class c extends o.Shape{constructor(t,e){super(t,"GopherHole.png",e);const n=[],r=[],i=[];a.Geometry.addCubeData(n,r,i,1,1,1),a.Geometry.translate(n,0,.3,0),this.createBuffers(t,n,r,i)}getObjectTransform(){const t=super.getObjectTransform();return u.mat4.rotate(t,t,Math.PI/4,[0,-1,0]),t}}e.GopherHole=c},701:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ground=void 0;const r=n(4);class i extends r.Cube{constructor(t,e,n){super(t,e,n)}}e.Ground=i},861:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Hazard=void 0;const a=s(n(887)),o=n(701);class u extends o.Ground{constructor(t,e){super(t,"Hazard.png",e),this.nextChangeTime=this.startTimeSeconds+3*Math.random(),Math.random()<.5?this.orientation=0:this.orientation=Math.PI/2}getObjectTransform(){const t=super.getObjectTransform(),e=window.performance.now()/1e3;return e>this.nextChangeTime&&(0===this.orientation?this.orientation=Math.PI/2:this.orientation=0,this.nextChangeTime=e+3*Math.random()),a.mat4.rotate(t,t,this.orientation,[0,1,0]),t}}e.Hazard=u},138:(t,e,n)=>{"use strict";const r=n(151),i=n(28),s=document.createElement("div");document.getElementsByTagName("body")[0].appendChild(s),r.Log.setTargetElement(s),r.Log.info("Initiating start sequence.");const a=new URL(document.URL),o=a.searchParams.get("login");if(o)(new i.Render).main(o),r.Log.info("Systems are active.");else{r.Log.info("Unrecognized user."),r.Log.info(""),r.Log.info("Enter your username");const t=document.getElementsByTagName("body")[0],e=document.createElement("span");e.innerText="login: ",t.appendChild(e);const n=document.createElement("span");n.classList.add("login"),n.contentEditable="true",n.spellcheck=!1,n.innerText="",n.tabIndex=1,t.appendChild(n);const i=document.createElement("a");t.appendChild(i);const s=()=>{const t=n.innerText.trim();if(t.match(/[A-Za-z][A-Za-z0-9]+/)){const e=new URL(a.href);e.searchParams.append("login",t),i.href=e.href,i.innerText="Let's go!"}else i.href="",i.innerText="";setTimeout(s,100)};s()}},767:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Intention=void 0,e.Intention=class{constructor(t,e,n){this.effectiveTime=t,this.delta=e,this.cog=n}}},799:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Library=void 0,e.Library=class{constructor(){this.books=new Map}mergeFromObject(t){for(const e of Object.keys(t))this.books.set(e,t[e])}toObject(){const t={};for(const e of this.books.keys())t[e]=this.books.get(e);return t}getCode(t){return this.books.has(t)?this.books.get(t):`/* No such library: ${t} */`}size(){return this.books.size}libraryNames(){return this.books.keys()}}},151:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Log=void 0;class n{static setTargetElement(t){n.target=t,t.classList.add("log")}static addToLog(t){n.messages.push(t),n.target.appendChild(t),n.messages.length>10&&(n.target.removeChild(n.messages[0]),n.messages.splice(0,1))}static info(t){if(t===this.lastMessage)return;this.lastMessage=t;const e=document.createElement("div");e.innerText=t,n.addToLog(e)}static error(t){if(t===this.lastMessage)return;this.lastMessage=t;const e=document.createElement("div");e.classList.add("error"),e.innerText=t,n.addToLog(e)}}e.Log=n,n.messages=[],n.lastMessage=""},470:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MasterControl=void 0;const r=n(962),i=n(667),s=n(719),a=n(823),o=n(723),u=n(154),c=n(296),_=n(451),p=n(701),h=n(861),l=n(767),d=n(151),f=n(819),m=n(709),g=n(507),v=n(663),y=n(762),b=n(811),w=n(170),k=n(435),x=n(750);e.MasterControl=class{constructor(t,e,n,r){this.gl=t,this.state=e,this.keyFocusElement=n,this.username=r,this.cogs=new Map,this.frameNumber=0,this.pendingEvents=[],this.keysDown=new Set,n.addEventListener("keydown",(t=>{this.keysDown.add(t.code)})),n.addEventListener("keyup",(t=>{this.keysDown.delete(t.code)})),n.addEventListener("focusout",(t=>{this.keysDown.clear(),d.Log.info("Lost focus.")})),this.terminal=new w.Terminal(n);for(const t of this.state.everything.allEntries())if(t instanceof g.Player&&d.Log.info("A Player!"),t.state.code&&t instanceof y.Shape){const e=new o.Computer(t.state.code,t.state.libraryList,this.state.library);d.Log.info(`New cog: ${t.state.libraryList}`);const n=new a.Cog(t,e);t.state.id>0&&!this.cogs.has(t.state.id)?this.cogs.set(t.state.id,n):d.Log.error(`Invalid thing: ${t.state.id}`)}if(this.state.players.has(this.username)){d.Log.info(`Materializing ${this.username}.`);const t=this.state.players.get(this.username),e=new g.Player(this.gl,t),n=new o.Computer(t.code,t.libraryList,this.state.library),r=new a.Cog(e,n);this.cogs.has(e.state.id)&&d.Log.error(`Duplicate: ${e.state.id}`),this.cogs.set(e.state.id,r),this.terminal.setCog(r),this.keyFocusElement.focus(),this.state.everything.insert(t.xyz[0],t.xyz[2],e)}else d.Log.error(`${this.username} is not here.`);requestAnimationFrame((t=>{this.eventLoop(t)}))}setGround(t,e,n){for(const r of n)if(r instanceof p.Ground&&!t(r)){this.state.everything.remove(r);const t=e(r.state);this.state.everything.insert(t.state.xyz[0],t.state.xyz[2],t);break}}setItem(t,e,n){for(const e of n)if(t(e))return;const r=e();this.state.everything.insert(r.state.xyz[0],r.state.xyz[2],r)}handleAdminAction(t,e){let n,l;[n,l]=t.state.inFrontXZ();const m=[];if(this.state.everything.appendFromRange(new v.BoundingBox(n,l,.99),m),0!=m.length){if("setTile"===e&&this.setGround((t=>t instanceof x.Tile),(t=>new x.Tile(this.gl,t)),m),"setOcean"===e&&this.setGround((t=>t instanceof f.Ocean),(t=>new f.Ocean(this.gl,t)),m),"setHazard"===e&&this.setGround((t=>t instanceof h.Hazard),(t=>new h.Hazard(this.gl,t)),m),"setBeacon"===e&&this.setItem((t=>t instanceof i.Beacon),(()=>{const t=new k.ThingState([n,0,l]);return new i.Beacon(this.gl,t)}),m),"setFlower"===e&&this.setItem((t=>t instanceof u.Flower),(()=>{const t=new k.ThingState([n,0,l]);return t.data={position:1},new u.Flower(this.gl,t)}),m),"setApi"===e&&this.setItem((t=>t instanceof b.Tablet),(()=>{const t=new k.ThingState([n,0,l]);return t.data={type:"api"},new b.Tablet(this.gl,t)}),m),"setNote"===e&&this.setItem((t=>t instanceof b.Tablet),(()=>{const t=new k.ThingState([n,0,l]);return t.data={type:"note"},new b.Tablet(this.gl,t)}),m),"setLib"===e&&this.setItem((t=>t instanceof b.Tablet),(()=>{const t=new k.ThingState([n,0,l]);return t.data={type:"lib"},new b.Tablet(this.gl,t)}),m),"setGopher"===e&&(this.setItem((t=>t instanceof c.Gopher),(()=>{const t=new k.ThingState([n,0,l]);return new c.Gopher(this.gl,t)}),m),this.setItem((t=>t instanceof _.GopherHole),(()=>{const t=new k.ThingState([n,0,l]);return new _.GopherHole(this.gl,t)}),m),this.setItem((t=>t instanceof s.Bubble),(()=>{const t=new k.ThingState([n,0,l]);return new s.Bubble(this.gl,"Hi!  I'm Gigi.",t)}),m)),"setRobot"===e){let t=!1;for(const e of m)if(e instanceof r.BasicBot){t=!0;break}if(!t){const t=new k.ThingState([n,0,l]);this.cogs.has(t.id)&&d.Log.error(`Duplicate!? ${t.id}`);const e=new r.BasicBot(this.gl,t);this.state.everything.insert(e.state.xyz[0],e.state.xyz[2],e),e.state.code="delta = {turn: 1.0, drive: 0.05}",e.state.libraryList="";const i=new o.Computer(e.state.code,e.state.libraryList,this.state.library),s=new a.Cog(e,i);this.cogs.set(e.state.id,s)}}if("clear"===e)for(const t of m)t instanceof p.Ground||this.state.everything.remove(t)}else d.Log.info("Missed.")}updateMiddleObject(t,e,n,r){if(null===t)return e;const i=t.state.xyz[0]-n,s=t.state.xyz[2]-r,a=i*i+s*s,o=e.state.xyz[0]-n,u=e.state.xyz[2]-r;return o*o+u*u<a?e:t}actOnThing(t,e){t instanceof y.Shape&&e instanceof y.Shape&&t.lift(e)&&this.cogs.has(e.state.id)&&(d.Log.info("lifting"),this.terminal.setCog(this.cogs.get(e.state.id)))}raiseRobot(t,e){d.Log.info("Raising robot.")}handleAction(t){if(t instanceof y.Shape&&t.isLifting())return void(t.drop()&&this.cogs.has(t.state.id)&&(d.Log.info("dropping"),this.terminal.setCog(this.cogs.get(t.state.id))));let e,n;[e,n]=t.state.inFrontXZ();const r=[];this.state.everything.appendFromRange(new v.BoundingBox(e,n,.99),r);let i=null,s=null;for(const e of r)e instanceof x.Tile&&(i=e),e instanceof p.Ground||(s=this.updateMiddleObject(s,e,t.state.xyz[0],t.state.xyz[2]));null==s?null!=i&&this.raiseRobot(t,i):this.actOnThing(t,s)}eventLoop(t){const e=this.frameNumber+5;for(const t of this.cogs.values()){const n=new m.Perspective;n.keysDown=this.keysDown,n.currentHeading=t.thing.state.heading,t.computer.getDelta(n).then((n=>{const r=new l.Intention(e,n,t);this.pendingEvents.push(r)}))}const n=[],i=new Map;for(const t of this.pendingEvents)t.effectiveTime<=this.frameNumber?(null!=t.delta.state&&null!=t.delta.state.adminAction&&(this.handleAdminAction(t.cog.thing,t.delta.state.adminAction),t.delta.state.adminAction=null),null!=t.delta.state&&null!=t.delta.state.action&&this.handleAction(t.cog.thing),this.state.applyThing(t.cog.thing.state,t.delta),i.has(t.cog.thing)||i.set(t.cog.thing,new Float32Array(3))):n.push(t);this.pendingEvents=n;const s=[];this.state.everything.appendFromRange(this.state.everything.getBoundary(),s);for(const t of s){if(0===t.lightness)continue;if(t instanceof y.Shape&&t.isLifted()){t.trackWithLifter();continue}const e=[];this.state.everything.appendFromRange(new v.BoundingBox(t.state.xyz[0],t.state.xyz[2],2.1),e);for(const n of e){if(n===t)continue;if(n instanceof x.Tile)continue;if(t instanceof r.BasicBot&&n instanceof h.Hazard)continue;if(n instanceof y.Shape&&n.isLifted())continue;const e=t.state.xyz[0]-n.state.xyz[0],s=t.state.xyz[2]-n.state.xyz[2];if(0===e&&0===s)continue;const a=e*e+s*s,o=(t.radius+n.radius)*(t.radius+n.radius);if(a<o){const r=t.lightness/(t.lightness+n.lightness),u=Math.sqrt(a),c=r*(Math.sqrt(o)-u),_=e/u*c,p=s/u*c;if(0!==_||0!==p){i.has(t)||i.set(t,new Float32Array(3));const e=i.get(t);e[0]=e[0]+_,e[2]=e[2]+p}}}}for(const t of i.keys()){const e=t.state,n=i.get(t);e.xyz[0]+=n[0],e.xyz[2]+=n[2],this.state.everything.move(e.xyz[0],e.xyz[2],t)}this.frameNumber++,requestAnimationFrame((t=>{this.eventLoop(t)}))}}},819:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Ocean=void 0;const a=s(n(887)),o=n(701);class u extends o.Ground{constructor(t,e){super(t,"Ocean-1.png",e),this.rate=(3+2*Math.random())/6}getObjectTransform(){const t=super.getObjectTransform(),e=window.performance.now()/1e3-this.startTimeSeconds;let n=.2*Math.sin(e/this.rate)-.1;return a.mat4.translate(t,t,[0,n,0]),t}}e.Ocean=u},955:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function a(t){try{u(r.next(t))}catch(t){s(t)}}function o(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.PeerConnection=void 0;const s=i(n(391)),a=n(151);e.PeerConnection=class{constructor(t){this.peer=new s.default(t),this.peers=new Map,this.responses=new Map,this.callbacks=new Map,this.addCallback("Hi!",(()=>"Hello.")),this.ready=!1,this.peer.on("open",(t=>{a.Log.info("My id is: "+t),this.ready=!0})),this.peer.on("connection",(t=>{t.on("data",(e=>{if(a.Log.info(`${t.peer} says: ${e}`),this.responses.set(t.peer,e),this.callbacks.has(e)){const n=this.callbacks.get(e)();n instanceof Promise?n.then((e=>{this.send(t.peer,e)})):this.send(t.peer,n)}}))}))}addCallback(t,e){this.callbacks.set(t,e)}waitReady(){return r(this,void 0,void 0,(function*(){return new Promise(((t,e)=>{this.ready?t():setTimeout((()=>{this.waitReady().then((()=>{t()}))}),100)}))}))}send(t,e){const n=this.peer.connect(t);n.on("open",(()=>{a.Log.info(`to ${t}, ${this.peer.id} says: ${e}`),n.send(e)}))}sendAndPromiseResponse(t,e){return r(this,void 0,void 0,(function*(){return this.waitReady().then((()=>{this.conn=this.peer.connect(t),this.conn.on("open",(()=>{a.Log.info(`to ${t}, ${this.peer.id} says: ${e}`),this.responses.delete(t),this.conn.send(e)}))})),new Promise(((e,n)=>{const r=window.performance.now()+5e3;a.Log.info("Deadline: "+r.toFixed(0)),this.waitForResponse(t,r,e,n)}))}))}waitForResponse(t,e,n,r){if(this.responses.has(t)){const e=this.responses.get(t);this.responses.delete(t),a.Log.info("I heard you, "+t),n(e)}else window.performance.now()>=e?(a.Log.info("Deadline exceeded: "+(window.performance.now()-e)),r("Deadline exceeded.")):setTimeout((()=>{this.waitForResponse(t,e,n,r)}),1)}}},709:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Perspective=void 0,e.Perspective=class{}},507:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Player=void 0;const a=s(n(887)),o=n(974),u=n(762);class c extends u.Shape{constructor(t,e){let n="Empty Player.png";e.imageSource&&(n=e.imageSource),super(t,n,e),this.lightness=1,this.radius=.6;const r=[],i=[],s=[];o.Geometry.addCubeData(r,s,i,.65,.65,.65),o.Geometry.translate(r,0,1.3,0),o.Geometry.addTubeData(r,s,i,.6),this.createBuffers(t,r,s,i)}getObjectTransform(){const t=super.getObjectTransform();return a.mat4.translate(t,t,[0,2,0]),t}}e.Player=c},699:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ProgramInfo=void 0,e.ProgramInfo=class{constructor(){}}},663:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QuadTree=e.BoundingBox=void 0;const r=n(151);class i{constructor(t,e,n){this.x=t,this.y=e,this.radius=n}containsPoint(t,e){return t>=this.x-this.radius&&e>=this.y-this.radius&&t<this.x+this.radius&&e<this.y+this.radius}intersects(t){for(let e of[-1,1])for(let n of[-1,1]){if(t.containsPoint(this.x-this.radius*e,this.y+this.radius*n))return!0;if(this.containsPoint(t.x-t.radius*e,t.y+t.radius*n))return!0}return!1}toString(){const t=this.radius;return`[${this.x-t}..${this.x+t}, ${this.y-t}..${this.y+t}]`}}e.BoundingBox=i;class s{constructor(t,e,n){this.x=t,this.y=e,this.value=n}}class a{constructor(t,e=!1){this.boundary=t,this.children=null,this.entries=[],e?this.root=null:(this.root=this,this.entryLocation=new Map)}getBoundary(){return this.boundary}insert(t,e,n){const r=new s(t,e,n);return this.entryLocation.set(n,r),this.insertEntry(r)}remove(t){const e=this.entryLocation.get(t);e?this.removeEntry(e):r.Log.error("Failed to find entry.")}move(t,e,n){const i=this.entryLocation.get(n);i?this.moveEntry(t,e,i):r.Log.error("Failed to find entry.")}allEntries(){const t=[];return this.appendFromRange(this.boundary,t),t}appendFromRange(t,e){if(t.intersects(this.boundary))if(null===this.children)for(let n of this.entries)t.containsPoint(n.x,n.y)&&e.push(n.value);else for(let n of this.children)n.appendFromRange(t,e)}insertEntry(t){if(!this.boundary.containsPoint(t.x,t.y))return!1;if(null===this.children)this.entries.push(t),this.entries.length>a.kMaxCapacity&&this.subdivide();else for(const e of this.children)if(e.insertEntry(t))break;return!0}removeEntry(t){if(!this.boundary.containsPoint(t.x,t.y))return!1;if(null===this.children){const e=[];for(const n of this.entries)n.value!==t.value&&e.push(n);this.entries=e}else for(const e of this.children)if(e.removeEntry(t))break;return!0}moveEntry(t,e,n){if(!this.boundary.containsPoint(n.x,n.y))return!1;if(null===this.children){if(n.x=t,n.y=e,this.boundary.containsPoint(t,e))return!0;{const t=[];for(const e of this.entries)e.value!==n.value&&t.push(e);return this.entries=t,this.root.insertEntry(n),!0}}for(const r of this.children)if(r.moveEntry(t,e,n))break;return!0}subdivide(){this.children=[];const t=this.boundary;for(let e of[-1,1])for(let n of[-1,1]){const r=new i(t.x+e*(t.radius/2),t.y+n*(t.radius/2),t.radius/2),s=new a(r);s.root=this.root,this.children.push(s)}for(const t of this.entries){let e=!1;for(let n of this.children)if(n.insertEntry(t)){e=!0;break}e||(r.Log.error(`Failed to subdivide: ${t.x}, ${t.y}`),r.Log.error(`Box: ${this.boundary.toString()}`))}this.entries=null}}e.QuadTree=a,a.kMaxCapacity=10},28:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Render=void 0;const a=n(699),o=s(n(887)),u=n(620),c=n(470),_=n(151),p=n(663);e.Render=class{constructor(){for(let t of document.getElementsByTagName("h1"))t.remove();this.canvas=document.createElement("canvas"),this.canvas.id="glCanvas",this.canvas.width=2048,this.canvas.height=1536;let t=document.getElementsByTagName("body")[0];this.focusContainer=document.createElement("div"),this.focusContainer.appendChild(this.canvas),this.focusContainer.tabIndex=1,t.appendChild(this.focusContainer),this.focusContainer.focus()}main(t){if(this.gl=this.canvas.getContext("webgl"),null==this.gl)return void alert("Your browser doesn't support WebGL");const e=this.initShaderProgram(this.gl,this.getVertexShaderSource(),this.getFragmentShaderSource());this.programInfo=new a.ProgramInfo,this.programInfo.program=e,this.programInfo.vertexPosition=this.gl.getAttribLocation(e,"aVertexPosition"),this.programInfo.vertexNormal=this.gl.getAttribLocation(e,"aVertexNormal"),this.programInfo.textureCoord=this.gl.getAttribLocation(e,"aTextureCoord"),this.programInfo.uSampler=this.gl.getUniformLocation(e,"uSampler"),this.programInfo.projectionMatrix=this.gl.getUniformLocation(e,"uProjectionMatrix"),this.programInfo.modelViewMatrix=this.gl.getUniformLocation(e,"uModelViewMatrix"),this.programInfo.objectTransform=this.gl.getUniformLocation(e,"uObjectTransform"),this.programInfo.eyePosition=this.gl.getUniformLocation(e,"uEyePosition"),_.Log.info(JSON.stringify(this.programInfo)),this.world=new u.World("vialis",this.gl,t),this.world.getState().then((e=>{this.masterControl=new c.MasterControl(this.gl,e,this.focusContainer,t),this.focusContainer.focus(),this.renderLoop()}))}renderLoop(){const t=this.world.getPlayerCoords();this.setScene(this.gl,this.programInfo,t);for(const e of this.world.getThings(new p.BoundingBox(t[0],t[2]-5,26)))e.render(this.gl,this.programInfo);requestAnimationFrame((()=>this.renderLoop()))}setScene(t,e,n){t.clearColor(.8,.9,1,1),t.clearDepth(1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);const r=15*Math.PI/180,i=this.canvas.clientWidth/this.canvas.clientHeight,s=o.mat4.create();o.mat4.perspective(s,r,i,.1,400);const a=o.mat4.create(),u=n[0],c=n[1],_=n[2],p=o.vec3.fromValues(u,c+60,_+60);o.mat4.lookAt(a,p,[u,c+4,_-2],[0,1,0]),t.useProgram(e.program),t.uniformMatrix4fv(e.projectionMatrix,!1,s),t.uniformMatrix4fv(e.modelViewMatrix,!1,a),t.uniformMatrix3fv(e.eyePosition,!1,o.vec3.fromValues(u,c,_))}initShaderProgram(t,e,n){const r=this.loadShader(t,t.VERTEX_SHADER,e),i=this.loadShader(t,t.FRAGMENT_SHADER,n),s=t.createProgram();return t.attachShader(s,r),t.attachShader(s,i),t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)?s:(alert("Unable to initialize the shader program: "+t.getProgramInfoLog(s)),null)}loadShader(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(alert("An error occurred compiling the shaders: "+t.getShaderInfoLog(r)),t.deleteShader(r),null)}getVertexShaderSource(){return"\n    attribute vec4 aVertexPosition;\n    attribute vec3 aVertexNormal;\n    attribute vec2 aTextureCoord;\n\n    uniform mat4 uObjectTransform;\n    uniform mat4 uModelViewMatrix;\n    uniform mat4 uProjectionMatrix;\n    uniform vec3 uVertexNormal;\n    uniform vec3 uEyePosition;\n\n    varying highp vec2 vTextureCoord;\n    varying highp vec3 vLighting;\n    varying highp float vFog;\n\n    void main(void) {\n      gl_Position = uProjectionMatrix * \n        uModelViewMatrix * \n        uObjectTransform *\n        aVertexPosition;\n      vTextureCoord = aTextureCoord;\n\n      highp vec4 physicalPosition = uObjectTransform * aVertexPosition;\n      highp float dist = uEyePosition.z - physicalPosition.z;\n      // vFog = max(min(dist / 20.0, 1.0), 0.0);\n      vFog = 0.0;\n\n      highp vec3 ambientLight = vec3(0.3, 0.3, 0.3);\n      highp vec3 directionalLightColor = vec3(0.7, 0.7, 0.7);\n      highp vec3 directionalVector = normalize(vec3(0.3, 0.9, 0.75));\n\n      highp vec3 transformedNormal = \n        normalize(mat3(uObjectTransform) * aVertexNormal);\n\n      highp float directional = max(dot(\n        transformedNormal, directionalVector), 0.0);\n      vLighting = ambientLight + (directionalLightColor * directional);\n    }\n  "}getFragmentShaderSource(){return"\n    varying highp vec2 vTextureCoord;\n    varying highp vec3 vLighting;\n    varying highp float vFog;\n\n    uniform sampler2D uSampler;\n\n    void main(void) {\n      highp vec4 texelColor = texture2D(uSampler, vTextureCoord);\n      highp vec4 pureColor = vec4(texelColor.rgb * vLighting, texelColor.a);      \n      highp vec4 fogPart = vFog * vec4(1.0, 1.0, 1.0, 1.0);\n      highp float q = 1.0 - vFog;\n      highp vec4 colorPart = q * pureColor;\n      gl_FragColor = fogPart + colorPart;\n    }\n    "}}},762:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=void 0;const a=n(534),o=s(n(887)),u=n(677),c=n(151);class _ extends u.Thing{constructor(t,e,n){super(),this.gl=t,this.startTimeSeconds=window.performance.now()/1e3,this.state=n,this.setTextureImage(e),this.liftedBy=null,this.lifting=null}createBuffers(t,e,n,r){this.vertexCount=e.length/3,this.positionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),this.textureCoordBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.textureCoordBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(n),t.STATIC_DRAW),this.normalBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(r),t.STATIC_DRAW)}getTextureImage(){return this.textureImage}setTextureImage(t){"string"==typeof t?(this.loadTexture(this.gl,t),this.textureImage=t):(c.Log.info("Binding canvas."),this.texture=a.TextureCache.buildTexture(this.gl,t))}loadTexture(t,e){this.texture=a.TextureCache.load(t,e)}getObjectTransform(){let t=o.mat4.create();return null===this.liftedBy?o.mat4.translate(t,t,this.state.xyz):(t=this.liftedBy.getObjectTransform(),o.mat4.translate(t,t,[0,2,0])),o.mat4.rotate(t,t,this.state.heading,[0,-1,0]),t}render(t,e){const n=this.getObjectTransform();t.uniformMatrix4fv(e.objectTransform,!1,n),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.vertexAttribPointer(e.vertexPosition,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(e.vertexPosition),t.bindBuffer(t.ARRAY_BUFFER,this.textureCoordBuffer),t.vertexAttribPointer(e.textureCoord,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(e.textureCoord),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.vertexAttribPointer(e.vertexNormal,3,t.FLOAT,!0,0,0),t.enableVertexAttribArray(e.vertexNormal),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture),t.uniform1i(e.uSampler,0);{const e=this.vertexCount,n=0;t.drawArrays(t.TRIANGLES,n,e)}}isLifted(){return null!==this.liftedBy}isLifting(){return null!==this.lifting}trackWithLifter(){this.state.xyz[0]=this.liftedBy.state.xyz[0],this.state.xyz[2]=this.liftedBy.state.xyz[2]}lift(t){return!(window.performance.now()<this.liftTime+500||(this.liftTime=window.performance.now(),t.liftedBy=this,this.lifting=t,0))}drop(){if(window.performance.now()<this.liftTime+500)return!1;this.liftTime=window.performance.now();const t=this.lifting;return t.liftedBy=null,this.lifting=null,t.state.xyz[0]=this.state.xyz[0]-.1*Math.sin(this.state.heading),t.state.xyz[2]=this.state.xyz[2]+.1*Math.cos(this.state.heading),!0}}e.Shape=_},800:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.State=void 0;const r=n(861),i=n(799),s=n(151),a=n(819),o=n(507),u=n(663),c=n(349),_=n(435),p=n(750);e.State=class{constructor(t){this.gl=t,this.players=new Map,this.everything=new u.QuadTree(new u.BoundingBox(0,0,1024)),this.library=new i.Library,this.radius=0}apply(t){if(null!=t.players)for(let e of t.players.keys())this.players.has(e)||(s.Log.info("Orphaned ThingStateDelta for "+e),this.players[e]=new _.ThingState([0,0,0])),this.applyThing(this.players[e],t.players[e])}applyThing(t,e){if(null!=e.dxyz)for(let n=0;n<3;++n)t.xyz[n]+=e.dxyz[n];if(e.drive>0&&null!=e.turn){const n=Math.max(0,Math.min(1,e.drive)),r=Math.max(-1,Math.min(1,e.turn)),i=.2,s=.8,a=n*i*(1-Math.abs(r)),o=n*i/s*r,u=Math.cos(t.heading)*a,c=-Math.sin(t.heading)*a;t.heading+=o,t.heading=t.heading%(2*Math.PI),t.xyz[0]=t.xyz[0]+c,t.xyz[2]=t.xyz[2]+u}null!=e.state&&(t.data=e.state)}mergeFromObject(t){if(null!=t.players)for(let e of Object.keys(t.players))s.Log.info(`Loading ${e} player info`),this.players.has(e)||this.players.set(e,new _.ThingState([0,0,0])),this.players.get(e).mergeFrom(t.players[e]);null!=t.library?(s.Log.info("Libraries exist."),this.library.mergeFromObject(t.library)):s.Log.info("No libraries in this world.")}getThings(t){const e=[];return this.everything.appendFromRange(t,e),e}serialize(){const t={tiles:[],hazards:[],things:[]};t.radius=this.radius,t.library=this.library.toObject();for(const e of this.everything.allEntries())if(!(e instanceof a.Ocean))if(e instanceof p.Tile)t.tiles.push([e.state.xyz[0],e.state.xyz[2]]);else if(e instanceof r.Hazard)t.hazards.push([e.state.xyz[0],e.state.xyz[2]]);else if(!(e instanceof o.Player)){const n=c.ThingCodec.encode(e);null!==n&&t.things.push(n)}t.players={};for(const e of this.players.keys())t.players[e]=this.players.get(e);return JSON.stringify(t)}deserialize(t){const e=JSON.parse(t);this.mergeFromObject(e),s.Log.info("Loaded size: "+t.length.toLocaleString()),e.map,this.radius=e.radius;for(const t of e.tiles){const e=t[0],n=t[1],r=new p.Tile(this.gl,new _.ThingState([e,0,n]));this.everything.insert(e,n,r)}if(e.hazards)for(const t of e.hazards){const e=t[0],n=t[1],i=new r.Hazard(this.gl,new _.ThingState([e,0,n]));this.everything.insert(e,n,i)}if(e.things)for(const t of e.things){const e=c.ThingCodec.decode(this.gl,t);this.everything.insert(e.state.xyz[0],e.state.xyz[2],e)}const n=[];for(let t=-this.radius;t<this.radius;t+=2){const e=t;for(let t=-this.radius;t<this.radius;t+=2){const r=t;for(;n.length>0;)n.pop();if(this.everything.appendFromRange(new u.BoundingBox(r,e,.5),n),0===n.length){const t=new a.Ocean(this.gl,new _.ThingState([r,0,e]));this.everything.insert(r,e,t)}}}}}},811:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Tablet=void 0;const a=s(n(887)),o=n(974),u=n(762);class c extends u.Shape{constructor(t,e){let n="tabletNote.png";if(e.data&&e.data.type)switch(e.data.type){case"lib":n="tabletLib.png";break;case"api":n="tabletApi.png";break;case"note":n="tabletNote.png"}super(t,n,e),this.lightness=0,this.radius=.8;const r=[],i=[],s=[];o.Geometry.addCubeData(r,s,i,.8,.8,.15),o.Geometry.translate(r,0,.5,0),o.Geometry.addTubeData(r,s,i,.1),this.vertexCount=r.length/3,this.positionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(r),t.STATIC_DRAW),this.textureCoordBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.textureCoordBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(s),t.STATIC_DRAW),this.normalBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW)}getObjectTransform(){const t=super.getObjectTransform();return a.mat4.translate(t,t,[0,2,0]),t}}e.Tablet=c},170:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Terminal=void 0;const i=n(151),s=n(762),a=r(n(204));class o{constructor(t,e,n){this.img=n,this.img.width=64,this.img.onclick=t=>{o.activateHolder(this)},this.div=document.createElement("div"),this.div.classList.add("terminal"),this.div.contentEditable="true",this.div.spellcheck=!1,this.div.innerText=t,e.appendChild(this.div),o.allHolders.push(this),o.activateHolder(this)}static activateHolder(t){for(const e of o.allHolders)e===t?e.activate():e.deactivate()}setCode(t){this.div.innerText=t}getCode(){return this.div.innerText.replace(/[^\n\x20-\x7e]/g," ")}format(){let t=this.getCode();t=a.default(t,{indent_size:2,indent_char:" ",max_preserve_newlines:1,preserve_newlines:!0,keep_array_indentation:!1,break_chained_methods:!1,brace_style:"collapse",space_before_conditional:!0,unescape_strings:!1,jslint_happy:!1,end_with_newline:!1,wrap_line_length:0,comma_first:!1,e4x:!1,indent_empty_lines:!1}),i.Log.info("Formatting..."),this.setCode(t)}activate(){this.div.classList.remove("hidden"),this.img.classList.remove("deactivated"),this.div.focus()}deactivate(){this.div.classList.add("hidden"),this.img.classList.add("deactivated")}}o.allHolders=[],e.Terminal=class{constructor(t){this.otherFocusElement=t;const e=document.getElementsByTagName("body")[0],n=document.createElement("div");n.classList.add("toolbar");const r=document.createElement("img");r.src="Camera.png",n.appendChild(r),this.imageCode=new o("",e,r);const i=document.createElement("img");i.src="Library.gif",n.appendChild(i),this.libraryCode=new o("",e,i);const s=document.createElement("img");s.src="PlayerCode.gif",n.appendChild(s),this.programCode=new o("",e,s);{const t=document.createElement("span");t.innerText=" ",n.appendChild(t)}this.uploadButton=document.createElement("img"),this.uploadButton.src="Upload.gif",this.uploadButton.alt="Upload",this.uploadButton.width=64,this.uploadButton.addEventListener("click",(t=>{this.upload()})),n.appendChild(this.uploadButton),this.dirty=!0,e.appendChild(n)}setCog(t){if(this.cog=t,this.programCode.setCode(t.thing.state.code),this.libraryCode.setCode(t.thing.state.libraryList),this.imageCode.setCode(""),t.thing instanceof s.Shape){const e=t.thing.getTextureImage();e&&this.imageCode.setCode(e)}o.activateHolder(this.programCode)}upload(){const t=this.imageCode.getCode();t&&this.cog.thing instanceof s.Shape&&(this.cog.thing.setTextureImage(t),this.cog.thing.state.imageSource=t),i.Log.info("Uploading."),this.programCode.format(),this.libraryCode.format(),this.cog.upload(this.programCode.getCode(),this.libraryCode.getCode()),this.otherFocusElement.focus()}}},534:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextureCache=void 0;class n{static buildTexture(t,e){let r=t.createTexture();return n.bindTexture(t,r,e),r}static bindTexture(t,e,n){const r=t.RGBA,i=t.RGBA,s=t.UNSIGNED_BYTE;t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,r,i,s,n),t.generateMipmap(t.TEXTURE_2D),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)}static load(t,e){if(n.cache.has(e))return n.cache.get(e);{let r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const i=0,s=t.RGBA,a=1,o=1,u=0,c=t.RGBA,_=t.UNSIGNED_BYTE,p=new Uint8Array([255,0,255,255]);t.texImage2D(t.TEXTURE_2D,i,s,a,o,u,c,_,p);const h=new Image;return h.onload=()=>{this.bindTexture(t,r,h)},h.src=e,n.cache.set(e,r),r}}}e.TextureCache=n,n.cache=new Map},677:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Thing=void 0,e.Thing=class{constructor(){this.lightness=0,this.radius=Math.sqrt(4/Math.PI)}render(t,e){}}},349:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ThingCodec=void 0;const r=n(962),i=n(667),s=n(296),a=n(451),o=n(151),u=n(811),c=n(435);e.ThingCodec=class{static encode(t){const e={};if(t instanceof s.Gopher)e.typeName="Gopher";else if(t instanceof a.GopherHole)e.typeName="GopherHole";else if(t instanceof u.Tablet)e.typeName="Tablet";else if(t instanceof r.BasicBot)e.typeName="BasicBot";else{if(!(t instanceof i.Beacon))return o.Log.error(`Missing encoding ${t.constructor.name}`),null;e.typeName="Beacon"}return e.state=t.state,e}static decode(t,e){const n=new c.ThingState([0,0,0]);switch(e.state&&n.mergeFrom(e.state),o.Log.info(`Thing: ${n.id}`),e.typeName){case"Gopher":return new s.Gopher(t,n);case"GopherHole":return new a.GopherHole(t,n);case"BasicBot":return new r.BasicBot(t,n);case"Beacon":return new i.Beacon(t,n);case"Tablet":return new u.Tablet(t,n)}return o.Log.error(`Cannot decode type: ${e.typeName}`),null}}},435:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ThingState=void 0;class n{constructor(t){n.numberOfThings+=1,this.id=n.numberOfThings,this.xyz=null!=t?new Float32Array(t):new Float32Array(3),this.heading=0,this.code=null,this.libraryList=null}mergeFrom(t){null!=t.xyz&&(this.xyz[0]=t.xyz[0],this.xyz[1]=t.xyz[1],this.xyz[2]=t.xyz[2]),null!=t.heading&&(this.heading=t.heading),null!=t.code&&(this.code=t.code),null!=t.libraryList&&(this.libraryList=t.libraryList),null!=t.imageSource&&(this.imageSource=t.imageSource),null!=t.data&&(this.data=t.data),t.id&&(this.id=t.id,n.numberOfThings=Math.max(this.id,n.numberOfThings))}inFrontXZ(){return[this.xyz[0]-2*Math.sin(this.heading),this.xyz[2]+2*Math.cos(this.heading)]}}e.ThingState=n,n.numberOfThings=0},750:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tile=void 0;const r=n(701);class i extends r.Ground{constructor(t,e){super(t,"Basic Bot-5.png",e)}getObjectTransform(){return super.getObjectTransform()}}e.Tile=i},620:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function a(t){try{u(r.next(t))}catch(t){s(t)}}function o(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.World=void 0;const i=n(151),s=n(955),a=n(800);e.World=class{constructor(t,e,n){this.worldName=t,this.gl=e,this.username=n,this.state=new a.State(e),this.loaded=!1,this.loadedCallback=null,new URL(document.URL).searchParams.get("local")?this.loadFromSavedState().then((t=>{this.buildFromString(t)})):this.setStateFromInternet(),this.saveButton=document.createElement("a"),this.saveButton.innerText="Download";const r=document.createElement("div");r.appendChild(this.saveButton),r.classList.add("download"),document.getElementsByTagName("body")[0].appendChild(r)}setStateFromInternet(){this.personalConnection=new s.PeerConnection(null),this.worldServer=null;const t=`chrysalis-${this.worldName}-72361`;this.personalConnection.sendAndPromiseResponse(t,"Hi!").then((e=>{i.Log.info("Thank you: "+e),this.personalConnection.sendAndPromiseResponse(t,"World, please.").then((t=>{this.buildFromString(t)})).catch((t=>{i.Log.info("Failed to get world: "+t)}))})).catch((e=>{i.Log.info("Failed to say hello: "+e),this.worldServer=new s.PeerConnection(t),this.worldServer.addCallback("World, please.",(()=>r(this,void 0,void 0,(function*(){return yield this.loadFromSavedState()})))),this.personalConnection.sendAndPromiseResponse(t,"World, please.").then((t=>{this.buildFromString(t)})).catch((t=>{i.Log.info("Failed to get world: "+t)}))}))}getPlayerCoords(){const t=this.state.players.get(this.username);return null!=t?t.xyz:new Float32Array([20,0,12])}getThings(t){return this.state.getThings(t)}saveLoop(){const t=this.state.serialize();window.localStorage.setItem(`${this.worldName}-world`,t),setTimeout((()=>{this.saveLoop()}),2e3);const e="data:text/javascript;base64,"+btoa(t);this.saveButton.href=e}loadFromSavedState(){return r(this,void 0,void 0,(function*(){const t=window.localStorage.getItem(`${this.worldName}-world`),e=new URL(document.URL);return t&&!e.searchParams.get("reset")?new Promise(((e,n)=>{i.Log.info("Loading from local storage."),e(t)})):(i.Log.info("Loading from json"),this.load("emptyWorld.json"))}))}load(t){return r(this,void 0,void 0,(function*(){return new Promise(((e,n)=>{const r=new XMLHttpRequest;r.open("GET",t,!0),r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){var t=r.status;0===t||t>=200&&t<400?e(r.responseText):n("Failed to load world.")}},r.send()}))}))}getState(){return this.loaded?new Promise(((t,e)=>{t(this.state)})):new Promise(((t,e)=>{this.loadedCallback=t}))}applyDelta(t){this.state.apply(t)}buildFromString(t){if(this.state.deserialize(t),this.state.players.has(this.username))i.Log.info(`Welcome back, ${this.username}.`);else{i.Log.info(`${this.username} is new to this world.`);const t=this.state.players.get("_prototype");this.state.players.set(this.username,t)}i.Log.info(`Loaded ${this.state.library.size()} libraries.`);for(const t of this.state.library.libraryNames())i.Log.info(`Library: ${t}`);this.loaded=!0,this.loadedCallback&&(this.loadedCallback(this.state),this.loadedCallback=null),this.saveLoop()}}}},e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(138)})();
//# sourceMappingURL=main.js.map